% Copyright (C) 2004-2015 Internet Systems Consortium, Inc. ("ISC")
% Copyright (C) 2000-2003 Internet Software Consortium.
% 
% Permission to use, copy, modify, and distribute this software for any
% purpose with or without fee is hereby granted, provided that the above
% copyright notice and this permission notice appear in all copies.
% 
% THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
% REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
% AND FITNESS. IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
% INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
% LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
% OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
% PERFORMANCE OF THIS SOFTWARE.
% ------------------------------------------------------------	
% Autogenerated LaTeX file for books	
% ------------------------------------------------------------	
\ifx\pdfoutput\undefined
\documentclass[,10pt,twoside,openright,]{report}
\else
\documentclass[pdftex,,10pt,twoside,openright,]{report}
\fi
\label{idm178377938720}\usepackage{ifthen}
% --------------------------------------------
% Check for PDFLaTeX/LaTeX 
% --------------------------------------------
%\newif\ifpdf
%\ifx\pdfoutput\undefined
%\pdffalse % we are not running PDFLaTeX
%\else
%\pdfoutput=1 % we are running PDFLaTeX
%\pdftrue
%\fi
\RequirePackage{ifpdf}
% --------------------------------------------
% Load graphicx package with pdf if needed 
% --------------------------------------------
\ifpdf
\usepackage[pdftex]{graphicx}
\pdfcompresslevel=9
\else
\usepackage{graphicx}
\fi
\usepackage{anysize}
\marginsize{3cm}{2cm}{1.25cm}{1.25cm}

\makeatletter
% redefine the listoffigures and listoftables so that the name of the chapter
% is printed whenever there are figures or tables from that chapter. encourage
% pagebreak prior to the name of the chapter (discourage orphans).
\let\save@@chapter\@chapter
\let\save@@l@figure\l@figure
\let\the@l@figure@leader\relax
\def\@chapter[#1]#2{\save@@chapter[{#1}]{#2}%
\addtocontents{lof}{\protect\def\the@l@figure@leader{\protect\pagebreak[0]\protect\contentsline{chapter}{\protect\numberline{\thechapter}#1}{}{\thepage}}}%
\addtocontents{lot}{\protect\def\the@l@figure@leader{\protect\pagebreak[0]\protect\contentsline{chapter}{\protect\numberline{\thechapter}#1}{}{\thepage}}}%
}
\renewcommand*\l@figure{\the@l@figure@leader\let\the@l@figure@leader\relax\save@@l@figure}
\let\l@table\l@figure
\makeatother
\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
% Safeguard against long headers.
\IfFileExists{truncate.sty}{
\usepackage{truncate}
% Use an ellipsis when text would be larger than x% of the text width.
% Preserve left/right text alignment using \hfill (works for English).
\fancyhead[ol]{\truncate{0.49\textwidth}{\sl\leftmark}}
\fancyhead[er]{\truncate{0.49\textwidth}{\hfill\sl\rightmark}}
\fancyhead[el]{\truncate{0.49\textwidth}{\sl\leftmark}}
\fancyhead[or]{\truncate{0.49\textwidth}{\hfill\sl\rightmark}}
}{\typeout{WARNING: truncate.sty wasn't available and functionality was skipped.}}
\pagestyle{fancy}
% ---------------------- 
% Most Common Packages   
% ---------------------- 
\usepackage{latexsym}         
\usepackage{enumerate}         
\usepackage{fancybox}      
\usepackage{float}       
\usepackage{ragged2e}       
\usepackage{fancyvrb}         
\makeatletter\@namedef{FV@fontfamily@default}{\def\FV@FontScanPrep{}\def\FV@FontFamily{}}\makeatother
\fvset{obeytabs=true,tabsize=3}
\usepackage{parskip}         
\usepackage{rotating}         
\usepackage{subfigure}         
\usepackage{tabularx}         
\usepackage{longtable}         
\usepackage{url}         
% --------------------------------------------
% Math support                                
% --------------------------------------------
\usepackage{amsmath,amsthm, amsfonts, amssymb, amsxtra,amsopn}
%\newtheorem{thm}{Theorem}[section]
%\newtheorem{cor}[section]{Corollary}
%\newtheorem{lem}[section]{Lemma}
%\newtheorem{defn}[section]{Definition}
%\newtheorem{prop}[section]{Proposition}
%\newtheorem{ax}{Axiom}
%\newtheorem{theorem}[section]{Theorem}
%\newtheorem{corollary}{Corollary}
%\newtheorem{lemma}{Lemma}
%\newtheorem{proposition}{Proposition}
%\theoremstyle{definition}
%\newtheorem{definition}{Definition}
%\theoremstyle{remark}
%\newtheorem{rem}{Remark}
%\newtheorem*{notation}{Notation}
%\newcommand{\ntt}{\normalfont\ttfamily}
%\newcommand{\thmref}[1]{Theorem~\ref{#1}}
%\newcommand{\secref}[1]{\S\ref{#1}}
%\newcommand{\lemref}[1]{Lemma~\ref{#1}}
 \newcommand{\bysame}{\mbox{\rule{3em}{.4pt}}\,}
 \newcommand{\A}{\mathcal{A}}
 \newcommand{\B}{\mathcal{B}}
 \newcommand{\XcY}{{(X,Y)}}
 \newcommand{\SX}{{S_X}}
 \newcommand{\SY}{{S_Y}}
 \newcommand{\SXY}{{S_{X,Y}}}
 \newcommand{\SXgYy}{{S_{X|Y}(y)}}
 \newcommand{\Cw}[1]{{\hat C_#1(X|Y)}}
 \newcommand{\G}{{G(X|Y)}}
 \newcommand{\PY}{{P_{\mathcal{Y}}}}
 \newcommand{\X}{\mathcal{X}}
 \newcommand{\wt}{\widetilde}
 \newcommand{\wh}{\widehat}
 % --------------------------------------------
 %\DeclareMathOperator{\per}{per}
 \DeclareMathOperator{\cov}{cov}
 \DeclareMathOperator{\non}{non}
 \DeclareMathOperator{\cf}{cf}
 \DeclareMathOperator{\add}{add}
 \DeclareMathOperator{\Cham}{Cham}
 \DeclareMathOperator{\IM}{Im}
 \DeclareMathOperator{\esssup}{ess\,sup}
 \DeclareMathOperator{\meas}{meas}
 \DeclareMathOperator{\seg}{seg}
% --------------------------------------------
% ---------------
% Document Font  
% ---------------
\usepackage{palatino}
% --------------------------------------------
% Load hyperref package with pdf if needed 
% --------------------------------------------
\ifpdf
\usepackage[pdftex,CJKbookmarks,bookmarksnumbered,colorlinks,backref,bookmarks,breaklinks,linktocpage,plainpages=false,pdfstartview=FitH]{hyperref}
\else
\usepackage[bookmarksnumbered,colorlinks,backref,bookmarks,breaklinks,linktocpage,plainpages=false,]{hyperref}
\fi
% --------------------------------------------
% ----------------------------------------------
% Define a new LaTeX environment (adminipage)
% ----------------------------------------------
\newenvironment{admminipage}%
{ % this code corresponds to the \begin{adminipage} command
 \begin{Sbox}%
 \begin{minipage}%
} %done
{ % this code corresponds to the \end{adminipage} command
 \end{minipage}
 \end{Sbox}
 \fbox{\TheSbox}
} %done
% ----------------------------------------------
% Define a new LaTeX length (admlength)
% ----------------------------------------------
\newlength{\admlength}
% ----------------------------------------------
% Define a new LaTeX environment (admonition)
% With 2 parameters:
% #1 The file (e.g. note.pdf)
% #2 The caption
% ----------------------------------------------
\newenvironment{admonition}[2] 
{ % this code corresponds to the \begin{admonition} command
 \hspace{0mm}\newline\hspace*\fill\newline
 \noindent
 \setlength{\fboxsep}{5pt}
 \setlength{\admlength}{\linewidth}
 \addtolength{\admlength}{-10\fboxsep}
 \addtolength{\admlength}{-10\fboxrule}
 \admminipage{\admlength}
 {\bfseries \sc\large{#2}} \newline
 \\[1mm]
 \sffamily
 \includegraphics[width=1cm]{#1}
 \addtolength{\admlength}{-1cm}
 \addtolength{\admlength}{-20pt}
 \begin{minipage}[lt]{\admlength}
 \parskip=0.5\baselineskip \advance\parskip by 0pt plus 2pt
} %done
{ % this code corresponds to the \end{admonition} command
 \vspace{5mm} 
 \end{minipage}
 \endadmminipage
 \vspace{.5em}
 \par
}
% --------------------------------------------
% Commands to manage/style/create floats      
% figures, tables, algorithms, examples, eqn  
% --------------------------------------------
 \floatstyle{ruled}
 \restylefloat{figure}
 \floatstyle{ruled}
 \restylefloat{table}
 \floatstyle{ruled}
 \newfloat{program}{ht}{lop}[section]
 \floatstyle{ruled}
 \newfloat{example}{ht}{loe}[section]
 \floatname{example}{Example}
 \floatstyle{ruled}
 \newfloat{dbequation}{ht}{loe}[section]
 \makeatletter\def\toclevel@dbequation{0}\makeatother
 \floatname{dbequation}{Equation}
 \floatstyle{boxed}
 \newfloat{algorithm}{ht}{loa}[section]
 \floatname{algorithm}{Algorithm}
\ifpdf
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\else
\DeclareGraphicsExtensions{.eps}
\fi
% --------------------------------------------
% $latex.caption.swapskip enabled for $formal.title.placement support
\newlength{\docbooktolatextempskip}
\newcommand{\captionswapskip}{\setlength{\docbooktolatextempskip}{\abovecaptionskip}\setlength{\abovecaptionskip}{\belowcaptionskip}\setlength{\belowcaptionskip}{\docbooktolatextempskip}}
\usepackage[english]{babel} 
% Guard against a problem with old package versions.
\makeatletter
\AtBeginDocument{
\DeclareRobustCommand\ref{\@refstar}
\DeclareRobustCommand\pageref{\@pagerefstar}
}
\makeatother
% --------------------------------------------
\makeatletter
\newcommand{\dbz}{\penalty \z@}
\newcommand{\docbooktolatexpipe}{\ensuremath{|}\dbz}
\newskip\docbooktolatexoldparskip
\newcommand{\docbooktolatexnoparskip}{\docbooktolatexoldparskip=\parskip\parskip=0pt plus 1pt}
\newcommand{\docbooktolatexrestoreparskip}{\parskip=\docbooktolatexoldparskip}
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else\hbox{}\thispagestyle{empty}\newpage\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\usepackage[latin1]{inputenc}

\ifx\dblatex@chaptersmark\@undefined\def\dblatex@chaptersmark#1{\markboth{\MakeUppercase{#1}}{}}\fi
\let\save@makeschapterhead\@makeschapterhead
\def\dblatex@makeschapterhead#1{\vspace*{-80pt}\save@makeschapterhead{#1}}
\def\@makeschapterhead#1{\dblatex@makeschapterhead{#1}\dblatex@chaptersmark{#1}}

			
\AtBeginDocument{\ifx\refname\@undefined\let\docbooktolatexbibname\bibname\def\docbooktolatexbibnamex{\bibname}\else\let\docbooktolatexbibname\refname\def\docbooktolatexbibnamex{\refname}\fi}
% Facilitate use of \cite with \label
\newcommand{\docbooktolatexbibaux}[2]{%
  \protected@write\@auxout{}{\string\global\string\@namedef{docbooktolatexcite@#1}{#2}}
}
% Provide support for bibliography `subsection' environments with titles
\newenvironment{docbooktolatexbibliography}[3]{
   \begingroup
   \let\save@@chapter\chapter
   \let\save@@section\section
   \let\save@@@mkboth\@mkboth
   \let\save@@bibname\bibname
   \let\save@@refname\refname
   \let\@mkboth\@gobbletwo
   \def\@tempa{#3}
   \def\@tempb{}
   \ifx\@tempa\@tempb
      \let\chapter\@gobbletwo
      \let\section\@gobbletwo
      \let\bibname\relax
   \else
      \let\chapter#2
      \let\section#2
      \let\bibname\@tempa
   \fi
   \let\refname\bibname
   \begin{thebibliography}{#1}
}{
   \end{thebibliography}
   \let\chapter\save@@chapter
   \let\section\save@@section
   \let\@mkboth\save@@@mkboth
   \let\bibname\save@@bibname
   \let\refname\save@@refname
   \endgroup
}

		
			
%\usepackage{cite}
%\renewcommand\citeleft{(}  % parentheses around list
%\renewcommand\citeright{)} % parentheses around list
\newcommand{\docbooktolatexcite}[2]{%
  \@ifundefined{docbooktolatexcite@#1}%
  {\cite{#1}}%
  {\def\@docbooktolatextemp{#2}\ifx\@docbooktolatextemp\@empty%
   \cite{\@nameuse{docbooktolatexcite@#1}}%
   \else\cite[#2]{\@nameuse{docbooktolatexcite@#1}}%
   \fi%
  }%
}
\newcommand{\docbooktolatexbackcite}[1]{%
  \ifx\Hy@backout\@undefined\else%
    \@ifundefined{docbooktolatexcite@#1}{%
      % emit warning?
    }{%
      \ifBR@verbose%
        \PackageInfo{backref}{back cite \string`#1\string' as \string`\@nameuse{docbooktolatexcite@#1}\string'}%
      \fi%
      \Hy@backout{\@nameuse{docbooktolatexcite@#1}}%
    }%
  \fi%
}

		
			
% --------------------------------------------
% A way to honour <footnoteref>s
% Blame j-devenish (at) users.sourceforge.net
% In any other LaTeX context, this would probably go into a style file.
\newcommand{\docbooktolatexusefootnoteref}[1]{\@ifundefined{@fn@label@#1}%
  {\hbox{\@textsuperscript{\normalfont ?}}%
    \@latex@warning{Footnote label `#1' was not defined}}%
  {\@nameuse{@fn@label@#1}}}
\newcommand{\docbooktolatexmakefootnoteref}[1]{%
  \protected@write\@auxout{}%
    {\global\string\@namedef{@fn@label@#1}{\@makefnmark}}%
  \@namedef{@fn@label@#1}{\hbox{\@textsuperscript{\normalfont ?}}}%
  }

		
			
% index labeling helper
\newif\ifdocbooktolatexprintindex\docbooktolatexprintindextrue
\let\dbtolatex@@theindex\theindex
\let\dbtolatex@@endtheindex\endtheindex
\def\theindex{\relax}
\def\endtheindex{\relax}
\newenvironment{dbtolatexindex}[1]
   {
\if@openright\cleardoublepage\else\clearpage\fi
\let\dbtolatex@@indexname\indexname
\def\dbtolatex@indexlabel{%
 \ifnum \c@secnumdepth >\m@ne \refstepcounter{chapter}\fi%
 \label{#1}\hypertarget{#1}{\dbtolatex@@indexname}%
 \global\docbooktolatexprintindexfalse}
\def\indexname{\ifdocbooktolatexprintindex\dbtolatex@indexlabel\else\dbtolatex@@indexname\fi}
\dbtolatex@@theindex
   }
   {
\dbtolatex@@endtheindex\let\indexname\dbtolatex@@indexname
   }

\newlength\saveparskip \newlength\saveparindent
\newlength\tempparskip \newlength\tempparindent

		
\def\docbooktolatexgobble{\expandafter\@gobble}
% Prevent multiple openings of the same aux file
% (happens when backref is used with multiple bibliography environments)
\ifx\AfterBeginDocument\undefined\let\AfterBeginDocument\AtBeginDocument\fi
\AfterBeginDocument{
   \let\latex@@starttoc\@starttoc
   \def\@starttoc#1{%
      \@ifundefined{docbooktolatex@aux#1}{%
         \global\@namedef{docbooktolatex@aux#1}{}%
         \latex@@starttoc{#1}%
      }{}
   }
}
% --------------------------------------------
% Hacks for honouring row/entry/@align
% (\hspace not effective when in paragraph mode)
% Naming convention for these macros is:
% 'docbooktolatex' 'align' {alignment-type} {position-within-entry}
% where r = right, l = left, c = centre
\newcommand{\docbooktolatex@align}[2]{\protect\ifvmode#1\else\ifx\LT@@tabarray\@undefined#2\else#1\fi\fi}
\newcommand{\docbooktolatexalignll}{\docbooktolatex@align{\raggedright}{}}
\newcommand{\docbooktolatexalignlr}{\docbooktolatex@align{}{\hspace*\fill}}
\newcommand{\docbooktolatexaligncl}{\docbooktolatex@align{\centering}{\hfill}}
\newcommand{\docbooktolatexaligncr}{\docbooktolatex@align{}{\hspace*\fill}}
\newcommand{\docbooktolatexalignrl}{\protect\ifvmode\raggedleft\else\hfill\fi}
\newcommand{\docbooktolatexalignrr}{}
\ifx\captionswapskip\@undefined\newcommand{\captionswapskip}{}\fi
\makeatother
\title{\bfseries BIND 9管理员参考手册}
\author{}
% --------------------------------------------
\makeindex
\makeglossary
% --------------------------------------------

\setcounter{tocdepth}{4}

\setcounter{secnumdepth}{4}

% Handle the lines with both chinese characters and ASCII.
\sloppy

\usepackage{CJK}
%\usepackage[dvips,CJKbookmarks]{hyperref}

\begin{document}

%\begin{CJK*}{GBK}{fang}
\begin{CJK*}{GB}{gbsn}
\CJKtilde


\InputIfFileExists{title}{\typeout{WARNING: Using cover page title}}
      \begin{titlepage}
        \null\vfil
        \vskip 60pt
        \begin{center}%
          { %\LARGE
	    \Huge
	    \bfseries
            BIND 9管理员参考手册
            \par}%
          \vskip 3em%
          { %\large
	    \Large
            \lineskip .75em%
            BIND版本9.10.2
            \par}
          %\vskip 1.5em%
	  \vfil
	  % Not sure exactly how much to trim logo, but given that
	  % this is a centered environment, we need not be too precise
	  % so long as the image is centered in the input PDF, we
	  % trim enough for it to fit on page, and we do not trim
	  % so much that we clip out part of the graphic itself.
	  % This seems to work, anyway.
	  \includegraphics[trim=400 400 400 400,scale=2.5]{isc-logo}
        \end{center}\par
        \vfil\null
      \end{titlepage}
    
\thispagestyle{empty}
\begin{center}Copyright \copyright{} 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015 Internet Systems Consortium, Inc. ("ISC")\end{center}
\begin{center}Copyright \copyright{} 2000, 2001, 2002, 2003 Internet Software Consortium.\end{center}
\begin{center}

      Permission to use, copy, modify, and distribute this software for any
      purpose with or without fee is hereby granted, provided that the above
      copyright notice and this permission notice appear in all copies.

      THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
      OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
    \end{center}

      \vfill
      \begin{center}
      Internet System Consortium \\
      950 Charter Street \\
      Redwood City, California \\
      USA \\
      http://www.isc.org/
      \end{center}
    
      \newpage
      \pagenumbering{roman}
      

\begin{center}Copyright \copyright{} 2008-2015 本文档中文版权归sunguonian@gmail.com所有\end{center}
\begin{center}

允许任何个人、任何组织以任何目的、任何形式付费或免费使用，拷贝，修改和分发
本文档，前提是需要在所有拷贝中出现上述的版权声明和本许可声明。
\end{center}

\tableofcontents
      \newpage
      \pagenumbering{arabic}
    
% -------------------------------------------------------------
% Chapter 介绍 
% ------------------------------------------------------------- 	
\chapter{介绍}
\label{Bv9ARM-gbk.ch01}\hypertarget{Bv9ARM-gbk.ch01}{}%

互联网域名系统（DNS）由以下几个部份组成： 在互联网中以层次体系方式指定实体名字的语法，用于在名字之间 授权的规则，和实际完成从名字到互联网地址映射的系统实现。 DNS数据是维护在一组分布式层次数据库中。

% ------------------------   
% Section 
\section{文档范围}
\label{idm178378044736}\hypertarget{idm178378044736}{}%

伯克利互联网名字域（Berkeley Internet Name Domain， BIND）在一些操作系统上实现了一个名字服务器。 本文档为系统管理员提供了安装和维护互联网系统集团 （Internet Systems Consortium，ISC） 的BIND版本9软件包的基本信息。

这个版本的手册对应于BIND的9.10版本。

% ------------------------   
% Section 
\section{本文档的组织}
\label{idm178377911712}\hypertarget{idm178377911712}{}%

在本文档中， {\em{第一章}}介绍DNS 和BIND的基本概念。 {\em{第二章}} 描述了在不同环境中运行BIND对资源的要求。 {\em{第三章}}中的信息以{\em{面向任务}} 的方式表述并按功能组织，目标是为BIND9软件的安装过程 提供帮助。接下来的{\em{第四章}}也是面向任务的部份， 它包含更多的系统管理员实现某种选项可能会用到的高级概念。 {\em{第五章}}描述BIND 9 的轻量级 解析器。{\em{第六章}}的内容按照参考手册组织，以帮助 正在进行的软件维护。{\em{第七章}}指明安全考虑， {\em{第八章}}包含排错帮助。文档主体后面是几个 {\em{附录}}，其中包含了一些有用的参考信息，例如一个 {\em{参考书目}}以及与BIND和域名系统 相关的历史信息。

% ------------------------   
% Section 
\section{本文档中的惯例}
\label{idm178377903392}\hypertarget{idm178377903392}{}%

在本文档中，我们使用以下的排版惯例：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178377902176}\hypertarget{idm178377902176}{}%
\begin{longtable}{|p{3.000in}|p{2.625in}|}
\hline 
{{{\em{要描述的内容：}}}} & {{{\em{我们使用的风格：}}}} \tabularnewline
 \hline 
{{一个路径，文件名，URL，主机名，邮件列表名，或者新的术语或概念}} & {{{\texttt{{Fixed width 固定宽度}}}}} \tabularnewline
 \hline 
{{用户输入}} & {{{\ttfamily\bfseries{{Fixed Width Bold 固定宽度的黑体}}}}} \tabularnewline
 \hline 
{{程序输出}} & {{{\texttt{{Fixed Width 固定宽度}}}}} \tabularnewline
\hline 
\end{longtable}
\end{center}


下列排版惯例用于描述BIND配置文件： 
% tabular ------------------------------------------------------
\begin{center}
\label{idm178377885792}\hypertarget{idm178377885792}{}%
\begin{longtable}{|p{3.000in}p{2.625in}|}
\hline 
{{{\em{要描述的内容：}}}} & {{{\em{我们使用的风格：}}}} \tabularnewline
{{关键字}} & {{{\texttt{{Fixed Width 固定宽度}}}}} \tabularnewline
{{变量}} & {{{\texttt{{Fixed Width 固定宽度}}}}} \tabularnewline
{{可选输入}} & {{[Text is enclosed in square brackets 文本在方括号之内]}} \tabularnewline
\hline 
\end{longtable}
\end{center}



% ------------------------   
% Section 
\section{域名系统（DNS）}
\label{idm178377865024}\hypertarget{idm178377865024}{}%

本文档的目的是解释BIND （Berkeley Internet Name Domain ）软件包的安装和维护，我们通过回顾 域名系统（Domain Name System，DNS）基础及其与 BIND的关系来作为开始。
\subsection{DNS基础}
\label{idm178377862048}\hypertarget{idm178377862048}{}%

域名系统（DNS）是一个层次化的分布式数据库。它存储用于互联网主机名与 IP 地址相互映射的信息，邮件路由信息，及其它互联网应用所用到的数据。

客户端通过调用一个{\em{解析器}}库来在 DNS 中查找信息， 解析器向一个或多个{\em{名字服务器}}发出请求并解释响应。 BIND 9软件分发包中包括一个名字服务器， {\bfseries{named}}，和一个解析器库， {\bfseries{liblwres}}。旧的 {\bfseries{libbind}}解析器库也可以作为一个单独的下载包从 ISC得到。
\subsection{域和域名}
\label{idm178377857200}\hypertarget{idm178377857200}{}%

存储在 DNS 中的数据以{\em{域名}}来标识，并根据类别或 行政区被组织成一颗树。树中的每个节点由一个标记表示，被成为一个 {\em{域}}。节点的域名就是将从这个节点到{\em{根}}节点的路径所经过的所有标记串接而成。它被表示成的书面格式 是从右至左以点分隔的标记串。 一个标记在其父域之内是唯一的。

例如，一个名叫{\em{Example}}的公司中的一台主机的域名 可以是{\texttt{{ourhost.\dbz{}example.\dbz{}com}}}，这里{\texttt{{com}}}是{\texttt{{ourhost.\dbz{}example.\dbz{}com}}}所属于的顶级域， {\texttt{{example}}}是{\texttt{{com}}}下的一个子域， 而{\texttt{{ourhost}}}是主机名。

为管理考虑，名字空间划分为名叫{\em{区}}的单位，每个区 以节点开始，向下扩展到树叶或其它区开始的节点。每个区的数据存储在一个 {\em{名字服务器}}中，名字服务器使用{\em{DNS协议}}回答对区的查询。

每个域名相关的数据以{\em{资源记录}}（resource records， RR）的形式存储。一些所支持的资源记录类型在 \hyperlink{types_of_resource_records_and_when_to_use_them}{第\ref{types_of_resource_records_and_when_to_use_them}节} 中描述。

关于DNS设计和DNS协议的更详细的信息，请参见\hyperlink{rfcs}{第\ref{rfcs}节}中 所列的标准文档。
\subsection{区}
\label{idm178377845744}\hypertarget{idm178377845744}{}%

为正确运行一个名字服务器，理解一个{\em{区}}和一个 {\em{域}}之间的差别是很重要的。

正如前面所说，区是DNS树的一个授权点。一个区是由 域树中那些邻接部份组成，名字服务器具有这部份域树的全部信息，并是 这部份域树的权威。它包含域树中自某个节点之下的所有域名，除那些被授权 到其它区的之外。一个授权点在父区中以一个或多个{\em{NS}} 记录表示，它应该与被授权区的根的 NS 记录匹配。

例如，考虑{\texttt{{example.\dbz{}com}}}域，它可以包含这样的名字： {\texttt{{host.\dbz{}aaa.\dbz{}example.\dbz{}com}}}和 {\texttt{{host.\dbz{}bbb.\dbz{}example.\dbz{}com}}}，即使 {\texttt{{example.\dbz{}com}}}区只包括 {\texttt{{aaa.\dbz{}example.\dbz{}com}}}和 {\texttt{{bbb.\dbz{}example.\dbz{}com}}}区的授权。 区可以精确对应到一个单一的域，也可以对应到域的一部份，而其它部份则可 授权到其它名字服务器。DNS树中的每个名字都是一个 {\em{域}}，即使它是{\em{终端节点}}， 只不过这样就没有{\em{子域}}。每个子域都是一个域， 除了根之外的所有域同时都是一个子域。术语不太形象，我们建议你阅读 RFC 1033、1034 和 1035 以获得对这个艰难而微妙问题的完整理解。

虽然BIND被称为一个“域名服务器”， 但它主要处理的是区。在{\texttt{{named.\dbz{}conf}}}文件中声明的 主服务器和辅服务器都是指的区，而不是域。当你询问一些其它站点是否愿意 充当你的{\em{域}}的辅服务器时，你实际上是想要其对一些区 来担当辅服务器的服务。
\subsection{权威名字服务器}
\label{idm178377834304}\hypertarget{idm178377834304}{}%

每个区至少由一台{\em{权威名字服务器}}来服务。后者包含了 这个区的全部数据。为了使DNS能在服务器和网络故障时照常工作，大多数区都 有两个或更多的权威服务器，并且分布在不同的网络中。

权威服务器的应答的数据包中包括“权威回答”（AA）位。 这在使用象{\bfseries{dig}} （\hyperlink{diagnostic_tools}{第\ref{diagnostic_tools}节}） 这样的工具来调试DNS配置时容易鉴别。
\subsubsection{主服务器}
\label{idm178377830864}\hypertarget{idm178377830864}{}%

维护有原始区数据的权威服务器被称为{\em{主服务器}}， 或简称{\em{主}}。典型情况下，它从某个本地文件装载 区数据，这个本地文件是由手工编辑，或者由某个手工编辑的其它本地文件 所生成。这个文件叫做{\em{区文件}}或{\em{主文件}}。

在某些情况下，主文件是完全无法由手工编辑而成，只能是以 {\em{动态更新}}操作的结果来代替。
\subsubsection{辅服务器}
\label{idm178377826624}\hypertarget{idm178377826624}{}%

其它的权威服务器，{\em{辅服务器}}（slave，也被称为 secondary）通过一个名叫{\em{区传送}}（zone transfer） 的复制过程从其它服务器中取得区的内容。典型情况下，数据直接从 主服务器传送，但是也可能从其它辅服务器传送。换句话说，一个辅服务器 本身也可以充当一个二级辅服务器的主服务器。
\subsubsection{隐藏服务器}
\label{idm178377823776}\hypertarget{idm178377823776}{}%

通常区的所有权威服务器都在其上级区中有NS 记录。这些NS 记录组成了 上级对这个区的{\em{授权}}。权威服务器也在其自己的 区文件中列出，位置在区的{\em{顶级}}（top level）或 {\em{顶点（apex）}}。你可以在区的顶级NS 记录中列出在 上级区中没有NS授权的服务器，但是你不能在上级区中对不在区顶级中出现 的服务器授权。

一个{\em{隐藏服务器}}就是指是一个区的权威服务器但却 没有出现在区的NS 记录中。隐藏服务器可以用来保存一个区的本地拷贝，以 加速对区记录的访问，或者在区的所有“官方”服务器都无法访问时仍然 使区可用。

一个主服务器本身是作为一个隐藏服务器配置时，通常被称为一个 “隐藏主服务器”配置。这种配置的一个用途是主服务器在一个防火墙的 后面而不能直接同外面的世界通信。
\subsection{缓存名字服务器}
\label{idm178377818224}\hypertarget{idm178377818224}{}%

由大多数操作系统所提供的解析库叫做{\em{存根解析器}}， 意思是它们没有能够通过直接与权威服务器通信而执行完全的域名解析过程的 能力。作为代替，它们依赖一个本地名字服务器来为它们执行解析。这样的 服务器称为{\em{递归的}}名字服务器；它为本地客户端执行 {\em{递归查找}}。

为增强性能，递归服务器缓存它们所执行查找的结果。由于递归过程和缓存是 密切相联的，术语{\em{递归服务器}}和{\em{缓存服务器}}通常是作为同义词使用的。

在一个缓存名字服务器的缓存中，一个记录被保留的时间长短是由与每个资源 记录相关的生存期（Time To Live, TTL）字段所控制的。
\subsubsection{转发}
\label{idm178377812672}\hypertarget{idm178377812672}{}%

即使一个缓存名字服务器也可以不需要由其本身来执行递归查找。 作为代替，它可以将其自身缓存中没有的一些或全部请求 {\em{转发}}到另一个缓存服务器，后者通常被称为 一个{\em{转发服务器}}。

可以有一个或多个转发服务器，它们轮流被请求，直到名单被遍历 或者找到答案为止。使用转发服务器的典型情况是，当你不希望一个 站点的所有服务器都与互联网上的其它服务器直接打交道时。一个 典型的景象会涉及到一些内部DNS服务器和一个 互联网防火墙。不能穿过防火墙的服务器就向能够穿过防火墙的 服务器转发请求，后者代表内部的服务器向互联网上的 DNS发请求。
\subsection{名字服务器的多个角色}
\label{idm178377808016}\hypertarget{idm178377808016}{}%

BIND名字服务器可以同时作为一些区的主服务器， 另一些区的辅服务器以及为一些本地客户端充当缓存（递归）服务器。

然而，由于权威名字服务和缓存/递归名字服务的功能在逻辑上是分离的，通常 将它们分别运行在分离的服务器上更有利些。一个只提供权威名字服务的服务 器（一个{\em{只权威服务器}}）可以关掉递归功能运行，这样 增强了可靠性和安全性。一个不为任何区作权威服务器并且只为本地客户端提 供递归服务的服务器（一个{\em{只缓存服务器}}）不需要全面 开放给互联网，可以被放在一个防火墙内部。

% -------------------------------------------------------------
% Chapter BIND资源要求 
% ------------------------------------------------------------- 	
\chapter{BIND资源要求}
\label{Bv9ARM-gbk.ch02}\hypertarget{Bv9ARM-gbk.ch02}{}%

% ------------------------   
% Section 
\section{硬件要求}
\label{idm178377802800}\hypertarget{idm178377802800}{}%

传统上，DNS对硬件的要求十分适度。对于许多配置， 从日常服务中淘汰下来的服务器就可以极好地胜任DNS 服务器。

BIND 9的DNSSEC特性需要更多的CPU能力，所以更多使用这 些特性的机构可能需要为其应用考虑更大的系统。BIND 9是 完全支持多线程的，可以完整地利用为其需要而配置的多个处理器。

% ------------------------   
% Section 
\section{CPU要求}
\label{idm178377798896}\hypertarget{idm178377798896}{}%

BIND 9 的CPU要求范围可以从服务于几个静态区并且没有 缓存服务的i486级机器变化到企业级的机器，如果你要处理多个动态更新且有 DNSSEC签名的区，并且可以达到每秒数千个请求。

% ------------------------   
% Section 
\section{内存要求}
\label{idm178377796800}\hypertarget{idm178377796800}{}%

服务器的内存必须足够大，以适合缓存和将区数据从硬盘装载到内存。 {\bfseries{max-cache-size}}选项可以用于限制缓存所使用的内存数量， 代价是减少缓存的命中率并带来更大的DNS流量。另外， 如果附加部份的缓存（\hyperlink{acache}{第\ref{acache}节}）是打开的， {\bfseries{max-acache-size}} 可以用于限制这个机制所使用的内存 总量。最好的实践是保持足够的内存以装载所有的区并在内存中缓存 数据 --- 不幸地，对给定配置来决定这个的最好方法是在运行中观察 名字服务器。经过几周的运行，服务器进程能够达到一个相对稳定的大小， 这时，缓存中因过期而被丢掉的条目与进入缓存的条目的速度一样。

% ------------------------   
% Section 
\section{名字服务器增强环境问题}
\label{idm178377792320}\hypertarget{idm178377792320}{}%

对于名字服务器增强的环境，用到两种可供选择的配置。第一种是客户端和所有 的二级内部名字服务器请求一个主名字服务器，后者有足够的内存来建立一个 巨大的缓存。这个方法最大限度减少了外部名字查找所用到的带宽。第二种是 设置内部的二级服务器来各自独立进行查询。在这个配置中，不需要某台主机 有象第一种方法那样需要巨大的内存和CPU能力，但是这个方法的缺点是需要 更多的外部查询，因为所有的名字服务器都不共享它们缓存的数据。

% ------------------------   
% Section 
\section{所支持的操作系统}
\label{idm178377791168}\hypertarget{idm178377791168}{}%

ISC BIND 9可以在大多数类UNIX操作系统和微软 Windows Server 2003和2008，以及Windows XP和Vista上编译和运行。 查看所支持 系统的最新名单，参见BIND 9源码分发包的顶级目录中的README文件。

% -------------------------------------------------------------
% Chapter 名字服务器配置 
% ------------------------------------------------------------- 	
\chapter{名字服务器配置}
\label{Bv9ARM-gbk.ch03}\hypertarget{Bv9ARM-gbk.ch03}{}%

在本章，我们提供一些建议的配置和与之相关的准则。我们建议给某些选项设置 合理的值。

% ------------------------   
% Section 
\section{样例配置}
\label{sample_configuration}\hypertarget{sample_configuration}{}%
\subsection{一个只缓存名字服务器}
\label{idm178377786560}\hypertarget{idm178377786560}{}%

下列配置样例合适用于一个只缓存名字服务器，用于一个公司的内部客户端。 通过使用{\bfseries{allow-query}}选项，所有外来客户端的请求都被 拒绝。另外一个选择是，使用合适的防火墙规则也可以取得同样的效果。

\begin{Verbatim}[]

// Two corporate subnets we wish to allow queries from.
acl corpnets { 192.168.4.0/24; 192.168.7.0/24; };
options {
     // Working directory
     directory "/etc/namedb";

     allow-query { corpnets; };
};
// Provide a reverse mapping for the loopback
// address 127.0.0.1
zone "0.0.127.in-addr.arpa" {
     type master;
     file "localhost.rev";
     notify no;
};

\end{Verbatim}
\subsection{一个只权威名字服务器}
\label{idm178377783744}\hypertarget{idm178377783744}{}%

这个样例配置是给只作权威服务器的，在这里服务器作 “{\texttt{{example.\dbz{}com}}}”的主服务器和其子域 “{\texttt{{eng.\dbz{}exmaple.\dbz{}com}}}”的辅服务器。

\begin{Verbatim}[]

options {
     // Working directory
     directory "/etc/namedb";
     // Do not allow access to cache
     allow-query-cache { none; };
     // This is the default
     allow-query { any; };
     // Do not provide recursive service
     recursion no;
};

// Provide a reverse mapping for the loopback
// address 127.0.0.1
zone "0.0.127.in-addr.arpa" {
     type master;
     file "localhost.rev";
     notify no;
};
// We are the master server for example.com
zone "example.com" {
     type master;
     file "example.com.db";
     // IP addresses of slave servers allowed to
     // transfer example.com
     allow-transfer {
          192.168.4.14;
          192.168.5.53;
     };
};
// We are a slave server for eng.example.com
zone "eng.example.com" {
     type slave;
     file "eng.example.com.bk";
     // IP address of eng.example.com master server
     masters { 192.168.4.12; };
};

\end{Verbatim}

% ------------------------   
% Section 
\section{负载均衡}
\label{idm178377780064}\hypertarget{idm178377780064}{}%

使用DNS对一个名字配置多个记录（例如多个A记录） 可以完成原始形式的负载均衡。

例如，如果你有3 台WWW 服务器分别使用10.0.0.1，10.0.0.2和10.0.0.3 的网络地址，象以下这个记录集就意味着客户端将会分别对每台机器有 三分之一的连接时间：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178377777024}\hypertarget{idm178377777024}{}%
\begin{longtable}{|p{0.875in}p{0.500in}p{0.750in}p{0.750in}p{2.028in}|}
\hline 
{{Name}} & {{TTL}} & {{CLASS}} & {{TYPE}} & {{Resource Record (RR) Data}} \tabularnewline
{{{\texttt{{www}}}}} & {{{\texttt{{600}}}}} & {{{\texttt{{IN}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}0.\dbz{}0.\dbz{}1}}}}} \tabularnewline
{{}} & {{{\texttt{{600}}}}} & {{{\texttt{{IN}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}0.\dbz{}0.\dbz{}2}}}}} \tabularnewline
{{}} & {{{\texttt{{600}}}}} & {{{\texttt{{IN}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}0.\dbz{}0.\dbz{}3}}}}} \tabularnewline
\hline 
\end{longtable}
\end{center}


当一个解析器请求这些记录时，BIND将滚动这三个记录， 以一个不同的顺序响应请求。在上面的例子中，不同的客户端将会随机收到以 “1，2，3”；“2，3，1”和“3，1，2”的顺序的 记录。大多数客户端将使用所得到的第一个记录而丢弃其余的。

关于将响应排序的更详细的内容，检查{\bfseries{options}} 语句的{\bfseries{rrset-order}}子语句，参见 \hyperlink{rrset_ordering}{资源记录集排序}。

% ------------------------   
% Section 
\section{名字服务器操作}
\label{idm178377737728}\hypertarget{idm178377737728}{}%
\subsection{用于名字服务器后台进程的工具}
\label{idm178377737056}\hypertarget{idm178377737056}{}%

本节描述了几个绝对必要的诊断，管理和监控工具，它们是提供给 系统管理员进行控制和调试名字服务器的。
\subsubsection{诊断工具}
\label{diagnostic_tools}\hypertarget{diagnostic_tools}{}%

{\bfseries{dig}}，{\bfseries{host}}和 {\bfseries{nslookup}}程序都是用于手工向服务器发请求的命令行 工具。他们在输入风格和输出格式上不相同。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dig}}}]\null{}
域名信息探索者（domain information groper, {\bfseries{dig}}）是这些查询工具中最多功能的。它有两种 模式：简单交互模式用于单个请求，批处理模式对有多个请求的 名单中的每一个执行请求。所有选项都可以从命令行访问。
\label{idm178377730064}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\textbf{用法}
\item\raggedright\texttt{dig [@\textit{server}]  \textit{domain}  [\textit{query-type}] [\textit{query-class}] [+\textit{query-option}] [-\textit{dig-option}] [\%\textit{comment}]}
\end{list}

经常使用的{\bfseries{dig}}的简单形式是

{\bfseries{dig @server domain query-type query-class}}

关于更多的可用命令和选项的清单，参见{\bfseries{dig}}的 帮助页。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{host}}}]\null{}
{\bfseries{host}}工具强调简单和易用。缺省情况下， 它在主机名和互联网地址之间互相转换，但它的功能也可使用选项 扩展。
\label{idm178377719616}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\textbf{用法}
\item\raggedright\texttt{host [-aCdlnrsTwv] [-c \textit{class}] [-N \textit{ndots}] [-t \textit{type}] [-W \textit{timeout}] [-R \textit{retries}] [-m \textit{flag}] [-4] [-6]  \textit{hostname}  [\textit{server}]}
\end{list}

关于更多的可用命令和选项的清单，参见{\bfseries{host}}的 帮助页。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{nslookup}}}]\null{}
{\bfseries{nslookup}}有两种模式：交互式和非交互式。 交互模式允许使用者向名字服务器发出对各种主机和域名信息 的查询请求，或者打印出一个域下面的主机列表。非交互模式 只能用于打印所查询的某个主机或域的名字和请求信息。
\label{idm178377708288}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\textbf{用法}
\item\raggedright\texttt{nslookup [-option...] [\textit{host-to-find} | -  [server]]}
\end{list}

在没有给出参数（将会使用缺省的名字服务器）或者第一个参数是 连字符（‘-’）并且第二个参数是主机名或者是一台名字服务器的 IP地址时，就进入了交互模式。

当需要查找的名字或者主机的IP 地址作为第一个参数给出时，就 使用非交互模式。可选的第二个参数指定主机名或者一台名字服务器 的地址。

由于其神秘的用户界面和频繁的不一致表现，我们不推荐使用 {\bfseries{nslookup}}。而使用{\bfseries{dig}} 替代。
\end{description}
\subsubsection{管理工具}
\label{admin_tools}\hypertarget{admin_tools}{}%

管理工具在一个服务器的管理中扮演一个主要角色。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{named-checkconf}}}]\null{}
{\bfseries{named-checkconf}}程序用来检查一个 {\texttt{{named.\dbz{}conf}}}文件的语法。
\label{idm178377696624}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\textbf{用法}
\item\raggedright\texttt{named-checkconf [-jvz] [-t \textit{directory}] [\textit{filename}]}
\end{list}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{named-checkzone}}}]\null{}
{\bfseries{named-checkzone}}程序用来检查一个主文件的 语法和一致性。
\label{idm178377691360}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\textbf{用法}
\item\raggedright\texttt{named-checkzone [-djqvD] [-c \textit{class}] [-o \textit{output}] [-t \textit{directory}] [-w \textit{directory}] [-k \textit{(ignore\docbooktolatexpipe{}warn\docbooktolatexpipe{}fail)}] [-n \textit{(ignore\docbooktolatexpipe{}warn\docbooktolatexpipe{}fail)}] [-W \textit{(ignore\docbooktolatexpipe{}warn)}]  \textit{zone}  [\textit{filename}]}
\end{list}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{named-compilezone}}}]\null{}
与{\bfseries{named-checkzone}}相似，它总是将区的内容转储 到一个指定的文件（通常是一个与区文件不同的格式）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{rndc}}}]\null{}
远程名字服务控制（remote name daemon control， {\bfseries{rndc}}）程序允许系统管理员控制一个名字服务器 的运行。自BIND 9.2以来， {\bfseries{rndc}}支持BIND 8的{\bfseries{ndc}}工具 中除了{\bfseries{ndc start}}和 {\bfseries{ndc restart}}之外的所有命令，而这两个命令在 {\bfseries{ndc}}的通道模式中也是不支持的。如果你不带任 何参数运行{\bfseries{rndc}}，它将显示出以下的用法信息：
\label{idm178377675104}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\textbf{用法}
\item\raggedright\texttt{rndc [-c \textit{config}] [-s \textit{server}] [-p \textit{port}] [-y \textit{key}]  \textit{command}  [\textit{command}...]}
\end{list}

关于可用的{\bfseries{rndc}}命令细节，参见 \hyperlink{man.rndc}{rndc(8)}。

{\bfseries{rndc}}需要一个配置文件，由于所有与服务器的 通信都使用依赖共享 密钥的数字签名来认证，并且没有其它方式可以比配置文件提供 更好的保密方式。{\bfseries{rndc}}配置文件的缺省路 径是{\texttt{{/\dbz{}etc/\dbz{}rndc.\dbz{}conf}}}，但也可以使用 {\texttt{{-c}}}选项来指定一个其它的路径。如果 {\bfseries{rndc}}没有找到找到配置文件，它将会查找 {\texttt{{/\dbz{}etc/\dbz{}rndc.\dbz{}key}}}（或者是 BIND构建时的由 {\texttt{{sysconfdir}}}所定义的其它目录）。 {\texttt{{rndc.\dbz{}key}}}文件是由 {\bfseries{rndc-confgen -a}}所生成，如 \hyperlink{controls_statement_definition_and_usage}{第\ref{controls_statement_definition_and_usage}节} 所描述。

配置文件的格式类似于{\texttt{{named.\dbz{}conf}}}的格式， 但是只有四个语句，{\bfseries{options}}， {\bfseries{key}}，{\bfseries{server}}和 {\bfseries{include}}语句。这些语句都是与密钥相关的， 服务器使用这些密钥共享密钥。语句的顺序没有关系。

{\bfseries{options}}语句有三个子句： {\bfseries{default-server}}， {\bfseries{default-key}}和 {\bfseries{default-port}}。 {\bfseries{default-server}}需要一个主机名或IP地址参数， 它表示一个要通信的缺省的服务器，如果服务器未在命令行中以 {\texttt{{-s}}}选项指定的情况。 {\bfseries{default-key}}以一个密钥的名字作为其参数,密钥 是在{\bfseries{key}}语句中定义的。 {\bfseries{default-port}}指定{\bfseries{rndc}} 用到的缺省端口，它在命令行或{\bfseries{server}}语句中 没有指定端口的情况下生效。

{\bfseries{key}}语句定义{\bfseries{rndc}}同 {\bfseries{named}}进行认证时要用到的密钥。其语法与 {\texttt{{named.\dbz{}conf}}}中的{\bfseries{key}} 语句相同。 {\ttfamily\bfseries{{key}}}关键字后跟一个密钥名，它可以是一个 有效的域名，尽管它并不需要一个层次结构；因而，一个像 “{\ttfamily\bfseries{{rndc\_\dbz{}key}}}”这样的字符串也是一个有效 的名字。{\bfseries{key}}语句有两个子句： {\bfseries{algorithm}}和{\bfseries{secret}}。 配置分析器将接受任何字符串作为算法参数，当前只有字符串 “{\ttfamily\bfseries{{hmac-\dbz{}md5}}}”， “{\ttfamily\bfseries{{hmac-\dbz{}sha1}}}”， “{\ttfamily\bfseries{{hmac-\dbz{}sha224}}}”， “{\ttfamily\bfseries{{hmac-\dbz{}sha256}}}”， “{\ttfamily\bfseries{{hmac-\dbz{}sha384}}}” 和“{\ttfamily\bfseries{{hmac-\dbz{}sha512}}}” 有意义。这个密钥是一个 由RFC 3548所指定的base-64编码的字符串。

{\bfseries{server}}语句将一个由{\bfseries{key}} 语句定义的密钥与一台服务器结合起来。关键字 {\ttfamily\bfseries{{server}}}后跟一个主机名或IP 地址。 {\bfseries{server}}语句有两个子句： {\bfseries{key}}和{\bfseries{port}}。 {\bfseries{key}}子句指定用于同这个服务器通信的密钥， {\bfseries{port}}子句用于指定{\bfseries{rndc}} 用来连接到这个服务器所用的端口。

以下是一个最小配置文件的样例：
\null{}
\begin{Verbatim}[]

key rndc_key {
     algorithm "hmac-sha256";
     secret
       "c3Ryb25nIGVub3VnaCBmb3IgYSBtYW4gYnV0IG1hZGUgZm9yIGEgd29tYW4K";
};
options {
     default-server 127.0.0.1;
     default-key    rndc_key;
};

\end{Verbatim}

这个文件，如果是作为{\texttt{{/\dbz{}etc/\dbz{}rndc.\dbz{}conf}}}安装， 将允许以下命令：

{\texttt{{\$}}}{\ttfamily\bfseries{{rndc reload}}}

经过953 端口连接到127.0.0.1 并使名字服务器重新装载，如果一个 运行在本机的名字服务器使用了以下的控制语句：
\null{}
\begin{Verbatim}[]

controls {
        inet 127.0.0.1
            allow { localhost; } keys { rndc_key; };
};

\end{Verbatim}

并且它有一个对应于{\texttt{{rndc\_\dbz{}key}}}的key 语句。

运行{\bfseries{rndc-confgen}}程序将会方便地为你创建 一个{\texttt{{rndc.\dbz{}conf}}}文件，并且会显示你所需要添加 到{\texttt{{named.\dbz{}conf}}}中的相关的 {\bfseries{controls}}语句。另外一个选择是，你可以运行 {\bfseries{rndc-confgen -a}} 来建立一个{\texttt{{rndc.\dbz{}key}}}文件，就一点也不用修改 {\texttt{{named.\dbz{}conf}}}了。
\end{description}
\subsection{信号}
\label{idm178377632416}\hypertarget{idm178377632416}{}%

某些UNIX信号将使名字服务器进行特定的动作，如下表所列。 这些信号可以由{\bfseries{kill}}命令发出。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178377630672}\hypertarget{idm178377630672}{}%
\begin{longtable}{|p{1.125in}|p{4.000in}|}
\hline 
{{{\bfseries{SIGHUP}}}} & {{使服务器读{\texttt{{named.\dbz{}conf}}}并重新装载数据库。}} \tabularnewline
 \hline 
{{{\bfseries{SIGTERM}}}} & {{使服务器清理并退出。}} \tabularnewline
 \hline 
{{{\bfseries{SIGINT}}}} & {{使服务器清理并退出。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


% -------------------------------------------------------------
% Chapter 高级DNS特征 
% ------------------------------------------------------------- 	
\chapter{高级DNS特征}
\label{Bv9ARM-gbk.ch04}\hypertarget{Bv9ARM-gbk.ch04}{}%

% ------------------------   
% Section 
\section{通知（Notify）}
\label{notify}\hypertarget{notify}{}%

DNS NOTIFY是一个让主服务器通知其辅服务器某个区数据 发生了变化的机制。作为对来自主服务器的{\bfseries{NOTIFY}}的相应， 辅服务器会检查其区的版本是否当前版本，如果不是，就发起区传送。

更多的关于DNS {\bfseries{NOTIFY}}的信息，参见 \hyperlink{boolean_options}{第\ref{boolean_options}节}对{\bfseries{notify}}选项的描述 和\hyperlink{zone_transfers}{第\ref{zone_transfers}节}对区选项 {\bfseries{also-notify}}的描述。 {\bfseries{NOTIFY}}协议由RFC 1996规定。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
一个辅服务器也可以成为其它辅服务器的主服务器，{\bfseries{named}} 在缺省情况下会 对其所载入的每个区发出{\bfseries{NOTIFY}}消息。 指定{\bfseries{notify master-only;}}将使{\bfseries{named}} 只对其所载入区的主服务器发出{\bfseries{NOTIFY}}。\end{admonition}


% ------------------------   
% Section 
\section{动态更新（Dynamic Update）}
\label{dynamic_update}\hypertarget{dynamic_update}{}%

动态更新是一个通过给主服务器发送一个特殊格式的DNS 消息来增加、替换和 删除其上的记录的方法。这些消息的格式和含义由RFC 2136指定。

动态更新是通过在{\bfseries{zone}}语句中包含一个 {\bfseries{allow-update}}或一个 {\bfseries{update-policy}}子句来打开的。

如果区的{\bfseries{update-policy}}被设为 {\ttfamily\bfseries{{local}}}，对区的更新将由密钥 {\texttt{{local-\dbz{}ddns}}}来许可，后者是由 {\bfseries{named}}启动时生成的。更多信息参见 \hyperlink{dynamic_update_policies}{第\ref{dynamic_update_policies}节}。

使用Kerberos签名请求进行的动态更新可以通过使用TKEY/GSS协议来完成， 要么是设置{\bfseries{tkey-gssapi-keytab}}选项，要么是设置 {\bfseries{tkey-gssapi-credential}}和 {\bfseries{tkey-domain}}选项。 一旦开启这个功能，Kerberos签名请求将与区的更新策略进行匹配，使用 Kerberos principal作为请求的签名者。

更新一个安全的区（使用DNSSEC的区）遵循RFC 3007：受更新影响 的RRSIG、NSEC和NSEC3记录通过服务器使用一个在线区密钥来自动 重新生成。更新授权是基于事务签名和一个显式的服务器策略。
\subsection{日志文件}
\label{journal}\hypertarget{journal}{}%

一个使用动态更新的区的所有变化将保存在这个区的日志文件中。这个文件在 第一个更新发生时自动创建。日志文件的名字由相关区文件的名字加上扩展名 “{\texttt{{.\dbz{}jnl}}}”组成，除非指定了名字。日志文件是 二进制格式，不能手工编辑。

服务器会时常将更新后的区的完整内容写到（“dump”）其区文件中。这个 操作不是每次动态更新后立即执行，因为如果这样，一个大的区在频繁更新时 将会导致服务器变得太慢。代替的方法是，转储（dump）操作延迟15 分钟， 以允许其它更新。 在转储过程中，将会创建以{\texttt{{.\dbz{}jnw}}}和 {\texttt{{.\dbz{}jbk}}}为后缀的瞬时文件；在普通情况下，这些 文件将在转储完成后被删除掉，忽略它们也是安全的。

当服务器在停止或宕掉之后重启时，将重新装载日志文件，以将自从上次 区转储以后发生的所有更新合并到区中。

增量区传送所产生的变化也是以类似的方式记录到日志的。

动态更新区的区文件不能象通常那样进行手工编辑，因为没法保证包含最近的 动态变化，这些变化只存在于日志文件中。保持动态更新区的区文件最新的 唯一方法是执行{\bfseries{rndc stop}}。

如果你必须手工修改动态区，需要按照下列步骤：使用 {\bfseries{rndc freeze {\ttfamily\itshape{{zone}}}}}关闭 到这个区的动态更新。 这会使用存放在其“{\texttt{{.\dbz{}jnl}}}”文件中的变化更新区的 主文件。 编辑区文件。执行 {\bfseries{rndc thaw {\ttfamily\itshape{{zone}}}}}重新装载 修改后的区文件并打开动态更新。

{\bfseries{rndc sync {\ttfamily\itshape{{zone}}}}}将使用 日志文件中的变化更新区文件而不停止动态更新；这对观察当前区状态是 有用的。要在更新区文件之后删除{\texttt{{.\dbz{}jnl}}}，使用 {\bfseries{rndc sync -clean}}。

% ------------------------   
% Section 
\section{增量区传送（IXFR）}
\label{incremental_zone_transfers}\hypertarget{incremental_zone_transfers}{}%

增量区传送（incremental zone transfer, IXFR）协议是一个为辅服务器提供 只传送变化的数据的方式，以代替必须传送整个区的方法。IXFR协议由RFC 1995 指定。参见\hyperlink{proposed_standards}{{[建议标准]}}。

当作为一个主服务器时，BIND 9支持IXFR 协议，为区提供 必要的变化历史的信息。这些包括以动态更新维护的主区和通过IXFR获取数据的 辅区。对于手工维护的主区，以及通过全区传送（AXFR）获取数据的辅区， IXFR仅在{\bfseries{ixfr-from-differences}}选项被设置成 {\ttfamily\bfseries{{yes}}}时才支持。

当作为一个辅服务器时，BIND 9将尝试使用IXFR，除非 其被显式关闭。 更多关于关闭IXFR 的信息，参见{\bfseries{server}} 语句的{\bfseries{request-ixfr}}子句的描述。

% ------------------------   
% Section 
\section{分割DNS}
\label{idm178377579376}\hypertarget{idm178377579376}{}%

对DNS空间的内部和外部解析器设置不同的视图，或可见度，通常被称为一个 {\em{分割的DNS}}设置。有几个原因使某个单位想要这样设置 其DNS。

一个以此方式设置DNS系统的共同的原因是对“外部”互联网上的客户隐藏 “内部”DNS信息。关于这样做是否确实有用，有一些争议。内部DNS信息以多种 渠道泄露（例如，通过电子邮件头部），并且大多数聪明的“攻击者”可以使用 其它手段来取得他们所需要的信息。无论如何，由于列出外部客户端不可能访问 到的内部服务器地址可以导致连接延迟和其它烦恼，一个单位可以选择使用一个 分割DNS来向外部世界提供一个一致的自身视图。

另一个设置一个分割DNS系统的共同的原因是允许在过滤器之后或在RFC 1918空间 （保留IP空间，在RFC 1918中说明）中的内部网络去查询互联网上的DNS。分割 DNS也可以用于允许来自外部的回复邮件进入内部网络。
\subsection{分割DNS设置的例子}
\label{idm178377576080}\hypertarget{idm178377576080}{}%

让我们假设一个名叫{\em{Example}}的公司 （{\texttt{{example.\dbz{}com}}}）有几个公司站点，有一个使用保留地址空 间的内部网络和一个外部停火区（ DMZ），或称为网络的“对外”部份，是外部 可以访问到的。

{\em{Example}}公司想要其内部的客户端可以解析外部主机名并 同外面的人们交换电子邮件。公司也想要其内部的解析器可以访问某些内部才有 的区，这些区对内部网络之外的用户不可用。

为达到这个目标，公司设置两台名字服务器。一台在内部网 （在保留地址空间）， 另一台在DMZ中的堡垒主机上，堡垒主机是一个“代理”主机，它可以同其两侧的 网络通信。

内部服务器配置成除了对{\texttt{{site1.\dbz{}internal}}}， {\texttt{{site2.\dbz{}internal}}}， {\texttt{{site1.\dbz{}example.\dbz{}com}}}和 {\texttt{{site2.\dbz{}example.\dbz{}com}}}之外的所有请求都转发给在DMZ的 服务器。这些内部服务器都有关于{\texttt{{site1.\dbz{}example.\dbz{}com}}}， {\texttt{{site2.\dbz{}example.\dbz{}com}}}， {\texttt{{site1.\dbz{}internal}}}和 {\texttt{{site2.\dbz{}internal}}}的全部信息。

为保护{\texttt{{site1.\dbz{}internal}}}和 {\texttt{{site2.\dbz{}internal}}}域，内部服务器必须配置成不允许任何 外部主机对这些域的请求来访问，其中也包括堡垒主机。

在堡垒主机上的外部服务器被配置成服务于 {\texttt{{site1.\dbz{}example.\dbz{}com}}}和 {\texttt{{site2.\dbz{}example.\dbz{}com}}}区的“公共”版本。其中可能包括 这样的一些公共服务器（{\texttt{{www.\dbz{}example.\dbz{}com}}}和 {\texttt{{ftp.\dbz{}example.\dbz{}com}}}）的主机记录以及邮件交换（MX）记录 （{\texttt{{a.\dbz{}mx.\dbz{}example.\dbz{}com}}}和 {\texttt{{b.\dbz{}mx.\dbz{}example.\dbz{}com}}}）。

另外，公共的{\texttt{{site1.\dbz{}example.\dbz{}com}}}和 {\texttt{{site2.\dbz{}example.\dbz{}com}}}区应该有包括通配（‘*’）记录的 特定MX 记录指向堡垒主机。这是必须的，因为外部邮件服务器没有其它任何 方式来查到如何将邮件投递到那些内部的主机。使用通配记录，邮件可以投递 到堡垒主机，堡垒主机再将邮件转发到内部主机。

这里是一个通配MX 记录的例子：

\begin{Verbatim}[]
*   IN MX 10 external1.example.com.
\end{Verbatim}

堡垒主机代表内部网络的任何主机接收邮件，它需要指定如何将邮件投递到 内部主机。为了这样的机制正常运转，堡垒主机上的解析器需要配置成指向 内部名字服务器，以完成DNS解析。

对内部主机的查询请求将由内部服务器回答，对外部主机的查询请求将转发到 堡垒主机上的DNS服务器。

为了让以上这些正常工作，内部客户端需要配置成{\em{只}}请求 内部名字服务器。这个也可以通过网络上的选择性过滤器来进行加强。

如果所有的东西都正确设置，{\em{Example}}公司的 内部客户端将能够：

\begin{itemize}
%--- Item
\item 
查询{\texttt{{site1.\dbz{}example.\dbz{}com}}}和 {\texttt{{site2.\dbz{}example.\dbz{}com}}}区上的所有主机。


%--- Item
\item 
查询{\texttt{{site1.\dbz{}internal}}}和 {\texttt{{site2.\dbz{}internal}}}域上的所有主机。


%--- Item
\item 
查询互联网上的所有主机。


%--- Item
\item 
同内部网和外部网上的人员交换电子邮件。

\end{itemize}

互联网上的主机将能够：

\begin{itemize}
%--- Item
\item 
查询{\texttt{{site1.\dbz{}example.\dbz{}com}}}和 {\texttt{{site2.\dbz{}example.\dbz{}com}}}区上的所有主机。


%--- Item
\item 
同{\texttt{{site1.\dbz{}example.\dbz{}com}}}和 {\texttt{{site2.\dbz{}example.\dbz{}com}}}区上的任何人交换电子邮件。

\end{itemize}

这里是对我们上述描述进行配置的一个例子。注意这里仅仅有配置信息；对于如 何配置你的区文件的信息，参见\hyperlink{sample_configuration}{第\ref{sample_configuration}节}。

内部DNS服务器配置：

\begin{Verbatim}[]


acl internals { 172.16.72.0/24; 192.168.1.0/24; };

acl externals { bastion-ips-go-here; };

options {
    ...
    ...
    forward only;
    // forward to external servers
    forwarders {
        bastion-ips-go-here;
    };
    // sample allow-transfer (no one)
    allow-transfer { none; };
    // restrict query access
    allow-query { internals; externals; };
    // restrict recursion
    allow-recursion { internals; };
    ...
    ...
};

// sample master zone
zone "site1.example.com" {
  type master;
  file "m/site1.example.com";
  // do normal iterative resolution (do not forward)
  forwarders { };
  allow-query { internals; externals; };
  allow-transfer { internals; };
};

// sample slave zone
zone "site2.example.com" {
  type slave;
  file "s/site2.example.com";
  masters { 172.16.72.3; };
  forwarders { };
  allow-query { internals; externals; };
  allow-transfer { internals; };
};

zone "site1.internal" {
  type master;
  file "m/site1.internal";
  forwarders { };
  allow-query { internals; };
  allow-transfer { internals; }
};

zone "site2.internal" {
  type slave;
  file "s/site2.internal";
  masters { 172.16.72.3; };
  forwarders { };
  allow-query { internals };
  allow-transfer { internals; }
};

\end{Verbatim}

外部（堡垒主机）DNS服务器配置：

\begin{Verbatim}[]

acl internals { 172.16.72.0/24; 192.168.1.0/24; };

acl externals { bastion-ips-go-here; };

options {
  ...
  ...
  // sample allow-transfer (no one)
  allow-transfer { none; };
  // default query access
  allow-query { any; };
  // restrict cache access
  allow-query-cache { internals; externals; };
  // restrict recursion
  allow-recursion { internals; externals; };
  ...
  ...
};

// sample slave zone
zone "site1.example.com" {
  type master;
  file "m/site1.foo.com";
  allow-transfer { internals; externals; };
};

zone "site2.example.com" {
  type slave;
  file "s/site2.foo.com";
  masters { another_bastion_host_maybe; };
  allow-transfer { internals; externals; }
};

\end{Verbatim}

堡垒主机上的{\texttt{{resolv.\dbz{}conf}}}（或等效的)文件：

\begin{Verbatim}[]

search ...
nameserver 172.16.72.2
nameserver 172.16.72.3
nameserver 172.16.72.4

\end{Verbatim}

% ------------------------   
% Section 
\section{TSIG}
\label{tsig}\hypertarget{tsig}{}%

这是一个在BIND中设置基于事务安全的事务签名 （Transaction SIGnatures，TSIG）的简短指导。它描述了配置文件需要作的变化， 以及不同特征所要求的变化，包括创建事务密钥的过程和在BIND 中使用事务签名。

BIND基本支持TSIG，用于服务器到服务器的通信。包括 区传送，通知和递归查询的信息。基于BIND 8较新版本的 解析器对TSIG提供有限的支持。

TSIG也可以用于动态更新。使用动态区的主服务器应该控制对动态更新 服务的访问，但是基于IP 的访问控制是不够的。由TSIG所提供的加密访 问控制要好得多。{\bfseries{nsupdate}}程序通过 {\texttt{{-k}}}和{\texttt{{-y}}}命令行选项或使用内置的 {\bfseries{key}}语句来支持TSIG。
\subsection{对每对主机生成共享密钥}
\label{idm178377534096}\hypertarget{idm178377534096}{}%

生成一个共享密钥，由{\em{host1}}和 {\em{host2}}共享。可以任意选择一个密钥名： “host1-host2.”。两台主机上的密钥名必须一致。
\subsubsection{自动生成}
\label{idm178377531952}\hypertarget{idm178377531952}{}%

下面的命令将生成一个上面所描述的128位（16字节）HMAC-SHA256密钥。 密钥越长越好，但是更短的密钥更易读。注意最大的密钥长度是摘要 长度，在这里是256位。 长度超过512位的密钥将被MD5算法摘要成为一个128位的密钥。

{\ttfamily\bfseries{{dnssec-\dbz{}keygen -\dbz{}a hmac-\dbz{}sha256 -\dbz{}b 128 -\dbz{}n HOST host1-\dbz{}host2.\dbz{}}}}

密钥在文件{\texttt{{Khost1-\dbz{}host2.\dbz{}+\dbz{}163+\dbz{}00000.\dbz{}private}}}中。 并不直接使用这个文件，但是可以从中将“{\texttt{{Key:}}}”后面 base-64编码的字符串抽取出来，用作一个共享密钥。

\begin{Verbatim}[]
Key: La/E5CjG9O+os1jq0a2jdA==
\end{Verbatim}

字符串“{\texttt{{La/\dbz{}E5CjG9O+\dbz{}os1jq0a2jdA==}}}”可以用作 共享密钥。
\subsubsection{手工生成}
\label{idm178377526496}\hypertarget{idm178377526496}{}%

共享密钥只是一个简单的以base-64编码的随机二进制位序列。大多数ASCII 字符串都是有效的base-64字符串（假设其长度是4的倍数，并且只含有有效 字符），所以共享密钥可以手工生成。

同样，一个字符串也可以通过使用{\bfseries{mmencode}}或类似的 程序来生成base-64编码的数据。
\subsection{拷贝共享密钥到两台主机}
\label{idm178377523616}\hypertarget{idm178377523616}{}%

这已经超出了DNS的范围。应该使用一个安全的传输机制。可以通过 安全的FTP，ssh，电话等等。
\subsection{告知服务器密钥的存在}
\label{idm178377522064}\hypertarget{idm178377522064}{}%

设想{\em{host1}}和{\em{host 2}}为两台 服务器。将下列语句添加到各自的{\texttt{{named.\dbz{}conf}}}文件中：

\begin{Verbatim}[]

key host1-host2. {
  algorithm hmac-sha256;
  secret "La/E5CjG9O+os1jq0a2jdA==";
};

\end{Verbatim}

密钥是由以上方式所生成的。因为这是一个秘密，推荐将 {\texttt{{named.\dbz{}conf}}}设置成并非所有人可读的，或者 使用key指令将一个并非所有人可读的文件包含进 {\texttt{{named.\dbz{}conf}}}中。

在这一点，密钥是可识别的。这意味着如果服务器收到一个由这个密钥所签名 的消息，它可以验证这个签名。如果成功验证签名，响应就会使用同样的密钥 签名。
\subsection{指示服务器使用密钥}
\label{idm178377516560}\hypertarget{idm178377516560}{}%

由于密钥仅仅在两台主机之间共享，服务器必须被告知去使用它。下列指令被 添加到{\em{host1}}的{\texttt{{named.\dbz{}conf}}}文件中， 假定{\em{host2}}的IP地址是10.1.2.3：

\begin{Verbatim}[]

server 10.1.2.3 {
  keys { host1-host2. ;};
};

\end{Verbatim}

可以提供多个密钥，但只能使用第一个。这条指令不包含任何秘密，所以它 可以放在一个所有人可读的文件中。

如果{\em{host1}}发出的消息是一个到那个地址的请求，这个 消息将被指定的密钥签名。{\em{host1}}将会期望对这个被签 名的消息的回应都被同一个密钥签名。

一个类似的语句必须出现在{\em{host2}}的配置文件（使用 {\em{host1}}的IP地址）中，供{\em{host2}} 将发向{\em{host1}}的消息进行签名。
\subsection{基于TSIG密钥的访问控制}
\label{idm178377508800}\hypertarget{idm178377508800}{}%

BIND允许在ACL定义和 {\bfseries{allow-\{ query \docbooktolatexpipe{} transfer \docbooktolatexpipe{} update \}}}指令中指定IP地址 和网络范围。这个也被扩展到允许TSIG密钥。上述密钥被表示成 {\bfseries{key host1-host2.}}。

一个{\bfseries{allow-update}}指令的例子是：

\begin{Verbatim}[]

allow-update { key host1-host2. ;};

\end{Verbatim}

这仅允许被名为“{\bfseries{host1-host2.}}”的密钥所签名的 动态更新请求能够成功。

关于{\bfseries{update-policy}}语句更灵活的讨论，参见 \hyperlink{dynamic_update_policies}{第\ref{dynamic_update_policies}节}。
\subsection{错误}
\label{idm178377502544}\hypertarget{idm178377502544}{}%

TSIG签名消息的过程可能产生一些错误。如果一个签名消息被放到一个 不知道TSIG的服务器，将返回一个FORMERR（格式错误）错误，因为服 务器不能够理解这个记录。这个是错误配置的结果，因为服务器必须被 显式地配置成发一个TSIG签名的消息到一个指定的服务器。

如果一个知道TSIG的服务器收到一个由其不知道的密钥所签名的消息， 它将返回一个未被签名的消息，并且TSIG扩展的错误码被置为BADKEY。 如果一个知道TSIG的服务器收到一个带有无效签名的消息，它将返回 一个未被签名的消息，并且TSIG扩展的错误码被置为BADSIG。如果一 个知道TSIG的服务器收到一个在允许的时间范围之外的消息，它将返 回一个被签名的消息，并且TSIG扩展的错误码被置为BADTIME，并调整 时间值，以使回应可以被成功验证。在所有这些情况，消息的rcode （响应码）都被置为NOTAUTH（未被认证）。

% ------------------------   
% Section 
\section{TKEY}
\label{idm178377500208}\hypertarget{idm178377500208}{}%

{\bfseries{TKEY}}是一个在两台主机之间自动生成共享密钥的机制。 {\bfseries{TKEY}}有几种“模式”来指定如何生成和分派密钥。 BIND 9只实现了这些模式中的一种，即Diffie-Hellman 密钥交换。两台主机都需要具有Diffie-Hellman KEY记录（虽然并不要求这 个记录出现在一个区中）。{\bfseries{TKEY}}过程必须使用签名消息， 可以使用TSIG或SIG(0)签名。{\bfseries{TKEY}}的结果是一个共享秘 密，可以用于在TSIG中签名消息。{\bfseries{TKEY}}也可以用来删除 它先前生成的共享密钥。

{\bfseries{TKEY}}过程是由一个客户端或者服务器向一个知道 TKEY的服务器发送一个签名的{\bfseries{TKEY}}请求（包括任 何合适的KEY）来发起的。服务器的响应，如果它指示是成功的，将包 含一个{\bfseries{TKEY}}记录和任何合适的密钥。完成这次交 换后，两方的参与者都有足够的信息来决定共享密钥；精确的过程依 赖于{\bfseries{TKEY}}的模式。 当使用Diffie-Hellman {\bfseries{TKEY}}模式时，互相交换 Diffie-Hellman密钥，两个参与方就得到了共享密钥。

% ------------------------   
% Section 
\section{SIG(0)}
\label{idm178377492720}\hypertarget{idm178377492720}{}%

BIND 9部份支持RFC 2535和RFC 2931中所指定的 DNSSEC SIG(0)事务签名。SIG(0)使用公钥/私钥来认证消息。访问控制 的执行与TSIG密钥类似；可以基于密钥名授予或拒绝权限。

当收到一个SIG(0)签名消息时，仅仅在服务器知道并相信密钥的情况下 才会验证它；服务器不会试图定位和（或）证实密钥。

多个消息的TCP流的SIG(0)签名还不支持。

跟随BIND 9发行的生成SIG(0)签名消息的唯一工具 是{\bfseries{nsupdate}}。

% ------------------------   
% Section 
\section{DNSSEC}
\label{DNSSEC}\hypertarget{DNSSEC}{}%

通过RFC 4033、RFC 4034和RFC 4035所定义的DNS安全 （{\em{DNSSEC-bis}}）扩展，DNS信息的加密认证是可能做到的。 本节描述了建立和使用DNSSEC对区签名。

为了设置一个DNSSEC安全的区，有一系列必须遵循的步骤。 BIND 9在这个过程中用到了几个附带的工具，这将在下面 详细解释。在所有的情况下，{\texttt{{-h}}}选项都会打印除一个完整的 参数清单。注意，DNSSEC工具要求密钥集文件在工作目录或者在由 {\texttt{{-d}}}选项所指定的目录中，而且BIND 9.2.x及更早的版本中所 附带的工具与当前版本所附带的不兼容。

必须同父区和/或子区的管理员通信，以传送密钥。一个区的安全状态必须由 其父区指明，以使支持DNSSEC的解析器相信它所得到的数据。这是通过在授权 点提供或者不提供一个{\texttt{{DS}}}记录来完成的。

对其它相信这个区的数据的服务器，它们必须静态地配置这个区的区密钥 或者在DNS树中这个区上面的另一个区的区密钥。
\subsection{生成密钥}
\label{idm178377481600}\hypertarget{idm178377481600}{}%

{\bfseries{dnssec-keygen}}程序用于生成密钥。

一个加密的区必须包含一个或多个区密钥。区密钥对区中的所有其它记录 签名，也对任何安全授权的区的区密钥签名。区密钥必须有一个与区同样 的名字，一个为{\bfseries{ZONE}}的类型名，并且必须可以用于认 证。推荐区密钥使用由IETF作为“强制实现”所指定的加密算法；当前唯 一的是RSASHA1。

下列命令为{\texttt{{child.\dbz{}example}}}区生成一个768位的 RSASHA1密钥：

{\ttfamily\bfseries{{dnssec-\dbz{}keygen -\dbz{}a RSASHA1 -\dbz{}b 768 -\dbz{}n ZONE child.\dbz{}example.\dbz{}}}}

将产生两个输出文件： {\texttt{{Kchild.\dbz{}example.\dbz{}+\dbz{}005+\dbz{}12345.\dbz{}key}}}和 {\texttt{{Kchild.\dbz{}example.\dbz{}+\dbz{}005+\dbz{}12345.\dbz{}private}}} （12345是密钥标记的一个例子）。密钥文件名包含密钥名（ {\texttt{{child.\dbz{}example.\dbz{}}}}），算法（3表示DSA，1表示RSAMD5， 5表示RSASH1，等等），和密钥标记（在本例中为12345）。私钥 （在{\texttt{{.\dbz{}private}}}文件中）用于生成签名，公钥 （在{\texttt{{.\dbz{}key}}}文件中）用于验证签名。

要生成同样属性的另一个密钥（但是使用一个不同的密钥标记）， 只需重复上面的命令。

{\bfseries{dnssec-keyfromlabel}}程序是用来从一个 隐藏硬件获取一个密钥对并生成密钥文件。其用法与 {\bfseries{dnssec-keygen}}类似。

公钥应该使用{\bfseries{\$INCLUDE}}语句来包含 {\texttt{{.\dbz{}key}}}文件的方式插入到区文件中。
\subsection{对区签名}
\label{idm178377470336}\hypertarget{idm178377470336}{}%

{\bfseries{dnssec-signzone}}程序用于对区签名。

任何与安全子区相关的{\texttt{{keyset}}}文件都应该出现。 区的签名者将为区生成{\texttt{{NSEC}}}、 {\texttt{{NSEC3}}}和{\texttt{{RRSIG}}} 记录，如同指定{\texttt{{‘-\dbz{}d’}}}选项时为子区生成 的{\texttt{{DS}}}记录一样。如果未指定 {\texttt{{'-\dbz{}d'}}}选项，就必须为安全的子区手工添加DS 资源记录集。

下列命令对区签名，假设它是一个名为 {\texttt{{zone.\dbz{}child.\dbz{}example}}} 的文件。缺省情况下，所有的区密钥都有一个可用的私钥用来生成签名。

{\ttfamily\bfseries{{dnssec-\dbz{}signzone -\dbz{}o child.\dbz{}example zone.\dbz{}child.\dbz{}example}}}

会产生一个输出文件：{\texttt{{zone.\dbz{}child.\dbz{}example.\dbz{}signed}}}。 这个文件必须在{\texttt{{named.\dbz{}conf}}}中作为输入文件被引用。

{\bfseries{dnssec-signzone}}也会生成一个keyset和dsset文件，以及 一个可选的dlvset文件。他们用于向上级区管理员提供 {\texttt{{DNSKEY}}}（或者与之相关的{\texttt{{DS}}} 记录），后者作为区的安全入口点。
\subsection{配置服务器}
\label{idm178377459744}\hypertarget{idm178377459744}{}%

为了使{\bfseries{named}}正确响应知道DNSSEC的客户端所发出的 DNS请求，必须将{\bfseries{dnssec-enable}}设置为yes。 （这是缺省设置。）

为了使{\bfseries{named}}验证其它服务器来的响应，必须将 {\bfseries{dnssec-enable}}选项设置为 {\ttfamily\bfseries{{yes}}}，并且将{\bfseries{dnssec-validation}} 选项设置为{\ttfamily\bfseries{{yes}}}或 {\ttfamily\bfseries{{auto}}}。

如果{\bfseries{dnssec-validation}}选项被设置为 {\ttfamily\bfseries{{auto}}}，就会使用DNS根区的一个缺省信任锚。 如果它被设置为{\ttfamily\bfseries{{yes}}}， 必须通过在{\texttt{{named.\dbz{}conf}}}中使用一个 {\bfseries{trusted-keys}}或 {\bfseries{managed-keys}}语句配置至少一个信任锚点，否则就不会 进行DNSSEC验证。缺省设置为{\ttfamily\bfseries{{yes}}}。

{\bfseries{trusted-keys}}是区的DNSKEY资源记录的拷贝，它用于形成 加密信任链的首个链接。所有在{\bfseries{trusted-keys}} （及相关的区）中的密钥列表都被认为是存在的，并且只有所列出的密钥可 以用于验证与其来源一致的DNSKEY资源记录集。

{\bfseries{managed-keys}}是通过RFC 5011信任锚点维护自动 保持更新的受信任密钥。

在本文档的后面有更多关于{\bfseries{trusted-keys}}和 {\bfseries{managed-keys}}的详细描述。

与BIND 8不同，BIND 9在装载时 不验证签名，所以不必在配置文件中指定权威区的区密钥。

在DNSSEC建立之后，一个典型的DNSSEC配置看起来就像以下内容。它有一个 或多个根的公钥。这可以允许来自外部的响应被验证。本单位所控制的部份 名字空间也需要几个密钥。其作用是确保{\bfseries{named}}不受 上级区安全的DNSSEC组成中的危险因素的影响。

\begin{Verbatim}[]

managed-keys {
        /* Root Key */
        "." initial-key 257 3 3 "BNY4wrWM1nCfJ+CXd0rVXyYmobt7sEEfK3clRbGaTwS
                                 JxrGkxJWoZu6I7PzJu/E9gx4UC1zGAHlXKdE4zYIpRh
                                 aBKnvcC2U9mZhkdUpd1Vso/HAdjNe8LmMlnzY3zy2Xy
                                 4klWOADTPzSv9eamj8V18PHGjBLaVtYvk/ln5ZApjYg
                                 hf+6fElrmLkdaz MQ2OCnACR817DF4BBa7UR/beDHyp
                                 5iWTXWSi6XmoJLbG9Scqc7l70KDqlvXR3M/lUUVRbke
                                 g1IPJSidmK3ZyCllh4XSKbje/45SKucHgnwU5jefMtq
                                 66gKodQj+MiA21AfUVe7u99WzTLzY3qlxDhxYQQ20FQ
                                 97S+LKUTpQcq27R7AT3/V5hRQxScINqwcz4jYqZD2fQ
                                 dgxbcDTClU0CRBdiieyLMNzXG3";
};

trusted-keys {
        /* Key for our organization's forward zone */
        example.com. 257 3 5 "AwEAAaxPMcR2x0HbQV4WeZB6oEDX+r0QM6
                              5KbhTjrW1ZaARmPhEZZe3Y9ifgEuq7vZ/z
                              GZUdEGNWy+JZzus0lUptwgjGwhUS1558Hb
                              4JKUbbOTcM8pwXlj0EiX3oDFVmjHO444gL
                              kBOUKUf/mC7HvfwYH/Be22GnClrinKJp1O
                              g4ywzO9WglMk7jbfW33gUKvirTHr25GL7S
                              TQUzBb5Usxt8lgnyTUHs1t3JwCY5hKZ6Cq
                              FxmAVZP20igTixin/1LcrgX/KMEGd/biuv
                              F4qJCyduieHukuY3H4XMAcR+xia2nIUPvm
                              /oyWR8BW/hWdzOvnSCThlHf3xiYleDbt/o
                              1OTQ09A0=";

        /* Key for our reverse zone. */
        2.0.192.IN-ADDRPA.NET. 257 3 5 "AQOnS4xn/IgOUpBPJ3bogzwc
                                       xOdNax071L18QqZnQQQAVVr+i
                                       LhGTnNGp3HoWQLUIzKrJVZ3zg
                                       gy3WwNT6kZo6c0tszYqbtvchm
                                       gQC8CzKojM/W16i6MG/eafGU3
                                       siaOdS0yOI6BgPsw+YZdzlYMa
                                       IJGf4M4dyoKIhzdZyQ2bYQrjy
                                       Q4LB0lC7aOnsMyYKHHYeRvPxj
                                       IQXmdqgOJGq+vsevG06zW+1xg
                                       YJh9rCIfnm1GX/KMgxLPG2vXT
                                       D/RnLX+D3T3UL7HJYHJhAZD5L
                                       59VvjSPsZJHeDCUyWYrvPZesZ
                                       DIRvhDD52SKvbheeTJUm6Ehkz
                                       ytNN2SN96QRk8j/iI8ib";
};

options {
        ...
        dnssec-enable yes;
        dnssec-validation yes;
};

\end{Verbatim}

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
本例中列出的所有密钥都是无效的。特别是，根密钥是无效的。\end{admonition}


当DNSSEC验证被打开并正确地配置后，解析器将会拒绝来自签名的 安全区的未通过验证的响应，并返回SERVFAIL给客户端。

响应可能因为以下任何一种原因而验证失败，包含错误的、过期的、 或无效的签名，密钥与父区中的DS资源记录集不匹配，或者来自一个区的 不安全的响应，而根据它的父区，应该是一个安全的响应。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

当验证者收到一个来自一个拥有签名父区的未签名区的响应，它必须 向其父区确认这个是有意未签名的。它通过验证父区没有包含子区的 DS记录，即通过签名的和验证了的NSEC/NSEC3记录，来确认这一点。

如果验证者{\em{能够}}证明区是不安全的，其响应 就是可以接受的。然而，如果不能证明，它就必须假设不安全的 响应是伪造的；它就拒绝响应并在日志中记录一个错误。

日志记录的错误为“insecurity proof failed”和 “got insecure response; parent indicates it should be secure”。 （在BIND 9.7之前，日志记录的错误为“not insecure”。 这是指区，而不是指响应。）
\end{admonition}


% ------------------------   
% Section 
\section{DNSSEC，动态区，和自动化签名}
\label{dnssec.dynamic.zones}\hypertarget{dnssec.dynamic.zones}{}%

作为BIND 9.7.0的一个特性，可以将一个动态区从不安全转变为 签名的区并备份。一个安全的区可以使用NSEC或NSEC3链。
\subsection{从不安全转换到安全}
\label{idm178377435136}\hypertarget{idm178377435136}{}%

有两种方法可以将一个区从不安全转换为安全：使用动态DNS更新， 或者{\bfseries{auto-dnssec}}区选项。

对这两种方法，你都需要配置{\bfseries{named}}，使其 能够看到{\texttt{{K*}}}文件，而后者包含签名区时会用到的 公钥和私钥部份。这些文件由{\bfseries{dnssec-keygen}}生成。 你可以将密钥文件放到在{\texttt{{named.\dbz{}conf}}}中所指名的 密钥目录中：

\begin{Verbatim}[]

        zone example.net {
                type master;
                update-policy local;
                file "dynamic/example.net/example.net";
                key-directory "dynamic/example.net";
        };

\end{Verbatim}

如果生成了一个KSK和一个ZSK DNSKEY密钥，这个配置将使区中 所有的记录被ZSK签名，并使DNSKEY资源记录集被KSK签名。作为初始签名 过程的一部份，还会生成一个NSEC链。
\subsection{动态DNS更新方法}
\label{idm178377430176}\hypertarget{idm178377430176}{}%

要通过动态更新插入密钥：

\begin{Verbatim}[]

        % nsupdate
        > ttl 3600
        > update add example.net DNSKEY 256 3 7 AwEAAZn17pUF0KpbPA2c7Gz76Vb18v0teKT3EyAGfBfL8eQ8al35zz3Y I1m/SAQBxIqMfLtIwqWPdgthsu36azGQAX8=
        > update add example.net DNSKEY 257 3 7 AwEAAd/7odU/64o2LGsifbLtQmtO8dFDtTAZXSX2+X3e/UNlq9IHq3Y0 XtC0Iuawl/qkaKVxXe2lo8Ct+dM6UehyCqk=
        > send

\end{Verbatim}

虽然更新请求会几乎立即完成，但是只有{\bfseries{named}} 有时间扫描整个区并生成NSEC和RRSIG记录之后，区的签名才会完成。 区顶点的NSEC记录会在最后添加，作为一个完整NSEC链的信号。

如果你希望使用NSEC3来取代NSEC作签名，你应该添加NSEC3PARAM 记录到初始更新请求中。如果你希望NSEC3链具有OPTOUT位，就在 NSEC3PARAM记录的标志字段中设置它。

\begin{Verbatim}[]

        % nsupdate
        > ttl 3600
        > update add example.net DNSKEY 256 3 7 AwEAAZn17pUF0KpbPA2c7Gz76Vb18v0teKT3EyAGfBfL8eQ8al35zz3Y I1m/SAQBxIqMfLtIwqWPdgthsu36azGQAX8=
        > update add example.net DNSKEY 257 3 7 AwEAAd/7odU/64o2LGsifbLtQmtO8dFDtTAZXSX2+X3e/UNlq9IHq3Y0 XtC0Iuawl/qkaKVxXe2lo8Ct+dM6UehyCqk=
        > update add example.net NSEC3PARAM 1 1 100 1234567890
        > send

\end{Verbatim}

再次强调，更新请求将会几乎立即完成；然而，所添加的记录 不会马上可见，直到{\bfseries{named}}有集合建立/强调相关的 链。一个私有类型的记录将被创建，以记录操作状态（参见下面更详细的 描述），并在操作完成之后被删除。

当初始签名及NSEC/NSEC3链正在生成时，其它更新也可能发生。
\subsection{完全自动化区签名}
\label{idm178377423856}\hypertarget{idm178377423856}{}%

要打开自动签名，需要在{\texttt{{named.\dbz{}conf}}}的 区语句中增加{\bfseries{auto-dnssec}}选项。 {\bfseries{auto-dnssec}}有两个可能的参数： {\texttt{{allow}}}或 {\texttt{{maintain}}}.

使用 {\bfseries{auto-dnssec allow}}, {\bfseries{named}}可以在密钥目录中查找与区匹配的密钥， 将其插入到区中，并使用它们来签名区。仅仅在其收到一个 {\bfseries{rndc sign \textless{}zonename\textgreater{}}}时才这样做。

 {\bfseries{auto-dnssec maintain}}包含上述功能，而且还 可以根据密钥的时间元数据的时间表自动调整区的DNSKEY记录。 （更多信息参见\hyperlink{man.dnssec-keygen}{dnssec-keygen(8)}和 \hyperlink{man.dnssec-settime}{dnssec-settime(8)}。）

{\bfseries{named}}将会周期性地搜索密钥目录查找与区匹配的密钥，如果密钥 的元数据显示区发生了任何变化，诸如增加，删除或者撤销一个密钥，这个动作都会被 执行。缺省时，每60分钟检查一次密钥目录；这个周期可以通过 {\texttt{{dnssec-loadkeys-interval}}}调整，最大到24小时。 {\bfseries{rndc loadkeys}}强制{\bfseries{named}}立即检查密钥是否 更新。

如果密钥被提供到密钥目录中，区第一次装载时，区就会立刻被签名， 而不用等待{\bfseries{rndc sign}}或 {\bfseries{rndc loadkeys}}命令。（然而，这些命令 仍然可以用于计划外的密钥变更时。）

当新的密钥被添加到一个区时，TTL被设置为与任何已存在的DNSKEY资源记录集的TTL 相匹配。如果不存在DNSKEY资源记录集，TTL将被设置为密钥创建时 （使用{\bfseries{dnssec-keygen -L}}选项）所指定的TTL，或者为SOA的TTL， 如果有的话。

如果你希望使用NSEC3来代替NSEC给区签名，需要在发布和激活密钥之前通过动态更新 提交一个NSEC3PARAM记录。如果你希望NSEC3链设置OPTOUT位，就在NSEC3PARAM记录的 标志字段中设置它。NSEC3PARAM记录将不会立即出现在区中，但它将被存储以供之后 参考。当区被签名并且NSEC3链完成之后，NSEC3PARAM将会出现在区中。

使用{\bfseries{auto-dnssec}}选项要求区被配置成 允许动态更新，这是通过在区配置中增加一个 {\bfseries{allow-update}}或 {\bfseries{update-policy}}语句来实现的。如果没有这个， 配置就会失败。
\subsection{私有类型记录}
\label{idm178377408432}\hypertarget{idm178377408432}{}%

签名过程的状态由私有类型记录（带有一个缺省值65534）发信号通知。 当签名完成，这些记录将会在最后一个字节有一个非零值（这些记录都有一个 初始的非零值）。

私有类型记录的格式：如果第一个字节不为0，这个记录表明 区需要由与记录匹配的密钥来签名，或者与记录匹配的所有签名应当 被删掉。


\begin{Verbatim}[]


  algorithm (octet 1)
  key id in network order (octet 2 and 3)
  removal flag (octet 4)
  complete flag (octet 5)

\end{Verbatim}


只有被标志为“complete”的记录才能通过动态更新被删除。删除 其它私有类型记录的企图将被默默地忽略掉。

如果第一个字节为零（这是一个保留的算法号，从来不会出现在一个 DNSKEY记录中），这个记录指示正在进行转换为NSEC3链的过程。其余的记录 包含一个NSEC3PARAM记录。标志字段基于标志位表明要执行哪种操作。


\begin{Verbatim}[]


  0x01 OPTOUT
  0x80 CREATE
  0x40 REMOVE
  0x20 NONSEC

\end{Verbatim}

\subsection{DNSKEY轮转}
\label{idm178377402848}\hypertarget{idm178377402848}{}%

随着不安全到安全的转换，轮转DNSSEC密钥可以使用两种方法完成： 使用一个动态DNS更新，或者{\bfseries{auto-dnssec}}区选项。
\subsection{动态DNS更新方法}
\label{idm178377401152}\hypertarget{idm178377401152}{}%

为通过动态更新执行密钥轮转，你需要为新密钥添加 {\texttt{{K*}}}文件，这样{\bfseries{named}}就能够找到 它们。然后你可以通过动态更新添加新的DNSKEY资源记录集。 然后将引起{\bfseries{named}}使用新的密钥对区进行签名。当签名完成， 将更新私有类型记录，使最后一个字节为非零。

如果这是一个KSK，你需要将新KSK通知上级域和所有的信任锚仓库。

然后，你应该在删除旧DNSKEY之前等待区中最大TTL的时间。如果更新 一个KSK，你还需要等待上级区中的DS资源记录集更新和其TTL失效。这就确保 当你删除旧DNSKEY时，所有的客户端能够验证至少一个签名。

可以通过UPDATE删除旧的DNSKEY。需要小心指定正确的密钥。 在更新完成后，{\bfseries{named}}将会清理由旧密钥生成的所有签名。
\subsection{自动密钥轮转}
\label{idm178377396336}\hypertarget{idm178377396336}{}%

当一个新密钥到达其激活日期（由{\bfseries{dnssec-keygen}} 或{\bfseries{dnssec-settime}}所设置的）时，如果 {\bfseries{auto-dnssec}}区选项被设置为{\texttt{{maintain}}}， {\bfseries{named}}将会自动执行密钥轮转。如果密钥的算法之前没有用于 签名区，区将被尽可能快地被全部签名。但是，如果替代现在密钥的新密钥使用同样 的算法，则区将被增量重签，在其签名有效期过期后，旧密钥的签名被新密钥的签名 所替代缺省时，这个轮转在30天内完成，之后就可以安全地将旧密钥从DNSKEY资源记 录集中删掉。
\subsection{通过UPDATE轮转NSEC3PARAM}
\label{idm178377393008}\hypertarget{idm178377393008}{}%

通过动态更新增加新的NSEC3PARAM记录。当生成了新的NSEC3链之后， NSEC3PARAM标志字段被置为零。在这时，你可以删除旧的NSEC3PARAM记录。 旧的链将会在更新请求完成之后被删除。
\subsection{从NSEC转换到NSEC3}
\label{idm178377390704}\hypertarget{idm178377390704}{}%

要做这个，你只需要添加一条NSEC3PARAM记录。在转换完成后，NSEC链 将被移除，NSEC3PARAM记录有一个0标志域。NSEC3链将在NSEC链被去掉之前 生成。
\subsection{从NSEC3转换到NSEC}
\label{idm178377389328}\hypertarget{idm178377389328}{}%

要做这件事，使用{\bfseries{nsupdate}}删除所有带有一个零 标志字段的NSEC3PARAM记录。在NSEC3链被删除之前先生成NSEC链。
\subsection{从安全转换为不安全}
\label{idm178377387616}\hypertarget{idm178377387616}{}%

要使用动态DNS将一个签名的区转换为未签名的区，需要使用 {\bfseries{nsupdate}}删除区顶点的所有DNSKEY记录。所有签名， NSEC或NSEC3链，以及相关的NSEC3PARAM记录都会被自动地删除掉。这个 发生在更新请求完成之后。

这要求{\texttt{{named.\dbz{}conf}}}中的 {\bfseries{dnssec-secure-to-insecure}}选项被设置为 {\ttfamily\bfseries{{yes}}}。

此外，如果使用了{\bfseries{auto-dnssec maintain}}区命令， 应该将其去掉或者将其值改为{\bfseries{allow}}（或者重签名）。
\subsection{周期性的重签名}
\label{idm178377382752}\hypertarget{idm178377382752}{}%

在任何支持动态更新的安全区中，named会周期性地对因为某些 更新动作而变为未签名的资源记录集进行重新签名。签名的生存期会被 调整，这样就会将重新签名的负载分散在一段时间而不是集中在一起。
\subsection{NSEC3 and OPTOUT}
\label{idm178377381280}\hypertarget{idm178377381280}{}%

{\bfseries{named}}仅仅支持一个区的所有NSEC3记录都有同样的 OPTOUT状态才建立新的NSEC3链。 {\bfseries{named}}支持UPDATES那些在链中的NSEC3记录有混合OPTOUT 状态的区。 {\bfseries{named}}不支持变更一个单独NSEC3记录的OPTOUT状态， 如果需要变更一个单独NSEC3记录的OPTOUT状态，就需要变更整个链。

% ------------------------   
% Section 
\section{动态的信任锚点管理}
\label{rfc5011.support}\hypertarget{rfc5011.support}{}%

BIND 9.7.0引入了对RFC 5011，动态信任锚点管理，的支持。 使用这个特征允许{\bfseries{named}}跟踪关键的DNSSEC密钥， 而不需要操作员改变任何配置文件。
\subsection{验证解析器}
\label{idm178377375248}\hypertarget{idm178377375248}{}%

为了配置一个验证解析器，使其用RFC 5011来维护一个信任锚点， 需要使用一个{\bfseries{managed-keys}}语句来配置信任锚点。 关于这个的信息可以在\hyperlink{managed-keys}{第\ref{managed-keys}节}中找到。
\subsection{权威服务器}
\label{idm178377372304}\hypertarget{idm178377372304}{}%

为设置一个使用RFC 5011信任锚点维护的权威区，需要为区生成两个 （或更多）的密钥签名密钥（KSK）。使用其中一个对区签名；这个密钥 就是“活动的“KSK。所有不对区签名的KSK都是”备用“密钥。

任何配置成将活跃KSK用作一个RFC 5011所管理的信任锚点的 验证解析器都会留意到区的DNSKEY资源记录集中的后备密钥，并将其存储 以备将来参考。 解析器将会周期性地重新检查区，并在30天之后，如果新密钥仍然存在， 这个密钥将会作为这个区的一个有效信任锚点被解析器所接受。 在这个30天的接受计时器结束后的任何时间，活跃的KSK可以被撤销，而 区可以被“轮转”到新的所接受的密钥。

将一个备用密钥放入一个区的最简单的方法是使用 {\bfseries{dnssec-keygen}}和 {\bfseries{dnssec-signzone}}的“智能签名”特征。 如果一个密钥的发布日期在过去，而激活日期未设置或是在未来， “{\bfseries{dnssec-signzone -S}}”将会把DNSKEY记录包含 到区中，但是不会使用它签名：

\begin{Verbatim}[]

$ dnssec-keygen -K keys -f KSK -P now -A now+2y example.net
$ dnssec-signzone -S -K keys example.net

\end{Verbatim}

为撤销一个密钥，增加了新的命令{\bfseries{dnssec-revoke}}。 这个命令增加密钥标志的REVOKED位，并重新生成 {\texttt{{K*.\dbz{}key}}}和{\texttt{{K*.\dbz{}private}}}文件。

在撤销一个活动的密钥之后，必须使用被撤销的KSK和新的活动的KSK 对区签名。（智能签名自动完成这个工作。）

一旦一个密钥被撤销并用于对其所在的DNSKEY资源记录集 签名，这个密钥就再也不能被解析器接受为一个有效的信任锚点。 然而，可以使用新的活动密钥（这个新密钥在作为备用密钥时已经 被解析器所接受）进行验证。

关于密钥轮换场景的更详细信息，参见RFC 5011。

当一个密钥被撤销时，其密钥ID会变化，即增加128，并在 超过65535时轮转。所以，例如，密钥 “{\texttt{{Kexample.\dbz{}com.\dbz{}+\dbz{}005+\dbz{}10000}}}”变成了 “{\texttt{{Kexample.\dbz{}com.\dbz{}+\dbz{}005+\dbz{}10128}}}”。

如果两个密钥的ID刚好相差128，并且在其中一个被撤销时，两个 密钥ID发生了碰撞，就会带来一些问题。为避免这种情况，如果出现的 另一个密钥可能发生碰撞，{\bfseries{dnssec-keygen}}将不会 生成一个新的密钥。 这个检查仅仅发生在当新密钥被写到存放区的所有其它在用密钥的 同一个目录的时候。

旧版本的BIND 9没有这个预防措施。 如果在用密钥撤销碰到先前版本所生成的密钥，或者在用密钥存储 在多个目录或多个服务器上，将会行使警告。

预料将来发布的BIND 9将会以一个不同的方式应对这个问题， 即通过将已撤销的密钥和其原始未撤销密钥的ID一起存储。

% ------------------------   
% Section 
\section{PKCS\#11 (Cryptoki)支持}
\label{pkcs11}\hypertarget{pkcs11}{}%

PKCS\#11 (公钥加密标准 \#11)为控制硬件安全模块（HSM）和其它 密码支持设备定义了一个平台独立的API。

BIND 9可以支持三种HSM：AEP Keyper，在Debian Linux，Solaris x86和 Windows Server 2003上测试通过；Thales nShield，在Debian Linux上测试通过； 以及Sun SCA 6000密码加速板，在Solaris x86上测试通过。 另外，BIND可以与所有当前版本的SoftHSM，一种基于软件的由OpenDNSSEC项目产出 的HSM模拟器，一块工作。

PKCS\#11利用了一个“提供者库（provider library）”：一个动态加载库，它提供 一个低级PKCS\#11接口来驱动HSM硬件。PKCS\#11提供者库来自HSM厂商，它针对于 由其控制的特定HSM有效。

BIND 9中存在两种可用的对PKCS\#11支持的机制：基于OpenSSL的PKCS\#11和 原生PKCS\#11。在使用第一种机制时，BIND使用一个OpenSSL的修改版本，后者加载 提供者库并间接操作HSM；任何HSM不支持的加密操作都替代成由OpenSSL执行。 第二种机制让BIND完全绕过OpenSSL；BIND自己加载提供者库，并使用PKCS\#11 API 直接驱动HSM。
\subsection{先决条件}
\label{idm178377354368}\hypertarget{idm178377354368}{}%

关于HSM的安装，初始化，测试和故障解决方面的信息，参见由HSM厂商 提供的文档。
\subsection{原生PKCS\#11}
\label{idm178377352960}\hypertarget{idm178377352960}{}%

原生PKCS\#11模式仅能与一个能够执行{\em{每个}}BIND 9可能 需要的加密操作的HSM一块工作。 HSM的提供者库必须带有一个PKCS\#11 API的完全实现，因此所有这些函数都是 可以访问的。 在写作本文档时，仅有Thales nShield HSM和SoftHSMv2可以被用于这个功能。 对其它HSM，包括AEP Keyper，Sun SCA 6000和旧版本的SoftHSM，使用 基于OpenSSL的PKCS\#11。 （注意：最终，当更多HSM支持原生PKCS\#11，可以预料基于OpenSSL的PKCS\#11将被 废弃。）

要使用原生PKCS\#11构建BIND，按如下配置：

\begin{Verbatim}[]

$ cd bind9
$ ./configure --enable-native-pkcs11 \
    --with-pkcs11=provider-library-path
    
\end{Verbatim}

这将导致所有BIND工具，包括{\bfseries{named}}和 {\bfseries{dnssec-*}}及{\bfseries{pkcs11-*}}工具，使用 在{\ttfamily\itshape{{provider-library-path}}}中指定的PKCS\#11 提供者库来加密。 （提供者库的路径可以在{\bfseries{named}}和 {\bfseries{dnssec-*}}工具中使用{\texttt{{-E}}}，或者在 {\bfseries{pkcs11-*}}工具中使用{\texttt{{-m}}}来覆盖。）
\subsubsection{构建SoftHSMv2}
\label{idm178377344512}\hypertarget{idm178377344512}{}%

SoftHSMv2，最新开发版SoftHSM，可在 https://github.com/opendnssec/SoftHSMv2 {\textless}\url{https://github.com/opendnssec/SoftHSMv2}{\textgreater}得到。 它是由OpenDNSSEC项目所开发的软件库 （http://www.opendnssec.org {\textless}\url{http://www.opendnssec.org}{\textgreater}）， 它提供了一个虚拟HSM的PKCS\#11接口，以一个在本地文件系统上的SQLite3 数据库的形式实现。 它提供的安全性较一个真正的HSM较少，但是它允许你在没有可用的HSM时试验 原生的PKCS\#11。 SoftHSMv2可以被配置成使用OpenSSL或者Botan库来执行加密功能，但当其用于 在BIND中的原生PKCS\#11时，必须使用OpenSSL。

缺省时，SoftHSMv2配置文件是 {\ttfamily\itshape{{prefix}}}/etc/softhsm2.conf（这里的 {\ttfamily\itshape{{prefix}}}是在编译时配置的）。 这个位置可以被SOFTHSM2\_CONF环境变量覆盖。SoftHSMv2加密存储必须在与 BIND一起使用之前被安装和初始化。

\begin{Verbatim}[]

$  cd SoftHSMv2 
$  configure --with-crypto-backend=openssl --prefix=/opt/pkcs11/usr --enable-gost 
$  make 
$  make install 
$  /opt/pkcs11/usr/bin/softhsm-util --init-token 0 --slot 0 --label softhsmv2 
      
\end{Verbatim}
\subsection{基于OpenSSL的PKCS\#11}
\label{idm178377336592}\hypertarget{idm178377336592}{}%

基于OpenSSL的PKCS\#11模式使用了一个OpenSSL库的修改版本；当前官方 版本的OpenSSL不能完全支持PKCS\#11。 ISC提供了一个补丁来纠正这个情况。这个补丁是基于源于OpenSolaris项目 所完成的工作；它被ISC修改以提供诸如PIN管理和密钥引用 （译注：key-by-reference）等新特性。

打过补丁的OpenSSL提供了两种PKCS\#11新“美味”，其中一种 必须在配置时选择。正确的选择依赖于HSM硬件：

\begin{itemize}
%--- Item
\item 
'crypto-accelerator'用于具有硬件加密加速的HSM，如 SCA 6000板。这使得OpenSSL在HSM中运行所有支持的加密操作。


%--- Item
\item 
'sign-only'用于那些设计功能主要是作为密钥存储设备，而缺乏 硬件加速的HSM。这类设备是高安全的，但是不需要在加密时比系统 CPU更快 --- 通常，他们会更慢。因此，最高效的方法是仅将其 用于要求访问安全私钥的加密功能，而其它所有计算密集性操作都使用 系统CPU。AEP Keyper是这类设备的一个例子。

\end{itemize}

修改的OpenSSL代码包含在BIND 9发行版中，以针对最新OpenSSL版本的带上下 文的diff结果的形式。OpenSSL 0.9.8，1.0.0和1.0.1都被支持；分别有各自版本 的diff文件。在后面的例子中，我们使用了OpenSSL 0.9.8，但是同样的方法也 适用于OpenSSL 1.0.0和1.0.1。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
这篇文档（2015年1月）的最新OpenSSL版本是0.9.8zc，1.0.0o和1.0.1j。 ISC在新版本的OpenSSL发布时会提供升级的补丁。在以下例子中的版本号预期 也会改变。\end{admonition}


在构建带PKCS\#11支持的BIND 9之前，需要在适当的位置使用这个补丁构建 OpenSSL并使用你的HSM的PKCS\#11提供者库的路径来配置它。
\subsubsection{给OpenSSL打补丁}
\label{idm178377328560}\hypertarget{idm178377328560}{}%

\begin{Verbatim}[]

$ wget http://www.openssl.org/source/openssl-0.9.8zc.tar.gz

\end{Verbatim}

解压tar包：

\begin{Verbatim}[]

$ tar zxf openssl-0.9.8zc.tar.gz

\end{Verbatim}

应用BIND 9发行版所带的补丁：

\begin{Verbatim}[]

$ patch -p1 -d openssl-0.9.8zc \
            < bind9/bin/pkcs11/openssl-0.9.8zc-patch

\end{Verbatim}

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
注意，补丁文件可能与不同操作系统下的"patch"应用不兼容。 你可能需要安装GNU patch。\end{admonition}


在构建OpenSSL时，将其放在一个非标准的位置，这样它不会干扰系统上的 OpenSSL库。在下面的例子中，我们选择安装到"/opt/pkcs11/usr"。我们将在 配置BIND 9时使用这个位置。

之后，在构建BIND 9时，用户构建OpenSSL库的位置需要通过configure指定。
\subsubsection{在Linux上为AEP Keyper构建OpenSSL}
\label{idm178377322064}\hypertarget{idm178377322064}{}%

AEP Keyper是一个高安全密钥存储设备，但是不提供硬件加密加速。 它能够执行加密操作，但是可能会减慢你的系统CPU。因此，我们在构建 OpenSSL时选择'sign-only'选项。

Keyper专用的PKCS\#11提供者库是随同Keyper软件分发的。在这个例子中， 我们将其放在/opt/pkcs11/usr/lib下：

\begin{Verbatim}[]

$ cp pkcs11.GCC4.0.2.so.4.05 /opt/pkcs11/usr/lib/libpkcs11.so

\end{Verbatim}

这个库仅仅通过32位二进制提供给Linux的。如果我们要在一台64位Linux系统上 编译，需要强制进行一个32位的构建，在构建时指定-m32选项。

最后，Keyper库要求线程，所以我们必须指定-pthread。

\begin{Verbatim}[]

$ cd openssl-0.9.8zc
$ ./Configure linux-generic32 -m32 -pthread \
            --pk11-libname=/opt/pkcs11/usr/lib/libpkcs11.so \
            --pk11-flavor=sign-only \
            --prefix=/opt/pkcs11/usr

\end{Verbatim}

在配置之后，运行"{\bfseries{make}}"和 "{\bfseries{make test}}"。如果"{\bfseries{make test}}" 失败并输出"pthread\_atfork() not found"，你可能忘记加上前面提到的 -pthread了。
\subsubsection{为Solaris上的SCA 6000构建OpenSSL}
\label{idm178377313856}\hypertarget{idm178377313856}{}%

SCA-6000 PKCS\#11提供者是作为一个系统库libpkcs11安装的。 它是一个真正的加密加速器，能够比任何CPU快4倍以上，所以特性应该 是'crypto-accelerator'。

在这个例子中，我们正在AMD64系统上的Solaris x86平台上构建。

\begin{Verbatim}[]

$ cd openssl-0.9.8zc
$ ./Configure solaris64-x86_64-cc \
            --pk11-libname=/usr/lib/64/libpkcs11.so \
            --pk11-flavor=crypto-accelerator \
            --prefix=/opt/pkcs11/usr

\end{Verbatim}

（对一个32位构建，使用"solaris-x86-cc"和/usr/lib/libpkcs11.so。）

在配置之后，运行{\bfseries{make}}和 {\bfseries{make test}}。
\subsubsection{为SoftHSM构建OpenSSL}
\label{idm178377308240}\hypertarget{idm178377308240}{}%

SoftHSM（版本1）是一个由OpenDNSSEC项目 （http://www.opendnssec.org {\textless}\url{http://www.opendnssec.org}{\textgreater}） 所提供的软件库，它提供了一个虚拟HSM的PKCS\#11接口，以一个在本地文件系统 上的SQLite3数据库的形式实现。 SoftHSM使用Botan库执行加密功能。 虽然比一个真正的HSM更不安全，但是它允许你在没有可用的HSM时试验PKCS\#11。

在与OpenSSL一起使用SoftHSM之前，必须安装和初始化SoftHSM加密存储， 并且SOFTHSM\_CONF环境变量必须总是指向SoftHSM配置文件：

\begin{Verbatim}[]

$  cd softhsm-1.3.7 
$  configure --prefix=/opt/pkcs11/usr 
$  make 
$  make install 
$  export SOFTHSM_CONF=/opt/pkcs11/softhsm.conf 
$  echo "0:/opt/pkcs11/softhsm.db" > $SOFTHSM_CONF 
$  /opt/pkcs11/usr/bin/softhsm --init-token 0 --slot 0 --label softhsm 
      
\end{Verbatim}

SoftHSM可以执行所有的加密操作，但是由于它只使用你系统的CPU，在除了签名 之外的其它事务上使用都没有优势。因此，我们在构建OpenSSL时选择 'sign-only'特性。

\begin{Verbatim}[]

$ cd openssl-0.9.8zc
$ ./Configure linux-x86_64 -pthread \
            --pk11-libname=/opt/pkcs11/usr/lib/libsofthsm.so \
            --pk11-flavor=sign-only \
            --prefix=/opt/pkcs11/usr

\end{Verbatim}

在配置之后，运行"{\bfseries{make}}"和 "{\bfseries{make test}}"。

一旦你完成构建OpenSSL，运行 "{\bfseries{apps/openssl engine pkcs11}}"来确认PKCS\#11支持 是正确编译的。输出应该是下列行中的一种，具体取决于所选的特性：

\begin{Verbatim}[]

        (pkcs11) PKCS #11 engine support (sign only)

\end{Verbatim}

或：

\begin{Verbatim}[]

        (pkcs11) PKCS #11 engine support (crypto accelerator)

\end{Verbatim}

接下来，运行 "{\bfseries{apps/openssl engine pkcs11 -t}}"。这将试图 初始化PKCS\#11引擎。如果能够顺利完成，它将会报告 {``}{\texttt{{[ available ]}}}{''}.

如果输出正确，运行"{\bfseries{make install}}"，将会 把修改后的OpenSSL套件安装到{\texttt{{/\dbz{}opt/\dbz{}pkcs11/\dbz{}usr}}}。
\subsubsection{为Linux配置带AEP Keyper的BIND 9}
\label{idm178377292048}\hypertarget{idm178377292048}{}%

为了链接到PKCS\#11提供者，在构建BIND 9时必须打开对线程的支持。

AEP Keyper的PKCS\#11库当前只作为一个32位二进制提供。如果我们要 在一个64位的主机上构建，我们必须通过在"configure"命令行的CC选项中 添加"-m32"来强制进行一个32位的构建。

\begin{Verbatim}[]

$ cd ../bind9
$ ./configure CC="gcc -m32" --enable-threads \
           --with-openssl=/opt/pkcs11/usr \
           --with-pkcs11=/opt/pkcs11/usr/lib/libpkcs11.so

\end{Verbatim}
\subsubsection{为Solaris配置带SCA 6000的BIND 9}
\label{idm178377288080}\hypertarget{idm178377288080}{}%

为链接到PKCS\#11提供者，必须在BIND 9构建时打开对线程的支持。

\begin{Verbatim}[]

$ cd ../bind9
$ ./configure CC="cc -xarch=amd64" --enable-threads \
            --with-openssl=/opt/pkcs11/usr \
            --with-pkcs11=/usr/lib/64/libpkcs11.so

\end{Verbatim}

（对一个32位的构建，省略CC="cc -xarch=amd64"。）

如果configure报告OpenSSL不工作，你可能有一个32/64位混合 搭配的体系结构。或者，你可能没有为OpenSSL指定正确的路径（这个 路径应该与OpenSSL配置时的--prefix参数一样）。
\subsubsection{为SoftHSM配置BIND 9}
\label{idm178377283712}\hypertarget{idm178377283712}{}%

\begin{Verbatim}[]

$ cd ../bind9
$ ./configure --enable-threads \
           --with-openssl=/opt/pkcs11/usr \
           --with-pkcs11=/opt/pkcs11/usr/lib/libsofthsm.so

\end{Verbatim}

在配置后，运行 "{\bfseries{make}}", "{\bfseries{make test}}"和 "{\bfseries{make install}}"。

（注意：如果“make test“在“pkcs11“系统测试中失败，你可能是忘记设置 SOFTHSM\_CONF环境变量了。）
\subsection{PKCS\#11工具}
\label{idm178377278768}\hypertarget{idm178377278768}{}%

BIND 9包含一个用以操作HSM的工具的最小集合，包括 {\bfseries{pkcs11-keygen}}，用于在HSM内生成一个新的密钥对， {\bfseries{pkcs11-list}}，用于列出当前可用的对象， {\bfseries{pkcs11-destroy}}，用于删除对象，和 {\bfseries{pkcs11-tokens}}，用于列出可用的符号。

在UNIX/Linux构建中，这些工具仅在BIND 9使用--with-pkcs11选项 配置时才被构建。（注意：如果--with-pkcs11被设置为“yes”，而不是 PKCS\#11提供者的路径，这时这些工具会被构建，但是提供者将会保持 未定义的状态。使用-m选项或PKCS11\_PROVIDER环境变量来指定提供者的路径。
\subsection{使用HSM}
\label{idm178377274592}\hypertarget{idm178377274592}{}%

对基于OpenSSL的PKCS\#11，我们必须设置运行时环境，以便装载OpenSSL和 PKCS\#11库：

\begin{Verbatim}[]

$ export LD_LIBRARY_PATH=/opt/pkcs11/usr/lib:${LD_LIBRARY_PATH}

\end{Verbatim}

这导致{\bfseries{named}}和其它的二进制可执行程序从 {\texttt{{/\dbz{}opt/\dbz{}pkcs11/\dbz{}usr/\dbz{}lib}}}而不是缺省位置装载 OpenSSL库。 在使用原生PKCS\#11时不需要本步骤。

例如，在操作一个AEP Keyper时，也需要指定“machine”文件的位置，它 存放提供者库所用到的Keyper的信息。如果机器文件在 {\texttt{{/\dbz{}opt/\dbz{}Keyper/\dbz{}PKCS11Provider/\dbz{}machine}}}, 使用：

\begin{Verbatim}[]

$ export KEYPER_LIBRARY_PATH=/opt/Keyper/PKCS11Provider

\end{Verbatim}

无论何时运行使用HSM的任何工具，都必须设置这些环境变量，包含 {\bfseries{pkcs11-keygen}}, {\bfseries{pkcs11-list}}, {\bfseries{pkcs11-destroy}}, {\bfseries{dnssec-keyfromlabel}}, {\bfseries{dnssec-signzone}}, {\bfseries{dnssec-keygen}}和 {\bfseries{named}}。

现在我们可以再HSM中创建和使用密钥。在这个例子中，我们将创建 一个2048位的密钥并赋予其一个标记"sample-ksk"：

\begin{Verbatim}[]

$ pkcs11-keygen -b 2048 -l sample-ksk

\end{Verbatim}

要确认密钥已经存在：

\begin{Verbatim}[]

$ pkcs11-list
Enter PIN:
object[0]: handle 2147483658 class 3 label[8] 'sample-ksk' id[0]
object[1]: handle 2147483657 class 2 label[8] 'sample-ksk' id[0]

\end{Verbatim}

在使用这个密钥签名一个区之前，我们必须创建一对BIND 9密钥文件。 "dnssec-keyfromlabel"应用程序完成这件事。在这个例子中，我们将使用 HSM密钥"sample-ksk"作为"example.net"的密钥签名密钥：

\begin{Verbatim}[]

$ dnssec-keyfromlabel -l sample-ksk -f KSK example.net

\end{Verbatim}

作为结果的K*.key和K*.private文件现在可以用于签名区。与包含公钥 和私钥的普通K*文件不同，这些文件只包含公钥数据，和一个存储在HSM中的 私钥的标识符。使用私钥进行签名是在HSM内部完成的。

如果你想要在HSM中生成第二个密钥用作一个区签名密钥，遵循上面 同样的流程，使用一个不同的密钥标记，一个更小的密钥长度，并在 dnssec-keyfromlabel的参数中去掉"-f KSK"：

（注意：当使用基于OpenSSL的PKCS\#11时，标记是一个任意的字符串，它标识 密钥。使用原生PKCS\#11时，标记是一个PKCS\#11 URI字符串，其中可能包含 关于和HSM的更详细的信息，包括自身的PIN。更详细的内容参见 \hyperlink{man.dnssec-keyfromlabel}{dnssec-keyfromlabel(8)}。）

\begin{Verbatim}[]

$ pkcs11-keygen -b 1024 -l sample-zsk
$ dnssec-keyfromlabel -l sample-zsk example.net

\end{Verbatim}

作为选择，你也可能更喜欢使用dnssec-keygen来生成一个传统的 存放在硬盘上的密钥：

\begin{Verbatim}[]

$ dnssec-keygen example.net

\end{Verbatim}

这比一个HSM密钥提供更弱的安全性，但是由于安全的原因，HSM可能更 慢或者使用不方便，保留HSM并将其用于更小频率的密钥签名操作可能更为有效。 如果你想，区签名密钥可以轮转更为频繁，以补偿密钥安全性的降低。 （注意：在使用原生PKCS\#11时，使用硬盘上的密钥没有速度优势，因为加密操作 是由HSM完成，并不使用硬盘上的密钥。）

现在你可以对区签名了。（注意：如果不给 {\bfseries{dnssec-signzone}}使用-S选项，就需要将两个 {\texttt{{K*.\dbz{}key}}}文件的内容添加到区的主文件中再签名。）

\begin{Verbatim}[]

$ dnssec-signzone -S example.net
Enter PIN:
Verifying the zone using the following algorithms:
NSEC3RSASHA1.
Zone signing complete:
Algorithm: NSEC3RSASHA1: ZSKs: 1, KSKs: 1 active, 0 revoked, 0 stand-by
example.net.signed

\end{Verbatim}
\subsection{在命令行指定引擎}
\label{idm178373040672}\hypertarget{idm178373040672}{}%

在使用基于OpenSSL的PKCS\#11时，OpenSSL所使用的"引擎"可以通过使用 "-E \textless{}engine\textgreater{}"命令行选项在{\bfseries{named}}和所有BIND的 {\bfseries{dnssec-*}}工具中指定。 如果BIND 9是使用--with-pkcs11选项构建的，这个选项缺省为"pkcs11"。 通常是不需要指定引擎的，除非因为某种原因，你希望使用一个不同的OpenSSL引擎。

如果你希望关闭使用"pkcs11"引擎 --- 因为调试目的，或者因为HSM 不可用 --- 就将引擎设置为空串。例如：

\begin{Verbatim}[]

$ dnssec-signzone -E '' -S example.net

\end{Verbatim}

这将导致{\bfseries{dnssec-signzone}}运行在如同没有使用 --with-pkcs11选项编译时的情况。

当使用原生PKCS\#11模式构建时，"引擎"选项具有一个不同的含义：它指定 PKCS\#11提供者库的路径。这在测试一个新的提供者库时可能很有用。
\subsection{以自动区重签的方式运行named}
\label{idm178373034960}\hypertarget{idm178373034960}{}%

如果你想要{\bfseries{named}}使用HSM密钥动态重签区， 和/或签名通过nsupdate插入的新记录，named必须能够访问HSM的PIN。 在基于OpenSSL的PKCS\#11中，这是通过将PIN放在openssl.cnf文件中 来达到（在上面的例子中， {\texttt{{/\dbz{}opt/\dbz{}pkcs11/\dbz{}usr/\dbz{}ssl/\dbz{}openssl.\dbz{}cnf}}}）。

openssl.cnf文件的位置可以再运行named之前通过设置OPENSSL\_CONF 环境变量进行覆盖。

openssl.cnf例子：

\begin{Verbatim}[]

        openssl_conf = openssl_def
        [ openssl_def ]
        engines = engine_section
        [ engine_section ]
        pkcs11 = pkcs11_section
        [ pkcs11_section ]
        PIN = <PLACE PIN HERE>

\end{Verbatim}

这也将允许dnssec-*工具无需PIN进入权限就能够访问HSM。（pkcs11-*工具 直接访问HSM，不经过OpenSSL，所以仍然需要一个PIN来使用它们。）

在原生PKCS\#11模式，PIN可以在一个作为密钥标记的一个属性所指定的文件中提供。 例如，如果一个密钥有一个标记 {\ttfamily\bfseries{{pkcs11:object=local-\dbz{}zsk;pin-\dbz{}source=/\dbz{}etc/\dbz{}hsmpin}}}， 就可以从文件{\texttt{{/\dbz{}etc/\dbz{}hsmpin}}}中读到PIN。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/warning}{警告}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

在这个方式中，将HSM的PIN放在一个文本文件中可能减少使用一个HSM的 安全优势。在以这种方式配置系统之前，确认这就是你想要的方式。
\end{admonition}


% ------------------------   
% Section 
\section{DLZ (Dynamically Loadable Zones，动态加载区)}
\label{dlz-info}\hypertarget{dlz-info}{}%

DLZ (Dynamically Loadable Zones，动态加载区)是一项BIND 9扩展，它允许直接从 一个外部数据库中提取区数据。它对格式或模式没有要求。已经存在对应几种不同的 数据库后端包括PostgreSQL，MySQL和LDAP的DLZ驱动，也可以写其它驱动。

早期，DLZ驱动是静态链接到named二进制代码的，并通过编译时的配置选项打开（ 例如，{\ttfamily\bfseries{{"configure -\dbz{}-\dbz{}with-\dbz{}dlz-\dbz{}ldap"}}}）。现在，驱动在 BIND 9源码包中提供，在{\texttt{{contrib/\dbz{}dlz/\dbz{}drivers}}}中，仍然以 同样方式链接。 way.

在BIND 9.8或更高版本，可以通过DLZ "dlopen"驱动，它充当了一个通用中间层封装 了一个实现DLZ API的共享对象，在运行时动态链接某些DLZ模块。"dlopen"驱动缺省 链接到named，在使用这些动态可链接的驱动时就不再需要配置选项了，但是使用 {\texttt{{contrib/\dbz{}dlz/\dbz{}drivers}}}下面的旧驱动时仍然需要。

当DLZ模块给named提供数据时，它使用文本格式。响应由named转换为DNS线上格式。 这个转换没有任何内部缓存，给DLZ模块的查询性能带来了重大限制。因此，不推荐 在大访问量服务器上使用DLZ。然而，它可以被用于一个隐藏主配置中，让辅服务器 通过AXFR获取区更新。（注意，由于DLZ没有对DNS notify的内置支持；辅服务器 不会收到数据库中区变化的通知信息。）
\subsection{配置DLZ}
\label{idm178373019616}\hypertarget{idm178373019616}{}%

通过{\texttt{{named.\dbz{}conf}}}中一个{\bfseries{dlz}}语句 配置一个DLZ数据库：

\begin{Verbatim}[]

    dlz example {
        database "dlopen driver.so args";
        search yes;
    };
    
\end{Verbatim}

这指定了一个在回复请求时要搜索的DLZ模块；这个模块在 {\texttt{{driver.\dbz{}so}}}中实现，并通过dlopen DLZ驱动在运行时装载。 可以指定多个{\bfseries{dlz}}语句；在回复一个请求时，所有 {\texttt{{search}}}被设置为{\texttt{{yes}}}的DLZ模块都将被 查询，以发现它们是否包含对请求名的答复；最好的可用答复将被返回给客户端。

上述例子中的{\texttt{{search}}}选项可以省略，因为 {\texttt{{yes}}}是缺省值。

如果{\texttt{{search}}}被设置为{\texttt{{no}}}，在收到一个请求 时，就{\em{不会}}在这个DLZ模块中查找最佳匹配。作为替代，在 这个DLZ中的区必须在一个zone语句中独立指定。这允许你使用标准的区选项语义 配置一个区，同时却指定一个不同的数据库后端来存储区数据。例如，使用一个 DLZ模块作重定向规则的后端存储来实现NXDOMAIN重定向：

\begin{Verbatim}[]

    dlz other {
        database "dlopen driver.so args";
        search no;
    };

    zone "." {
        type redirect;
        dlz other;
    };
    
\end{Verbatim}
\subsection{样板DLZ驱动}
\label{idm178373009536}\hypertarget{idm178373009536}{}%

为指导实现DLZ模块，目录{\texttt{{contrib/\dbz{}dlz/\dbz{}example}}}包含了 一个基本的动态可链接DLZ模块--即一个可以由"dlopen" DLZ驱动在运行时加载 的模块。 这个例子建立了一个区，其名字作为{\bfseries{dlz}}中的一个参数被 传递给模块：

\begin{Verbatim}[]

    dlz other {
        database "dlopen driver.so example.nil";
    };
    
\end{Verbatim}

在上面的例子中，模块被配置为建立一个区"example.nil"，它可以回复查询和 AXFR请求，并接受DDNS更新。在运行时，在任何更新的前面，区中包含其顶点 一条SOA记录，一条NS记录及一条A记录：

\begin{Verbatim}[]

 example.nil.  3600    IN      SOA     example.nil. hostmaster.example.nil. (
                                               123 900 600 86400 3600
                                       )
 example.nil.  3600    IN      NS      example.nil.
 example.nil.  1800    IN      A       10.53.0.1
    
\end{Verbatim}

样板驱动能够提取关于请求客户端的信息，并基于这个信息修改它的响应。 为演示这个特性，例子驱动用请求的源地址响应对 "source-addr.{\texttt{{zonename}}}\textgreater{}/TXT"的请求。 注意，这个记录将 *不会* 被包含到AXFR或ANY响应中。 通常，这个特性用于以一些其它的方式修改响应。 例如，根据请求来自的不同网络而对同一个特定名字提供不同的地址记录。

DLZ模块API的文档可以在{\texttt{{contrib/\dbz{}dlz/\dbz{}example/\dbz{}README}}}中 找到。这个目录也包含头文件{\texttt{{dlz\_\dbz{}minimal.\dbz{}h}}}，后者定义 了这个API并应被包含在任何动态可链接DLZ模块中。

% ------------------------   
% Section 
\section{BIND 9对IPv6的支持}
\label{idm178373001824}\hypertarget{idm178373001824}{}%

BIND 9对当前所定义的各种IPv6形式的名字到地址和 地址到名字的查找提供完全的支持。它也可以在具有IPv6的系统上使用 IPv6地址来发出请求。

对正向的查找，BIND 9仅支持AAAA记录。RFC 3363 废除了A6记录的使用，相应地，作为客户端对A6记录的支持也从 BIND 9中去掉了。然而，权威BIND 9 名字服务器仍然可以正确装载包含A6记录的区文件，回答对A6记录的请求， 并接受包含A6记录的区的区传送。

对IPv6反向查找，BIND 9支持传统的“半字节”格式， 既可以用于{\em{ip6.arpa}}域，也可以用于旧的、被废除的 {\em{ip6.int}}域。旧版本的的BIND 9 支持“二进制标记”（也被称为“位串”）格式，但是对二进制标记的支持已经 完全被RFC 3363所去掉了。多数BIND 9中的应用完全 不再识别二进制标记格式，如果遇到将会报错。特别的，一个权威 BIND 9名字服务器将不再装载一个包含二进制标记的区 文件。

对IPv6地址格式和结构的概括，参见\hyperlink{ipv6addresses}{第\ref{ipv6addresses}节}。
\subsection{使用AAAA记录查找地址}
\label{idm178372992432}\hypertarget{idm178372992432}{}%

IPv6的AAAA记录与IPv4的A记录相对应，并且与被废除的A6记录不同， 它在一个记录中指定完整的IPv6地址。例如：

\begin{Verbatim}[]

$ORIGIN example.com.
host            3600    IN      AAAA    2001:db8::1

\end{Verbatim}

不推荐使用IPv6内嵌IPv4映射地址。如果一个主机有一个IPv4地址， 使用一个A记录，而不是带有{\texttt{{::ffff:192.\dbz{}168.\dbz{}42.\dbz{}1}}} 的AAAA记录来作为其地址。
\subsection{使用半字节格式从地址查名字}
\label{idm178372989200}\hypertarget{idm178372989200}{}%

在使用半字节格式来查找一个地址时，地址元素只是简单地反转，并且 在反转之后的名字后面添加{\texttt{{ip6.\dbz{}arpa.\dbz{}}}}，就像在IPv4 中一样。例如，下面将提供对一个地址为{\texttt{{2001:db8::1}}} 的主机进行反向名字查找。

\begin{Verbatim}[]

$ORIGIN 0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa.
1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0   14400 IN      PTR    (
                                     host.example.com. )

\end{Verbatim}

% -------------------------------------------------------------
% Chapter BIND 9的轻量级解析器 
% ------------------------------------------------------------- 	
\chapter{BIND 9的轻量级解析器}
\label{Bv9ARM-gbk.ch05}\hypertarget{Bv9ARM-gbk.ch05}{}%

% ------------------------   
% Section 
\section{轻量级解析器库}
\label{idm178372984656}\hypertarget{idm178372984656}{}%

传统的应用链接到一个存根解析器库，通过后者向本地缓存名字服务器 发送递归的DNS请求。

IPv6给解析过程引入了新的复杂性，如：根据A6链和DNAME记录，并且同时 查找IPv4和IPv6地址。虽然大多数复杂性已经被去掉，还是很难或不可能 实现一个传统的存根解析器。

因而BIND 9就通过一个运行在本地主机上的轻量级解 析器库和一个解析器后台进程来为本地客户端提供解析服务。这些通信使 用一个基于UDP的简单协议，“轻量级解析器协议”与完全的DNS协议区别开 来，并比后者更简单。

% ------------------------   
% Section 
\section{运行一个解析器看守进程}
\label{lwresd}\hypertarget{lwresd}{}%

要使用轻量级解析器接口，系统必须运行解析器后台进程 {\bfseries{lwresd}}，或者一个配置了{\bfseries{lwres}} 语句的本地名字服务器。

缺省情况下，使用轻量级解析器库的应用向IPv4的环回地址（127.0.0.1） 的921端口发送UDP请求。这个地址可以由 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中的{\bfseries{lwserver}} 行重新指定。

当前，后台进程只在DNS中查找，但是将来它可能使用到其它资源， 如{\texttt{{/\dbz{}etc/\dbz{}hosts}}}，NIS等等。

{\bfseries{lwresd}}后台进程本质上是一个只缓存名字服务器，它 使用轻量级解析器协议而不是DNS协议来响应请求。因为它需要在每台主机 上运行，所有它被设计成不需要或只需要最小的配置。除非被配置成其它 方式，它使用{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中的 {\bfseries{nameserver}}行中列出的名字服务器作转发者，如果没 有任何指定，它也能够自动做解析。

{\bfseries{lwresd}}也可以被配置成具有一个 {\texttt{{named.\dbz{}conf}}}风格的配置文件，缺省为 {\texttt{{/\dbz{}etc/\dbz{}lwresd.\dbz{}conf}}}。一个名字服务器也可以通过在 {\texttt{{named.\dbz{}conf}}}中使用{\bfseries{lwres}}语句而 被配置成充当一个轻量级解析器后台进程。

% -------------------------------------------------------------
% Chapter BIND 9配置参考 
% ------------------------------------------------------------- 	
\chapter{BIND 9配置参考}
\label{Bv9ARM-gbk.ch06}\hypertarget{Bv9ARM-gbk.ch06}{}%

BIND 9的配置在很大程度上与BIND 8 相似；然而，也有一些新的配置领域，例如视图（view）。 BIND 8的配置文件只需很少改动就可以工作在 BIND 9中，虽然更复杂的配置应该被重新审核以检查他们 是否可以用只有BIND 9才有的新特征来更有效率地实现。

BIND 4的配置文件可以使用shell脚本 {\texttt{{contrib/\dbz{}named-\dbz{}bootconf/\dbz{}named-\dbz{}bootconf.\dbz{}sh}}}转换成 新的格式。

% ------------------------   
% Section 
\section{配置文件元素}
\label{configuration_file_elements}\hypertarget{configuration_file_elements}{}%

以下是贯穿在BIND配置文件的文档中的元素清单：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178372963200}\hypertarget{idm178372963200}{}%
\begin{longtable}{|p{1.855in}p{3.770in}|}
\hline 
{{{\texttt{{acl\_name}}}}} & {{由{\bfseries{acl}}语句所定义的一个地址匹配表 {\texttt{{address\_match\_list}}}的名字。}} \tabularnewline
{{{\texttt{{address\_match\_list}}}}} & {{一个或多个{\texttt{{ip\_addr}}}， {\texttt{{ip\_prefix}}}，{\texttt{{key\_id}}}或 {\texttt{{acl\_name}}}元素的列表，参见 \hyperlink{address_match_lists}{第\ref{address_match_lists}节}。}} \tabularnewline
{{{\texttt{{masters\_list}}}}} & {{一个或多个带有{\texttt{{key\_id}}}和/或 {\texttt{{ip\_port}}} 选项的{\texttt{{ip\_addr}}}的命名列表。 一个{\texttt{{masters\_list}}}可以包含其它 {\texttt{{masters\_list}}}。}} \tabularnewline
{{{\texttt{{domain\_name}}}}} & {{必须用作一个DNS名字的引号内字符串，如 “{\texttt{{my.\dbz{}test.\dbz{}domain}}}”。}} \tabularnewline
{{{\texttt{{namelist}}}}} & {{一个或多个{\texttt{{domain\_name}}}的列表。}} \tabularnewline
{{{\texttt{{dotted\_decimal}}}}} & {{以点（‘.’）分隔的一个到四个0到255之间的整数，如 {\bfseries{123}}，{\bfseries{45.67}}或 {\bfseries{89.123.45.67}}。}} \tabularnewline
{{{\texttt{{ip4\_addr}}}}} & {{一个IPv4地址，严格含有4个元素的 {\texttt{{dotted\_decimal}}}符号。}} \tabularnewline
{{{\texttt{{ip6\_addr}}}}} & {{一个IPv6地址，如{\bfseries{2001:db8::1234}}。IPv6范围 地址在其范围区具有模糊性，必须由一个带有百分号（‘\%’）作 分隔符的合适的区ID来澄清。强烈推荐使用字符串区名字而不是数字 标识符，以在系统配置更改时更健壮。然而，由于没有映射这种名字 和标识符值的标准，当前仅仅支持将接口名作为联系标识符。例如， 一个连接的本地的地址{\bfseries{fe80::1}}连接到接口 {\bfseries{ne0}}可以指定为 {\bfseries{fe80::1\%ne0}}。 注意在大多数系统的连接到本地的地址都有模糊性，需要澄清。}} \tabularnewline
{{{\texttt{{ip\_addr}}}}} & {{一个{\texttt{{ip4\_addr}}}或者 {\texttt{{ip6\_addr}}}。}} \tabularnewline
{{{\texttt{{ip\_dscp}}}}} & {{一个介于0到63之间的{\texttt{{number}}}，用于给去往 支持差分服务代码点（DSCP）的操作系统的流量选择一个DSCP值。}} \tabularnewline
{{{\texttt{{ip\_port}}}}} & {{一个IP端口{\texttt{{号}}}。其范围为0到65535，1024以下 端口被限制为以root身份运行的进程所使用。在某些情况下星号 （‘*’）字符用作占位符，以选择大数目的端口。}} \tabularnewline
{{{\texttt{{ip\_prefix}}}}} & {{一个IP网络地址，由一个{\texttt{{ip\_addr}}}后跟一个斜线 （‘/’）和一个代表掩码位数的数字所指定。 {\texttt{{ip\_addr}}}后面的零将被忽略。例如， {\bfseries{127/8}}表示网络 {\bfseries{127.0.0.0}}，掩码为 {\bfseries{255.0.0.0}}，{\bfseries{1.2.3.0/28}} 表示网络{\bfseries{1.2.3.0}}， 掩码为{\bfseries{255.255.255.240}}。  \par  当指定的一个前缀涉及一个IPv6范围地址，这个范围可以被忽略， 在这个情况，前缀将会匹配来自任何范围的包。}} \tabularnewline
{{{\texttt{{key\_id}}}}} & {{一个{\texttt{{domain\_name}}}，代表一个共享密钥的名字， 用在事务安全中。}} \tabularnewline
{{{\texttt{{key\_list}}}}} & {{一个或多个{\texttt{{key\_id}}}的列表，以分号分隔和结束。}} \tabularnewline
{{{\texttt{{number}}}}} & {{一个非负32位整数（即0到4294967295（含）之间的整数）。它所能 接受的值可能更多地受其使用的上下文所限制。}} \tabularnewline
{{{\texttt{{path\_name}}}}} & {{一个引用的字符串，用作路径名，例如 {\texttt{{zones/\dbz{}master/\dbz{}my.\dbz{}test.\dbz{}domain}}}。}} \tabularnewline
{{{\texttt{{port\_list}}}}} & {{一个{\texttt{{ip\_port}}}或者端口范围的列表。 一个端口范围以{\ttfamily\bfseries{{range}}}后跟两个 {\texttt{{ip\_port}}}的形式指定，即 {\texttt{{port\_low}}}和 {\texttt{{port\_high}}}，表示从 {\texttt{{port\_low}}}到 {\texttt{{port\_high}}}的端口号，含。 {\texttt{{port\_low}}}必须小于或等于 {\texttt{{port\_high}}}。例如， {\ttfamily\bfseries{{range 1024 65535}}}表示从1024到 65535的端口。在两种情况下，星号（‘*’）字符都不是被 允许的有效{\texttt{{ip\_port}}}。}} \tabularnewline
{{{\texttt{{size\_spec}}}}} & {{一个64位无符号整数、关键词{\ttfamily\bfseries{{unlimited}}}， 或{\ttfamily\bfseries{{default}}}。  \par  整数可以取值的范围为0 \textless{}= value \textless{}= 18446744073709551615， 虽然某些参数（如{\bfseries{max-journal-size}}）在这个 范围中使用更受限的区间。在大多数情况下， 设置一个值为0不意谓着字面上的零；它表示“未定义”或 “尽可能的大”，具体是什么取决于上下文。参见特殊参数的解释 以获取{\texttt{{size\_spec}}}在如何解释其用法的详细信息。  \par  数字值后面可以选择跟比例因数： {\ttfamily\bfseries{{K}}}或{\ttfamily\bfseries{{k}}}表示 千字节，{\ttfamily\bfseries{{M}}}或{\ttfamily\bfseries{{m}}} 表示兆字节，{\ttfamily\bfseries{{G}}}或 {\ttfamily\bfseries{{g}}}表示吉字节， 其比例分别为乘1024，1024*1024和1024*1024*1024。  \par  {\texttt{{unlimited}}}通常表示“尽可能的大”， 并且通常是设置一个大数时的最佳方式。  \par  {\texttt{{default}}}使用服务器启动时的有效限制。}} \tabularnewline
{{{\texttt{{yes\_or\_no}}}}} & {{{\ttfamily\bfseries{{yes}}}或{\ttfamily\bfseries{{no}}}。单词 {\ttfamily\bfseries{{true}}}和{\ttfamily\bfseries{{false}}} 也可以，同样还有数字{\ttfamily\bfseries{{1}}}和 {\ttfamily\bfseries{{0}}}。}} \tabularnewline
{{{\texttt{{dialup\_option}}}}} & {{{\ttfamily\bfseries{{yes}}}， {\ttfamily\bfseries{{no}}}， {\ttfamily\bfseries{{notify}}}， {\ttfamily\bfseries{{notify-\dbz{}passive}}}， {\ttfamily\bfseries{{refresh}}}， {\ttfamily\bfseries{{passive}}}之一。 当使用在一个区中时， {\ttfamily\bfseries{{notify-\dbz{}passive}}}， {\ttfamily\bfseries{{refresh}}}和 {\ttfamily\bfseries{{passive}}}被限制 在只能用于辅区和存根区中。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsection{地址匹配表}
\label{address_match_lists}\hypertarget{address_match_lists}{}%
\subsubsection{语法}
\label{idm178372857104}\hypertarget{idm178372857104}{}%

\begin{Verbatim}[]
address_match_list = address_match_list_element ;
  [ address_match_list_element; ... ]
address_match_list_element = [ ! ] (ip_address [/length] |
   key key_id | acl_name | { address_match_list } )

\end{Verbatim}
\subsubsection{定义和用法}
\label{idm178372853824}\hypertarget{idm178372853824}{}%

地址匹配表主要用于决定对各种服务器操作的访问控制。它们通常也用在 {\bfseries{listen-on}}和{\bfseries{sortlist}}语句中。组 成一个地址匹配表的元素可以是以下的任何一种：

\begin{itemize}
%--- Item
\item 
一个IP地址（IPv4或IPv6）


%--- Item
\item 
一个IP前缀（以‘/’表示法）


%--- Item
\item 
一个密钥ID，由{\bfseries{key}}语句所定义的


%--- Item
\item 
使用{\bfseries{acl}}语句定义的地址匹配表的名字


%--- Item
\item 
包含在花括号中的嵌套的地址匹配表

\end{itemize}

元素可以使用惊叹号（‘!’）取反，匹配表名“any”、“none”、 “localhost”和“localnets”是预定义的。可以从acl语句的描述中找到这 些名字的更多信息。

增加key子句使这个句法元素的名字有些怪异，因为安全密钥可以校验访问而 不需考虑一个主机或网络的地址。虽然如此，“地址匹配表”这个术语仍然 贯穿整个文档。

当一个给定的IP地址或前缀与一个地址匹配表进行比较时，比较需要大致 O(1)的时间。然而，密钥比较要求遍历密钥链表，直到找到一个匹配的 密钥，这样就会较慢一些。

一次匹配的解释依赖于列表是否被使用于访问控制、 定义{\bfseries{listen-on}}端口， 或者在一个{\bfseries{sortlist}}中，以及元素是否被取反。

当用作一个访问控制表时，非否定的匹配允许访问而否定的匹配拒绝访问。 如果没有匹配，则拒绝访问。子句 {\bfseries{allow-notify}}， {\bfseries{allow-recursion}}， {\bfseries{allow-recursion-on}}， {\bfseries{allow-query}}， {\bfseries{allow-query-on}}， {\bfseries{allow-query-cache}}， {\bfseries{allow-query-cache-on}}， {\bfseries{allow-transfer}}， {\bfseries{allow-update}}， {\bfseries{allow-update-forwarding}}和 {\bfseries{blackhole}}都使用地址匹配表。类似地， {\bfseries{listen-on}}选项 将使服务器拒绝任何发到不与列表匹配的机器地址的请求。

插入的顺序是重要的。如果一个ACL中有超过一个元素与给定的IP地址或 前缀匹配，那么在ACL中{\em{首先}}定义的就会优先。 由于这个首次匹配的特性，作为列表中某个元素的子集的元素应该放在列表 的前面，而不考虑是否是否定的条目。例如，在 {\bfseries{1.2.3/24; ! 1.2.3.13;}}中，元素1.2.3.13完全是无用 的，因为算法会将所有查找1.2.3.13的匹配到元素1.2.3/24上。使用 {\bfseries{! 1.2.3.13; 1.2.3/24}}修正了这个问题，通过否定符阻 止了1.2.3.13，而让其它的1.2.3.*主机都通过。
\subsection{注释语法}
\label{idm178372833200}\hypertarget{idm178372833200}{}%

BIND 9注释语法允许注释可以出现在一个BIND配置文件中 空白字符可以出现的任何位置。应各种类型的程序员的要求，注释可以写成C， C++或shell/perl的风格。
\subsubsection{语法}
\label{idm178372831280}\hypertarget{idm178372831280}{}%


\begin{Verbatim}[]
/* This is a BIND comment as in C */
\end{Verbatim}
 
\begin{Verbatim}[]
// This is a BIND comment as in C++
\end{Verbatim}
 
\begin{Verbatim}[]
# This is a BIND comment as in common UNIX shells
and perl
\end{Verbatim}

\subsubsection{定义和用法}
\label{idm178372827616}\hypertarget{idm178372827616}{}%

在一个BIND配置文件中，注释可以出现在任何空白字符 可以出现的地方。

C风格的注释以两个字符/*（斜线，星号）开始，以*/（星号，斜线）结束。 因为其完全以这些字符划界，所以它们可以用于在一行的一部份或跨越多行 时的注释。

C风格的注释不能嵌套。例如，以下是无效的，因为全部注释在第一个*/时结 束：


\begin{Verbatim}[]
/* This is the start of a comment.
   This is still part of the comment.
/* This is an incorrect attempt at nesting a comment. */
   This is no longer in any comment. */

\end{Verbatim}


C++风格的注释以两个字符//（斜线，斜线）开始并持续到一行的结束。它们 不能继续并跨越多个行；要想使一个注释跨越多行，必须在每行都使用//。 例如：


\begin{Verbatim}[]
// This is the start of a comment.  The next line
// is a new comment, even though it is logically
// part of the previous comment.

\end{Verbatim}


Shell风格（或者称为perl风格，只要你愿意）的注释以字符\#（井号）开始 并持续到一行的结束，与C++注释一样。 例如：


\begin{Verbatim}[]
# This is the start of a comment.  The next line
# is a new comment, even though it is logically
# part of the previous comment.

\end{Verbatim}


\begin{admonition}{/usr/local/share/db2latex/xsl/figures/warning}{警告}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

你不能象在区文件中一样，使用分号（‘;’）字符来开始一个注释。分号 表示一个配置语句的结束。
\end{admonition}


% ------------------------   
% Section 
\section{配置文件语法}
\label{Configuration_File_Grammar}\hypertarget{Configuration_File_Grammar}{}%

BIND 9的配置文件由语句和注释组成。语句以分号结束。语 句和注释是仅有的可以出现在花括号之外的元素。许多语句包含由子语句组成的 块，子语句也以分号结束。

以下是所支持的语句：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178372815760}\hypertarget{idm178372815760}{}%
\begin{longtable}{|p{1.336in}p{3.778in}|}
\hline 
{{{\bfseries{acl}}}} & {{定义一个命名的IP地址匹配列表，用于访问控制或其它用途。}} \tabularnewline
{{{\bfseries{controls}}}} & {{声明控制通道，用于{\bfseries{rndc}}应用程序。}} \tabularnewline
{{{\bfseries{include}}}} & {{包含一个文件。}} \tabularnewline
{{{\bfseries{key}}}} & {{指定在使用TSIG时，用于的认证和授权的密钥信息。}} \tabularnewline
{{{\bfseries{logging}}}} & {{指定服务器记录哪些日志，和在哪里记录日志消息。}} \tabularnewline
{{{\bfseries{lwres}}}} & {{配置{\bfseries{named}}，使其也充当轻量级解析器看守进程 （{\bfseries{lwresd}}）。}} \tabularnewline
{{{\bfseries{masters}}}} & {{定义一个命名的主服务器列表，一般包含在存根区和辅区的 {\bfseries{masters}}或{\bfseries{also-notify}} 列表中。}} \tabularnewline
{{{\bfseries{options}}}} & {{控制全局服务器配置和为其它语句设置缺省参数。}} \tabularnewline
{{{\bfseries{server}}}} & {{为基于单个服务器的配置设置某个配置选项。}} \tabularnewline
{{{\bfseries{statistics-channels}}}} & {{声明通信通道，以访问{\bfseries{named}}统计信息。}} \tabularnewline
{{{\bfseries{trusted-keys}}}} & {{定义信任的DNSSEC密钥。}} \tabularnewline
{{{\bfseries{managed-keys}}}} & {{列出通过RFC 5011信任锚点维护来保持更新 的DNSSEC密钥。}} \tabularnewline
{{{\bfseries{view}}}} & {{定义一个视图。}} \tabularnewline
{{{\bfseries{zone}}}} & {{定义一个区。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


{\bfseries{logging}}和{\bfseries{options}}语句在每个配置文 件中只能出现一次。
\subsection{{\bfseries{acl}}语句语法}
\label{idm178372766224}\hypertarget{idm178372766224}{}%

\begin{Verbatim}[]
acl acl-name {
    address_match_list
};

\end{Verbatim}
\subsection{{\bfseries{acl}}语句定义和用法}
\label{acl}\hypertarget{acl}{}%

{\bfseries{acl}}语句将一个地址匹配列表赋值给一个符号名字。其名 字来源于地址匹配列表的主要用途：访问控制表 （Access Control Lists，ACLs）。

下列ACL是内建的：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178372761904}\hypertarget{idm178372761904}{}%
\begin{longtable}{|p{1.130in}p{4.000in}|}
\hline 
{{{\bfseries{any}}}} & {{匹配所有主机。}} \tabularnewline
{{{\bfseries{none}}}} & {{匹配空主机。}} \tabularnewline
{{{\bfseries{localhost}}}} & {{匹配系统的所有网络接口的IPv4和IPv6地址。当有地址被添加或 删除时，{\bfseries{localhost}} ACL元素被更新以反映 变化。}} \tabularnewline
{{{\bfseries{localnets}}}} & {{匹配一个系统所在的IPv4或IPv6网络上的所有主机。 当有地址被添加或删除时， {\bfseries{localnets}} ACL元素被更新以反映变化。 一些系统不提供决定本地IPv6地址的前缀长度的方法。 在这样的情况下，{\bfseries{localnets}}只匹配 本地IPv6地址，如同{\bfseries{localhost}}一样。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


当BIND 9是带GeoIP支持构建时，ACL也可用于 地理访问限制。通过指定一个如下形式的ACL元素可以达成： {\bfseries{geoip [db {\ttfamily\itshape{{database}}}] {\ttfamily\itshape{{field}}} {\ttfamily\itshape{{value}}}}}

{\ttfamily\itshape{{field}}}指示在一个匹配时搜索哪个字段。可用的 字段为"country"，"region"，"city"，"continent"，"postal"（邮政编码）， "metro"（城区代码），"area"（地区编码），"tz"（时区），"isp"，"org"， "asnum"，"domain"和"netspeed"。

{\ttfamily\itshape{{value}}}是要在数据库中搜索的值。一个包含空格 或其它特殊字符的字符串必须使用引号。如果是一个"asnum"搜索，需要使用 "ASNNNN"开始的字符串，否则必须使用完整描述 （例如，"ASNNNN 某某公司名"）。如果是一个"country"搜索并且字符串是 两个字符长度，它必须是一个标准的ISO-3166-1双字符国家代码，如果是 三个字符长度，它必须是一个ISO-3166-1三字符国家代码；否则就应该是国家 的全称。类似地，如果是一个"region"搜索并且字符串是两个字符长度，它 必须是一个标准的双字符州或省的缩写；否则它就是州或省的全称。

{\ttfamily\itshape{{database}}}字段指示匹配时要搜索哪个GeoIP 数据库。大多数情况这不是必须的，因为大多数搜索字段只能在单个数据库 中找到。然而，对一个国家的搜索可以由"city"，"region"或"country"数据库 回答，对区域的搜索（例如，州或省）可以由"city"或"region"数据库回答。 对这些搜索类型，指定一个{\ttfamily\itshape{{database}}}将强制 请求由那个数据库而不是别的数据库回答。如果未指定 {\ttfamily\itshape{{database}}}，这些请求将会按照顺序由"city" 数据库回答，如果安装了这个数据库，或者由"region"数据库回答，如果 安装了这个数据库，或者由"country"数据库回答。

一些GeoIP ACL的例子：

\begin{Verbatim}[]
geoip country US;
geoip country JAP;
geoip db country country Canada;
geoip db region region WA;
geoip city "San Francisco";
geoip region Oklahoma;
geoip postal 95062;
geoip tz "America/Los_Angeles";
geoip org "Internet Systems Consortium";

\end{Verbatim}
\subsection{{\bfseries{controls}}语句语法}
\label{idm178372733952}\hypertarget{idm178372733952}{}%

\begin{Verbatim}[]
controls {
   [ inet ( ip_addr | * ) [ port ip_port ]
                allow {  address_match_list  }
                keys { key_list }; ]
   [ inet ...; ]
   [ unix path perm number owner number group number
     keys { key_list }; ]
   [ unix ...; ]
};

\end{Verbatim}
\subsection{{\bfseries{controls}}语句定义和用法}
\label{controls_statement_definition_and_usage}\hypertarget{controls_statement_definition_and_usage}{}%

{\bfseries{controls}}语句声明控制通道，其被系统管理员用来控制对 名字服务器的操作。这些控制通道由{\bfseries{rndc}}应用程序使用， 它可以发送命令到名字服务器及从名字服务器获取一些非DNS的结果。

一个{\bfseries{inet}}控制通道是一个监听在 {\bfseries{ip\_addr}}地址的{\bfseries{ip\_port}}端口的TCP套 接字，可以是IPv4或IPv6地址。一个值为{\texttt{{*}}}（星号）的 {\bfseries{ip\_addr}}被解释成IPv4通配地址；到系统的任何IPv4地址 的连接都将被接受。要监听IPv6的通配地址，使用值为{\texttt{{::}}} 的{\bfseries{ip\_addr}}。如果你只想对本机使用 {\bfseries{rndc}}，使用环回地址（{\texttt{{127.\dbz{}0.\dbz{}0.\dbz{}1}}}或 {\texttt{{::1}}}）是最为安全的推荐做法。

如果没有指定端口，就使用953端口。星号“{\texttt{{*}}}”不能用于 {\bfseries{ip\_port}}。

通过控制通道发送命令的能力是被{\bfseries{allow}}和 {\bfseries{keys}}子句所限制的。通过基于 {\bfseries{address\_match\_list}}来允许到控制通道的连接。这只是一 个简单的基于IP地址的过滤；{\bfseries{address\_match\_list}}中的任 何{\bfseries{key\_id}}元素都被忽略。

一个{\bfseries{unix}}控制通道是一个UNIX域套接字，它监听文件系统 中指定的路径。对这个套接字的访问由{\bfseries{perm}}、 {\bfseries{owner}}和{\bfseries{group}}子句指定。注意在某 些平台（SunOS和Solaris）上，权限（{\bfseries{perm}}）是应用在上 级目录，而在套接字本身上的权限是被忽略的。

命令通道的主要授权机制是{\bfseries{key\_list}}，它是一个 {\bfseries{key\_id}}的列表。{\bfseries{key\_list}}中的每个 {\bfseries{key\_id}}都被授权能够通过控制通道执行命令。关于在 {\bfseries{rndc}}中配置密钥的信息，参见 \hyperlink{admin_tools}{第\ref{admin_tools}节}中的\hyperlink{rndc}{{[Remote Name Daemon Control application]}}。

如果没有提供{\bfseries{controls}}语句，{\bfseries{named}} 将设置一个缺省的控制通道，监听在环回地址127.0.0.1及其IPv6的对应者::1 上。在这样的情况下，当有{\bfseries{controls}}语句但是没有提供一 个{\bfseries{keys}}子句时，{\bfseries{named}}将试图从 {\texttt{{/\dbz{}etc}}}（或者是BIND编译时 {\texttt{{sysconfdir}}}所指定的目录）下的 {\texttt{{rndc.\dbz{}key}}}文件中装载命令通道密钥。要建立一个 {\texttt{{rndc.\dbz{}key}}}文件，运行 {\ttfamily\bfseries{{rndc-\dbz{}confgen -\dbz{}a}}}。

建立{\texttt{{rndc.\dbz{}key}}}特性是为了减少从 BIND 8的改变，后者在其命令通道上没有提供数字签名， 因而没有{\bfseries{keys}}子句。这使BIND 9可 以不加改变地使用现成的BIND 8配置文件，并使 {\bfseries{rndc}}能够用与BIND 8中{\bfseries{ndc}}同样的方 式工作，只是在BIND 9安装完成之后简单地执行命令 {\ttfamily\bfseries{{rndc-\dbz{}confgen -\dbz{}a}}}。

由于{\texttt{{rndc.\dbz{}key}}}特性只是想要允许向后兼容 BIND 8配置文件的用法，这个特征没有高度的配置能力。 你不能很容易地改变密钥名或秘密的大小，所以，如果你希望更改这些东西， 你应该用你自己的密钥建立一个{\texttt{{rndc.\dbz{}conf}}}。 {\texttt{{rndc.\dbz{}key}}}文件有其自身的权限设置，以使其只能由其所 有者（运行{\bfseries{named}}的用户）才能访问。如果你期望更大的 灵活性以使其它用户可以访问{\bfseries{rndc}}命令，你需要建立一个 {\texttt{{rndc.\dbz{}conf}}}并将其设为要访问它的用户所在的组具有组 可读的权限。

要禁用命令通道，使用一个空的{\bfseries{controls}}语句： {\bfseries{controls \{ \};}}。
\subsection{{\bfseries{include}}语句语法}
\label{idm178372695664}\hypertarget{idm178372695664}{}%

\begin{Verbatim}[]
include filename;
\end{Verbatim}
\subsection{{\bfseries{include}}语句定义和用法}
\label{idm178372693552}\hypertarget{idm178372693552}{}%

{\bfseries{include}}语句将指定的文件插入到 {\bfseries{include}}语句出现的点。{\bfseries{include}}语 句使配置文件的管理更加容易，可以允许读或者写某些内容，没有其它用途。 例如，这个语句可以包含进只有名字服务器才可以读的私钥。
\subsection{{\bfseries{key}}语句语法}
\label{idm178372690592}\hypertarget{idm178372690592}{}%

\begin{Verbatim}[]
key key_id {
    algorithm string;
    secret string;
};

\end{Verbatim}
\subsection{{\bfseries{key}}语句定义和用法}
\label{idm178372687648}\hypertarget{idm178372687648}{}%

{\bfseries{key}}语句定义了一个共享密钥，用于TSIG （参见\hyperlink{tsig}{第\ref{tsig}节}）或命令通道 （参见\hyperlink{controls_statement_definition_and_usage}{第\ref{controls_statement_definition_and_usage}节}）中。

{\bfseries{key}}语句可以放在配置文件的顶级或一个 {\bfseries{view}}语句的内部。定义在顶级{\bfseries{key}}语 句中的密钥可以用于所有视图中。想要用于{\bfseries{controls}}语句 （参见\hyperlink{controls_statement_definition_and_usage}{第\ref{controls_statement_definition_and_usage}节}）中的 密钥必须定义在顶级中。

{\ttfamily\itshape{{key\_id}}}，即密钥的名字，是一个唯一表示一个密 钥的域名。它可以用于一个{\bfseries{server}}语句中，它使发向那台 服务器的请求都用这个密钥签名，或者用于地址匹配表中，以检验所收到的请 求是由与这个名字、算法和秘密相匹配的密钥所签名。

{\ttfamily\itshape{{algorithm\_id}}}是一个指定安全/认证算法的字符 串。named支持{\texttt{{hmac-\dbz{}md5}}}， {\texttt{{hmac-\dbz{}sha1}}}，{\texttt{{hmac-\dbz{}sha224}}}， {\texttt{{hmac-\dbz{}sha256}}}，{\texttt{{hmac-\dbz{}sha384}}}和 {\texttt{{hmac-\dbz{}sha512}}} TSIG认证。通过在尾部增加一个以减号开始 的符合要求位数的最小数字来支持截断散列，如： {\texttt{{hmac-\dbz{}sha1-\dbz{}80}}}。 {\ttfamily\itshape{{secret\_string}}}是算法所用到的秘密，被当作一 个base-64编码的字符串。
\subsection{{\bfseries{logging}}语句语法}
\label{idm178372675776}\hypertarget{idm178372675776}{}%

\begin{Verbatim}[]
logging {
   [ channel channel_name {
     ( file path_name
         [ versions ( number | unlimited ) ]
         [ size size_spec ]
       | syslog syslog_facility
       | stderr
       | null );
     [ severity (critical | error | warning | notice |
                 info | debug [ level ] | dynamic ); ]
     [ print-category yes or no; ]
     [ print-severity yes or no; ]
     [ print-time yes or no; ]
   }; ]
   [ category category_name {
     channel_name ; [ channel_name ; ... ]
   }; ]
   ...
};

\end{Verbatim}
\subsection{{\bfseries{logging}}语句定义和用法}
\label{idm178372659712}\hypertarget{idm178372659712}{}%

{\bfseries{logging}}语句为名字服务器配置了广泛的日志选项种类。 其{\bfseries{channel}}短语将输出方法、格式选项和严重级别与一个 可以用于{\bfseries{category}}短语中的名字联系起来，用以选择多种 类别的消息应当如何记入日志。

只能使用一条{\bfseries{logging}}语句，它可以定义多个想要的通道 和类别。如果没有{\bfseries{logging}}语句，日志配置将会是：

\begin{Verbatim}[]
logging {
     category default { default_syslog; default_debug; };
     category unmatched { null; };
};

\end{Verbatim}

在BIND 9中，日志配置只是在全部的配置文件被分析完成 之后才建立。在BIND 8中，日志配置是在 {\bfseries{logging}}语句被分析时建立的。在服务器启动时，所有关 于配置文件中语法错误的日志消息都被写到缺省通道，或者在指定 “{\texttt{{-g}}}”选项时被写到标准错误中。
\subsubsection{{\bfseries{channel}}短语}
\label{idm178372652464}\hypertarget{idm178372652464}{}%

所有的日志输出都写到一个或多个{\em{channels}}；你可以 按照需要建立多个通道。

每个通道定义必须包含一个目标子句，这个子句中说明此通道的消息是到一 个文件、到特定的syslog设施、到标准错误输出流还是被丢弃。还有些可选 的选项，限定此通道所接受的消息严重级别（缺省为 {\bfseries{info}}），是否包含{\bfseries{named}}所生成的 时间戳，类别名字和/或严重级别（缺省是不包含任何）。

{\bfseries{null}}目标子句使得所有发送到此通道的消息被丢弃；在 此情况下，通道的其它选项都没有意义。

{\bfseries{file}}目标子句将定向到一个磁盘文件。它可以包括两个 指标的限制，一个是允许多大的文件，一个是在文件打开时允许多少个版本 的文件存在。

如果你使用{\bfseries{versions}}日志文件选项， {\bfseries{named}}将通过在打开状态更改名字来保存多个备份 版本。例如，如果你选择保持文件{\texttt{{lamers.\dbz{}log}}}的三个 旧版本，那么在打开它之前，{\texttt{{lamers.\dbz{}log.\dbz{}1}}}被更名为 {\texttt{{lamers.\dbz{}log.\dbz{}2}}}， {\texttt{{lamers.\dbz{}log.\dbz{}0}}}被更名为 {\texttt{{lamers.\dbz{}log.\dbz{}1}}}，{\texttt{{lamers.\dbz{}log}}} 被更名为{\texttt{{lamers.\dbz{}log.\dbz{}0}}}。你可以设置 {\bfseries{versions unlimited}}不限制版本数。如果将 {\bfseries{size}}选项附加到日志文件，只有在被打开的文件超过了 所指定的大小时才会更名。缺省情况下，没有备份版本；所有现存的日志文 件只是简单地追加。

{\bfseries{size}}选项用于限制日志的增长，如果文件超过了这个大 小，{\bfseries{named}}将会停止写到文件，除非它有一个 {\bfseries{versions}}选项。如果保持备份版本，文件将按照上述方 式轮转，并开始一个新的。如果没有{\bfseries{versions}}选项，就 不会写入更多的数据到日志中，除非有某些带外的机制输出日志或者截断日 志使其小于最大大小。缺省行为是不限制文件大小。

{\bfseries{size}}和{\bfseries{versions}}选项用法例子：

\begin{Verbatim}[]
channel an_example_channel {
    file "example.log" versions 3 size 20m;
    print-time yes;
    print-category yes;
};

\end{Verbatim}

{\bfseries{syslog}}目标子句将通道导向系统日志。它的参数是在 {\bfseries{syslog}}手册页中所描述的系统日志的设施。知名的设施 有{\bfseries{kern}},{\bfseries{user}}, {\bfseries{mail}},{\bfseries{daemon}}, {\bfseries{auth}},{\bfseries{syslog}}, {\bfseries{lpr}},{\bfseries{news}}, {\bfseries{uucp}},{\bfseries{cron}}, {\bfseries{authpriv}},{\bfseries{ftp}}, {\bfseries{local0}},{\bfseries{local1}}, {\bfseries{local2}},{\bfseries{local3}}, {\bfseries{local4}},{\bfseries{local5}}, {\bfseries{local6}}和{\bfseries{local7}}， 但是，不是所有的操作系统上都支持所有的设施。 {\bfseries{syslog}}如何处理发向这些设施的消息在 {\bfseries{syslog.conf}}手册页中描述。如果你的系统使用非常旧 的{\bfseries{syslog}}版本，它只支持使用两个参数调用 {\bfseries{openlog()}}函数，这时这个子句会被静默地忽略。

在Windows机器上，syslog消息直接定向到事件查看器（EventViewer）。

{\bfseries{severity}}子句工作起来象{\bfseries{syslog}} 的“优先级”，只有一点不同，就是如果你直接写到文件而不是使用 {\bfseries{syslog}}时，也可以使用它们。至少达到所使用的 严重级别的消息将才会送到此通道；大于严重级别的消息会被接受。

如果你使用{\bfseries{syslog}}，{\bfseries{syslog.conf}} 优先级也会决定最终的通过量。例如，定义一个通道设施，其严重级别为 {\bfseries{daemon}}和{\bfseries{debug}}，但是通过 {\bfseries{syslog.conf}}设置只记录 {\bfseries{daemon.warning}}，将会导致严重级别为 {\bfseries{info}}和{\bfseries{notice}}的消息被扔掉。在 相反的情况下，{\bfseries{named}}只记录 {\bfseries{warning}}或更高级别的消息， {\bfseries{syslogd}}会记录所有它从这个通道收到的消息。

{\bfseries{stderr}}目标子句将通道引导到服务器的标准错误流。其 意图是在服务器作为一个前台进程运行时使用的，例如调试一个配置时。

服务器在调试模式时可以支持扩展调试信息。如果服务器的全局调试级别大 于0，调试模式将会被激活。全局调试级别可以通过在启动 {\bfseries{named}}服务器时带{\texttt{{-d}}}标志并后跟一个 正整数，或者通过运行{\bfseries{rndc trace}}。全局调试级别可以 设为0，调试模式被关闭，或者通过运行 {\bfseries{rndc notrace}}。服务器中的所有调试信息都有一个 调试级别，越高的调试级别给出越详细的输出。在通道内指定一个特定的 调试严重级别，例如：

\begin{Verbatim}[]
channel specific_debug_level {
    file "foo";
    severity debug 3;
};

\end{Verbatim}

将会在服务器工作在调试模式的任何时间时，得到第3级或更低的调试输出， 而无论全局调试级别的设置是多少。严重级别为 {\bfseries{dynamic}}的通道使用服务器的全局调试级别来决定输出 哪些消息。

如果{\bfseries{print-time}}被打开，日期和时间将会被记入日志。 {\bfseries{print-time}}可以用于{\bfseries{syslog}} 通道，但是通常不这样用，因为{\bfseries{syslog}}也记录日期和 时间。如果要{\bfseries{print-category}}，消息的类别也将被记入 日志。最后，如果打开{\bfseries{print-severity}}，消息的严重 级别将被记入日志。{\bfseries{print-}}选项可以用在任何组合， 并总是按照下列顺序打印：时间，类别，严重性。这里是所有三个 {\bfseries{print-}}选项都打开的一个例子：

{\texttt{{28-Feb-2000 15:05:32.863 general: notice: running}}}

有四个预定义的通道供{\bfseries{named}}缺省日志使用， 具体如下：如何使用它们在\hyperlink{the_category_phrase}{第\ref{the_category_phrase}节}描述。

\begin{Verbatim}[]
channel default_syslog {
    // send to syslog's daemon facility
    syslog daemon;
    // only send priority info and higher
    severity info;
};

channel default_debug {
    // write to named.run in the working directory
    // Note: stderr is used instead of "named.run" if
    // the server is started with the '-f' option.
    file "named.run";
    // log at the server's current debug level
    severity dynamic;
};

channel default_stderr {
    // writes to stderr
    stderr;
    // only send priority info and higher
    severity info;
};

channel null {
   // toss anything sent to this channel
   null;
};

\end{Verbatim}

{\bfseries{default\_debug}}通道具有专门的属性，它只在服务器的 调试级别不为零时才有输出。通常情况下，它会写到服务器工作目录下面一 个文件名为{\texttt{{named.\dbz{}run}}}的文件。

由于安全原因，当使用了“{\texttt{{-u}}}”命令行选项时， {\texttt{{named.\dbz{}run}}}文件只在{\bfseries{named}}改变 为新的UID之后才被创建，并且在{\bfseries{named}}启动过程中还以 root运行时所产生的调试输出都被丢弃。如果你需要捕捉这些输出，你必须 使用“{\texttt{{-g}}}”选项运行服务器并将标准错误重定向到一个文 件。

一旦一个通道被定义后，它不能被重定义。这样你不能直接修改内建的 通道，但是你可以修改缺省的日志，即将类别指向你所定义的通道。
\subsubsection{{\bfseries{category}}短语}
\label{the_category_phrase}\hypertarget{the_category_phrase}{}%

存在许多类别，这样你可以发送你想要看的日志，而不看你不想要的日志。 如果你不为一个类别指定一个通道名单，这个类别下面的日志消息将会被发 送到{\bfseries{default}}类别。如果你不指定一个缺省的类别，就 使用下列“缺省的缺省”：

\begin{Verbatim}[]
category default { default_syslog; default_debug; };

\end{Verbatim}

作为一个例子，我们假设你想将安全事件记录到一个文件，但是你也想保持 缺省的日志行为。你会如下设定：

\begin{Verbatim}[]
channel my_security_channel {
    file "my_security_file";
    severity info;
};
category security {
    my_security_channel;
    default_syslog;
    default_debug;
};
\end{Verbatim}

想丢弃一个类别中的所有消息，指定null通道：

\begin{Verbatim}[]
category xfer-out { null; };
category notify { null; };

\end{Verbatim}

以下是可用类别及其所包含的日志信息类型的简单描述。将来的 BIND发行版会添加更多的类别。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178372592384}\hypertarget{idm178372592384}{}%
\begin{longtable}{|p{1.150in}p{3.350in}|}
\hline 
{{{\bfseries{default}}}} & {{缺省类别，为没有被明确定义的配置的类别指定的日志选项。}} \tabularnewline
{{{\bfseries{general}}}} & {{捕捉所有。许多未被分类到某个类别中，都被记入此类。}} \tabularnewline
{{{\bfseries{database}}}} & {{与数据库相关的消息，数据库指名字服务器内部用于存储区和缓 存数据。}} \tabularnewline
{{{\bfseries{security}}}} & {{同意和拒绝请求。}} \tabularnewline
{{{\bfseries{config}}}} & {{配置文件分析及处理。}} \tabularnewline
{{{\bfseries{resolver}}}} & {{DNS解析，例如由缓存名字服务器所进行的递归查询给客户端的影 响。}} \tabularnewline
{{{\bfseries{xfer-in}}}} & {{服务器所接受的区传送。}} \tabularnewline
{{{\bfseries{xfer-out}}}} & {{服务器所发出的区传送。}} \tabularnewline
{{{\bfseries{notify}}}} & {{NOTIFY协议。}} \tabularnewline
{{{\bfseries{client}}}} & {{对客户端请求的处理。}} \tabularnewline
{{{\bfseries{unmatched}}}} & {{{\bfseries{named}}不能够决定的类别或者没有合适的 {\bfseries{view}}与之匹配的消息。一个单行的摘要也 记入{\bfseries{client}}类别。这个类别最好发送到一个 文件或标准错误，缺省时它被发送到{\bfseries{null}} 通道。}} \tabularnewline
{{{\bfseries{network}}}} & {{网络操作。}} \tabularnewline
{{{\bfseries{update}}}} & {{动态更新。}} \tabularnewline
{{{\bfseries{update-security}}}} & {{同意和拒绝更新请求。}} \tabularnewline
{{{\bfseries{queries}}}} & {{指定记录请求日志的地方。  \par  在启动时，指定{\bfseries{queries}}类别将启动对请求 的日志，除非设定{\bfseries{querylog}}选项。  \par  请求日志条目报告了客户端IP地址和端口，请求的名字，类和类 型。接下来它报告是否设置了期望递归（Recursion Desired） 的标志（如果设置是+，如果未设置是-），请求是否被签名 （S），是否使用EDNS（E），是否使用TCP（T），DO位 （DNSSEC Ok）是否被设置（D）， 或者CD位（Checking Disables）是否被设置（C）。 在这之后，报告请求被发送到的目标地址。  \par  {\texttt{{client 127.0.0.1\#62536 (www.example.com): query: www.example.com IN AAAA +SE}}}  \par  {\texttt{{client ::1\#62537 (www.example.net): query: www.example.net IN AAAA -SE}}}  \par  （这条日志消息的第一部份，显示了客户端地址/端口号和 请求名，在随后所有与同样请求相关的日志消息中都被 重复。）}} \tabularnewline
{{{\bfseries{query-errors}}}} & {{关于导致失败的请求信息。}} \tabularnewline
{{{\bfseries{dispatch}}}} & {{分发收到的包到将要处理它们的服务器模块。}} \tabularnewline
{{{\bfseries{dnssec}}}} & {{DNSSEC和TSIG协议处理。}} \tabularnewline
{{{\bfseries{lame-servers}}}} & {{跛服务器。这是远端服务器上的错误配置，是在解析过程中试图 向其发请求时由BIND 9所发现的。}} \tabularnewline
{{{\bfseries{delegation-only}}}} & {{只授权。记录被强制成NXDOMAIN的请求，它是一个只授权区或一 个转发、提示或存根区定义中有 {\bfseries{delegation-only}}的结果。}} \tabularnewline
{{{\bfseries{edns-disabled}}}} & {{记录由于超时而被强制使用普通DNS的请求日志。这 通常是因为远端服务器不是兼容RFC 1034（对EDNS请求 和其不明白的DNS其它扩展并不总是返回FORMERR或类似 的东西）。换句话说，这是瞄准服务器不能响应其不明白 的DNS请求的。  \par  注意：日志消息也可能是因为包丢失。在报告服务器 不兼容RFC 1034之前，应该再测试它们以决定不兼容 的类别。这个测试应当阻止或减少不正确报告的数目。  \par  注意：最后，{\bfseries{named}}必须不将这样的 超时归咎为不兼容RFC 1034而将其当作普通的包丢失。 将包丢失错误地归咎为不兼容RFC 1034会影响DNSSEC验证， 后者要求对DNSSEC记录返回EDNS。}} \tabularnewline
{{{\bfseries{RPZ}}}} & {{关于响应策略区文件中错误，重写响应以及最高级 {\bfseries{debug}}中试图重写响应等的信息。}} \tabularnewline
{{{\bfseries{rate-limit}}}} & {{一个响应流的比率限制的启动、周期性及结束通知将以 {\bfseries{info}}级别被写入这个类别。 这些消息包含响应域名的一个散列值和域名自身，没有足够的 内存来记录结束通知的名字这种情况除外。 结束通知通常延迟到比率限制停止一分钟之后。 内存不足可能导致仓促发出结束通知，这种情况下以一个星号 （*）开头。各种内部事件以调试级别1或更高级记录日志。  \par  对单个请求的比率限制记录在{\bfseries{query-errors}} 类别中。}} \tabularnewline
{{{\bfseries{cname}}}} & {{记录因为一个CNAME记录而非A/AAAA记录而被跳过的名字服务器。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsubsection{{\bfseries{query-errors}}类别}
\label{idm178372504784}\hypertarget{idm178372504784}{}%

{\bfseries{query-errors}}类别是专门用于调试目的： 是为了标识特定的请求为什么以及怎样导致错误响应。 因此，这个类别的信息仅仅用{\bfseries{debug}}级别 记录日志。

在1或更高的调试级别时，每个返回码（rcode）为SERVFAIL的 响应按如下方式记录日志：

{\texttt{{client 127.0.0.1\#61502: query failed (SERVFAIL) for www.example.com/IN/AAAA at query.c:3880}}}

这表示在源文件{\texttt{{query.\dbz{}c}}}的 第3880行检测到一个导致SERVFAIL的错误。 这个级别的日志消息对识别一个权威服务器中导致 SERVFAIL的原因特别有帮助。

在2或更高的调试级别时，记录了导致SERVFAIL的递归解析的 详细上下文信息。 日志消息将像如下这样：

 
\begin{Verbatim}[]

fetch completed at resolver.c:2970 for www.example.com/A
in 30.000183: timed out/success [domain:example.com,
referral:2,restart:7,qrysent:8,timeout:5,lame:0,neterr:0,
badresp:1,adberr:0,findfail:0,valfail:0]
            
\end{Verbatim}


在冒号之前的第一部份表示一个对www.example.com的AAAA记录 的递归解析在30.000183内完成并最终结果导致一个SERVFAIL， 它是在源文件{\texttt{{resolver.\dbz{}c}}}的第2970行 找到的。

接下来的部份显示了所检测到的最终结果和DNSSEC验证的 最近结果。 当不试图进行验证时，后者总是成功。 在这个例子中，这个请求导致SERVFAIL，可能是因为所有的 名字服务器都宕机或不可达，并产生了一个30秒的超时。 很可能不试图进行DNSSEC验证。

最后部份包含在方括号中，显示了这次特定的解析过程中 搜集的统计信息。 {\texttt{{domain}}}字段显示解析器所到达的最深 的区； 它是最终检测到错误的区。 其它字段的含义在下表中总结。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178372494224}\hypertarget{idm178372494224}{}%
\begin{longtable}{|p{1.150in}p{3.350in}|}
\hline 
{{{\texttt{{referral}}}}} & {{在解析过程中解析器所收到的引用个数。 在上面的例子中是2，很可能是com和example.com。}} \tabularnewline
{{{\texttt{{restart}}}}} & {{解析器试探{\texttt{{domain}}}区的远程 服务器循环次数。 在每一个循环，解析器向{\texttt{{domain}}} 区的每个已知的名字服务器发送一个请求（有可能 重发，取决于响应）。}} \tabularnewline
{{{\texttt{{qrysent}}}}} & {{解析器发送到{\texttt{{domain}}}区的请求数。}} \tabularnewline
{{{\texttt{{timeout}}}}} & {{解析器收到最后响应之后的超时次数。}} \tabularnewline
{{{\texttt{{lame}}}}} & {{解析器所检测到的{\texttt{{domain}}}区的 跛服务器数目。 一个服务器被检测为跛服务器，要么是因为一个 不正确的响应，要么是在BIND9的地址数据库（ADB） 中的查找结果，前者缓存了跛服务器。}} \tabularnewline
{{{\texttt{{neterr}}}}} & {{解析器在发送请求到{\texttt{{domain}}} 区时遇到的错误结果数目。 一个通常的情形是远程服务器不可达，解析器收到 一个ICMP不可达错误消息。}} \tabularnewline
{{{\texttt{{badresp}}}}} & {{解析器在发送请求到{\texttt{{domain}}}区 时所收到的意料之外的响应 （{\texttt{{lame}}}之外）数目。}} \tabularnewline
{{{\texttt{{adberr}}}}} & {{在ADB中查找{\texttt{{domain}}}区的远程 服务器地址时的失败次数。 一个通常的此类情形是远程服务器的名字没有任何 地址记录。}} \tabularnewline
{{{\texttt{{findfail}}}}} & {{解析远程服务器地址时的失败次数。 这是贯穿解析过程的失败总数。}} \tabularnewline
{{{\texttt{{valfail}}}}} & {{DNSSEC验证失败次数。 所计算的验证失败贯穿解析过程（不限于 {\texttt{{domain}}}区），但是应该仅仅 是发生在{\texttt{{domain}}}内的。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


在3或更高的调试级别时，记录那些与在调试级别1相同的消息， 但只对其它错误，而不记录SERVFAIL。 注意，在这里，象NXDOMAIN这样的否定响应并不被当作错误。

在4或更高的调试级别时，记录那些与在调试级别2相同的消息， 但只对其它错误，而不记录SERVFAIL。 与上面的级别3的情况不同，否定响应的消息要被记录。 这是因为在递归的情况下，调试任何未预期的结果都可能很难。
\subsection{{\bfseries{lwres}}语句语法}
\label{idm178372451328}\hypertarget{idm178372451328}{}%

这是{\texttt{{named.\dbz{}conf}}}文件中{\bfseries{lwres}}语 句的语法：

\begin{Verbatim}[]
lwres {
    [ listen-on { ip_addr [port ip_port] [dscp ip_dscp] ;
    [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ view view_name; ]
    [ search { domain_name ; [ domain_name ; ... ] }; ]
    [ ndots number; ]
};

\end{Verbatim}
\subsection{{\bfseries{lwres}}语句定义和用法}
\label{idm178372440736}\hypertarget{idm178372440736}{}%

{\bfseries{lwres}}语句把名字服务器配置成为一个轻量级的解析服务 器。（参见\hyperlink{lwresd}{第\ref{lwresd}节}。）可以有多个 {\bfseries{lwres}}语句配置轻量级解析服务器的不同属性。

{\bfseries{listen-on}}语句指定一个轻量级解析服务能够接受请求的 IPv4地址（和端口）的名单。如果没有指定端口，就使用921端口。 如果这个语句被省略，请求将在地址127.0.0.1的921端口被接受。

{\bfseries{view}}语句将一个轻量级解析服务绑定到DNS名字空间的视 图，这样响应就会以与这个视图所匹配的普通DNS请求同样的方式被构造。如果 这个语句被省略，就使用缺省视图，如果没有缺省视图，就触发一个错误。

{\bfseries{search}}语句与{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}} 中的{\bfseries{search}}语句等效。它提供一个追加到请求中的相对名 字的域名列表。

{\bfseries{ndots}}语句与{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中 的{\bfseries{ndots}}语句等效。它指示在一个相对域名中的点的最小 数目，将在追加查找路径元素之前作一个精确查找。
\subsection{{\bfseries{masters}}语句语法}
\label{idm178372432048}\hypertarget{idm178372432048}{}%

\begin{Verbatim}[]

masters name [port ip_port] [dscp ip_dscp] { ( masters_list | 
      ip_addr [port ip_port] [key key] ) ; [...] };

\end{Verbatim}
\subsection{{\bfseries{masters}}语句定义和用法}
\label{idm178372425888}\hypertarget{idm178372425888}{}%

{\bfseries{masters}}列表让一组共同的主服务器易于被用于多个 存根区和辅区，通过放入后者的{\bfseries{masters}}或 {\bfseries{also-notify}}列表中。
\subsection{{\bfseries{options}}语句语法}
\label{idm178372423072}\hypertarget{idm178372423072}{}%

这是{\texttt{{named.\dbz{}conf}}}文件中{\bfseries{options}}语 句的语法：

\begin{Verbatim}[]
options {
    [ attach-cache cache_name; ]
    [ version version_string; ]
    [ hostname hostname_string; ]
    [ server-id server_id_string; ]
    [ directory path_name; ]
    [ geoip-directory path_name; ]
    [ key-directory path_name; ]
    [ managed-keys-directory path_name; ]
    [ named-xfer path_name; ]
    [ tkey-gssapi-keytab path_name; ]
    [ tkey-gssapi-credential principal; ]
    [ tkey-domain domainname; ]
    [ tkey-dhkey key_name key_tag; ]
    [ cache-file path_name; ]
    [ dump-file path_name; ]
    [ bindkeys-file path_name; ]
    [ secroots-file path_name; ]
    [ session-keyfile path_name; ]
    [ session-keyname key_name; ]
    [ session-keyalg algorithm_id; ]
    [ memstatistics yes_or_no; ]
    [ memstatistics-file path_name; ]
    [ pid-file path_name; ]
    [ recursing-file path_name; ]
    [ request-sit yes_or_no; ]
    [ statistics-file path_name; ]
    [ zone-statistics full | terse | none; ]
    [ auth-nxdomain yes_or_no; ]
    [ deallocate-on-exit yes_or_no; ]
    [ dialup dialup_option; ]
    [ fake-iquery yes_or_no; ]
    [ fetch-glue yes_or_no; ]
    [ flush-zones-on-shutdown yes_or_no; ]
    [ has-old-clients yes_or_no; ]
    [ host-statistics yes_or_no; ]
    [ host-statistics-max number; ]
    [ minimal-responses yes_or_no; ]
    [ multiple-cnames yes_or_no; ]
    [ notify yes_or_no | explicit | master-only; ]
    [ recursion yes_or_no; ]
    [ request-nsid yes_or_no; ]
    [ rfc2308-type1 yes_or_no; ]
    [ use-id-pool yes_or_no; ]
    [ maintain-ixfr-base yes_or_no; ]
    [ ixfr-from-differences (yes_or_no | master | slave); ]
    [ dnssec-enable yes_or_no; ]
    [ dnssec-validation (yes_or_no | auto); ]
    [ dnssec-lookaside ( auto | 
                      no |
                        domain trust-anchor domain ); ]
    [ dnssec-must-be-secure domain yes_or_no; ]
    [ dnssec-accept-expired yes_or_no; ]
    [ forward ( only | first ); ]
    [ forwarders { [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ dual-stack-servers [port ip_port] [dscp ip_dscp] {
        ( domain_name [port ip_port] [dscp ip_dscp] |
          ip_addr [port ip_port] [dscp ip_dscp]) ; 
        ... }; ]
    [ check-names ( master | slave | response )
          ( warn | fail | ignore ); ]
    [ check-dup-records ( warn | fail | ignore ); ]
    [ check-mx ( warn | fail | ignore ); ]
    [ check-wildcard yes_or_no; ]
    [ check-integrity yes_or_no; ]
    [ check-mx-cname ( warn | fail | ignore ); ]
    [ check-srv-cname ( warn | fail | ignore ); ]
    [ check-sibling yes_or_no; ]
    [ check-spf ( warn | ignore ); ]
    [ allow-new-zones { yes_or_no }; ]
    [ allow-notify { address_match_list }; ]
    [ allow-query { address_match_list }; ]
    [ allow-query-on { address_match_list }; ]
    [ allow-query-cache { address_match_list }; ]
    [ allow-query-cache-on { address_match_list }; ]
    [ allow-transfer { address_match_list }; ]
    [ allow-recursion { address_match_list }; ]
    [ allow-recursion-on { address_match_list }; ]
    [ allow-update { address_match_list }; ]
    [ allow-update-forwarding { address_match_list }; ]
    [ update-check-ksk yes_or_no; ]
    [ dnssec-update-mode ( maintain | no-resign ); ]
    [ dnssec-dnskey-kskonly yes_or_no; ]
    [ dnssec-loadkeys-interval number; ]
    [ dnssec-secure-to-insecure yes_or_no ;]
    [ try-tcp-refresh yes_or_no; ]
    [ allow-v6-synthesis { address_match_list }; ]
    [ blackhole { address_match_list }; ]
    [ no-case-compress { address_match_list }; ]
    [ use-v4-udp-ports { port_list }; ]
    [ avoid-v4-udp-ports { port_list }; ]
    [ use-v6-udp-ports { port_list }; ]
    [ avoid-v6-udp-ports { port_list }; ]
    [ listen-on [ port ip_port ] [dscp ip_dscp] { address_match_list }; ]
    [ listen-on-v6 [ port ip_port] [dscp ip_dscp]
{ address_match_list }; ]
    [ query-source ( ( ip4_addr | * )
        [ port ( ip_port | * ) ]
        [ dscp ip_dscp] |
        [ address ( ip4_addr | * ) ]
        [ port ( ip_port | * ) ] )
        [ dscp ip_dscp] ; ]
    [ query-source-v6 ( ( ip6_addr | * )
        [ port ( ip_port | * ) ]
        [ dscp ip_dscp] |
        [ address ( ip6_addr | * ) ] 
        [ port ( ip_port | * ) ] )
        [ dscp ip_dscp] ; ]
    [ use-queryport-pool yes_or_no; ]
    [ queryport-pool-ports number; ]
    [ queryport-pool-updateinterval number; ]
    [ max-transfer-time-in number; ]
    [ max-transfer-time-out number; ]
    [ max-transfer-idle-in number; ]
    [ max-transfer-idle-out number; ]
    [ tcp-clients number; ]
    [ reserved-sockets number; ]
    [ recursive-clients number; ]
    [ serial-query-rate number; ]
    [ serial-queries number; ]
    [ tcp-listen-queue number; ]
    [ transfer-format ( one-answer | many-answers ); ]
    [ transfers-in  number; ]
    [ transfers-out number; ]
    [ transfers-per-ns number; ]
    [ transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ transfer-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ alt-transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ alt-transfer-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ use-alt-transfer-source yes_or_no; ]
    [ notify-delay seconds ; ]
    [ notify-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ notify-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ notify-to-soa yes_or_no ; ]
    [ also-notify { ip_addr
                    [port ip_port] [dscp ip_dscp] [key keyname] ;
                    [ ip_addr [port ip_port] [dscp ip_dscp] [key keyname] ; ... ] }; ]
    [ max-ixfr-log-size number; ]
    [ max-journal-size size_spec; ]
    [ coresize size_spec ; ]
    [ datasize size_spec ; ]
    [ files size_spec ; ]
    [ stacksize size_spec ; ]
    [ cleaning-interval number; ]
    [ heartbeat-interval number; ]
    [ interface-interval number; ]
    [ statistics-interval number; ]
    [ topology { address_match_list }];
    [ sortlist { address_match_list }];
    [ rrset-order { order_spec ; [ order_spec ; ... ] ] };
    [ lame-ttl number; ]
    [ max-ncache-ttl number; ]
    [ max-cache-ttl number; ]
    [ max-zone-ttl number ; ]
    [ sig-validity-interval number [number] ; ]
    [ sig-signing-nodes number ; ]
    [ sig-signing-signatures number ; ]
    [ sig-signing-type number ; ]
    [ min-roots number; ]
    [ use-ixfr yes_or_no ; ]
    [ provide-ixfr yes_or_no; ]
    [ request-ixfr yes_or_no; ]
    [ treat-cr-as-space yes_or_no ; ]
    [ min-refresh-time number ; ]
    [ max-refresh-time number ; ]
    [ min-retry-time number ; ]
    [ max-retry-time number ; ]
    [ port ip_port; ]
    [ dscp ip_dscp] ;
    [ additional-from-auth yes_or_no ; ]
    [ additional-from-cache yes_or_no ; ]
    [ random-device path_name ; ]
    [ max-cache-size size_spec ; ]
    [ match-mapped-addresses yes_or_no; ]
    [ filter-aaaa-on-v4 ( yes_or_no | break-dnssec ); ]
    [ filter-aaaa-on-v6 ( yes_or_no | break-dnssec ); ]
    [ filter-aaaa { address_match_list }; ]
    [ dns64 ipv6-prefix {
      [ clients { address_match_list }; ]
      [ mapped { address_match_list }; ]
        [ exclude { address_match_list }; ]
      [ suffix IPv6-address; ]
      [ recursive-only yes_or_no; ]
      [ break-dnssec yes_or_no; ]
    }; ];
    [ dns64-server name ]
    [ dns64-contact name ]
    [ preferred-glue ( A | AAAA | NONE ); ]
    [ edns-udp-size number; ]
    [ max-udp-size number; ]
    [ max-rsa-exponent-size number; ]
    [ root-delegation-only [ exclude { namelist } ] ; ]
    [ querylog yes_or_no ; ]
    [ disable-algorithms domain { algorithm;
                                [ algorithm; ] }; ]
    [ disable-ds-digests domain { digest_type;
                                [ digest_type; ] }; ]
    [ acache-enable yes_or_no ; ]
    [ acache-cleaning-interval number; ]
    [ max-acache-size size_spec ; ]
    [ clients-per-query number ; ]
    [ max-clients-per-query number ; ]
    [ max-recursion-depth number ; ]
    [ max-recursion-queries number ; ]
    [ masterfile-format
            (text|raw|map) ; ]
    [ empty-server name ; ]
    [ empty-contact name ; ]
    [ empty-zones-enable yes_or_no ; ]
    [ disable-empty-zone zone_name ; ]
    [ zero-no-soa-ttl yes_or_no ; ]
    [ zero-no-soa-ttl-cache yes_or_no ; ]
    [ resolver-query-timeout number ; ]
    [ deny-answer-addresses { address_match_list } [ except-from { namelist } ];]
    [ deny-answer-aliases { namelist } [ except-from { namelist } ];]
    [ prefetch number [number] ; ]

    [ rate-limit {
      [ responses-per-second number ; ]
      [ referrals-per-second number ; ]
      [ nodata-per-second number ; ]
      [ nxdomains-per-second number ; ]
      [ errors-per-second number ; ]
      [ all-per-second number ; ]
      [ window number ; ]
      [ log-only yes_or_no ; ]
      [ qps-scale number ; ]
      [ ipv4-prefix-length number ; ]
      [ ipv6-prefix-length number ; ]
      [ slip number ; ]
      [ exempt-clients  { address_match_list } ; ]
      [ max-table-size number ; ]
      [ min-table-size number ; ]
      } ; ]
    [ response-policy {
        zone zone_name
        [ policy (given | disabled | passthru | drop |
                  nxdomain | nodata | cname domain) ]
        [ recursive-only yes_or_no ]
        [ max-policy-ttl number ]
        [ break-dnssec yes_or_no ]
        [ min-ns-dots number ]
        [ qname-wait-recurse yes_or_no ]
        ; [...]
    } ; ]
};

\end{Verbatim}
\subsection{{\bfseries{options}}语句定义和用法}
\label{options}\hypertarget{options}{}%

{\bfseries{options}}语句设置BIND所使用的全局 选项。这个语句只能在一个配置文件中出现一次。如果没有 {\bfseries{options}}语句，将会使用一个options块，其中包含每个选 项的缺省值。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{attach-cache}}}]\null{}
允许多个视图共享一个缓存数据库。 缺省时每个视图拥有自己的缓存数据库，但是如果多个视图 在名字解析和缓存上有同样的操作策略，通过使用这个选项 这些视图可以共享一个缓存数据库来节约内存，并有可能 提高解析效率。

{\bfseries{attach-cache}}选项也可以在 {\bfseries{view}}语句中指定，这种情况下， 它会覆盖全局的{\bfseries{attach-cache}}选项。

{\ttfamily\itshape{{cache\_name}}}指定要共享的 缓存。当{\bfseries{named}}服务器配置要共享 一个缓存的视图时，它使用指定的名字为这些共享视图 中的第一个视图建立一个缓存。 其余的视图只是简单地引用已经建立的视图。

一个通常的共享一个缓存的配置是允许所有的视图共享 一个视图。 这个可以通过在全局选项中为 {\bfseries{attach-cache}}指定一个任意名字 而完成。

另一个可能的操作是允许全部视图中的一个子集共享一个 缓存，而其它的视图使用各自的缓存。 例如，如果有三个视图A，B和C，并且只有A和B应该共享 一个缓存，指定{\bfseries{attach-cache}}选项 作为视图A（或B）的选项，使其引用其它的视图名：
\null{}
\begin{Verbatim}[]

  view "A" {
    // this view has its own cache
    ...
  };
  view "B" {
    // this view refers to A's cache
    attach-cache "A";
  };
  view "C" {
    // this view has its own cache
    ...
  };

\end{Verbatim}

共享同一个缓存的视图必须在可能影响缓存的配置参数上 有同样的策略。 当前的实现要求在这些视图在下列配置选项上要一致： {\bfseries{check-names}}, {\bfseries{cleaning-interval}}, {\bfseries{dnssec-accept-expired}}, {\bfseries{dnssec-validation}}, {\bfseries{max-cache-ttl}}, {\bfseries{max-ncache-ttl}}, {\bfseries{max-cache-size}}, and {\bfseries{zero-no-soa-ttl}}.

注意有可能其它参数也会带来混乱，如果它们在不同的 视图共享一个缓存时不一致的话。 例如，如果这些视图定义不同的转发者集合，而这些转发者 对同样的问题可能返回不同的回答，共享这些回答可能就 没有意义甚至是有害的。 确保在不同的视图中的配置差异不会导致对共享缓存的破坏 是系统管理员的责任。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{directory}}}]\null{}
服务器的工作目录。所有在配置文件中出现的非绝对路径都将是相对于 这个目录的。服务器的大多数输出文件（例如： {\texttt{{named.\dbz{}run}}}）都是以此为缺省位置。如果未指定 目录，工作目录缺省为’\mbox{{\texttt{{.\dbz{}}}}}’，即服务器开始运 行的目录。这个目录应该被指定为一个绝对路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{geoip-directory}}}]\null{}
为GeoIP初始化指定包含GeoIP{\texttt{{.\dbz{}dat}}} 数据库文件的目录。缺省时，这个选项未设置，GeoIP支持会使用 libGeoIP的内建目录。 （关于{\bfseries{geoip}} ACL更详细的内容，参见 \hyperlink{acl}{第\ref{acl}节}。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{key-directory}}}]\null{}
当进行安全区的动态更新时，应该从这个目录能够找到DNSSEC公钥和 私钥文件，它与当前工作目录不同。 （注意这个选项对如同{\texttt{{bind.\dbz{}keys}}}， {\texttt{{rndc.\dbz{}key}}}或 {\texttt{{session.\dbz{}key}}}这样包含非DNSSEC密钥的 文件的路径时无效。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{managed-keys-directory}}}]\null{}
指定目录，其中保存着跟踪被管理DNSSEC密钥的文件。缺省时，它就是 工作目录。

如果{\bfseries{named}}被配置为没有使用视图，服务器的被管理 密钥会保存在一个名为{\texttt{{managed-\dbz{}keys.\dbz{}bind}}}的文件 中。否则，受管理密钥在不同的文件中被跟踪，每个视图一个文件；每个 文件名都是视图名SHA256 HASH的值，再加上 后缀{\texttt{{.\dbz{}mkeys}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{named-xfer}}}]\null{}
{\em{本选项已被废除。}}它是用于 BIND 8中指定{\bfseries{named-xfer}}程 序的路径。在BIND 9中，不再需要单独的 {\bfseries{named-xfer}}程序；其功能已经被内建在名字服务器 中。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{tkey-gssapi-keytab}}}]\null{}
用于GSS-TSIG更新的KRB5 keytab文件。如果设置了这个选项并且没有 设置tkey-gssapi-credential，将允许使用与指定keytab中的一个 principal相匹配的任何密钥进行更新。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{tkey-gssapi-credential}}}]\null{}
安全证书，服务器应该用它来认证GSS-TSIG协议所请求的密钥。 当前只能使用Kerberos 5认证，并且证书是一个Kerberos主， 服务器可以通过缺省的系统密钥文件，一般是 {\texttt{{/\dbz{}etc/\dbz{}krb5.\dbz{}keytab}}}，来获取它。 keytab文件的位置可以使用tkey-gssapi-keytab选项来重载。 通常这个主是这样的形式 "{\ttfamily\bfseries{{DNS/\dbz{}}}}{\texttt{{server.domain}}}"。 要使用GSS-TSIG，如果没有使用tkey-gssapi-keytab设置一个特定的 keytab，就必须设置{\bfseries{tkey-domain}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{tkey-domain}}}]\null{}
添加到由{\bfseries{TKEY}}生成的所有共享密钥名的域名。当一 个客户端请求进行{\bfseries{TKEY}}交换时，它可以指定所期望 的密钥的名字，也可以不指定。如果指定，共享密钥的名字是 {\texttt{{client specified part}}} + {\texttt{{tkey-domain}}}。否则，共享密钥的名字是 {\texttt{{random hex digits}}} + {\texttt{{tkey-domain}}}。在大多数情况下， {\bfseries{domainname}}应该是服务器的域名， 或者是一个不存在的子域，如 "\_tkey.{\texttt{{domainname}}}"。如果你使用了GSS-TSIG， 必须定义这个变量，除非你使用tkey-gssapi-keytab指定了一个特定的 keytab。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{tkey-dhkey}}}]\null{}
服务器所使用的Diffie-Hellman密钥，它用来生成与客户端共享的 密钥，使用{\bfseries{TKEY}}的Diffie-Hellman模式。 服务器必须能够从工作目录的文件中加载公钥和私钥。在大多数 情况下，密钥名应该是服务器的主机名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{cache-file}}}]\null{}
这个仅用于测试。不要使用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dump-file}}}]\null{}
指定服务器在收到{\bfseries{rndc dumpdb}}命令时，转储数据 到文件的路径。如果未指定，缺省为 {\texttt{{named\_\dbz{}dump.\dbz{}db}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{memstatistics-file}}}]\null{}
服务器在退出时，将内存统计写到的文件路径。如果没有指定， 缺省是{\texttt{{named.\dbz{}memstats}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{pid-file}}}]\null{}
服务器将其进程号写入的文件。如果未指定，缺省为 {\texttt{{/\dbz{}var/\dbz{}run/\dbz{}named/\dbz{}named.\dbz{}pid}}}。PID文件是 用于要向正在运行的名字服务器发送信号的程序。指定 {\bfseries{pid-file none}}关闭使用一个 PID文件 --- 不写文件，如果已经有一个，将被删除。 注意{\bfseries{none}}是一个关键字，不是一个文件名， 所以不使用双引号将其包含。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{recursing-file}}}]\null{}
指定服务器在通过{\bfseries{rndc recursing}}命令指定转储当 前递归请求到文件的路径。如果未指定，缺省为 {\texttt{{named.\dbz{}recursing}}}文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{statistics-file}}}]\null{}
指定服务器在收到{\bfseries{rndc stats}}命令时，追加统计数 据的文件路径。如果未指定，缺省为服务器当前目录下的 {\texttt{{named.\dbz{}stats}}}文件。这个文件的格式由 \hyperlink{statsfile}{第\ref{statsfile}节}描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{bindkeys-file}}}]\null{}
用于覆盖由{\bfseries{named}}所提供的内置信任密钥的 文件的路径名。 更详细的内容参见对{\bfseries{dnssec-lookaside}}和 {\bfseries{dnssec-validation}}的讨论。 如果未指定，缺省是{\texttt{{/\dbz{}etc/\dbz{}bind.\dbz{}keys}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{secroots-file}}}]\null{}
在收到{\bfseries{rndc secroots}}指令后， 服务器转储安全根的目的文件的路径名。 如果未指定，缺省为{\texttt{{named.\dbz{}secroots}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{session-keyfile}}}]\null{}
存放一个TSIG会话密钥的文件的路径名，这个密钥是由 {\bfseries{named}}所生成，用于 {\bfseries{nsupdate -l}}。 如果未指定，缺省是 {\texttt{{/\dbz{}var/\dbz{}run/\dbz{}named/\dbz{}session.\dbz{}key}}}。 （参见\hyperlink{dynamic_update_policies}{第\ref{dynamic_update_policies}节}， 特别的，对{\bfseries{update-policy}}语句的 {\ttfamily\bfseries{{local}}}选项的讨论有关于这个 特征的更多信息。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{session-keyname}}}]\null{}
用于TSIG会话密钥的密钥名。如果未指定，缺省是 “local-ddns”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{session-keyalg}}}]\null{}
用于TSIG会话密钥的算法。有效值为hmac-sha1， hmac-sha224，hmac-sha256，hmac-sha384，hmac-sha512 和hmac-md5。如果未指定，缺省为hmac-sha256。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{port}}}]\null{}
服务器用于接收和发送DNS协议流量的UDP/TCP端口。缺省是53。这个选 项的主要目的是服务器测试；一个使用53端口之外的服务器将无法与全 球的DNS进行通信。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dscp}}}]\null{}
全局的差分服务代码点 （DSCP，Differentiated Services Code Point）值，用于在支持DSCP 的操作系统上分类发出的DNS流量。有效的值为从0到63。缺省未配置。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{random-device}}}]\null{}
服务器所用的熵源。熵的主要需求是DNSSEC操作，例如TKEY事务和签名 区的动态更新。这个选项指定一个读出熵的设备（或文件）。如果是一 个文件，当要求熵的操作在文件耗尽时将会失败。如果未指定，缺省值 为{\texttt{{/\dbz{}dev/\dbz{}random}}}（或等效物），如果后者存在的 话，如果不存在则为none。{\bfseries{random-device}}选项在 服务器启动时的初始配置装载时生效，而在随后的重载将会忽略它。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{preferred-glue}}}]\null{}
如果指定，在一个请求响应的附加部份内的其它粘着记录之前，所列的 类型（A或AAAA）将被写入。缺省是不优先任何类型（NONE）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{root-delegation-only}}}]\null{}
使用一个可选的排除列表，在TLD（顶级域）和根区中打开只授权模式的 增强特性。

只授权区期待接受和回复DS请求。这样的请求和响应被当成只授权处理 的一个例外，并且如果请求的名字没有找到一个CNAME记录时不能转换 为NXDOMAIN响应。

如果一个只授权区的服务器同时也作为一个子区的服务器，就不可能 都能够判断一个应答是来自于只授权区还是子区。 SOA记录、NS记录和DNSKEY记录是区顶点仅有的记录，并且包含这些 记录或者DS记录的一个匹配的响应被当作是来自于一个子区。 同时也检查RRSIG记录看其是否被一个子区签名。 还要检查权威部份看是否有应答来自子区的迹象。 被确认为来自一个子区的应答不会被转换为NXDOMAIN响应。 尽管有所有这些检查，在同时提供一个子区服务时， 仍然存在错误否定响应的可能性。

与之类似的错误肯定响应也可能产生于只授权区中的空节点 （名字中没有记录）且请求类型不是ANY时。

注意一些TLD不是只授权的（如：“DE”，“LV”，“US”和 “MUSEUM”）。这个列表并不完整。
\null{}
\begin{Verbatim}[]

options {
        root-delegation-only exclude { "de"; "lv"; "us"; "museum"; };
};

\end{Verbatim}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{disable-algorithms}}}]\null{}
关掉在指定名下的指定DNSSEC算法。允许使用多个 {\bfseries{disable-algorithms}}语句。 只有最与{\bfseries{disable-algorithms}}匹配的子句将被用于 决定使用哪个算法。

如果所有支持的算法都被关闭，由 {\bfseries{disable-algorithms}}所覆盖的区将被视为 不安全的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{disable-ds-digests}}}]\null{}
在指定的名字及之下的名字关闭指定的DS/DLV摘要类型。 允许使用多个{\bfseries{disable-ds-digests}}语句。 只有最与{\bfseries{disable-ds-digests}}匹配的子句将被用于 决定使用哪个摘要类型。

如果所有支持的摘要类型都被关闭，由 {\bfseries{disable-ds-digests}}所覆盖的区将被视为 不安全的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-lookaside}}}]\null{}
当其被设置后，{\bfseries{dnssec-lookaside}}提供一个 校验器，后者带有一个可选的方法来校验一个区的顶端的DNSKEY记录。 当一个DNSKEY位于一个由最深的{\bfseries{dnssec-lookaside}} 所指定的域中或之下，并且普通的DNSSEC校验留下了不可信的密钥， 则信任锚点将会被添加到密钥名字之后，同时一个DLV记录将会被查找 以检查其是否可以校验这个密钥。如果DLV记录校验了一个DNSKEY（与 一个DS记录所做的方式相似），DNSKEY资源记录被视作可信任的。

如果{\bfseries{dnssec-lookaside}}被设置为 {\ttfamily\bfseries{{auto}}}， 就会使用内置DLV域和信任锚点的缺省值，同时用一个内置密钥 来验证。

如果{\bfseries{dnssec-lookaside}}被设置为 {\ttfamily\bfseries{{no}}}，就不使用dnssec-lookaside。

缺省的DLV密钥存放在文件{\texttt{{bind.\dbz{}keys}}}中； 如果{\bfseries{dnssec-lookaside}}被设为 {\texttt{{auto}}}，{\bfseries{named}}在 启动时会装载这个密钥。 在BIND 9安装时，会同时安装这个文件的 一个拷贝，并且通常为发行日期。如果DLV密钥过期，可以从 https://www.isc.org/solutions/dlv/ {\textless}\url{https://www.isc.org/solutions/dlv/}{\textgreater}下载 一个新的{\texttt{{bind.\dbz{}keys}}}拷贝。

（为避免找不到{\texttt{{bind.\dbz{}keys}}}带来的问题， 当前的密钥也可以被编译进{\bfseries{named}}。 依赖于这个措施是不推荐的，因为，当DLV密钥过期时，它要求 使用一个新的密钥重新编译{\bfseries{named}}。）

注意：{\bfseries{named}}仅仅装载 {\texttt{{bind.\dbz{}keys}}}中的某些特定的密钥：即DLV区和 DNS根区的密钥。这个文件不能用来存放其它区的密钥。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-must-be-secure}}}]\null{}
指定肯定或者可能不安全（被签名和校验）的层次体系。如果是 {\ttfamily\bfseries{{yes}}}，{\bfseries{named}}将仅仅接受 安全的回答。如果为{\ttfamily\bfseries{{no}}}，允许不安全回答的 普通的DNSSEC校验申请将会被接受。指定的域必须在一个 {\bfseries{trusted-key}}或 {\bfseries{managed-keys}}语句之 下，或者{\bfseries{dnssec-lookaside}}必须被激活。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dns64}}}]\null{}
这条指令指示{\bfseries{named}}在没有找到AAAA记录时，返回 由IPv4地址所映射到的AAAA查询。其意图是用于和NAT64相配合。每个 {\bfseries{dns64}}定义一个DNS64前缀。 可以定义多个DNS64前缀。

按照RFC 6052，兼容的IPv6前缀可以有32，40，48，56，64和96这些 长度。

使用合成的CNAME为前缀创建一个附加的反向IP6.ARPA区，提供 一个从IP6.ARPA名字到对应的IN-ADDR.ARPA名字的映射。 CNAMEs. {\bfseries{dns64-server}}和 {\bfseries{dns64-contact}}可以用于指定服务器的名字和区的 联系人。这些也可以在view/options级中设置。这些不能在每个前缀的 基础上设置。

每个{\bfseries{dns64}}支持一个可选的 {\bfseries{clients}}访问控制表，它决定哪些客户端受这条 指令的影响。如果未设置，缺省值为{\ttfamily\bfseries{{any;}}}。

每个{\bfseries{dns64}}支持一个可选的 {\bfseries{mapped}}访问控制表，它在相关的A资源记录集中 选择哪些IPv4地址会被映射。如果未设置，缺省值为 {\ttfamily\bfseries{{any;}}}。

通常地，DNS64不会应用于一个拥有一个或多个AAAA记录的域名；只是简单 地返回这些记录。可选的{\bfseries{exclude}}访问控制表允许 规定一个IPv6地址的列表，如果它们出现在一个域名的AAAA记录中，将 被忽略，并且DNS64将被用于这个域名所拥有的任何A记录。 如果未定义，{\bfseries{exclude}}缺省为none。

也可以定义一个可选的{\bfseries{suffix}}，用来设置映射到 IPv4地址位的结尾部分。 缺省时这些位被设置为{\ttfamily\bfseries{{::}}}。这些位匹配的前缀 和映射的IPv4地址必须为零。

如果{\bfseries{recursive-only}}被设置为 {\bfseries{yes}}，DNS64合成仅仅发生在递归请求。缺省是 {\bfseries{no}}.

如果{\bfseries{break-dnssec}}被设置为 {\bfseries{yes}}，将会进行DNS64合成，即使结果在验证时会 导致一个DNSSEC验证失败。如果这个选项被设置为 {\bfseries{no}}（缺省值），进来的请求中带有DO位，在可用 的记录中有RRSIG，这时不会进行DNS64合成。
\null{}
\begin{Verbatim}[]

        acl rfc1918 { 10/8; 192.168/16; 172.16/12; };

        dns64 64:FF9B::/96 {
                clients { any; };
                mapped { !rfc1918; any; };
                exclude { 64:FF9B::/96; ::ffff:0000:0000/96; };
                suffix ::;
        };

\end{Verbatim}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-update-mode}}}]\null{}
如果在一个{\texttt{{master}}}类型的区中这个选项被 设为其缺省值{\texttt{{maintain}}}，而这个区是DNSSEC 签名的并被配置为允许动态更新（参见 \hyperlink{dynamic_update_policies}{第\ref{dynamic_update_policies}节}），并且如果 {\bfseries{named}}能够访问区的私有签名密钥， {\bfseries{named}}就会自动对所有新的或修改过的记录 签名并通过重新生成RRSIG记录维护区的签名，无论其是否过期。

如果这个选项被改为{\texttt{{no-\dbz{}resign}}}， {\bfseries{named}}将只对所有新的或修改过的记录签名， 但不安排对签名的维护。

对这两个设置中的任何一种，{\bfseries{named}}，如果签名 密钥是未激活或者对{\bfseries{named}}不可用， {\bfseries{named}}都会拒绝对一个DNSSEC签名区的更新。 （一个计划的第三个选项，{\texttt{{external}}}，将会 关闭所有自动签名并允许将DNSSEC数据提交给一个通过动态更新的 区；这个还未实现。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-zone-ttl}}}]\null{}
指定一个最大可能的TTL值。在使用一个 {\texttt{{masterfile-format}}}为 {\texttt{{text}}}或者{\texttt{{raw}}}装载一个 区文件时，任何带有超过{\texttt{{max-zone-ttl}}}的TTL值的 记录都将导致区被拒绝。

这在DNSSEC签名区中很有用，因为在轮转到一个新DNSKEY时，旧密钥 需要保持可用，直到RRSIG记录从缓存中过期。 {\texttt{{max-zone-ttl}}}选项保证区中的最大TTL不会比所 设置的值更大。

（注意：因为{\texttt{{map}}}格式的文件直接装载到 内存中，这个选项不适应它。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{zone-statistics}}}]\null{}
如果为{\ttfamily\bfseries{{full}}}，服务器搜集所有区的统计数据 （除非在每个区的配置中被关掉，这可以通过在 {\bfseries{zone}}语句中指定 {\bfseries{zone-statistics terse}}或 {\bfseries{zone-statistics none}}来实现）。 缺省是{\ttfamily\bfseries{{terse}}}，提供对区的最小统计（包括 名字和当前序列号，但不含请求类型计数器）。

这些统计可以通过{\bfseries{statistics-channel}}访问到， 或使用{\bfseries{rndc stats}}来访问， 后者将把数据存放在{\bfseries{statistics-file}}所指定的 文件中。参见\hyperlink{statsfile}{第\ref{statsfile}节}。

为向后兼容早期的BIND 9版本，{\bfseries{zone-statistics}} 选项也可接受{\ttfamily\bfseries{{yes}}}或 {\ttfamily\bfseries{{no}}}；{\ttfamily\bfseries{{yes}}}与 {\ttfamily\bfseries{{full}}}有同样的含义。 对于BIND 9.10，{\ttfamily\bfseries{{no}}}与 {\ttfamily\bfseries{{none}}}有同样的含义；之前的版本，它与 {\ttfamily\bfseries{{terse}}}相同。
\end{description}
\subsubsection{布尔选项}
\label{boolean_options}\hypertarget{boolean_options}{}%

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{automatic-interface-scan}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}且操作系统支持，在接口地址 被添加或删除时自动扫描网络接口。缺省是 {\ttfamily\bfseries{{yes}}}。

当前要支持{\bfseries{automatic-interface-scan}}， 操作系统需要支持路由套接字（routing sockets）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-new-zones}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，就可以在运行时通过 {\bfseries{rndc addzone}}添加区，或者通过 {\bfseries{rndc delzone}}删除区。 缺省为{\ttfamily\bfseries{{no}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{auth-nxdomain}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，总是在NXDOMAIN响应中设置 {\bfseries{AA}}位，即使服务器并非实际的权威服务器。缺省 为{\ttfamily\bfseries{{no}}}；这是从BIND 8 开始改变的。如果你使用非常旧的DNS软件，你可能需要将其设为 {\ttfamily\bfseries{{yes}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{deallocate-on-exit}}}]\null{}
这个选项是用于BIND 8中，以打开对退出时的 内存泄漏检查。BIND 9忽略这个选项并总是 进行检查。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{memstatistics}}}]\null{}
在退出时写内存统计到{\bfseries{memstatistics-file}} 所指定的文件。 缺省是{\ttfamily\bfseries{{no}}}，除非在命令行指定 '-m record'，在这种情况下，它是{\ttfamily\bfseries{{yes}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dialup}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，服务器将所有区当成通过即时 拨号线路进行区传送，拨号连接是由此服务器的流量所引发。根据区 类型的不同，这种方式有不同的效果，并且缩短了区维护，以使所有 动作发生在一个短的周期之内，每一个 {\bfseries{heartbeat-interval}}进行一次，并希望在一次连 接中完成。它也抑制了一些通常的区维护流量。缺省为 {\ttfamily\bfseries{{no}}}。

{\bfseries{dialup}}选项也可在{\bfseries{view}}和 {\bfseries{zone}}语句中指定，在此情况它将覆盖全局 {\bfseries{dialup}}选项。

如果区是一个主区，服务器将会向其所有辅发出一个NOTIFY请求（缺 省的）。这将会触发辅服务器（假设其支持NOTIFY）检查区的 序列号，允许辅服务器在连接有效时对区进行验证。NOTIFY所发向的 服务器可以通过{\bfseries{notify}}和 {\bfseries{also-notify}}来进行控制。

如果区是辅区或存根区，服务器将会超越普通的“区更新” （refresh）请求，而只会在 {\bfseries{heartbeat-interval}}过期时执行， 附带发送NOTIFY请求。

可以通过使用{\ttfamily\bfseries{{notify}}}仅仅发送NOTIFY消息， 使用{\ttfamily\bfseries{{notify-\dbz{}passive}}}发送NOTIFY消息并禁止 普通刷新请求，使用{\ttfamily\bfseries{{refresh}}}禁止普通刷新 处理并在{\bfseries{heartbeat-interval}}过期时发送刷新请 求，以及使用{\ttfamily\bfseries{{passive}}}禁止普通刷新处理来 进行细粒度控制。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178371977488}\hypertarget{idm178371977488}{}%
\begin{longtable}{|p{1.150in}p{1.150in}p{1.150in}p{1.150in}|}
\hline 
{{dialup模式}} & {{普通刷新}} & {{心跳刷新}} & {{心跳通知}} \tabularnewline
{{{\bfseries{no}}（缺省）}} & {{yes}} & {{no}} & {{no}} \tabularnewline
{{{\bfseries{yes}}}} & {{no}} & {{yes}} & {{yes}} \tabularnewline
{{{\bfseries{notify}}}} & {{yes}} & {{no}} & {{yes}} \tabularnewline
{{{\bfseries{refresh}}}} & {{no}} & {{yes}} & {{no}} \tabularnewline
{{{\bfseries{passive}}}} & {{no}} & {{no}} & {{no}} \tabularnewline
{{{\bfseries{notify-passive}}}} & {{no}} & {{no}} & {{yes}} \tabularnewline
\hline 
\end{longtable}
\end{center}


注意，普通的NOTIFY进程不受{\bfseries{dialup}}的影响。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{fake-iquery}}}]\null{}
在BIND 8中，这个选项打开对作废的DNS请求类 型IQUERY的模拟。BIND 9不再支持IQUERY模拟。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{fetch-glue}}}]\null{}
这个选项被废弃了。在BIND 8中， {\ttfamily\bfseries{{fetch-\dbz{}glue yes}}}使服务器在一个响应中构造 附加数据部份时试图去取得它所没有的粘着记录。这个在现在被认为 是一个坏主意，BIND 9不再这样做了。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{flush-zones-on-shutdown}}}]\null{}
当服务器由于收到SIGTERM信号而退出时，刷新或不刷新未完成的区信 息写磁盘操作。缺省为 {\bfseries{flush-zones-on-shutdown}} {\ttfamily\bfseries{{no}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{has-old-clients}}}]\null{}
这个选项在BIND 8中被错误实现了，并在 BIND 9中被忽略了。要取得 {\bfseries{has-old-clients}} {\ttfamily\bfseries{{yes}}} 的预想效果，使用两个分开的选项 {\bfseries{auth-nxdomain}} {\ttfamily\bfseries{{yes}}}和 {\bfseries{rfc2308-type1}} {\ttfamily\bfseries{{no}}}来 替代。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{host-statistics}}}]\null{}
在BIND 8中，这个选项打开一个统计开关，它允许对与此名字服务器 相互影响的所有主机进行统计。在BIND 9中没有实现。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{maintain-ixfr-base}}}]\null{}
{\em{这个选项被废弃了}}。它用于 BIND 8中，以决定是否为增量区传送保留一个事 务日志。BIND 9只要可能，随时保留着一个事务 日志。如果你需要关掉对外的增量区传送，使用 {\bfseries{provide-ixfr}} {\ttfamily\bfseries{{no}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{minimal-responses}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，在产生响应时，服务器将只将 被请求的记录添加到权威和附加数据部份（例如：授权， 否定响应）。这可以增加服务器的性能。缺省为 {\ttfamily\bfseries{{no}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{multiple-cnames}}}]\null{}
这个选项是用于BIND 8中，以允许一个域名可以 含有与DNS标准冲突的多个CNAME记录。BIND 9.2 之后总是按照标准严格地对主文件和动态更新增强了CNAME规则。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}（缺省情况），服务器所负责的 区发生改变时发出DNS NOTIFY消息，参见 \hyperlink{notify}{第\ref{notify}节}。消息发向区的NS记录（除SOA MNAME 字段所指示的主服务器之外）中所列出的服务器，以及在 {\bfseries{also-notify}}选项中列出的任何服务器。

如果为{\ttfamily\bfseries{{master-\dbz{}only}}}，通知仅发给主区。如 果为{\ttfamily\bfseries{{explicit}}}，通知仅发给使用 {\bfseries{also-notify}}显式列出的服务器。如果为 {\ttfamily\bfseries{{no}}}，不发出通知。

{\bfseries{notify}}选项也可在{\bfseries{zone}}语 句中指定，在这种情况下，它将覆盖 {\bfseries{options notify}}语句。仅仅在它导致辅服务器崩 溃时才需要关掉这个选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-to-soa}}}]\null{}
如果是{\ttfamily\bfseries{{yes}}}就不针对SOA MNAME检查NS 资源记录集中的名字服务器。通常一个NOTIFY消息不会发送给 SOA MNAME（SOA源），因为假设它包含终极主服务器的名字。 然而，有时候在隐藏主服务器的配置中一个辅服务器被作为 SOA MNAME列出，在这种情况下，你可能想要终极主服务器仍然 发送NOTIFY消息给NS资源记录集中列出的所有名字服务器。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{recursion}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，并且一个DNS请求也要求递归， 服务器就试图完成所有要求的工作以回答请求。如果递归关闭并且服 务器不知道答案，它将会返回一个参考响应。缺省为 {\ttfamily\bfseries{{yes}}}。 注意，设置{\bfseries{recursion no}}不会阻止客户端从服务 器的缓存获取数据；它仅仅阻止作为客户端请求结果的新的数据被缓 存。缓存仍然会作为服务器内部操作的结果而被产生，例如NOTIFY地 址查找。参见上面的{\bfseries{fetch-glue}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{request-nsid}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，在迭代解析时，所有发向权威 服务器的请求都会带上一个空的EDNS(0) NSID（名字服务器标识符）。 如果权威服务器在其响应中返回了一个NSID选项，其内容将被记录到 日志的{\bfseries{resolver}}分类，级别为 {\bfseries{info}}。 缺省是{\ttfamily\bfseries{{no}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{request-sit}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，请求中会设置一个SIT （Source Identity Token，源特征符号）EDNS选项。如果解析器 之前与服务器通信过，之前返回的SIT会被发送。这个用于让服务器 判断这个解析器之前是否来访问过。 一个发送正确SIT的解析器会被假设不是发送一个伪造源地址请求的 off-path攻击者；这个请求就不太可能被当成一个反射/放大攻击， 因此发送一个正确SIT选项的解析器就不会遭遇到 响应率限制（RRL）。 不发送一个正确SIT选项的解析器可能被通过 {\bfseries{nosit-udp-size}}选项限制成接收更小的响应。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sit-secret}}}]\null{}
如果设置，这是一个用于在一个任意播集群内生成和验证 源特征符号EDNS选项的共享秘钥。如果未设置，系统将在 启动时生成一个随机秘钥。共享密钥被编码成一个十六进制 字符串，对AES128为128位，对SHA1为160位，对SHA256为 256位。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{rfc2308-type1}}}]\null{}
将这个设置为{\ttfamily\bfseries{{yes}}}将导致服务器发送NS记录 连同SOA记录作为否定答案。缺省为{\ttfamily\bfseries{{no}}}。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

BIND 9还没有实现。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{use-id-pool}}}]\null{}
{\em{这个选项被废弃了}}。 BIND 9总是从一个池中申请请求的ID。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{use-ixfr}}}]\null{}
{\em{此选项被废除了}}。如果你需要关掉到一个或多 个服务器的IXFR，参见 \hyperlink{server_statement_definition_and_usage}{第\ref{server_statement_definition_and_usage}节}中 {\bfseries{provide-ixfr}}选项的相关信息。也可参见 \hyperlink{incremental_zone_transfers}{第\ref{incremental_zone_transfers}节}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{provide-ixfr}}}]\null{}
参见\hyperlink{server_statement_definition_and_usage}{第\ref{server_statement_definition_and_usage}节}中 对{\bfseries{provide-ixfr}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{request-ixfr}}}]\null{}
参见\hyperlink{server_statement_definition_and_usage}{第\ref{server_statement_definition_and_usage}节}中 对{\bfseries{request-ixfr}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{treat-cr-as-space}}}]\null{}
这个选项用于BIND 8中，使服务器将回车 （“{\bfseries{\textbackslash r}}”）字符以空格或tab字符一样的方式对 待，以帮助在UNIX系统上装载在NT或DOS主机上生成的区文件。在 BIND 9中，UNIX的“{\bfseries{\textbackslash n}}” 和NT/DOS的“{\bfseries{\textbackslash r\textbackslash n}}”换行都会被接受，这个选项 就被忽略了。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{additional-from-auth}}, {\bfseries{additional-from-cache}}}]\null{}
这些选项控制权威服务器在回答有附加数据的请求，或者在跟随CNAME 和DNAME链时的行为。

当这两个选项都被设置为{\ttfamily\bfseries{{yes}}}（缺省值）并 且请求由权威数据（配置在服务器中的一个区）所应答时，响应的附 加数据部份将会填充来自其它权威区和缓存的数据。在某些情况下这 是不受欢迎的，例如，在关心缓存的正确性时，或者在服务器的辅区 可能被不信任的第三方所添加和修改时。另外，在可能浪费额外的请 求来解析那些可能被提供在附加部份的名字时，避免对这些附加的数 据的搜索将会加速服务器的操作。

例如，如果一个请求问到主机{\texttt{{foo.\dbz{}example.\dbz{}com}}} 的MX记录，而找到的记录是 “{\texttt{{MX 10 mail.\dbz{}example.\dbz{}net}}}”，通常 {\texttt{{mail.\dbz{}example.\dbz{}net}}}的地址记录（A和AAAA）也会 被提供，如果服务器知道的话，即使它们并不在example.com区中。将 这些选项设置为{\bfseries{no}}会关掉这个行为，并使服务器 只在它要回应的区中查找附加记录。

这些选项目的是应用于只作权威的服务器，或只作权威的视图。如果 企图将它们设为{\bfseries{no}}而不同时指定 {\bfseries{recursion no}}将会导致服务器忽略这个选项并在 日志中记录一个警告消息。

指定{\bfseries{additional-from-cache no}}实际上不止是在 查找附加数据部份时关掉使用缓存，而且在查找回答部份时也不使用 缓存。这通常是只作权威服务器的所期望的行为，其中的缓存数据的 正确性是有争议的。

当一个名字服务器收到一个请求，要求查询不在其所服务的顶点之下 的一个名字时，它通常回答一个“向上引用”，指到根服务器，或者 指到被请求名字的众所周知的上级服务器。由于在向上引用中的数据 来自于缓存，服务器在 {\bfseries{additional-from-cache no}}被设定时将不能够提 供向上引用。作为替代，它将对这样的请求以REFUSED进行响应。这不 会带来任何问题，因为向上引用并不是解析过程所要求的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{match-mapped-addresses}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，一个映射到IPv4的IPv6地址将 会与相关IPv4地址匹配的任何地址匹配表条目匹配。

引入这个选项是工作在某些操作系统中内核特有的行为，即导致 例如区传送中的IPv4的TCP的连接被使用地址映射的IPv6套接字 所接受。这会导致为IPv4所设计的地址匹配表匹配失败。然而， {\bfseries{named}}现在在内部解决这个问题。不鼓励 使用这个选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{filter-aaaa-on-v4}}}]\null{}
这个选项仅在BIND 9用“configure” 命令行中的{\ttfamily\bfseries{{-\dbz{}-\dbz{}with-\dbz{}filter-\dbz{}aaaa}}}选项 编译时可用。其目的是通过不将IPv6地址返回给没有IPv6接入的 DNS客户端来帮助从IPv4到IPv6的迁移。除非特别需要，这个是 不推荐的。缺省是{\ttfamily\bfseries{{no}}}。 {\bfseries{filter-aaaa-on-v4}}选项也可在 {\bfseries{view}}语句中指定，用于覆盖全局 {\bfseries{filter-aaaa-on-v4}}选项。

如果为{\ttfamily\bfseries{{yes}}}，DNS客户端在 {\bfseries{filter-aaaa}}中的一个IPv4地址， 并且如果响应中不包含DNSSEC签名，这时所有的AAAA记录都会从 响应中删除。这个过滤应用在所有响应中而不仅仅是权威 响应。

如果为{\ttfamily\bfseries{{break-\dbz{}dnssec}}}，即使打开了 DNSSEC也会删除AAAA记录。 如同名字所暗示的，这会地址不校验响应，因为DNSSEC协议 被设计成能检测删除。

这个机制可能会错误地导致其它服务器不向其客户端给出AAAA记录。 一个具有IPv6和IPv4双栈地址的递归服务器通过IPv4向具有 这个机制的权威服务器发起请求，即使其客户端使用IPv6，也有 可能被删去AAAA记录。

这个机制应用于权威记录，也应用于非权威记录。 一个使用IPv4并且不允许递归请求的客户端可能会错误地收到 AAAA记录，因为其服务器不被允许查找A记录。

有些AAAA记录会作为粘着（glue）记录返回给IPv4客户端。 同时也做服务器的IPv4客户端可能错误地回应通过IPv4接收到的 对AAAA记录的请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{filter-aaaa-on-v6}}}]\null{}
与{\bfseries{filter-aaaa-on-v4}}相同，除了它过滤来自 IPv6的客户端而不是IPv4的客户端的AAAA响应。要过滤所有响应， 将两个选项都设置为{\ttfamily\bfseries{{yes}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{ixfr-from-differences}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}并且服务器从其区文件装载一个 新版本的主区或者通过区传送方式接收一个新版本的 辅区文件时，它将会比较新版本与先前版本并计算一个差集。差别就 写入到区的日志文件中，这样变化就可以用增量区传送的方式向 下游的辅服务器传送。

通过允许在非动态区中使用增量区传送，这个选项以增加主服务器的 CPU和内存消耗的代价节约了带宽。在特殊情况下，如果一个区的新版 本与前一个版本完全不一样，差别集将会有相当于旧版本和新版本之 和的大小，并且服务器会临时申请内存以保持这个完整的差别集。

{\bfseries{ixfr-from-differences}}在view和options级别也 接受{\bfseries{master}}和{\bfseries{slave}}，这将 导致{\bfseries{ixfr-from-differences}}分别在所有的 {\bfseries{master}}或{\bfseries{slave}}区被打开。 缺省是关闭的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{multi-master}}}]\null{}
当你的一个区有多个主服务器并且其地址指向不同的机器时，应该设 置此选项。如果为{\ttfamily\bfseries{{yes}}}， {\bfseries{named}}在主服务器的 序列号小于当前{\bfseries{named}}的序列号时将不会记录。 缺省为{\ttfamily\bfseries{{no}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-enable}}}]\null{}
在{\bfseries{named}}中打开对DNSSEC的支持。除非设为 {\ttfamily\bfseries{{yes}}}，否则{\bfseries{named}} 的行为就象其不支持DNSSEC。缺省为{\ttfamily\bfseries{{yes}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-validation}}}]\null{}
在{\bfseries{named}}中打开DNSSEC正确性检查。注意 {\bfseries{dnssec-enable}}也需要被设为 {\ttfamily\bfseries{{yes}}}以使此选项生效。 如果设置为{\ttfamily\bfseries{{no}}}，DNSSEC验证将被关闭。 如果设置为{\ttfamily\bfseries{{auto}}}，DNSSEC验证将被开启， 并为根区使用一个缺省的信任锚。如果设置为 {\ttfamily\bfseries{{yes}}}，DNSSEC验证将被开启，但是必须使用 一个{\bfseries{trusted-keys}}或 {\bfseries{managed-keys}}语句手工配置一个信任锚。 缺省为{\ttfamily\bfseries{{yes}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-accept-expired}}}]\null{}
在校验DNSSEC签名时接受过期的签名。缺省为 {\ttfamily\bfseries{{no}}}。把这个选项设置为 {\ttfamily\bfseries{{yes}}}有可能使 {\bfseries{named}}遭受重发攻击。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{querylog}}}]\null{}
指定是否在{\bfseries{named}}启动的同时启动请求日志。 如果未指定{\bfseries{querylog}}，则是否记录请求日志 由logging类别中{\bfseries{queries}}中是否出现来决定。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-names}}}]\null{}
这个选项是用于限制主服务器文件和/或从网络中接收到的DNS响应中 的域名的字符集和语法。根据使用场合的缺省值是不一样的。对 {\bfseries{master}}区，缺省为{\bfseries{fail}}。 对{\bfseries{slave}}区，缺省是{\bfseries{warn}}。 对从网络接收的回答（{\bfseries{response}}），缺省是 {\bfseries{ignore}}。

合法主机名和邮件域名的规则是由RFC 952和RFC 821派生出来的，并 由RFC 1123所修改。

{\bfseries{check-names}}应用到A，AAAA和MX记录的属主名字 段。它也应用到NS，SOA，MX和SRV记录RDATA字段的域名中。它也 应用到PTR记录的RDATA字段中，在这里属主名表示其是一个主机的 反向查找（属主名以IN-ADDR.ARPA，IP6.ARPA或者IP6.INT结尾）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-dup-records}}}]\null{}
检查主区中，在DNSSEC中被当作不同的，但是在普通DNS中语义上 相等的记录。缺省为{\bfseries{warn}}，其它可能值为 {\bfseries{fail}}和{\bfseries{ignore}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-mx}}}]\null{}
检查MX记录是否与一个IP地址一起出现。缺省值为 {\bfseries{warn}}。其它可能值为{\bfseries{fail}} 和{\bfseries{ignore}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-wildcard}}}]\null{}
这个选项用于检查非终结的通配符。使用非终结的通配符几乎总是导 致理解通配符匹配算法（RFC 1034）的失败。这个选项影响主区。缺 省（{\bfseries{yes}}）是检查非终结的通配符并发出一个警 告。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-integrity}}}]\null{}
对主区执行加载后的区完整性检查。这将检查MX和SRV记录所提到的地 址（A或AAAA）记录和因授权区而存在的粘着地址记录。对MX和SRV记 录，仅对本区的主机名进行检查（对区外的主机名使用 {\bfseries{named-checkzone}}）。对NS记录，仅对区的顶端 下的名字进行检查（对区外名字和粘着一致性检查使用 {\bfseries{named-checkzone}}）。缺省是 {\bfseries{yes}}。

使用SPF记录做发送者策略框架的发布已被弃用，即从使用TXT记录到 SPF记录的迁移一样被放弃一样。打开这个选项在已存在一个SPF记录 时，会检查一个TXT类型的发送者策略框架记录（以"v=spf1"开头） 是否已经存在。如果TXT记录不存在，将发出警告，也可通过 {\bfseries{check-spf}}拟制。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-mx-cname}}}]\null{}
如果设置了{\bfseries{check-integrity}}，遇到指向CNAME名 字的MX记录就会失败，警告或忽略。缺省是 {\bfseries{warn}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-srv-cname}}}]\null{}
如果设置了{\bfseries{check-integrity}}，遇到指向CNAME名 字的SRV记录就会失败，警告或忽略。缺省是 {\bfseries{warn}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-sibling}}}]\null{}
在执行完整性检查的同时，也检查兄弟线索的存在。缺省是 {\bfseries{yes}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-spf}}}]\null{}
如果设置了{\bfseries{check-integrity}}并且存在一条 SPF记录，就检查是否存在一条TXT类型的发送者策略框架记录 （以"v=spf1"开头）。缺省是{\bfseries{warn}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{zero-no-soa-ttl}}}]\null{}
当给SOA请求返回权威的消极响应时，将所返回的权威部份中的SOA记 录的TTL值设置为零。缺省是{\bfseries{yes}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{zero-no-soa-ttl-cache}}}]\null{}
当为SOA请求返回缓存的消极响应时，将其中TTL值设置为零。缺省是 {\bfseries{no}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{update-check-ksk}}}]\null{}
在设置为缺省值{\texttt{{yes}}}时，检查每个密钥的 KSK位以决定为一个安全区生成RRSIG时如何使用密钥。

正常情况下，区签名密钥（即未置KSK位的密钥）用于对整个区 签名，而密钥签名密钥（设置了KSK位的密钥）仅用于对区顶点 的DNSKEY资源记录集签名。然而，如果这个选项被设置为 {\texttt{{no}}}，KSK位被忽略；KSK被当成ZSK，用于 对整个区签名。这与{\bfseries{dnssec-signzone -z}} 命令行选项相似。

当这个选项被设置为{\texttt{{yes}}}时，在DNSKEY 资源记录集中的每个算法至少有两个激活的密钥：每个算法 至少有一个KSK和一个ZSK。如果有任何一个算法的要求未被 满足，这个选项对于这种算法将被忽略。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-dnskey-kskonly}}}]\null{}
当这个选项和{\bfseries{update-check-ksk}}都被设置 为{\texttt{{yes}}}时，只有密钥签名密钥（即设置了 KSK位的密钥）会被用于对区顶点的DNSKEY资源记录集签名。 区签名密钥（未置KSK位的密钥）会被用于对区剩下部份签名， 不包括DNSKEY资源记录集。这与 {\bfseries{dnssec-signzone -x}}命令行选项相似。

缺省为{\bfseries{no}}。如果 {\bfseries{update-check-ksk}}被设置为 {\texttt{{no}}}，这个选项将被忽略。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-loadkeys-interval}}}]\null{}
当一个区配置有{\bfseries{auto-dnssec maintain;}}时， 将会周期性地检查其密钥库，以查看是否有新的密钥添加或者任何 现存密钥的计时元数据被修改（参见 \hyperlink{man.dnssec-keygen}{dnssec-keygen(8)}和 \hyperlink{man.dnssec-settime}{dnssec-settime(8)}）。 {\bfseries{dnssec-loadkeys-interval}}选项设置自动检查 库的频率，以分钟计。缺省为{\texttt{{60}}}（1小时）， 最小为{\texttt{{1}}}（1分钟），最大为 {\texttt{{1440}}}（24小时）；任何更大的值将被静默地 减小。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{try-tcp-refresh}}}]\null{}
如果UDP请求失败，试图使用TCP刷新区。为BIND 8兼容性， 缺省是{\bfseries{yes}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-secure-to-insecure}}}]\null{}
通过删除所有DNSKEY记录，允许一个区从安全状态迁移到 不安全状态。缺省为{\bfseries{no}}。
\end{description}
\subsubsection{转发}
\label{idm178371753840}\hypertarget{idm178371753840}{}%

转发设施可以被用于在一些服务器上建立一个大的缓存，并减少到外部名字 服务器的流量。它也允许这样的请求，服务器不能直接访问互联网，但也希 望通过某种方式查找外部的名字。转发只发生在那些服务器不是其权威服务 器并且其缓存没有答案的请求上。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{forward}}}]\null{}
这个选项仅在转发服务器列表非空的情况下有意义。值为 {\texttt{{first}}}时，即其缺省值，将使服务器首先请求转 发服务器 --- 并且如果它不回答问题时，服务器再自行查找 回答。如果指定{\texttt{{only}}}，服务器只请求 转发服务器。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{forwarders}}}]\null{}
指定用于转发的IP地址。缺省时空列表（不转发）。
\end{description}

转发也可以按域来配置，允许全局转发选项被多种方式覆盖。你可以设置某 个特定的域使用不同的转发服务器，或者使用不同的 {\bfseries{forward only/first}}行为，或者全都不转发，参见 \hyperlink{zone_statement_grammar}{第\ref{zone_statement_grammar}节}。
\subsubsection{双栈服务器}
\label{idm178371744944}\hypertarget{idm178371744944}{}%

双栈服务器是服务器的最后手段，用于解决这样的问题，即由于主机缺乏 IPv4或IPv6可达性。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dual-stack-servers}}}]\null{}
指定机器的主机名或者地址，它可以通过IPv4和IPv6都能被访问到。 如果使用主机名，服务器必须在其所使用的传输方式上能够被 解析到。如果机器是双栈的， {\bfseries{dual-stack-servers}}就没有效，除非到某个 传输方式的访问被命令行禁止掉 （如{\bfseries{named -4}}）。
\end{description}
\subsubsection{访问控制}
\label{access_control}\hypertarget{access_control}{}%

对服务器的访问可以基于发出请求的系统的IP地址进行限制。参见 \hyperlink{address_match_lists}{第\ref{address_match_lists}节}以获得如何指定IP地址列表的详细 内容。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-notify}}}]\null{}
指定允许哪些主机可以通知本服务器，作为一个辅服务器，除了区主 服务器之外关于区改变的信息。{\bfseries{allow-notify}}也 可以在{\bfseries{zone}}语句中指定，这时它会覆盖 {\bfseries{options allow-notify}}语句。它仅对一个辅区有 意义。如果未指定，缺省是仅处理来自一个区的主服务器的 通知消息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-query}}}]\null{}
指定允许哪些主机可以进行普通的DNS查询。 {\bfseries{allow-query}}也可以在{\bfseries{zone}} 语句中指定，这时它会覆盖 {\bfseries{options allow-query}}语句。 如果未指定，缺省是允许所有主机请求。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

{\bfseries{allow-query-cache}}现在用于指定对缓存的 访问。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-query-on}}}]\null{}
指定哪些本机地址可以接受普通的DNS问题。这使得这样的 情况成为可能，例如，允许面向内部的接口接受请求而不允许 面向外部的接口接受请求，而不需要知道内部的网络地址。

注意{\bfseries{allow-query-on}}仅仅针对被 {\bfseries{allow-query}}所允许的请求才被检查。请求 必须被两个ACL都允许，否则将被拒绝。

{\bfseries{allow-query-on}}也可以在 {\bfseries{zone}}语句中指定，这时，它会覆盖 {\bfseries{options allow-query-on}}语句。

如果未指定，缺省是允许在所有地址上的请求。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

{\bfseries{allow-query-cache}}用于指定对缓存的 访问。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-query-cache}}}]\null{}
指定允许哪些主机可以从缓存中获取答案。如果未设置 {\bfseries{allow-query-cache}}而设置了 {\bfseries{allow-recursion}}就使用它，否则如果设置了 {\bfseries{allow-query}}就使用它，除非设置了 {\bfseries{recursion no;}}，在这种情况下使用 {\bfseries{none;}}， 否则使用缺省的 （{\bfseries{localnets;}} {\bfseries{localhost;}}）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-query-cache-on}}}]\null{}
指定哪些本机地址可以从缓存给出答案，如果未指定，缺省 允许在任何地址上的对缓存的请求， {\bfseries{localnets}}和 {\bfseries{localhost}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-recursion}}}]\null{}
指定允许哪些主机可以通过本服务器进行递归查询。如果未设置 {\bfseries{allow-recursion}}而设置了 {\bfseries{allow-query-cache}}就使用它，否则如果设置了 {\bfseries{allow-query}}就使用它，否则使用缺省的 （{\bfseries{localnets;}}{\bfseries{localhost;}}）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-recursion-on}}}]\null{}
指定哪些本机地址可以接受递归请求。如果未指定，缺省是 允许在所有地址上的递归请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-update}}}]\null{}
指定允许哪些主机可以对主区提交动态DNS更新。缺省是拒绝所有主机 的动态更新。注意，允许基于请求者IP地址的动态更新是不安全的； 更详细的内容参见\hyperlink{dynamic_update_security}{第\ref{dynamic_update_security}节}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-update-forwarding}}}]\null{}
指定允许哪些主机可以对能够转发到主区的辅区提交动态DNS更新。缺 省是{\ttfamily\bfseries{{\docbooktolatexgobble\string\{ none; \docbooktolatexgobble\string\}}}}，表示不执行 更新转发操作。要允许更新转发，指定 {\ttfamily\bfseries{{allow-\dbz{}update-\dbz{}forwarding \docbooktolatexgobble\string\{ any; \docbooktolatexgobble\string\};}}}。 指定{\ttfamily\bfseries{{\docbooktolatexgobble\string\{ none; \docbooktolatexgobble\string\}}}}或 {\ttfamily\bfseries{{\docbooktolatexgobble\string\{ any; \docbooktolatexgobble\string\}}}}之外的值通常是相反的意义，因为 对更新的访问控制应该是主服务器的责任，而不是辅服务器的责任。

注意打开一个辅服务器上的更新转发特性可能将主服务器依赖基于不 安全IP地址的访问控制暴露给攻击者；更详细的内容参见 \hyperlink{dynamic_update_security}{第\ref{dynamic_update_security}节}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-v6-synthesis}}}]\null{}
本选项引入从AAAA到A6以及从“半字节标记”到二进制标记的平滑转 换功能。然而，由于A6和二进制标记都废弃了，本选项也被废弃了。 现在这个选项被忽略，并带有一些警告信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-transfer}}}]\null{}
指定哪些主机允许从服务器接收区传送。 {\bfseries{allow-transfer}}也可以在 {\bfseries{zone}}语句中指定，在这种情况下它会覆盖 {\bfseries{options allow-transfer}}语句。如果未指定，缺 省是允许所有主机进行传送。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{blackhole}}}]\null{}
指定一个地址列表，服务器将不会接受来自其中的请求或者用其解析 一个请求。从这些地址来的请求将不会有任何响应。缺省是 {\ttfamily\bfseries{{none}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{filter-aaaa}}}]\null{}
指定一个{\bfseries{filter-aaaa-on-v4}}所应用到的 地址的列表。缺省为{\ttfamily\bfseries{{any}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{no-case-compress}}}]\null{}
指定一个地址列表，其中地址要求响应使用大小写无关的压缩。 当{\bfseries{named}}需要与那些不遵守RFC 1034所要求 的在匹配域名时使用大小写无关的名字压缩的客户端的通信时， 可以使用这个ACL。

如果未定义，ACL缺省为{\bfseries{none}}：大小写无关 的压缩将用于所有客户端。如果定义了ACL并且与一个客户端 匹配，在发送给那个客户端的响应中压缩域名时将忽略大小写。

这将导致稍稍小一点的响应：如果一个响应包含名字"example.com" 和"example.COM"，大小写无关的压缩将把第二个当成一个副本。 它也确保请求名的大小写与返回记录的属主名精确匹配，而不是 匹配其文件中记录的大小写。这允许响应精确匹配请求，这是一些 不正确使用大小写相关压缩的客户端所要求的。

大小写无关压缩{\em{总是}}用在AXFR和IXFR响应， 而不管客户端是否匹配这个ACL。

在有些环境中{\bfseries{named}}不保持记录属主名的 大小写：如果一个其文件中定义同一个名字的不同类型记录， 但名字的大写字母使用不同（例如，"www.example.com/A"和 "WWW.EXAMPLE.COM/AAAA"），那么所有对那个名字的响应将使用 在区文件中用到的那个名字的{\em{第一个}}版本。 这个限制可能在一个将来的版本中被处理。然而，在资源记录的 rdata部份所指定的域名（例如，NS，MX，CNAME等记录类型） 将总是保持其大小写，重复客户端匹配这个ACL。 ACL.
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{resolver-query-timeout}}}]\null{}
解析器在尝试解析一个递归请求时，在失败之前将花费的时间。缺省值 和最小值是{\texttt{{10}}}，最大值是{\texttt{{30}}}。 将其设置为{\texttt{{0}}}将会导致使用缺省值。
\end{description}
\subsubsection{接口}
\label{idm178371677088}\hypertarget{idm178371677088}{}%

服务器回答请求的接口和端口可以由{\bfseries{listen-on}} 选项指定。{\bfseries{listen-on}}接受作为可选项的端口号 和一个IPv4地址的{\texttt{{address\_match\_list}}}。 （IPv6地址被忽略，并在日志中记录一条警告。） 服务器将监听在地址匹配表所允许的所有接口上。如果未指定端口， 将使用53端口。

允许使用多个{\bfseries{listen-on}}语句。例如，

\begin{Verbatim}[]
listen-on { 5.6.7.8; };
listen-on port 1234 { !1.2.3.4; 1.2/16; };

\end{Verbatim}

将使服务器监听在IP地址5.6.7.8的53端口，以及本机在网络1.2上但不是 1.2.3.4的地址的1234端口上。

如果没有指定{\bfseries{listen-on}}，服务器将会监听在所有 IPv4接口的53端口。

{\bfseries{listen-on-v6}}选项指定服务器用来监听IPv6发来的 请求所用的接口和端口。如果未指定，服务器将监听在所有IPv6接口的 53端口。

当指定
\begin{Verbatim}[]
{ any; }
\end{Verbatim}
 作为{\bfseries{listen-on-v6}}选项的 {\texttt{{address\_match\_list}}}时，如果操作系统对IPv6有足够 的API支持，服务器不会象对IPv4地址一样将一个单独的套接字绑定到其 每个IPv6接口地址上（特别是在其遵从RFC 3493和RFC 3542时）。作为 替代，它会监听在IPv6的通配地址上。如果系统仅仅对IPv6有不完全的 API支持，其行为就与IPv4一样。

可以指定一个特殊的IPv6地址列表，在这样的情况下，服务器监听在每个 特定地址的单独的套接字上，而不用考虑系统是否有足够的API支持。 在{\bfseries{listen-on-v6}}中指定的IPv4地址将被忽略，并 在日志中记录一条警告。

可以使用多个{\bfseries{listen-on-v6}}选项。例如，

\begin{Verbatim}[]
listen-on-v6 { any; };
listen-on-v6 port 1234 { !2001:db8::/32; any; };

\end{Verbatim}

将使服务器监听在任何IPv6地址（带有单个通配套接字）的53端口，以及 任何不在2001:db8::/32前缀（对每个匹配的地址有单独的套接字）的 IPv6地址的1234端口上。

要使服务器不监听在任何IPv6地址，使用

\begin{Verbatim}[]
listen-on-v6 { none; };

\end{Verbatim}
\subsubsection{请求地址}
\label{query_address}\hypertarget{query_address}{}%

如果不知道一个问题答案，它就会请求其它的名字服务器。 {\bfseries{query-source}}指定这样的请求所使用的地址和端口。对 通过IPv6发出的请求，有一个单独的{\bfseries{query-source-v6}} 选项。如果{\bfseries{address}}为{\bfseries{*}}（星号） 或被省略，就使用通配符IP地址（{\bfseries{INADDR\_ANY}}）。

如果{\bfseries{port}}为{\bfseries{*}}或被省略，就从一个 预先配置的范围中随机取出一个端口号，并用在每个请求中。端口范围是在 {\bfseries{use-v4-udp-ports}}（对IPv4）和 {\bfseries{use-v6-udp-ports}}（对IPv6）选项中指定，并分别排除 {\bfseries{avoid-v4-udp-ports}}和 {\bfseries{avoid-v6-udp-ports}}选项所指定的范围。

{\bfseries{query-source}}和{\bfseries{query-source-v6}} 的缺省选项为：

\begin{Verbatim}[]
query-source address * port *;
query-source-v6 address * port *;

\end{Verbatim}

如果未指定{\bfseries{use-v4-udp-ports}}或者 {\bfseries{use-v6-udp-ports}}， {\bfseries{named}}将检查操作系统是否提供一个程序 接口来提取系统缺省的临时端口的范围。如果有这样的一个接口， {\bfseries{named}}将使用相应的系统缺省范围；否则， 它将使用自己的缺省值：

\begin{Verbatim}[]
use-v4-udp-ports { range 1024 65535; };
use-v6-udp-ports { range 1024 65535; };

\end{Verbatim}

注意：确保这个范围足够大，以保证安全。一个合理的大小依赖于 多个参数，但是我们通常推荐它至少包含16384个端口（14位熵）。 还要注意系统的缺省范围在使用时可能太小而不满足这个目的，这 个范围甚至可能在{\bfseries{named}}运行时发生变化；当 {\bfseries{named}}重新装载时，将会自动应用新的范围。 鼓励显式地配置{\bfseries{use-v4-udp-ports}}和 {\bfseries{use-v6-udp-ports}}，这样范围就足够大并适度 地独立于其它应用所使用的范围。

注意：{\bfseries{named}}所用的运行配置可能禁止使用 某些端口。例如，UNIX系统将不允许以一个非root权限运行的 {\bfseries{named}}使用小于1024的端口。 如果这样的端口被包含在所指定的（或被检测的）请求端口集合 中，相应的请求企图将会失败，从而导致解析失败或延期。因此， 配置端口集合，使其能够安全地使用在期望的运行环境中是很重要 的。

{\bfseries{avoid-v4-udp-ports}}和 {\bfseries{avoid-v6-udp-ports}}的缺省选项为：

\begin{Verbatim}[]
avoid-v4-udp-ports {};
avoid-v6-udp-ports {};

\end{Verbatim}

注意：BIND 9.5.0引入了{\bfseries{use-queryport-pool}} 来支持随机端口池，但是这个选项现在被废弃了，因为重复使用池中 的同样端口可能不是足够安全。 由于这个原因，通常强烈不鼓励为 {\bfseries{query-source}}或 {\bfseries{query-source-v6}}选项指定一个特定的端口； 它隐含地关闭了使用随机端口号。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{use-queryport-pool}}}]\null{}
这个选项被废弃。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{queryport-pool-ports}}}]\null{}
这个选项被废弃。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{queryport-pool-updateinterval}}}]\null{}
这个选项被废弃。
\end{description}

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

{\bfseries{query-source}}选项中所指定的地址是同时用于UDP和 TCP请求，但是端口只用于UDP请求。TCP请求总是使用一个随机的非特权端 口。
\end{admonition}


\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

Solaris 2.5.1及之前的版本不支持设置TCP套接字的源地址。
\end{admonition}


\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

参见{\bfseries{transfer-source}}和 {\bfseries{notify-source}}。
\end{admonition}

\subsubsection{区传送}
\label{zone_transfers}\hypertarget{zone_transfers}{}%

BIND有机制来做区传送，并在系统进行区传送的地方对 负载量设置限制。下列选项应用于区传送。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{also-notify}}}]\null{}
定义一个全局的名字服务器的IP地址表，无论何时只要有更新的区被 加载，都会向这个表中的服务器发出NOTIFY消息，还包括在区的NS记 录中列出的服务器。这将有助于确保区拷贝尽快地同步到 隐藏服务器。作为可选项，可以在每个 {\bfseries{also-notify}}地址指定一个端口，用于将通知 消息发到缺省的53之外的端口。 每个地址也可指定一个可选的TSIG密钥，使通知信息也被签名；这在 向多个视图发送通知时很有用。 作为显式地址的替代，也可以使用一个或多个命名的 {\bfseries{masters}}列表。 如果在{\bfseries{zone}}语句中有一个 {\bfseries{also-notify}}表，它将会覆盖 {\bfseries{options also-notify}}语句。当一个 {\bfseries{zone notify}}语句被设置为 {\bfseries{no}}，对于这个区，将不会向全局 {\bfseries{also-notify}}表中的IP地址发出NOTIFY消息。缺 省是空表（无全局通知表）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-time-in}}}]\null{}
进来数据的区传送如果超过这么多分钟将被终止。缺省为120分钟 （2小时）。最大值为28天（40320分钟）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-idle-in}}}]\null{}
进来数据的区传送在这么多分钟之内没有进展将被终止。缺省为60 分钟（1小时）。最大值为28天（40320分钟）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-time-out}}}]\null{}
出去数据的区传送如果超过这么多分钟将被终止。缺省为120分钟 （2小时）。最大值为28天（40320分钟）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-idle-out}}}]\null{}
出去数据的区传送在这么多分钟之内没有进展将被终止。缺省为60 分钟（1小时）。最大值为28天（40320分钟）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{serial-query-rate}}}]\null{}
辅服务器将会周期性地请求主服务器以发现区的序列号是否改变。每 个这样的请求占用一定量的辅服务器网络带宽。为限制所使用的带宽 数量，BIND 9限制请求发送的速率。 {\bfseries{serial-query-rate}}选项的值为一个整数，表示 每秒发送的最大请求数。缺省为20每秒。 可能的最低速率是1每秒；当设置为0时，它会被静默地提升为1。

除了控制发出SOA刷新请求的速率， {\bfseries{serial-query-rate}}还控制从主区和辅区发出的 NOTIFY消息的速率。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{serial-queries}}}]\null{}
在BIND 8中，{\bfseries{serial-queries}}选项设置在任何时 间允许未完成的最大并发序列号请求的数目。BIND 9不限制未完成的 序列号请求数并忽略{\bfseries{serial-queries}}选项。取而 代之的是，它限制由{\bfseries{serial-query-rate}}选项所 定义的请求发送的速率。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfer-format}}}]\null{}
区传送可以使用两种不同的格式发送， {\bfseries{one-answer}}和 {\bfseries{many-answers}}。 {\bfseries{transfer-format}}选项用于在主服务器上决定使 用那种格式发送。{\bfseries{one-answer}}使用一个DNS消息 传送一个资源记录。{\bfseries{many-answers}}将多个资源记 录尽可能地打包在一个消息中。{\bfseries{many-answers}}更 有效率，但是仅在相对新的辅服务器中支持，如 BIND 9，BIND 8.x和 BIND 4.9.5之后的版本。最近的 Microsoft Windows名字服务器也支持 {\bfseries{many-answers}}格式。 缺省是{\bfseries{many-answers}}。 通过使用{\bfseries{server}}语句， {\bfseries{transfer-format}}可以被覆盖成以每个服务器为 基础。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfers-in}}}]\null{}
可以同时运行的进入的区传送的最大数目。缺省值是 {\texttt{{10}}}。增加{\bfseries{transfers-in}}可 以加速辅区的同步，但是它也会增加本地系统的负载。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfers-out}}}]\null{}
可以同时运行的出去的区传送的最大数目。超过限制的区传送请求将 会被拒绝。缺省值是{\texttt{{10}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfers-per-ns}}}]\null{}
可以同时运行的来自某个给定远程名字服务器的进入的区传送的最大 数目。缺省值是{\texttt{{2}}}。增加 {\bfseries{transfers-per-ns}}可以加速辅区的同步，但是它 也会增加远程名字服务器的负载。通过在{\bfseries{server}} 语句中使用{\bfseries{transfers}}子句， {\bfseries{transfers-per-ns}}可以被覆盖成以每个服务器为 基础。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfer-source}}}]\null{}
{\bfseries{transfer-source}}决定哪个本地地址将会被绑定 到IPv4的TCP连接，是用于服务器获取传入的区。它也决定更新区的请 求和转发动态更新所使用的源IPv4地址，及可选的UDP端口，如果未指 定，它缺省是一个系统控制的值，通常是“最接近”远端的接口的地 址。这个地址必须出现在远端的{\bfseries{allow-transfer}} 选项以便能够进行区传送，如果指定了这个选项的话。这个语句为所 有区设置{\bfseries{transfer-source}}，但是可以通过在配 置文件的{\bfseries{view}}或{\bfseries{zone}}块中 包含{\bfseries{transfer-source}}语句而被覆盖成以每个视 图或每个区为基础。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

Solaris 2.5.1及更早期的版本不支持设置TCP套接字的源地址。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfer-source-v6}}}]\null{}
与{\bfseries{transfer-source}}相似，除了区传送是使用 IPv6之外。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{alt-transfer-source}}}]\null{}
一个可替换的传送源，如果在{\bfseries{transfer-source}} 中列出的源失效并且设置了 {\bfseries{use-alt-transfer-source}}。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
如果你不希望使用一个可替换的传送源，你应该正确设置 {\bfseries{use-alt-transfer-source}}，并且你不应该依赖 于从第一个更新请求获得一个回复。\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{alt-transfer-source-v6}}}]\null{}
一个可替换的传送源，如果在 {\bfseries{transfer-source-v6}}中列出的源失效并且设置了 {\bfseries{use-alt-transfer-source}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{use-alt-transfer-source}}}]\null{}
是否使用可替换的传送源，如果使用视图，这个选项的省为 {\bfseries{no}}，否则其缺省为{\bfseries{yes}} （为了BIND 8的兼容性）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-source}}}]\null{}
{\bfseries{notify-source}}决定哪个本地源地址，及可选的 UDP端口，将用于发送NOTIFY消息。这个地址必须出现在辅服务器的 {\bfseries{masters}}区子句或 {\bfseries{allow-notify}}子句中。本语句为全部区设置 {\bfseries{notify-source}}，但是可以通过在配置文件的 {\bfseries{zone}}或{\bfseries{view}}块中包含 {\bfseries{notify-source}}语句而被覆盖成以每个区或每个 视图为基础。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

Solaris 2.5.1及更早期的版本不支持设置TCP套接字的源地址。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-source-v6}}}]\null{}
与{\bfseries{notify-source}}相似，但是以IPv6地址发送通 知消息。
\end{description}
\subsubsection{UDP端口列表}
\label{idm178371563280}\hypertarget{idm178371563280}{}%

{\bfseries{use-v4-udp-ports}}, {\bfseries{avoid-v4-udp-ports}}, {\bfseries{use-v6-udp-ports}}和 {\bfseries{avoid-v6-udp-ports}}指定可以用于或不 能用于UDP消息源端口的IPv4和IPv6UDP端口的列表。 关于如何决定可利用的端口，参见 \hyperlink{query_address}{第\ref{query_address}节}。 例如，使用下列配置

\begin{Verbatim}[]

use-v6-udp-ports { range 32768 65535; };
avoid-v6-udp-ports { 40000; range 50000 60000; };

\end{Verbatim}

从{\bfseries{named}}发送IPv6消息的UDP端口将是下列 范围中的一个：32768到39999，40001到49999，以及60001到 65535。

{\bfseries{avoid-v4-udp-ports}}和 {\bfseries{avoid-v6-udp-ports}}可以用来防止 {\bfseries{named}}随机选择到被防火墙阻止或被其它应用使用 的端口；如果一个请求带有被防火墙所阻止的源端口，回答就不会经过 防火墙，名字服务器不得不重新请求。 注意：期望的范围也可以只使用 {\bfseries{use-v4-udp-ports}}和 {\bfseries{use-v6-udp-ports}}来表示，在这个意义上 {\bfseries{avoid-}}是冗余的；提供它们是为了向后兼容性和 有可能简化端口设定。
\subsubsection{操作系统资源限制}
\label{idm178371554736}\hypertarget{idm178371554736}{}%

服务器使用的大多数系统资源是可以限制的。在指定资源限制时的值是可变 的。例如，{\bfseries{1G}}可以使用 {\bfseries{1073741824}}来替代，以指定一吉字节的限制。 {\bfseries{unlimited}}要求不限制使用，或可利用的最大数量。 {\bfseries{default}}使用服务器启动时强制设定的限制。参见 \hyperlink{configuration_file_elements}{第\ref{configuration_file_elements}节}的关于 {\bfseries{size\_spec}}的描述。

下列选项为名字服务器进程设置操作系统限制。某些操作系统不支持某些或 任何限制。在这样的系统上，如果使用一个不支持的限制，将会发出一条警 告。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{coresize}}}]\null{}
内核转储的最大大小。缺省为{\texttt{{default}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{datasize}}}]\null{}
服务器可以使用的数据内存的最大数量。缺省为 {\texttt{{default}}}。这是服务器内存用量的硬限制。如果 服务器企图申请的内存超过这个限制，申请将会失败，将会导致服务 器不能执行DNS服务。所以，这个选项很少作为一种限制内存总量的方 式由服务器所使用，但是它可以用于在缺省值太小的情况下提升操作 系统数据大小的限制。如果你想限制服务器所使用的内存总量，使用 {\bfseries{max-cache-size}}和 {\bfseries{recursive-clients}}选项来替代。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{files}}}]\null{}
服务器可以同时打开的文件的最大数目。缺省为 {\texttt{{unlimited}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{stacksize}}}]\null{}
服务器可以使用的栈内存的最大数量。缺省为 {\texttt{{default}}}。
\end{description}
\subsubsection{服务器资源限制}
\label{server_resource_limits}\hypertarget{server_resource_limits}{}%

下列选项设置了服务器对资源消耗的限额，这些限额是在服务器内部实现而 不是由操作系统来实现的。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-ixfr-log-size}}}]\null{}
本选项被废除了；它被接受并忽略只是为了BIND 8的兼容性。在 BIND 9中，选项{\bfseries{max-journal-size}}执行类似的功 能。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-journal-size}}}]\null{}
设置每个日志文件（参见\hyperlink{journal}{第\ref{journal}节}）的最大大小。 当日志文件达到指定的大小时，其中一些最旧的事物会被自动删除。 允许的最大值为2G字节。缺省是{\texttt{{unlimited}}}，也 表示2G字节。这也可以基于每个区来设置。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{host-statistics-max}}}]\null{}
在BIND 8中，指定所要保持的主机统计条目的最大数目。 在BIND 9中未实现。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{recursive-clients}}}]\null{}
执行并行递归查询的最大数目，这是服务器所提供给客户端的行为。 缺省值是{\texttt{{1000}}}。因为每个递归查询使用相当大小 的内存，大致是20k字节，在内存有限的主机上可以降低 {\bfseries{recursive-clients}}选项的值。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{tcp-clients}}}]\null{}
服务器所能接受的并发的TCP客户端连接的最大数目。缺省是 {\texttt{{100}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{reserved-sockets}}}]\null{}
为TCP，标准输入输出等保留的文件描述符个数。这个数需要足够 大，以覆盖{\bfseries{named}}监听的接口数，以及用于提供 向外TCP请求和进入的区传送的{\bfseries{tcp-clients}}。 缺省是{\texttt{{512}}}。最小值是 {\texttt{{128}}}，最大值是maxsockets (-S)减 {\texttt{{128}}}。这个选项在将来可能被去掉。

这个选项在Windows上几乎没有效果。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-cache-size}}}]\null{}
用于服务器缓存的最大内存量，以字节为单位。当缓存中的数据量达 到这个限制时，服务器将使用一个基于LRU的策略使记录提前作废 以免超过限制。 关键字{\ttfamily\bfseries{{unlimited}}}，或值0，将使缓存大小 没有限制； 记录将在TTL过期时才将其从缓存中清除。 任何小于2MB的正数都被忽略并重置为2MB。 在一个带多个视图的服务器上，这个限制分别应用到各个视图的缓 存上。缺省为{\ttfamily\bfseries{{unlimited}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{tcp-listen-queue}}}]\null{}
监听队列长度。缺省值和最小值都是10。如果内核支持接受过滤器 “dataready”，这个也可以控制有多少TCP连接可以在内核空间中排 队以等待数据被接收。小于10的非零值将被静默地提升。也可以使用 0；在大多数平台上这将会将监听队列长度设置为一个系统定义的 缺省值。
\end{description}
\subsubsection{周期的内部任务}
\label{idm178371513056}\hypertarget{idm178371513056}{}%

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{cleaning-interval}}}]\null{}
这个间隔事实上被废除了。先前，服务器将会每 {\bfseries{cleaning-interval}}分钟清理一次 缓存，从中删除过期的资源记录。 BIND 9现在以一个更复杂的方式管理 缓存，并不再依赖于周期性地清理。 因此指定这个选项对服务器的行为没有任何影响。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{heartbeat-interval}}}]\null{}
服务器将对所有标记为{\bfseries{dialup}}的区执行区 维护任务，无论本时间间隔是否过期。缺省是60分钟。1天 （1440分钟）以内的值都是合理的。最大值是28天（40320分钟）。 如果设置为0，就不会对这些区进行区维护。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{interface-interval}}}]\null{}
服务器将每{\bfseries{interface-interval}}分钟对网络接口 列表进行扫描。缺省是60分钟。最大值是28天（40320分钟）。如果 设置为0，仅在配置文件装载后，才会进行接口扫描。扫描后，服务器 将开始在新发现的端口监听请求（假定这些端口在 {\bfseries{listen-on}}配置中被允许）， 并且不会停止已经不存在的监听端口。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{statistics-interval}}}]\null{}
名字服务器统计信息在每{\bfseries{statistics-interval}} 分钟被写入日志。缺省是60分钟。最大值是28天（40320分钟）。 如果设置为0，就不将统计写入日志。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

BIND 9中还未实现。
\end{admonition}

\end{description}
\subsubsection{拓扑}
\label{topology}\hypertarget{topology}{}%

在所有其它方面都是相同的情况下，当一个服务器在一个名字服务器的列表 中选择一个来发送请求时，它会优先选择拓扑上离它最近的。 {\bfseries{topology}}语句使用 {\bfseries{address\_match\_list}}，并以一个特殊的方式解释它。 每个顶级列表元素被指定一个距离。非否定元素获得一个基于它们在 列表中位置的距离，离表的开始处越近，在其与服务器之间的距离越短。 否定匹配将被指定离服务器最大的距离。如果没有匹配，地址将会获得一个 比任何非否定列表元素更远，而比任何否定元素更近的距离。例如，

\begin{Verbatim}[]
topology {
    10/8;
    !1.2.3/24;
    { 1.2/16; 3/8; };
};
\end{Verbatim}

将最先选择网络10中的服务器，然后是网络1.2.0.0（掩码255.255.0.0） 和网络3上的主机，并且不包括网络1.2.3（掩码255.255.255.0）上主机， 后者是最小的优先级。

缺省拓扑是

\begin{Verbatim}[]
    topology { localhost; localnets; };

\end{Verbatim}

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

BIND 9中还未实现{\bfseries{topology}} 选项。
\end{admonition}

\subsubsection{{\bfseries{sortlist}}语句}
\label{the_sortlist_statement}\hypertarget{the_sortlist_statement}{}%

一个DNS请求的响应由多个资源记录（Resource Record，RR）构成，它们 形成了一个资源记录集（RRset）。名字服务器的通常返回中，资源记录集 中的资源记录的顺序是不确定的（但可参见 \hyperlink{rrset_ordering}{第\ref{rrset_ordering}节}中的{\bfseries{rrset-order}} 语句）。客户端解析器代码应该适当 地重新对资源记录排序，即，优先使用本地网络中的任何地址，然后是其它 地址。然而，不是所有的解析器可以完成这项工作，或者被错误配置。当一 个客户端使用一个本地服务器时，排序可以基于客户端的地址在服务器上完 成。这仅需要配置名字服务器，完全不需要配置客户端。

{\bfseries{sortlist}}语句（见下）以一个 {\bfseries{address\_match\_list}}作为参数并且比 {\bfseries{topology}}语句更有效率地解释它 （\hyperlink{topology}{第\ref{topology}节}）。每个{\bfseries{sortlist}}中 的顶级语句必须使用一个或两个元素在 {\bfseries{address\_match\_list}}中显式地指定其自身。每个 顶级列表的第一个元素（必须是一个IP地址，一个IP前缀，一个ACL名或者 一个嵌套的{\bfseries{address\_match\_list}}）与请求的源地址 比较，直到匹配。

一旦请求的源地址匹配，如果顶级语句只包含一个元素，实际与源地址匹配 的元素用于选择响应中的地址，通过放在响应的开始处来实现。如果语句是 两个元素的列表，第二个元素被当成{\bfseries{topology}}语句中 的{\bfseries{address\_match\_list}}。每个顶级元素被指定一个 距离，响应中具有最小距离的地址被放在响应的开始。

在下面的例子中，从主机的任何地址所收到的任何请求将会优先得到任何本 地连接网络地址的响应。下一个优先的是在192.168.1/24网络上的地址，然 后是192.168.2/24或192.168.3/24网络，这两个网络之间没有优先关系。来 自192.168.1/24网络上的主机的请求比192.168.2/24和192.168.3/24网络的 地址优先。来自192.168.4/24或192.168.5/24网络的主机的请求将仅仅比主 机直接连接的其它地址优先。

\begin{Verbatim}[]
sortlist {
    // IF the local host
    // THEN first fit on the following nets
    { localhost;
        { localnets;
            192.168.1/24;
            { 192.168.2/24; 192.168.3/24; }; }; };
    // IF on class C 192.168.1 THEN use .1, or .2 or .3
    { 192.168.1/24;
        { 192.168.1/24;
            { 192.168.2/24; 192.168.3/24; }; }; };
    // IF on class C 192.168.2 THEN use .2, or .1 or .3
    { 192.168.2/24;
        { 192.168.2/24;
            { 192.168.1/24; 192.168.3/24; }; }; };
    // IF on class C 192.168.3 THEN use .3, or .1 or .2
    { 192.168.3/24;
        { 192.168.3/24;
            { 192.168.1/24; 192.168.2/24; }; }; };
    // if .4 or .5, prefer that net
    { { 192.168.4/24; 192.168.5/24; };
    };
};
\end{Verbatim}

下列例子给出本地主机和本地主机直接连接网络下的合理行为。它与 BIND 4.9.x中的地址排序行为很相似。发给来自本地 主机请求的响应优先选用任何直接连接的网络。发给来自直接连接网络的其 它主机请求的响应优先选用同一网络的地址。发给其它请求的响应不排序。

\begin{Verbatim}[]
sortlist {
           { localhost; localnets; };
           { localnets; };
};

\end{Verbatim}
\subsubsection{资源记录集排序}
\label{rrset_ordering}\hypertarget{rrset_ordering}{}%

在一个回答中有多个记录时，配置响应中记录的顺序可能非常有用。 {\bfseries{rrset-order}}语句允许在一个多记录响应中配置记录的 顺序。参见{\bfseries{sortlist}}语句， \hyperlink{the_sortlist_statement}{第\ref{the_sortlist_statement}节}。

{\bfseries{order\_spec}}按下列格式定义：

[class {\ttfamily\itshape{{class\_name}}}] [type {\ttfamily\itshape{{type\_name}}}] [name {\ttfamily\itshape{{"domain\_name"}}}] order {\ttfamily\itshape{{ordering}}}

如果没有指定类，缺省为{\bfseries{ANY}}。 如果没有指定类型，缺省是{\bfseries{ANY}}。 如果没有指定名字，缺省是“{\bfseries{*}}”（星号）。

合法的{\bfseries{ordering}}值是：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178371467616}\hypertarget{idm178371467616}{}%
\begin{longtable}{|p{0.750in}p{3.750in}|}
\hline 
{{{\bfseries{fixed}}}} & {{以区文件中定义的顺序返回记录。}} \tabularnewline
{{{\bfseries{random}}}} & {{以随机的顺序返回记录。}} \tabularnewline
{{{\bfseries{cyclic}}}} & {{以循环轮转的顺序返回记录。  \par  如果BIND在编译时使用了 "--enable-fixed-rrset"选项，资源记录集的初始顺序 会与区文件中指定的一致。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


例如：

\begin{Verbatim}[]
rrset-order {
   class IN type A name "host.example.com" order random;
   order cyclic;
};

\end{Verbatim}

将使响应中任何类为IN类型为A并有 “{\texttt{{host.\dbz{}example.\dbz{}com}}}” 后缀的记录以随机的顺序返回。所有其它的记录都以轮转的顺序返回。

如果出现了多个{\bfseries{rrset-order}}语句，它们不会 组合 --- 只有最后一个起作用。

缺省时，所有记录以随机顺序返回。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

在这个版本的BIND 9中，缺省时 {\bfseries{rrset-order}}语句不支持“固定”顺序。可以 在编译时在"configure"命令行指定"--enable-fixed-rrset"打开 固定顺序。
\end{admonition}

\subsubsection{调优}
\label{tuning}\hypertarget{tuning}{}%

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{lame-ttl}}}]\null{}
设置跛服务器指示的缓存秒数。0关掉缓存。（这是 {\bfseries{不}}推荐的。）缺省为值 {\texttt{{600}}}（10分钟），最大值为 {\texttt{{1800}}}（30分钟）。

Lame-ttl也控制DNSSEC验证失败被缓存的时间。如果lame-ttl 被设置为小于30秒，则被应用到否定缓存条目的最小值为30秒。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-ncache-ttl}}}]\null{}
为减少网络流量和提高性能，服务器会存储“记录不存在”的响应。 {\bfseries{max-ncache-ttl}}用来设置这些响应在服务器中最 大保持时间的秒数。缺省的{\bfseries{max-ncache-ttl}}值为 {\texttt{{10800}}}（3小时）。 {\bfseries{max-ncache-ttl}} 不能超过7天，如果超过，将会静默地被截为7天。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-cache-ttl}}}]\null{}
设置服务器的缓存普通（正）响应的最大时间。缺省值是一周（7天）。 值为0可能导致所有的请求都返回SERVFAIL，因为在解析过程中会丢失 中间资源记录集（如NS和粘着AAAA/A记录）的缓存。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{min-roots}}}]\null{}
根服务器的最小个数，一个需要查询根服务器的请求所能接受。缺省 值为{\ttfamily\bfseries{{2}}}。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

BIND 9中还未实现。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-validity-interval}}}]\null{}
指定DNSSEC签名在未来失效前的天数，这个签名是作为动态更新 （\hyperlink{dynamic_update}{第\ref{dynamic_update}节}）的结果自动生成的。 有一个可选的第二字段指定在失效之前多长时间重新生成签名。 如果未指定，就在基本间隔的1/4时重新生成签名。如果基本间隔 大于7天，第二字段以天数指定，否则就以小时数指定。 缺省的基本间隔是{\texttt{{30}}}天，对应的重签名间隔 是7又1/2天。最大值是10年（3660天）。

签名的开始时间被无条件地设为当前时间之前一小时，以允许 有限的时钟误差。

{\bfseries{sig-validity-interval}}应该至少是SOA过期 间隔的几倍，以允许在不同计时器和过期日期之间合理的互操作。 The {\bfseries{sig-validity-interval}}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-signing-nodes}}}]\null{}
指定在使用一个新DNSKEY签名一个区时，在每个量中检查的节点 的最大数目。缺省是{\texttt{{100}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-signing-signatures}}}]\null{}
指定在使用一个新DNSKEY签名一个区时，签名数目的上限，如果 超过将会终止对一个量的处理。缺省是{\texttt{{10}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-signing-type}}}]\null{}
指定一个在生成签名状态记录时会用到的私有RDATA类型。 缺省是{\texttt{{65534}}}。

一旦有了一个标准类型，预料这个参数在将来的版本中会 被去掉。

签名状态记录是用于{\bfseries{named}}，用来跟踪一个区 签名进程的当前状态。即，它是否还存活或者已经完成。这些记录 可以使用命令 {\bfseries{rndc signing -list {\ttfamily\itshape{{zone}}}}} 检查。 一旦{\bfseries{named}}使用一个特定密钥完成对一个区的 签名，与那个密钥相关的签名状态记录就可以通过执行 {\bfseries{rndc signing -clear {\ttfamily\itshape{{keyid/algorithm}}} {\ttfamily\itshape{{zone}}}}} 删除。 要删除一个区的所有已完成签名状态记录，使用 {\bfseries{rndc signing -clear all {\ttfamily\itshape{{zone}}}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{min-refresh-time}}, {\bfseries{max-refresh-time}}, {\bfseries{min-retry-time}}, {\bfseries{max-retry-time}}}]\null{}
这些选项控制服务器在刷新一个区（请求SOA看是否有变化）或者重试 失败的传送时的行为。通常是使用区的SOA值，但是这些值是由主服务 器设置的，只给辅服务器管理员一点点对内容的控制权。

这些选项允许管理员针对每个区，每个视图或者全局设置一个最小和 最大的刷新和重试时间。这些选项对辅区和存根区有效，将SOA的刷新 和重试时间指定到特定的值上。

下列为相应的缺省值。{\bfseries{min-refresh-time}} 300秒，{\bfseries{max-refresh-time}} 2419200秒（4周），{\bfseries{min-retry-time}} 500秒， {\bfseries{max-retry-time}} 1209600秒（2周）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{edns-udp-size}}}]\null{}
设置被广告的以字节计的EDNS UDP缓存的最大大小，用以控制从 权威服务器接收的作为递归响应的包的大小。 有效值为从512到4096（超出这个范围的值将被静默地调整为范围内 最接近的值）。缺省值是4096。

设置{\bfseries{edns-udp-size}}为 非缺省值的通常的原因是为了让UDP回答穿过坏的防火墙，这样的防火 墙阻止碎包和（或）阻止大于512字节的UDP DNS包通过。

当{\bfseries{named}}首次请求一个远程服务器时，它会广告 一个512字节的UDP缓冲区，这样在首次试探中有最大的成功机会。

如果这个初始响应超时，{\bfseries{named}}会以普通DNS 重试 ，如果重试成功，它就会得出这个服务器不支持EDNS的结论。 在使用EDNS时足够的失败和使用普通DNS时足够的成功之后， {\bfseries{named}}在将来同这台服务器通信时缺省使用普通 DNS。（{\bfseries{named}}将会周期性地发送EDNS请求来查看 情况是否有改善。）

另外，如果初始的广告带512字节缓存的EDNS的请求成功后， {\bfseries{named}}将逐步在后继的请求中广告一个更大的 缓存，直到响应超时或者达到{\bfseries{edns-udp-size}}。

{\bfseries{named}}使用的缺省缓存大小为512，1232，1432和 4096，但不超过{\bfseries{edns-udp-size}}。 （选择值1232和1432是为了让一个IPv4/IPv6封装的UDP消息能够不被 分片地在最小MTU的以太网和IPv6网络中发送。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-udp-size}}}]\null{}
设置{\bfseries{named}}所发送的EDNS UDP消息的最大字节数。 有效值为从512到4096（超出这个范围的值将被静默地调整为范围内 最接近的值）。缺省值是4096。

这个值应用在一个服务器发出的响应；要设置请求中广告的缓存大小， 参见{\bfseries{edns-udp-size}}。

设置{\bfseries{max-udp-size}} 为非缺省值的通常的原因是为了让UDP回答穿过坏的防火墙，这样的防 火墙阻止碎包和（或）阻止大于512字节的UDP包通过。 这是独立于所广播的接收缓存 （{\bfseries{edns-udp-size}}）。

这个值设置得越小，就将得到越多的到名字服务器的TCP流量。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{masterfile-format}}}]\null{}
指定区文件的格式（参见\hyperlink{zonefile_format}{第\ref{zonefile_format}节}）。缺 省值是{\texttt{{text}}}，即标准的文本表示，除非对辅区， 对后者缺省值为{\texttt{{raw}}}。 {\texttt{{text}}}之外的文件格式一般是用 {\bfseries{named-compilezone}}工具生成，或由 {\bfseries{named}}导出。

需要注意的是， 如果一个非{\texttt{{text}}}格式的区文件被装载， {\bfseries{named}}将省略某些只对{\texttt{{text}}} 格式文件才做的检查。特别的，{\bfseries{check-names}}检 查不会应用到{\texttt{{raw}}}格式。这就意谓着 {\texttt{{raw}}}格式的区文件必须以 {\bfseries{named}}配置文件中所指定的同样检查级别来生成。 而且，{\texttt{{map}}}格式的文件通过内存映射直接装 入内存，只有最低限度的检查。

本语句为所有区设置{\bfseries{masterfile-format}}，但是 可以通过在配置文件中的{\bfseries{zone}}或 {\bfseries{view}}块中包含 {\bfseries{masterfile-format}}语句而被覆盖成以每个服务 器为基础。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{clients-per-query}}, {\bfseries{max-clients-per-query}}}]\null{}
这些设置允许同时进行的针对任何给定请求 （\textless{}qname，qtype，qclass\textgreater{}）的递归客户端的 初始数目（最小值）和最大数目，对任何超过这个数目的额外请求， 服务器都将扔掉。{\bfseries{named}}会尝试自己调整这个值， 并将改变记入日志。缺省值为10和100。

这个值应该反映自它开始解析某个名字开始的一段时间内进来了多少个 针对给定名字的请求。如果请求的数目超过这个值， {\bfseries{named}}将会假定它正在与一个无响应的区打交道， 就会扔掉多余的请求。如果它在扔掉请求后收到响应，它会调高估值。 如果没有变化，20分钟后估值会被降低。

如果{\bfseries{clients-per-query}}设为零，表示每个请求 的客户端没有限制，没有请求被扔掉。

如果{\bfseries{max-clients-per-query}}设为零，表示除了 {\bfseries{recursive-clients}}所设定的值外没有上限。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-recursion-depth}}}]\null{}
设置在提供递归请求服务时任意一个时刻允许的递归层级的 最大数目。解析一个名字时可能要求查找一个名字服务器的 地址，这会导致要求解析另外的名字，等等；如果间接查询 的次数超过了这个值，递归请求会被终止并返回SERVFAIL。 缺省是7.
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-recursion-queries}}}]\null{}
设置提供递归请求服务时可以发出的迭代查询的最大数目。 如果需要发出更多的请求，递归请求会被终止并返回 SERVFAIL。对诸如"com"和"net"等顶级域和DNS根区进行查找的请求 被豁免在这个限制之外。缺省是75。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-delay}}}]\null{}
在发送一个区的通知消息集之间的延迟，单位为秒。缺省是 五（5）秒。

所有区所发出的NOTIFY消息的整体速率是由 {\bfseries{serial-query-rate}}来控制。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-rsa-exponent-size}}}]\null{}
在验证时接受的最大RSA指数的位数。有效值是从35到4096位。 缺省值零（0）也可以接受，并且等效于4096.
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{prefetch}}}]\null{}
当收到一个有缓存且即将过期的请求，{\bfseries{named}} 可以立即从权威服务器刷新数据，确保缓存总有答复可用。

{\texttt{{prefetch}}}指定"trigger" TTL值，在这个值将 进行当前请求的预取：当一个低TTL值的缓存记录在查询过程中 遇到，它将被刷新。有效的触发TTL值是1到10秒。超过10秒的值 将被静默地减到10。 设置一个触发TTL为零（0）将关闭预取功能。 缺省的触发TTL是{\texttt{{2}}}。

一个可选的第二参数指定"eligibility" TTL：对于一个适宜预取 的记录可接受的最小{\em{original}} TTL值。 适宜TTL必须至少比触发TTL大六秒：如果不是这样， {\bfseries{named}}将静默地向大调整。 缺省的适宜TTL是{\texttt{{9}}}。
\end{description}
\subsubsection{服务器内置信息区}
\label{builtin}\hypertarget{builtin}{}%

服务器通过在伪顶级域{\texttt{{bind}}}的 {\bfseries{CHAOS}}类中的一些内置区提供了一些有用的诊断信息。 这些区是类{\bfseries{CHAOS}}中内置视图 （参见\hyperlink{view_statement_grammar}{第\ref{view_statement_grammar}节}）的一部份，与类 {\bfseries{IN}}的缺省视图是分开的。 大多数全局配置选项（{\bfseries{allow-query}}等等）将会应用到 这个视图，但是有一些是局部被覆盖的：{\bfseries{notify}}， {\bfseries{recursion}}和 {\bfseries{allow-new-zones}}总是被设置为 {\ttfamily\bfseries{{no}}}，并且{\bfseries{rate-limit}}被设置 为允许三个响应每秒。

如果你需要关掉这些区，使用下面的选项，或者通过定义一个 {\bfseries{CHAOS}}类下的匹配所有客户端的显式视图来隐藏内置的 {\bfseries{CHAOS}}视图。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{version}}}]\null{}
服务器在收到一个类型为{\bfseries{TXT}}， 类为{\bfseries{CHAOS}}， 名为{\texttt{{version.\dbz{}bind}}}的请求时应该报告的版本。 缺省是这个服务器的真实版本号。 指定{\bfseries{version none}}关掉对这个请求的处理。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{hostname}}}]\null{}
服务器在收到一个类型为{\bfseries{TXT}}， 类为{\bfseries{CHAOS}}， 名为{\texttt{{hostname.\dbz{}bind}}}的请求时应该报告的主机 名。缺省为运行名字服务器的主机名，并且可以通过gethostname() 函数查到。这个请求的主要目的是判定在一组anycast服务器中是哪一 台实际回应你的请求。指定{\bfseries{hostname none;}} 关掉对这个请求的处理。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{server-id}}}]\null{}
服务器在收到一个名字服务器标识符（Name Server Identifier, NSID） 请求，或一个类型为{\bfseries{TXT}}， 类为{\bfseries{CHAOS}}， 名为{\texttt{{ID.\dbz{}SERVER}}}的请求时应该报告其ID。 这类请求的主要目的是判定在一组anycast服务器中是 哪一台实际回应你的请求。指定 {\bfseries{server-id none;}}关掉对这个请求的处理。指定 {\bfseries{server-id hostname;}}将使 {\bfseries{named}}使用由 gethostname()函数所查到的主机名。 缺省{\bfseries{server-id}}是{\bfseries{none}}。
\end{description}
\subsubsection{内置空区}
\label{empty}\hypertarget{empty}{}%

named有一些内置空区（仅含有SOA和NS记录）。这是通常情况下只应在本地 响应而不应该发到互联网的根服务器上的请求。覆盖这些名字空间的官方服 务器会对这些请求响应NXDOMAIN。特别地，这些覆盖了来自于RFC 1918， RFC 4193，RFC 5737和RFC 6598。这些也包含IPv6本地地址（本地分配的） 的反向名字空间，IPv6链路本地地址，IPv6环回地址和IPv6未知地址。

named将试图决定是否一个内置区已经存在或者是激活的（被一个 forward-only的转发定义所覆盖），并且在此情况不会创建一个空区。

当前的空区列表为： 
\begin{itemize}
%--- Item
\item 10.IN-ADDR.ARPA

%--- Item
\item 16.172.IN-ADDR.ARPA

%--- Item
\item 17.172.IN-ADDR.ARPA

%--- Item
\item 18.172.IN-ADDR.ARPA

%--- Item
\item 19.172.IN-ADDR.ARPA

%--- Item
\item 20.172.IN-ADDR.ARPA

%--- Item
\item 21.172.IN-ADDR.ARPA

%--- Item
\item 22.172.IN-ADDR.ARPA

%--- Item
\item 23.172.IN-ADDR.ARPA

%--- Item
\item 24.172.IN-ADDR.ARPA

%--- Item
\item 25.172.IN-ADDR.ARPA

%--- Item
\item 26.172.IN-ADDR.ARPA

%--- Item
\item 27.172.IN-ADDR.ARPA

%--- Item
\item 28.172.IN-ADDR.ARPA

%--- Item
\item 29.172.IN-ADDR.ARPA

%--- Item
\item 30.172.IN-ADDR.ARPA

%--- Item
\item 31.172.IN-ADDR.ARPA

%--- Item
\item 168.192.IN-ADDR.ARPA

%--- Item
\item 64.100.IN-ADDR.ARPA

%--- Item
\item 65.100.IN-ADDR.ARPA

%--- Item
\item 66.100.IN-ADDR.ARPA

%--- Item
\item 67.100.IN-ADDR.ARPA

%--- Item
\item 68.100.IN-ADDR.ARPA

%--- Item
\item 69.100.IN-ADDR.ARPA

%--- Item
\item 70.100.IN-ADDR.ARPA

%--- Item
\item 71.100.IN-ADDR.ARPA

%--- Item
\item 72.100.IN-ADDR.ARPA

%--- Item
\item 73.100.IN-ADDR.ARPA

%--- Item
\item 74.100.IN-ADDR.ARPA

%--- Item
\item 75.100.IN-ADDR.ARPA

%--- Item
\item 76.100.IN-ADDR.ARPA

%--- Item
\item 77.100.IN-ADDR.ARPA

%--- Item
\item 78.100.IN-ADDR.ARPA

%--- Item
\item 79.100.IN-ADDR.ARPA

%--- Item
\item 80.100.IN-ADDR.ARPA

%--- Item
\item 81.100.IN-ADDR.ARPA

%--- Item
\item 82.100.IN-ADDR.ARPA

%--- Item
\item 83.100.IN-ADDR.ARPA

%--- Item
\item 84.100.IN-ADDR.ARPA

%--- Item
\item 85.100.IN-ADDR.ARPA

%--- Item
\item 86.100.IN-ADDR.ARPA

%--- Item
\item 87.100.IN-ADDR.ARPA

%--- Item
\item 88.100.IN-ADDR.ARPA

%--- Item
\item 89.100.IN-ADDR.ARPA

%--- Item
\item 90.100.IN-ADDR.ARPA

%--- Item
\item 91.100.IN-ADDR.ARPA

%--- Item
\item 92.100.IN-ADDR.ARPA

%--- Item
\item 93.100.IN-ADDR.ARPA

%--- Item
\item 94.100.IN-ADDR.ARPA

%--- Item
\item 95.100.IN-ADDR.ARPA

%--- Item
\item 96.100.IN-ADDR.ARPA

%--- Item
\item 97.100.IN-ADDR.ARPA

%--- Item
\item 98.100.IN-ADDR.ARPA

%--- Item
\item 99.100.IN-ADDR.ARPA

%--- Item
\item 100.100.IN-ADDR.ARPA

%--- Item
\item 101.100.IN-ADDR.ARPA

%--- Item
\item 102.100.IN-ADDR.ARPA

%--- Item
\item 103.100.IN-ADDR.ARPA

%--- Item
\item 104.100.IN-ADDR.ARPA

%--- Item
\item 105.100.IN-ADDR.ARPA

%--- Item
\item 106.100.IN-ADDR.ARPA

%--- Item
\item 107.100.IN-ADDR.ARPA

%--- Item
\item 108.100.IN-ADDR.ARPA

%--- Item
\item 109.100.IN-ADDR.ARPA

%--- Item
\item 110.100.IN-ADDR.ARPA

%--- Item
\item 111.100.IN-ADDR.ARPA

%--- Item
\item 112.100.IN-ADDR.ARPA

%--- Item
\item 113.100.IN-ADDR.ARPA

%--- Item
\item 114.100.IN-ADDR.ARPA

%--- Item
\item 115.100.IN-ADDR.ARPA

%--- Item
\item 116.100.IN-ADDR.ARPA

%--- Item
\item 117.100.IN-ADDR.ARPA

%--- Item
\item 118.100.IN-ADDR.ARPA

%--- Item
\item 119.100.IN-ADDR.ARPA

%--- Item
\item 120.100.IN-ADDR.ARPA

%--- Item
\item 121.100.IN-ADDR.ARPA

%--- Item
\item 122.100.IN-ADDR.ARPA

%--- Item
\item 123.100.IN-ADDR.ARPA

%--- Item
\item 124.100.IN-ADDR.ARPA

%--- Item
\item 125.100.IN-ADDR.ARPA

%--- Item
\item 126.100.IN-ADDR.ARPA

%--- Item
\item 127.100.IN-ADDR.ARPA

%--- Item
\item 0.IN-ADDR.ARPA

%--- Item
\item 127.IN-ADDR.ARPA

%--- Item
\item 254.169.IN-ADDR.ARPA

%--- Item
\item 2.0.192.IN-ADDR.ARPA

%--- Item
\item 100.51.198.IN-ADDR.ARPA

%--- Item
\item 113.0.203.IN-ADDR.ARPA

%--- Item
\item 255.255.255.255.IN-ADDR.ARPA

%--- Item
\item 0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA

%--- Item
\item 1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.IP6.ARPA

%--- Item
\item 8.B.D.0.1.0.0.2.IP6.ARPA

%--- Item
\item D.F.IP6.ARPA

%--- Item
\item 8.E.F.IP6.ARPA

%--- Item
\item 9.E.F.IP6.ARPA

%--- Item
\item A.E.F.IP6.ARPA

%--- Item
\item B.E.F.IP6.ARPA
\end{itemize}


可以在视图一级设置空区，并且只应用到IN类的视图。仅当没有在视图一级 指定被禁止的空区时，被禁止的空区才派生自options。要重载被禁止区的选 项列表，你需要在视图一级禁止根区，例如： 
\begin{Verbatim}[]

            disable-empty-zone ".";

\end{Verbatim}


如果你正在使用这里所列的地址范围，你应该已经有反向区来覆盖你所用的 地址。在实际中，不会出现这样的情况，即许多请求发向基础的服务器来查 找这个空间中的名字。在实际情况中有太多这样的情况，需要部署牺牲服务 器来将查询负载从基础服务器引导出来。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
在这些区的真实的上级服务器中，应该禁止其下的所有空区。对真正的根服 务器，这都是内建空区。这使它们能够返回树中对更深一级的引用。\end{admonition}


\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{empty-server}}}]\null{}
指定出现在空区的SOA记录中的服务器名字。如果未指定， 就使用区的名字。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{empty-contact}}}]\null{}
指定出现在空区的SOA记录中的联系人名字。如果未指定， 就使用“.”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{empty-zones-enable}}}]\null{}
打开或关闭所有的空区。缺省是打开的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{disable-empty-zone}}}]\null{}
关闭单独的空区。缺省没有空区是关闭的。这个选项可以多次指定。
\end{description}
\subsubsection{附加部份缓存}
\label{acache}\hypertarget{acache}{}%

附加部份缓存，也叫做{\bfseries{acache}}，是一个为了提高BIND 9 响应性能的内部缓存。当打开附加部份缓存时，BIND 9将为每个答案部份的 资源记录而在附加部份的内容中缓存一个内部缩写。注意 {\bfseries{acache}}是一个BIND 9的内部缓存机制， 与DNS的缓存服务器功能没有关系。

附加部份缓存不改变响应内容（附加部份的资源记录集的顺序除外，参见下 文），但是可以极大地提高响应的性能。特别是在BIND 9作为一个带有许多 授权，并且每个授权都有多个粘连资源记录的区的权威服务器的情况下。

为了从附加部份缓存获得最大的性能提升，推荐将 {\bfseries{additional-from-cache}}设置为 {\bfseries{no}}，因为当前的{\bfseries{acache}}实现 没有缩小来自DNS缓存数据的附加部份信息。

{\bfseries{acache}}的一个明显的缺点是它需要更多的内存空间来存 放内部缓存数据。然而，如果响应性能不明显并且内存消耗更关键时，可以 通过将{\bfseries{acache-enable}}设置为{\bfseries{no}}来 关掉{\bfseries{acache}}机制。也可以通过使用 {\bfseries{max-acache-size}}来指定内存消耗的上限。

附加部份缓存对附加部份中的资源记录集的顺序也有一点点影响。没有 {\bfseries{acache}}的情况下，{\bfseries{cyclic}}顺序对 附加部份也有效，就象其对答案和权威部份一样。然而，附加部份缓存将会 在它第一次缓存一个资源记录集时固定其顺序，在后续的响应中将保持同样 的顺序，而忽略{\bfseries{rrset-order}}的设置。这样做的影响应 该较小，另外，由于附加部份的一个资源记录集典型情况下只包含很小数目 的资源记录（在许多情况它只包含一个资源记录），这样情况下顺序就没有 什么影响了。

以下是与{\bfseries{acache}}相关的选项的概括。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{acache-enable}}}]\null{}
如果设为{\bfseries{yes}}，打开附加部份缓存。 缺省值是{\bfseries{no}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{acache-cleaning-interval}}}]\null{}
服务器将去掉陈旧的缓存条目，这个操作基于LRU算法，每 {\bfseries{acache-cleaning-interval}}分钟一次。缺省是60 分钟。如果设为0，不做定期清理。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-acache-size}}}]\null{}
服务器用于acache的内存的最大字节数。当acache中的数据量达到这 个限制时，服务器将会主动地进行清理以保证不超过限额。在有多个 视图的服务器上，acache的限额单独应用在各个视图上。缺省是 {\texttt{{16M}}}。
\end{description}
\subsubsection{内容过滤}
\label{idm178371257568}\hypertarget{idm178371257568}{}%

BIND 9提供了过滤来自外部DNS服务器的， 在回答部份包含某种类型数据的DNS响应的能力。 特别地，如果相关的IPv4或IPv6地址与 {\bfseries{deny-answer-addresses}}所给出的 {\texttt{{address\_match\_list}}}匹配，它可以拒绝 地址（A或者AAAA）记录。 它也可以拒绝CNAME或DNAME记录，如果“别名”（即CNAME 别名或由于DNAME而被替换的请求名）与 {\bfseries{deny-answer-aliases}}选项所给出的 {\texttt{{namelist}}}匹配时，这里所指的“匹配” 表示别名是{\texttt{{name\_list}}}中一个元素的 一个子域。 如果伴随{\bfseries{except-from}}指定了可选的 {\texttt{{namelist}}}，请求名与列表匹配的记录也会 被接受，而不考虑过滤设置。 同样地，如果别名是相应区的一个子域， {\bfseries{deny-answer-aliases}}过滤器也不会生效； 例如，即使给{\bfseries{deny-answer-aliases}} 指定了“example.com”，

\begin{Verbatim}[]
www.example.com. CNAME xxx.example.com.
\end{Verbatim}

来自一个“example.com”服务器的响应也会被接受。

在{\bfseries{deny-answer-addresses}}选项的 {\texttt{{address\_match\_list}}}中，只有 {\texttt{{ip\_addr}}}和 {\texttt{{ip\_prefix}}}有意义；任何 {\texttt{{key\_id}}}将会被默默地忽略。

如果一个响应消息因为过滤而被拒绝，整个消息将会被丢弃 并且不会缓存，还会返回一个SERVFAIL错误给客户端。

这个过滤器是为了阻止“DNS重绑定攻击”，在这种攻击中，攻击者 对查询一个攻击者所控制的域名的请求，返回一个你自己网络内的 IP地址或者一个你自己域内的一个别名。 一个幼稚的网页浏览器或者脚本可能无意会充当代理，会让 攻击者访问你的局域网络中的内部节点，而这本不是外部 所能够访问到的。 关于这个攻击更详细的内容参见 http://portal.acm.org/citation.cfm?id=1315245.1315298 {\textless}\url{http://portal.acm.org/citation.cfm?id=1315245.1315298}{\textgreater} 处的论文。

例如，如果你拥有一个域名“example.net”并且你的内部网络 使用192.0.2.0/24的IPv4前缀，你可能设定如下规则：

\begin{Verbatim}[]
deny-answer-addresses { 192.0.2.0/24; } except-from { "example.net"; };
deny-answer-aliases { "example.net"; };

\end{Verbatim}

如果一个外部攻击者让你局域网内的一个网页浏览器查找 “attacker.example.com”的IPv4地址，攻击者的DNS服务器会 返回一个在回答部份中有像这样记录的响应：

\begin{Verbatim}[]
attacker.example.com. A 192.0.2.1
\end{Verbatim}

由于这个记录（IPv4地址）的rdata与所设定的前缀192.0.2.0/24 匹配，这个响应将会被忽略。

另一方面，如果浏览器查找一个合法的内部web服务器 “www.example.net”并且下列响应被返回给 BIND 9服务器

\begin{Verbatim}[]
www.example.net. A 192.0.2.2
\end{Verbatim}

这个响应会被接受，因为属主名“www.example.net”与 {\bfseries{except-from}}的设置“example.net”匹配。

注意这个本身并非真正是对DNS的攻击。实际上，一个“外部的” 名字映射到你“内部的”IP地址或者来自一个视图点上的域名 没有任何错误。 它实际上可能被用作合法目的，例如调试。 由于这个映射表是由正确的属主所提供的，在DNS中检测这个映射的 目的是否合法就是不可能的或者是没有意义的。 “重绑定”攻击首先必须由使用DNS的应用进行防护。然而，对一个 大的站点，立即保护所有可能的应用是很困难的。 提供这个过滤特征仅仅是为了对这种运行环境有所帮助； 通常是不鼓励打开这个功能，除非你很清楚没有其它的选择，并且 攻击对你的应用而言是一个现实的威胁。

如果你想在地址段127.0.0.0/8中使用这个选项，就需要特别小心。 这些地址显然是“内部的”地址，但是许多应用传统上依赖DNS将 某些名字映射到这样的地址。 过滤包含这类地址的DNS记录可能会破坏这类应用。
\subsubsection{响应策略区（RPZ）重写}
\label{idm178371237520}\hypertarget{idm178371237520}{}%

BIND 9包含了一个限制机制，它修改请求 的DNS响应，类似于电子邮件中的反垃圾邮件DNS黑名单。响应 可以被修改成某个域名不存在（NXDOMAIN），某个域名的IP地址不存在 （NODATA），或者包含其它的IP地址或数据。

响应策略区在视图中的{\bfseries{response-policy}}选项中 命名，或者当视图中没有response-policy选项时在全局选项中命名。 响应策略区是普通的DNS区，包含资源记录集， 在允许时可以进行普通的查询。 通常最好使用某些规则限制那些请求，如： {\bfseries{allow-query \{ localhost; \};}}。

{\bfseries{response-policy}}选项可以支持多个策略区。 为最大化性能，使用一个基数树来快速识别包含与当前查询匹配的触发器 的响应策略区。这强制一个{\bfseries{response-policy}}选项中 策略区的数量上限为32；超过那个数就是一个配置错误。

在RPZ记录中可以编码五种策略触发器。 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RPZ-CLIENT-IP}}}]\null{}
IP记录由DNS客户端的IP地址触发。 客户端IP地址触发器被编码到的记录中，其属主名是 {\ttfamily\bfseries{{rpz-\dbz{}client-\dbz{}ip}}}的子域名，它相对于 策略区原点名字，并编码一个地址或地址块。 IPv4地址被表示为 {\ttfamily\bfseries{{prefixlength.\dbz{}B4.\dbz{}B3.\dbz{}B2.\dbz{}B1.\dbz{}rpz-\dbz{}ip}}}。 IPv4前缀长度必须在1和32之间。 所有四个字节，B4，B3，B2和B1，都必须出现。 B4是IPv4地址中的最低字节的十进制数值，如同在IN-ADDR.ARPA 中一样。

IPv6被编码成类似于标准的IPv6文本表示格式， {\ttfamily\bfseries{{prefixlength.\dbz{}W8.\dbz{}W7.\dbz{}W6.\dbz{}W5.\dbz{}W4.\dbz{}W3.\dbz{}W2.\dbz{}W1.\dbz{}rpz-\dbz{}ip}}}。 W8，...，W1中的每个都是一个一到四位的十六进制数，表示IPv6 地址中的16位，如同IPv6地址的标准文本表示法，但是是如同 IN-ADDR.ARPA中的反向表示的。 所有的8个双字节都必须出现，除非一个连续值为零的双字节集合， 后者被替换为{\ttfamily\bfseries{{.\dbz{}zz.\dbz{}}}}，类似于标准IPv6文本 编码中的双冒号（::）。 IPv6前缀长度必须在64和128之间。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{QNAME}}}]\null{}
QNAME策略记录由请求中的请求名所触发，并且CNAME记录所指向的 目标被解析用以生成响应。 一个QNAME策略记录的属主名是与策略区相对的请求名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RPZ-IP}}}]\null{}
IP触发器是一个响应中ANSWER部份中的一个A或AAAA记录中的 IP地址。 它们被编码成类似客户端IP触发器，除了作为 {\bfseries{rpz-ip}}的子域名之外。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RPZ-NSDNAME}}}]\null{}
NSDNAME触发器用权威服务器的名字去匹配请求名，一个请求名的 父域，一个请求名的CNAME或者一个CNAME的父域。它们被编码成 相对于RPZ原点的{\ttfamily\bfseries{{rpz-\dbz{}nsdname}}}的子域名。 NSIP触发器用A和AAAA资源记录集中的IP地址匹配域名，后者可以与 NSDNAME策略记录比对。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RPZ-NSIP}}}]\null{}
NSIP触发器被编码成类似IP触发器，除了作为 {\ttfamily\bfseries{{rpz-\dbz{}nsip}}}的子域名之外。 NSDNAME和NSIP触发器仅在名字至少带有 {\bfseries{min-ns-dots}}个点时才被检查。 对非顶级域，{\bfseries{min-ns-dots}}的缺省值是1。
\end{description}


查询响应将与所有响应策略区进行比对，所以两条或多条策略记录可以被 一条响应所触发。由于DNS响应根据至多一条策略记录被重写，必须选择一条 策略编码一个动作（除{\bfseries{DISABLED}}策略之外）。 以下列顺序为重写选择编码它们的触发器或记录： 
\begin{itemize}
%--- Item
\item 选择区中最先在{\bfseries{response-policy}}选项中 出现的触发器记录。

%--- Item
\item 在单个区中，按CLIENT-IP，QNAME，IP，NSDNAME，NSIP的顺序 使用触发器。

%--- Item
\item 在NSDNAME触发器中，优先使用匹配DNSSEC顺序下最小名字的 触发器。

%--- Item
\item 在IP或者NSIP触发器之间，优先选择具有最长前缀的触发器。

%--- Item
\item 在带有相同前缀长度的触发器之间，优先选择匹配最小IP地址 的IP或NSIP触发器。
\end{itemize}


当一个响应的处理被重新开始解析DNAME或CNAME记录并且没有策略记录被 触发，所有的响应策略区被重新针对DNAME或者CNAME名字和地址查找。

RPZ记录集是除了DNAME或DNSSEC之外的任何类型的DNS记录，它编码了 针对请求的动作或响应。 任何策略可以于任何触发器一起使用。例如， {\bfseries{TCP-only}}策略通常与 {\bfseries{client-IP}}触发器一起使用，但它也可以与任意 其它类型的触发器一起使用，并强制一个区中对属主名的响应使用TCP。 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{PASSTHRU}}}]\null{}
白名单策略由一个目标为{\bfseries{rpz-passthru}}的 CNAME所指定。 它使响应不被重写，通常用于在CIDR块的策略中"挖出小洞"。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{DROP}}}]\null{}
黑名单策略由一个目标为{\bfseries{rpz-drop}}的 CNAME所指定。 它使响应被丢弃。不发送任何响应给DNS客户端。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{TCP-Only}}}]\null{}
"slip"策略由一个目标为{\bfseries{rpz-tcp-only}}的 CNAME所指定。 它修改UDP响应为短小的、被截断的DNS响应，要求DNS客户端使用 TCP重试。 它用于缓解分布式DNS反射攻击。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{NXDOMAIN}}}]\null{}
未定义域名响应由一个目标为根域（.）的CNAME编码。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{NODATA}}}]\null{}
资源记录的空集由目标为通配顶级域（*.）的CNAME指定。 它重写响应为NODATA或ANCOUNT=1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{Local Data}}}]\null{}
一个普通DNS记录所组成的集合可以用于回答请求。 请求不在集合中的记录类型将会得到NODATA应答。

本地数据的一个特殊形式是一条目标为一个通配符，如 *.example.com，的CNAME。 它通常被用作一个普通的CNAME，在星号（*）被请求名替换之后。 这个特殊形式的目的是在围墙花园（原文：walled garden）内的 权威DNS服务器上作请求日志。
\end{description}

 一个使用由另一个组织所提供的RPZ的组织可以使用这个机制来重定向域名 到它自己的围墙花园。 
在一个策略区中所有由全部单个记录指定的动作可以被 {\bfseries{response-policy}}选项中的 {\bfseries{policy}}字句所覆盖。 一个使用由另一个组织所提供的策略区的组织可以使用这个机制来重定向 域名到它自己的围墙花园。 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{GIVEN}}}]\null{}
站位符策略表示"不覆盖但是执行区中所指定的动作。"
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{DISABLED}}}]\null{}
测试覆盖策略导致策略区记录不做任何事情，但是记录如果策略区 未被关闭时可能做的事情。 对DNS请求的应答将根据任何被触发的未被关闭的策略记录被重写 （或不被重写）。 关闭的策略区应放在最前面，因为如果一个更高优先级的触发器 在前面时，它们通常都不会被记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{PASSTHRU}}, {\bfseries{DROP}}, {\bfseries{TCP-Only}}, {\bfseries{NXDOMAIN}}, {\bfseries{NODATA}}}]\null{}
使用对应的每记录策略覆盖。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{CNAME domain}}}]\null{}
导致所有RPZ策略记录表现为好像它们是"cname domain"记录。
\end{description}


缺省时，在一个响应策略区中编码的动作仅应用到要求递归（RD=1）的请求。 这个缺省可以在一个视图中使用一条 {\bfseries{recursive-only no}}子句为一个策略区或全部 响应策略区而被改变。 这个特性在下面的情况很有用，在一个RFC 1918云的内部和外部有同样的 区文件，并使用RPZ来删除外部可见的名字服务器或视图上可能包含的 RFC 1918值。

同样缺省的是，RPZ动作仅应用于那些要么不要求DNSSEC元数据（DO=0）， 要么在原始区中没有请求名的DNSSEC记录的DNS请求中。 这个缺省可以在一个视图中使用{\bfseries{break-dnssec yes}} 子句而对所有响应策略区被改变。 在这种情况下，RPZ动作被应用而不考虑DNSSEC。子句选项的名字反映了 被RPZ动作所重写的结果不能被验证的事实。

对一个QNAME或Client-IP触发器，不需要DNS记录。 名字或者IP地址自身就已足够，所以原则上请求名不需要被递归解析。 但是，不解析请求名可能泄漏使用了策略区重写和名字被列入一个策略区 的事实给所列名字的服务器的操作者。 为阻止这个信息泄漏，缺省一个请求所需的任何递归查询都在任何策略 触发器被考虑之前完成。因为列出的域名通常有较慢的权威服务器，这个 缺省行为可能花费大量时间。 当递归查询不能改变一个非错响应时， {\bfseries{qname-wait-recurse no}}选项覆盖缺省行为。 这个选项不影响列在其它包含IP，NSIP和NSDNAME触发器的区之后的策略区中 的QNAME或client-IP触发器，因为那些（触发器）可能依赖在递归解析中会被 发现的A，AAAA和NS记录。 它也不影响DNSSEC请求（DO=1），除非使用了 {\bfseries{break-dnssec yes}}，因为响应会依赖解析中是否发现了 RRSIG记录。 使用这个选项可能导致诸如出现SERVFAIL的错误响应被重写，由于没有 递归查询被完成，以发现权威服务器中的问题。

一个被RPZ策略所修改的记录的TTL根据策略区中相关记录的TTL来设置。 它被限制为一个最大值。 {\bfseries{max-policy-ttl}}子句从其缺省值5改变那个最大值。

例如，你可能使用这个选项语句

\begin{Verbatim}[]
    response-policy { zone "badlist"; };
\end{Verbatim}

和这个区语句

\begin{Verbatim}[]
    zone "badlist" {type master; file "master/badlist"; allow-query {none;}; };
\end{Verbatim}

以及这个区文件

\begin{Verbatim}[]
$TTL 1H
@                       SOA LOCALHOST. named-mgr.example.com (1 1h 15m 30d 2h)
                        NS  LOCALHOST.

; QNAME policy records.  There are no periods (.) after the owner names.
nxdomain.domain.com     CNAME   .               ; NXDOMAIN policy
*.nxdomain.domain.com   CNAME   .               ; NXDOMAIN policy
nodata.domain.com       CNAME   *.              ; NODATA policy
*.nodata.domain.com     CNAME   *.              ; NODATA policy
bad.domain.com          A       10.0.0.1        ; redirect to a walled garden
                        AAAA    2001:2::1
bzone.domain.com        CNAME   garden.example.com.

; do not rewrite (PASSTHRU) OK.DOMAIN.COM
ok.domain.com           CNAME   rpz-passthru.

; redirect x.bzone.domain.com to x.bzone.domain.com.garden.example.com
*.bzone.domain.com      CNAME   *.garden.example.com.


; IP policy records that rewrite all responses containing A records in 127/8
;       except 127.0.0.1
8.0.0.0.127.rpz-ip      CNAME   .
32.1.0.0.127.rpz-ip     CNAME   rpz-passthru.

; NSDNAME and NSIP policy records
ns.domain.com.rpz-nsdname   CNAME   .
48.zz.2.2001.rpz-nsip       CNAME   .

; blacklist and whitelist some DNS clients
112.zz.2001.rpz-client-ip    CNAME   rpz-drop.
8.0.0.0.127.rpz-client-ip    CNAME   rpz-drop.

; force some DNS clients and responses in the example.com zone to TCP
16.0.0.1.10.rpz-client-ip   CNAME   rpz-tcp-only.
example.com                 CNAME   rpz-tcp-only.
*.example.com               CNAME   rpz-tcp-only.


\end{Verbatim}

RPZ会影响服务器性能。每个已配置的响应策略区都会使一个请求被回答前 要求服务器执行一到四次额外的数据库查找。 例如，一个DNS服务器有四个策略区，每个有四种类型的响应触发器， QNAME，IP，NSIP和NSDNAME，会要求进行相当于一个没有响应策略区的普通 DNS服务器17倍的数据库查找。 一个BIND9服务器，带有足够内存和一个带QNAME和IP 触发器的响应策略区可能比最大每秒请求数下降约20\%。一个有四个带 QNAME和IP触发器的响应策略区的服务器可能比最大QPS下降约50\%。

由RPZ所重写的响应在{\bfseries{RPZRewrites}}统计中被计数。
\subsubsection{响应比率限制}
\label{idm178371167312}\hypertarget{idm178371167312}{}%

过多的几乎同样的UDP{\em{responses}}可以通过在一个 {\bfseries{options}}或{\bfseries{view}}语句中 配置{\bfseries{rate-limit}}子句来控制。 这个机制使权威的BIND 9免于被用于放大反射拒绝服务（DoS）攻击。 可以通过发送短截断（TC=1）响应来提供按比率限制的响应给位于一个 伪造的、受攻击的IP地址范围中的合法客户端。 合法的客户端对丢弃或截断响应的反应分别是使用UDP或TCP重试。

这个机制目的是用于权威DNS服务器。它也可以用于递归服务器但会减慢 诸如SMTP服务器（邮件接收者）和HTTP客户端（web浏览器）这些反复请求 同一个域的应用。 在可能情况下，关闭“公开”递归服务器是更好的选择。

响应比率限制使用一个“信用（credit）”或“代价桶（token bucket）” 方案。每个同一响应和客户端的组合有一个概念上的帐号，会每秒挣得 一个特定数目的信用值。 一个预期的的响应将会从其帐号上减一。 当帐号是负值时，响应将被丢弃或者被截断。 响应在一个缺省值为15秒的时间轮转窗口中被跟踪，窗口大小可以使用 {\bfseries{window}}选项配置为从1到3600秒（1小时）之间的 任意值。 帐号不能大于每秒限制值或者小于{\bfseries{window}}乘以每秒 限制值。 当一类响应的指定信用值被设为0，这些响应没有比率限制。

对比率限制中的“同一响应（identical response）”和“DNS客户端” 的概念是不能简单化理解的。 所有到一个地址块的响应被统计为如同到一个单一地址。 地址块的前缀长度由{\bfseries{ipv4-prefix-length}} （缺省24）和{\bfseries{ipv6-prefix-length}}（缺省56）指定。

所有针对一个有效域名（qname）和记录类型（qtype）的非空响应都是 相同的，有一个由{\bfseries{responses-per-second}}指定的 限制(缺省为0或没有限制)。 所有针对一个有效域名，不管其请求类型的空（NODATA）响应也是相同的。 NODATA这一类响应被{\bfseries{nodata-per-second}}所限制 （缺省是{\bfseries{responses-per-second}}）。 对一个给定的有效域名的任何及所有未定义的子域的请求而产生的 NXDOMAIN错误，不考虑请求类型，都是同一的。 它们由{\bfseries{nxdomains-per-second}}限制 （缺省基于{\bfseries{responses-per-second}}）。 这控制某些使用随机域名的攻击，但能够在期望许多合法NXDOMAIN响应 的服务器上被放松或关闭（设置为0），例如来自反垃圾黑名单。 指向或授权到一个给定域名的服务器都是同一的并可以被 {\bfseries{referrals-per-second}}所限制 （缺省是{\bfseries{responses-per-second}}）。

由本地通配符产生的响应被计数并限制，如同对于其父域名一样。 这个用于控制random.wild.example.com（译注：随机通配符域名）的泛洪。

所有导致DNS错误，例如SERVFAIL和FORMERR，而不是NXDOMAIN的请求都是 相同的，而不考虑请求名（qname）或记录类型（qtype）。这控制使用 无效请求或使用陌生、缺陷权威服务器的攻击。 缺省时，对错误的限制与{\bfseries{responses-per-second}}值 一致，但它也可以被独立地使用{\bfseries{errors-per-second}} 设置。

许多利用DNS的攻击涉及伪造源地址的UDP请求。 比率限制阻止利用BIND 9由于对伪造源地址请求的响应而对一个网络进行 泛洪攻击，但是可以让一个第三方阻塞对合法请求响应。 有一个机制可以回复一些来自一个其地址被伪造而用于泛洪攻击的客户端的 合法请求。 设置{\bfseries{slip}}为2（其缺省值）将使每隔一个UDP请求在回复 时带有一个小截断（TC=1）响应。 “slipped”响应的大小较小且缩小了频率，就缺乏放大效应，使其对反射 DoS攻击没有吸引力。 {\bfseries{slip}}必须介于0到10之间。 值为0表示不“slip”：因比率限制而不发出被截断的响应，所有响应都不丢弃。 值为1使每个响应都slip； 值为2到10之间使每N个响应slip一次。 一些错误响应包括REFUSE和SERVFAIL不能被替代成截断的响应， and are instead leaked 以{\bfseries{slip}}比率。

（注意：从一个权威服务器丢弃响应可能减小一个第三方成功伪造响应到 一个递归解析器的难度。针对伪造响应的最安全方法，对权威服务器的 操作者而言是使用DNSSEC签名自己的区，对递归服务器的操作者而言是验证 响应。当这不是一个可选项时，对更关心响应完整性而不是缓解泛洪攻击的 操作者，可以考虑设置{\bfseries{slip}}为1，将使所有比率限制 响应都被截断而不是被丢弃。这就减小了针对反射攻击的比率限制的效果。)

当大致的每秒请求率超过了{\bfseries{qps-scale}}值， {\bfseries{responses-per-second}}， {\bfseries{errors-per-second}}， {\bfseries{nxdomains-per-second}}和 {\bfseries{all-per-second}}的值就减小一个比率，即当前比率比 {\bfseries{qps-scale}}。 这个特性可以在攻击时增强抵抗能力。 例如，设置 {\bfseries{qps-scale 250; responses-per-second 20;}}并且一个 包含TCP的所有DNS客户端的所有请求的总请求率为1000次请求/秒，这时的 '有效响应/秒'限制变为(250/1000)*20或5。 通过TCP发送的响应不会被限制，但是会被计数，以计算每秒请求率。

DNS客户端社区可以给出其自身的参数，或完全没有比率限制，即将 {\bfseries{rate-limit}}语句放入{\bfseries{view}}语句中 而不是{\bfseries{option}}中。 一个视图中的{\bfseries{rate-limit}}语句是替代而不是增补了 主配置中的{\bfseries{rate-limit}}语句。 在一个视图中的DNS客户端可以通过{\bfseries{exempt-clients}} 子句免出比率限制。

所有类型的UDP响应可以由{\bfseries{all-per-second}}短句限制。 这个比率限制不同于在一个DNS服务器上由 {\bfseries{responses-per-second}}， {\bfseries{errors-per-second}}和 {\bfseries{nxdomains-per-second}}所提供的比率限制，后者 通常都是DNS反射攻击的受害者所看不到的。 除非攻击者伪造的请求与受害者的合法请求完全一致，受害者的请求是不受 影响的。 受一个{\bfseries{all-per-second}}限制影响的响应总是被丢弃； {\bfseries{slip}}值没有任何效果。 一个{\bfseries{all-per-second}}限制至少是其它限制的4倍大， 因为单一的DNS客户端通常爆发出合法的请求。 例如，在考虑到进入的SMTP/TCP/IP连接时，单个邮件消息的接收者可能 产生来自一个SMTP服务器的对NS，PTR，A和AAAA记录的请求。 这个SMTP服务器在它考虑SMTP的{\bfseries{Mail From}}命令时， 可能需要额外的NS，A，AAAA，MX，TXT和SPF记录。 Web浏览器通常重复地解析在一页的HTML \textless{}IMG\textgreater{}标签中重复出现的 同样名字。 {\bfseries{All-per-second}}类似于防火墙所提供的比率限制， 但通常不如后者。 Attacks that justify ignoring the contents of DNS responses are likely to be attacks on the DNS server itself. 它们通常应该在DNS服务器花费资源建立TCP连接或分析DNS请求之前被 丢弃，但是比率限制必须在DNS服务器见到请求之前完成。

用于跟踪请求和比率限制响应的表的最大大小，通过 {\bfseries{max-table-size}}设置。 表中每个条目介于40到80字节之间。 表中需要的条目数大致是每秒收到的请求数。 缺省是20,000。 为减小冷启动时的表增长，{\bfseries{min-table-size}} （缺省是500）可以设置最小的表大小。 打开{\bfseries{rate-limit}}类日志以监控表的增长并获取关于 选择表大小初始值和最大值的信息。

使用{\bfseries{log-only yes}}测试比率限制参数而不会实际丢掉 任何请求。

被比率限制所丢弃的响应被包含在{\bfseries{RateDropped}}和 {\bfseries{QryDropped}}统计中。 被比率限制所截断的响应被包含在{\bfseries{RateSlipped}}和 {\bfseries{RespTruncated}}统计中。
\subsection{{\bfseries{server}}语句语法}
\label{server_statement_grammar}\hypertarget{server_statement_grammar}{}%

\begin{Verbatim}[]
server ip_addr[/prefixlen] {
    [ bogus yes_or_no ; ]
    [ provide-ixfr yes_or_no ; ]
    [ request-ixfr yes_or_no ; ]
    [ request-nsid yes_or_no ; ]
    [ request-sit yes_or_no ; ]
    [ edns yes_or_no ; ]
    [ edns-udp-size number ; ]
    [ nosit-udp-size number ; ]
    [ max-udp-size number ; ]
    [ transfers number ; ]
    [ transfer-format ( one-answer | many-answers ) ; ]]
    [ keys { string ; [ string ; [...]] } ; ]
    [ transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ transfer-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ notify-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ notify-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ query-source [ address ( ip_addr | * ) ]
                  [ port ( ip_port | * ) ] [dscp ip_dscp] ; ]
    [ query-source-v6 [ address ( ip_addr | * ) ]
                     [ port ( ip_port | * ) ] [dscp ip_dscp] ; ]
    [ use-queryport-pool yes_or_no; ]
    [ queryport-pool-ports number; ]
    [ queryport-pool-updateinterval number; ]
};

\end{Verbatim}
\subsection{{\bfseries{server}}语句定义和用法}
\label{server_statement_definition_and_usage}\hypertarget{server_statement_definition_and_usage}{}%

{\bfseries{server}}语句定义与一个远程名字服务器相关的特性。如 果指定一个前缀长度，就覆盖一个范围的服务器。只有最特定的server子句 应用不考虑在{\texttt{{named.\dbz{}conf}}}中的顺序。

{\bfseries{server}}语句可以出现在配置文件的顶级，也可以在一个 {\bfseries{view}}语句中。如果一个{\bfseries{view}}语句 中包含一个或多个{\bfseries{server}}语句时，只有这些会应用到视 图中，而任何顶级的都被忽略。如果一个视图不包含 {\bfseries{server}}语句，任何顶级{\bfseries{server}}语 句都作为缺省使用。

如果你发现一个远程服务器发出错误的数据，将其标志为bogus而阻止再发请 求给它。{\bfseries{bogus}}的缺省值是{\bfseries{no}}。

{\bfseries{provide-ixfr}}子句决定本地服务器在作为主服务器时， 当远程服务器，一个辅服务器请求时是否使用一个增量区传送进行应答。如 果设为{\bfseries{yes}}，无论何时都提供增量区传送。如果设为 {\bfseries{no}}，所有到远程服务器的区传送都不会使用增量方式。 如果未设置，就使用视图或者全局选项块中的 {\bfseries{provide-ixfr}}选项值作为缺省值。

{\bfseries{request-ixfr}}子句决定本地服务器，作为一个辅服务器 时，将向给定的远程服务器，即主服务器，请求增量区传送。如果未设置， 就使用视图或者全局选项块中的{\bfseries{request-ixfr}}选项值作 为缺省值。它也可在区块中设置，如果在那里设置，它会对那个区覆盖全局 和视图中的设置。

IXFR请求如果发送到不支持IXFR的服务器上，将会自动降格为AXFR。所以， 不需要手工列出哪个服务器支持IXFR和哪个服务器不支持；全局缺省值 {\bfseries{yes}}将总能够工作。 {\bfseries{provide-ixfr}}和{\bfseries{request-ixfr}} 子句的目的是即使主服务器和辅服务器都支持IXFR时可以关掉它，例如如果 一个服务器在使用IXFR时，有许多bug并宕掉或者数据损坏。

{\bfseries{edns}}子句决定在与远程服务器通信时， 是否企图使用EDNS。缺省是{\bfseries{yes}}。

{\bfseries{edns-udp-size}}选项设置EDNS UDP的大小，这个值在 {\bfseries{named}}向远程服务器发出请求时广播出去。有效值是 从512到4096字节（在这个范围之外的值将被静默地调整到范围内最接近的 值）。这个选项是 用于你想要广播一个与你全局广播值不同的值到这个服务器时，例如， 当远程站点有一个防火墙阻止较大的响应时。 （注意：当前，这对所有发送给这个服务器的包设置了一个UDP大小； {\bfseries{named}}将不会偏离这个值。 这与{\bfseries{options}}或者{\bfseries{view}}语句中的 {\bfseries{edns-udp-size}}的行为方式有所不同，后者指定一个 最大值。 在将来的版本中，{\bfseries{server}}语句的行为可能与 {\bfseries{options/view}}的行为一致。）

{\bfseries{max-udp-size}}选项设置{\bfseries{named}}发出 的EDNS UDP消息的最大大小。有效值是从512到4096字节（在这个范围之外的 值将被静默地调整）。这个选项是用于当你知道有防火墙阻止来自 {\bfseries{named}}的大回复包时。

{\bfseries{nosit-udp-size}}选项设置发送给没有有效源身份特征 请求方的UDP响应的最大大小。{\bfseries{max-udp-size}}选项 可以更进一步地限制响应的大小。

服务器支持两种区传送方法。第一种，{\bfseries{one-answer}}， 使用一个DNS消息传送一个资源记录。{\bfseries{many-answers}}将 尽可能多的资源记录封装在一个消息中。{\bfseries{many-answers}} 更有效率，但它只能被BIND 9， BIND 8.X和打补丁的BIND 4.9.5 所识别。你可以在{\bfseries{transfer-format}}选项中指定对一个 服务器使用哪种方法。如果{\bfseries{transfer-format}}未指定， 将使用{\bfseries{options}}选项中所指定的 {\bfseries{transfer-format}}。

{\bfseries{transfers}}用于限制从指定的服务器进来的并发区传送 的数目。如果没有设定{\bfseries{transfers}}子句，就根据 {\bfseries{transfers-per-ns}}选项设定限制。

{\bfseries{keys}}子句标识一个由{\bfseries{keys}}语句所 定义的{\bfseries{key\_id}}，在与远程服务器通讯时，用于事务安全 （TSIG，\hyperlink{tsig}{第\ref{tsig}节}）。当一个请求发向远程服务器时，就使 用这里所指定的key来生成一个请求签名并将其添加到消息尾部。一个源自远 程服务器的请求不要求被这个key签名。

虽然{\bfseries{keys}}子句的语法允许多个key，但是当前只支持每 个服务器一个key。

{\bfseries{transfer-source}}和 {\bfseries{transfer-source-v6}}子句分别指定用于同远程服务器进 行区传送的IPv4和IPv6源地址。对一个IPv4远程服务器，仅需要指定 {\bfseries{transfer-source}}。类似的，对一个IPv6远程服务器， 仅需要指定{\bfseries{transfer-source-v6}}。更多细节，参见 \hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{transfer-source}}和 {\bfseries{transfer-source-v6}}的描述。

{\bfseries{notify-source}}和 {\bfseries{notify-source-v6}}子句分别指定用于向远程服务器发送 通知消息的IPv4和IPv6源地址。对一个IPv4远程服务器，仅需要指定 {\bfseries{notify-source}}。类似的，对一个IPv6远程服务器， 仅需要指定{\bfseries{notify-source-v6}}。

{\bfseries{query-source}}和 {\bfseries{query-source-v6}}子句分别指定用于向远程服务器发送 请求的IPv4和IPv6源地址。对一个IPv4远程服务器，仅需要指定 {\bfseries{query-source}}。类似的，对一个IPv6远程服务器， 仅需要指定{\bfseries{query-source-v6}}。

{\bfseries{request-nsid}}子句决定本地服务器在发送请求给这个 服务器时是否需要添加一个NSID EDNS选项。这个覆盖在视图级和option级 的{\bfseries{request-nsid}}设置。

{\bfseries{request-sit}}子句决定本地服务器在发送到其它服务器 的请求中是否要添加一个SIT EDNS选项。这覆盖视图或全局选项中的 {\bfseries{request-sit}}设置。named可能决定SIT不被远程服务器 支持并且不在请求中添加一个SIT EDNS选项。
\subsection{{\bfseries{statistics-channels}}语句语法}
\label{statschannels}\hypertarget{statschannels}{}%

\begin{Verbatim}[]
statistics-channels {
   [ inet ( ip_addr | * ) [ port ip_port ]
   [allow {  address_match_list  } ]; ]
   [ inet ...; ]
};

\end{Verbatim}
\subsection{{\bfseries{statistics-channels}}语句定义和用法}
\label{idm178371046624}\hypertarget{idm178371046624}{}%

{\bfseries{statistics-channels}}语句声明了系统管理员用来获取 名字服务器统计信息的通信通道。

这个语句是打算在将来能够灵活地支持多个通信协议，但是当前只 支持HTTP访问。 它要求带有libxml2和/或json-c（也被称为libjson0）编译BIND 9； 即使在编译时没有提供库， {\bfseries{statistics-channels}}语句也被接受，但是任何 HTTP访问都会失败并返回一个错误。

一个{\bfseries{inet}}控制通道是一个监听在特定 {\bfseries{ip\_addr}}，可以是一个IPv4或IPv6地址，上的特定 {\bfseries{ip\_port}}的TCP套接字，一个 为{\texttt{{*}}}（星号）的{\bfseries{ip\_addr}}将被解释 为IPv4通配地址；到系统的任何IPv4地址的连接都会被接受。 要监听在IPv6的通配地址，使用为{\texttt{{::}}}的 {\bfseries{ip\_addr}}。

如果没有指定端口，给HTTP通道使用端口80。 星号"{\texttt{{*}}}"不能用作{\bfseries{ip\_port}}。

打开一个统计通道的企图被可选的{\bfseries{allow}}所限制。 到统计通道的连接基于{\bfseries{address\_match\_list}}而允许。 如果没有提供{\bfseries{allow}}子句，{\bfseries{named}} 接受任何地址来的连接企图；由于统计可能包含敏感的内部信息，强烈 推荐正确地限制连接源。

如果没有提供{\bfseries{statistics-channels}}语句， {\bfseries{named}}将不会打开任何通信通道。

统计以不同格式和视图提供，依赖于访问它们所使用的URI。例如， 如果配置了统计通道并监听在127.0.0.1的8888端口，就可以以XML格式在 {\textless}\url{http://127.0.0.1:8888/}{\textgreater}或 {\textless}\url{http://127.0.0.1:8888/xml}{\textgreater} 访问统计。 引入一个CSS文件，在使用一个样式表兼容的浏览器查看时，可以将XML统计 转换格式为表格，在使用一个支持javascript的浏览器查看时，可以使用 Google Charts API将其转换格式为图表和图形。

依赖某一特定XML模式的应用可以请求 {\textless}\url{http://127.0.0.1:8888/xml/v2}{\textgreater}获得版本2的 统计XML模式或者 {\textless}\url{http://127.0.0.1:8888/xml/v3}{\textgreater}获得版本3的。 如果服务器支持所请求的模式，就会有响应；如果不支持，就会返回 一个“page not found”错误。

统计的单独子项可以在下列位置查看 {\textless}\url{http://127.0.0.1:8888/xml/v3/status}{\textgreater} （服务器运行时间和上次修改配置时间）， {\textless}\url{http://127.0.0.1:8888/xml/v3/server}{\textgreater} （服务器和解析器统计）， {\textless}\url{http://127.0.0.1:8888/xml/v3/zones}{\textgreater} （区统计）， {\textless}\url{http://127.0.0.1:8888/xml/v3/net}{\textgreater} （网络状态和套接字统计）， {\textless}\url{http://127.0.0.1:8888/xml/v3/mem}{\textgreater} （内存管理统计）， {\textless}\url{http://127.0.0.1:8888/xml/v3/tasks}{\textgreater} （任务管理统计）。

也可以JSON格式读取完整的统计集合 {\textless}\url{http://127.0.0.1:8888/json}{\textgreater}, 在下列位置查看单独子项 {\textless}\url{http://127.0.0.1:8888/json/v1/status}{\textgreater} （服务器运行时间和上次修改配置时间）， {\textless}\url{http://127.0.0.1:8888/json/v1/server}{\textgreater} （服务器和解析器统计）， {\textless}\url{http://127.0.0.1:8888/json/v1/zones}{\textgreater} （区统计）， {\textless}\url{http://127.0.0.1:8888/json/v1/net}{\textgreater} （网络状态和套接字统计）， {\textless}\url{http://127.0.0.1:8888/json/v1/mem}{\textgreater} （内存管理统计）， {\textless}\url{http://127.0.0.1:8888/json/v1/tasks}{\textgreater} （任务管理统计）。
\subsection{{\bfseries{trusted-keys}}语句语法}
\label{trusted-keys}\hypertarget{trusted-keys}{}%

\begin{Verbatim}[]
trusted-keys {
    string number number number string ;
    [ string number number number string ; [...]]
};

\end{Verbatim}
\subsection{{\bfseries{trusted-keys}}语句定义和用法}
\label{idm178371010976}\hypertarget{idm178371010976}{}%

{\bfseries{trusted-keys}}语句定义DNSSEC安全根。DNSSEC在 \hyperlink{DNSSEC}{第\ref{DNSSEC}节}中描述。一个安全根被定义，当一个非授权区的 公钥被公开，但是不能通过DNS获得安全，要么因为它是DNS根区，要么因为 它的父区为签名。一旦一个密钥被配置成可信任密钥，它就被当作已验证和 被证实为安全。解析器试图DNSSEC验证一个安全根子域的所有DNS数据。

所有{\bfseries{trusted-keys}}中列出的密钥（和相应的区）都被认 为是存在，并与父区所说无关。所有{\bfseries{trusted-keys}}中列 出的密钥的相似地是，仅仅这些密钥在验证DNSKEY资源记录集时被用到。 父区的DS资源记录集不会被用到。

{\bfseries{trusted-keys}}语句可以包含多个密钥条目，每个条目由 密钥域名，标志，协议，算法和Base-64表示的密钥数据组成。 密钥数据中的空格，制表符，换行和回车被忽略，所以配置可以分割 放入多行中。

{\bfseries{trusted-keys}}可以被设置在 {\texttt{{named.\dbz{}conf}}}的顶级或者在一个视图内。如果 它在两个地方都被设置了，它们都会被添加：在顶级定义的密钥 被所有的视图所继承，但是在一个视图内部定义的密钥只能用于 那个视图。
\subsection{{\bfseries{managed-keys}} Statement Grammar}
\label{managed-keys}\hypertarget{managed-keys}{}%

\begin{Verbatim}[]
managed-keys {
    name initial-key flags protocol algorithm key-data ;
    [ name initial-key flags protocol algorithm key-data ; [...]]
};

\end{Verbatim}
\subsection{{\bfseries{managed-keys}} Statement Definition and Usage}
\label{idm178370996944}\hypertarget{idm178370996944}{}%

于{\bfseries{trusted-keys}}相似， {\bfseries{managed-keys}}语句定义DNSSEC安全根。 差别是{\bfseries{managed-keys}}可以自动保持更新， 无须解析器管理员干预。

例如，假设一个区的密钥签名密钥被攻破了，区的所有者必须撤销 并替代这个密钥。在{\bfseries{trusted-keys}}语句中 拥有一个旧密钥的解析器就不能再验证这个区的数据；它的回答会 带有一个SERVFAIL响应码。这会一直持续下去，直到解析器管理员 使用新的密钥更新{\bfseries{trusted-keys}}语句。

然而，如果区被列入到{\bfseries{managed-keys}}中，区的 所有者可以预先给区增加一个“备用的”密钥。 {\bfseries{named}}将会存储这个备用的密钥，并在原始的 密钥被撤销时，{\bfseries{named}}将能够平滑地过渡到新的 密钥。它也能够识别旧密钥已经被撤销，并停止使用旧密钥验证 回答，最小化被攻破的密钥所能够带来的损害。

一个{\bfseries{managed-keys}}语句包含了要管理的密钥的 列表，以及这些密钥在开始的时候如何被初始化的信息。当前所支持的 （即对于BIND 9.7.0）唯一初始化方法是 {\texttt{{initial-\dbz{}key}}}。 这表示{\bfseries{managed-keys}}语句必须包含一个初始化 密钥的拷贝。（将来的版本可能允许密钥以其它方式初始化，从而 取消这项要求。）

所以，一个{\bfseries{managed-keys}}语句表面上与一个 {\bfseries{trusted-keys}}相似，区别出现在第二个字段， 前者包含了关键字{\texttt{{initial-\dbz{}key}}}。区别是， 在{\bfseries{trusted-keys}}中列出的密钥可以一直被 信任，直到其从{\texttt{{named.\dbz{}conf}}}中删除掉， 而在{\bfseries{managed-keys}}语句中列出的一个初始化 密钥只被信任{\em{一次}}：因为它装载被管理的 密钥数据库并开始RFC 5011密钥维护进程。

当{\bfseries{named}}第一次带有一个配置在 {\texttt{{named.\dbz{}conf}}}中的被管理密钥运行时，它直接 从区顶点取得DNSKEY资源记录集，并使用 {\bfseries{managed-keys}}语句中所指定的密钥验证它。 如果这个DNSKEY资源记录集是有效签名的，它就被用作一个新的 被管理密钥数据库的基础。

从那个点开始，无论{\bfseries{named}}何时运行，它 看见了{\bfseries{managed-keys}}语句，检查并确认针对 指定域的RFC 5011密钥维护已经被初始化，如果是，它只是简单地 继续。在{\bfseries{managed-keys}}中所指定的密钥并 不用于校验回答；它被储存在被管理的密钥数据库中的一个或 多个密钥所替代。

在一个名字从{\bfseries{managed-keys}}语句中 {\em{删除}}之后下一次运行 {\bfseries{named}}时，对应的区将会从被管理密钥数据库 中删除，并且RFC 5011密钥维护将不再用于这个域。

{\bfseries{named}}只维持一个被管理的密钥数据库；所以， 与{\bfseries{trusted-keys}}不同， {\bfseries{managed-keys}}可能仅仅被设置在 {\texttt{{named.\dbz{}conf}}}的顶级，而不放在视图中。

在当前的实现中，被管理的密钥数据库是以一个主区文件格式存放的， 文件名为{\texttt{{managed-\dbz{}keys.\dbz{}bind}}}。当密钥数据库 被改变时，区就被更新。与其它任何动态区一样，改变会被写入到 一个日志文件，{\texttt{{managed-\dbz{}keys.\dbz{}bind.\dbz{}jnl}}}。 随后它们会尽快被提交到主文件；在被管理的密钥数据库的情况中， 这个通常发生在30秒之内。所以，无论何时{\bfseries{named}} 采用了自动密钥管理，这两个文件将会存在在工作目录中。（因为 这个以及其它原因，工作目录应该总是{\bfseries{named}} 可写的。）

如果{\bfseries{dnssec-validation}}选项被设为 {\ttfamily\bfseries{{auto}}}，{\bfseries{named}}会自动为根区 初始化一个被管理密钥。同样地， 如果{\bfseries{dnssec-lookaside}}选项被设为 {\ttfamily\bfseries{{auto}}}， {\bfseries{named}}将会自动为区 {\texttt{{dlv.\dbz{}isc.\dbz{}org}}}初始化一个被管理密钥。在两种情况下， 用于初始化密钥维护进程的密钥是内建于{\bfseries{named}}， 并且能够被{\bfseries{bindkeys-file}}中的密钥所覆盖。
\subsection{{\bfseries{view}}语句语法}
\label{view_statement_grammar}\hypertarget{view_statement_grammar}{}%

\begin{Verbatim}[]
view view_name
      [class] {
      match-clients { address_match_list };
      match-destinations { address_match_list };
      match-recursive-only yes_or_no ;
      [ view_option; ...]
      [ zone_statement; ...]
};

\end{Verbatim}
\subsection{{\bfseries{view}}语句定义和用法}
\label{idm178370946096}\hypertarget{idm178370946096}{}%

{\bfseries{view}}语句是BIND 9的一个强大功 能，它使一个名字服务器在回答一个DNS请求时，可以依据是谁在请求而有所 不同。这在实现分割的DNS设置却不需要运行多个服务器时特别有用。

每个{\bfseries{view}}语句定义了一个被一些客户子集所看到的DNS 名字空间的视图。一个客户匹配一个视图是指它的源地址与视图的 {\bfseries{match-clients}}子句中的 {\texttt{{address\_match\_list}}}匹配并且它的目的地址与视图的 {\bfseries{match-destinations}}子句中的 {\texttt{{address\_match\_list}}}匹配。如果未指定， {\bfseries{match-clients}}和 {\bfseries{match-destinations}}缺省都是匹配所有地址。除了检查 IP地址，{\bfseries{match-clients}}和 {\bfseries{match-destinations}}也可以使用 {\bfseries{keys}}，它给客户端提供了一个选择视图的机制。一个视 图也可以指定成为{\bfseries{match-recursive-only}}，它表示仅仅 来自匹配客户的递归请求才匹配此视图。{\bfseries{view}}语句的顺 序非常重要 --- 一个客户端请求将在它所匹配的第一个 {\bfseries{view}}的上下文中被解析。

在一个{\bfseries{view}}语句中定义的区只能被与这个 {\bfseries{view}}相匹配的客户端访问。通过在多个视图中定义同样 名字的区，可以为不同的客户端提供不同的区数据，例如，在一个分割的DNS 上建立“internal”和“external”客户端。

许多在{\bfseries{options}}语句中给出的选项也可以用在 {\bfseries{view}}语句中，并且仅仅在解析这个视图之内的请求时生 效。当没有给出按视图指定的值时，缺省试验{\bfseries{options}} 语句中的值。同样，区选项也使用在{\bfseries{view}}语句中指定的 值做缺省值；这些按视图指定的缺省值优先于其在 {\bfseries{options}}语句中的值。

视图是按类划分的。如果没有给出类，假设为IN类。注意所有的非IN视图必 须包含一个暗示区，因为只有IN类有一个预编译的缺省暗示区。

如果配置文件中没有{\bfseries{view}}语句，就自动在IN类中建立一 个匹配所有客户端的缺省视图。然后在配置文件的顶层所指定的 {\bfseries{zone}}语句都是这个缺省视图的一部份， {\bfseries{options}}语句将会应用到这个缺省视图。如果提供任何 显式的{\bfseries{view}}语句，所有{\bfseries{zone}}语句 都必须出现在{\bfseries{view}}语句之内。

这里是使用{\bfseries{view}}语句实现分割DNS的一个典型设置：

\begin{Verbatim}[]
view "internal" {
      // This should match our internal networks.
      match-clients { 10.0.0.0/8; };

      // Provide recursive service to internal
      // clients only.
      recursion yes;

      // Provide a complete view of the example.com
      // zone including addresses of internal hosts.
      zone "example.com" {
            type master;
            file "example-internal.db";
      };
};

view "external" {
      // Match all clients not matched by the
      // previous view.
      match-clients { any; };

      // Refuse recursive service to external clients.
      recursion no;

      // Provide a restricted view of the example.com
      // zone containing only publicly accessible hosts.
      zone "example.com" {
           type master;
           file "example-external.db";
      };
};

\end{Verbatim}
\subsection{{\bfseries{zone}}语句语法}
\label{zone_statement_grammar}\hypertarget{zone_statement_grammar}{}%

\begin{Verbatim}[]
zone zone_name [class] {
    type master;
    [ allow-query { address_match_list }; ]
    [ allow-query-on { address_match_list }; ]
    [ allow-transfer { address_match_list }; ]
    [ allow-update { address_match_list }; ]
    [ update-check-ksk yes_or_no; ]
    [ dnssec-dnskey-kskonly yes_or_no; ]
    [ dnssec-loadkeys-interval number; ]
    [ update-policy local | { update_policy_rule [...] }; ]
    [ also-notify { ip_addr [port ip_port] [dscp ip_dscp] ;
                  [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ check-names (warn|fail|ignore) ; ]
    [ check-mx (warn|fail|ignore) ; ]
    [ check-wildcard yes_or_no; ]
    [ check-spf ( warn | ignore ); ]
    [ check-integrity yes_or_no ; ]
    [ dialup dialup_option ; ]
    [ file string ; ]
    [ masterfile-format (text|raw|map) ; ]
    [ journal string ; ]
    [ max-journal-size size_spec; ]
    [ forward (only|first) ; ]
    [ forwarders { [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ ixfr-base string ; ]
    [ ixfr-from-differences yes_or_no; ]
    [ ixfr-tmp-file string ; ]
    [ request-ixfr yes_or_no ; ]
    [ maintain-ixfr-base yes_or_no ; ]
    [ max-ixfr-log-size number ; ]
    [ max-transfer-idle-out number ; ]
    [ max-transfer-time-out number ; ]
    [ notify yes_or_no | explicit | master-only ; ]
    [ notify-delay seconds ; ]
    [ notify-to-soa yes_or_no; ]
    [ pubkey number number number string ; ]
    [ notify-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ notify-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ zone-statistics full | terse | none; ]
    [ sig-validity-interval number [number] ; ]
    [ sig-signing-nodes number ; ]
    [ sig-signing-signatures number ; ]
    [ sig-signing-type number ; ]
    [ database string ; ]
    [ min-refresh-time number ; ]
    [ max-refresh-time number ; ]
    [ min-retry-time number ; ]
    [ max-retry-time number ; ]
    [ key-directory path_name; ]
    [ auto-dnssec allow|maintain|off; ]
    [ inline-signing yes_or_no; ]
    [ zero-no-soa-ttl yes_or_no ; ]
    [ serial-update-method increment|unixtime; ]
    [ max-zone-ttl number ; ]
};

zone zone_name [class] {
    type slave;
    [ allow-notify { address_match_list }; ]
    [ allow-query { address_match_list }; ]
    [ allow-query-on { address_match_list }; ]
    [ allow-transfer { address_match_list }; ]
    [ allow-update-forwarding { address_match_list }; ]
    [ dnssec-update-mode ( maintain | no-resign ); ]
    [ update-check-ksk yes_or_no; ]
    [ dnssec-dnskey-kskonly yes_or_no; ]
    [ dnssec-loadkeys-interval number; ]
    [ dnssec-secure-to-insecure yes_or_no ; ]
    [ try-tcp-refresh yes_or_no; ]
    [ also-notify [port ip_port] [dscp ip_dscp] { ( masters_list | ip_addr
                              [port ip_port]
                              [dscp ip_dscp]
                              [key key] ) ; [...] }; ]
    [ check-names (warn|fail|ignore) ; ]
    [ dialup dialup_option ; ]
    [ file string ; ]
    [ masterfile-format (text|raw|map) ; ]
    [ journal string ; ]
    [ max-journal-size size_spec; ]
    [ forward (only|first) ; ]
    [ forwarders { [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ ixfr-base string ; ]
    [ ixfr-from-differences yes_or_no; ]
    [ ixfr-tmp-file string ; ]
    [ maintain-ixfr-base yes_or_no ; ]
    [ masters [port ip_port] [dscp ip_dscp] { ( masters_list | ip_addr
                              [port ip_port]
                              [dscp ip_dscp]
                              [key key] ) ; [...] }; ]
    [ max-ixfr-log-size number ; ]
    [ max-transfer-idle-in number ; ]
    [ max-transfer-idle-out number ; ]
    [ max-transfer-time-in number ; ]
    [ max-transfer-time-out number ; ]
    [ notify yes_or_no | explicit | master-only ; ]
    [ notify-delay seconds ; ]
    [ notify-to-soa yes_or_no; ]
    [ pubkey number number number string ; ]
    [ transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ transfer-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ alt-transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ alt-transfer-source-v6 (ip6_addr | *)
                             [port ip_port]
                             [dscp ip_dscp] ; ]
    [ use-alt-transfer-source yes_or_no; ]
    [ notify-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ notify-source-v6 (ip6_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ zone-statistics full | terse | none; ]
    [ sig-validity-interval number [number] ; ]
    [ sig-signing-nodes number ; ]
    [ sig-signing-signatures number ; ]
    [ sig-signing-type number ; ]
    [ database string ; ]
    [ min-refresh-time number ; ]
    [ max-refresh-time number ; ]
    [ min-retry-time number ; ]
    [ max-retry-time number ; ]
    [ key-directory path_name; ]
    [ auto-dnssec allow|maintain|off; ]
    [ inline-signing yes_or_no; ]
    [ multi-master yes_or_no ; ]
    [ zero-no-soa-ttl yes_or_no ; ]
};

zone zone_name [class] {
    type hint;
    file string ;
    [ delegation-only yes_or_no ; ]
    [ check-names (warn|fail|ignore) ; ] // Not Implemented.
};

zone zone_name [class] {
    type stub;
    [ allow-query { address_match_list }; ]
    [ allow-query-on { address_match_list }; ]
    [ check-names (warn|fail|ignore) ; ]
    [ dialup dialup_option ; ]
    [ delegation-only yes_or_no ; ]
    [ file string ; ]
    [ masterfile-format (text|raw|map) ; ]
    [ forward (only|first) ; ]
    [ forwarders { [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ masters [port ip_port] [dscp ip_dscp] { ( masters_list | ip_addr
                              [port ip_port]
                              [dscp ip_dscp]
                              [key key] ) ; [...] }; ]
    [ max-transfer-idle-in number ; ]
    [ max-transfer-time-in number ; ]
    [ pubkey number number number string ; ]
    [ transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ transfer-source-v6 (ip6_addr | *)
                         [port ip_port] [dscp ip_dscp] ; ]
    [ alt-transfer-source (ip4_addr | *) [port ip_port] [dscp ip_dscp] ; ]
    [ alt-transfer-source-v6 (ip6_addr | *)
                            [port ip_port] [dscp ip_dscp] ; ]
    [ use-alt-transfer-source yes_or_no; ]
    [ zone-statistics yes_or_no ; ]
    [ database string ; ]
    [ min-refresh-time number ; ]
    [ max-refresh-time number ; ]
    [ min-retry-time number ; ]
    [ max-retry-time number ; ]
    [ multi-master yes_or_no ; ]
};

zone zone_name [class] {
    type static-stub;
    [ allow-query { address_match_list }; ]
    [ server-addresses { [ ip_addr ; ... ] }; ]
    [ server-names { [ namelist ] }; ]  
    [ zone-statistics yes_or_no ; ]
};

zone zone_name [class] {
    type forward;
    [ forward (only|first) ; ]
    [ forwarders { [ ip_addr [port ip_port] [dscp ip_dscp] ; ... ] }; ]
    [ delegation-only yes_or_no ; ]
};

zone "." [class] {
    type redirect;
    file string ;
    [ masterfile-format (text|raw|map) ; ]
    [ allow-query { address_match_list }; ]
    [ max-zone-ttl number ; ]
};

zone zone_name [class] {
    type delegation-only;
};

zone zone_name [class] {
    [ in-view string ; ]
};


\end{Verbatim}
\subsection{{\bfseries{zone}}语句定义和用法}
\label{idm178370731424}\hypertarget{idm178370731424}{}%
\subsubsection{区类型}
\label{idm178370730480}\hypertarget{idm178370730480}{}%

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370729824}\hypertarget{idm178370729824}{}%
\begin{longtable}{|cp{4.017in}|}
\hline 
{{{\texttt{{master}}}}} & {{服务器拥有区数据的主拷贝，并能够提供关于这个区的 权威回答。}} \tabularnewline
{{{\texttt{{slave}}}}} & {{一个辅区是一个主区的一份复制。 {\bfseries{masters}}列表指定一个或多个主服务器， 辅服务器从其更新自己的区拷贝。主服务器列表元素也可以是 其它主服务器列表的名字。缺省时，自53端口发出区传送；这 个也可以通过在IP地址列表之前指定一个端口号修改，这对所 有服务器都适用；或者在IP地址之后指定端口，这个就依每个 服务器而不同。对主服务器的认证也可以基于每个服务器的 TSIG密钥来做。如果指定了一个文件，无论何时区有了改变， 就将复制来的数据写到这个文件中，并在服务重新启动时重新 装入这个文件。推荐使用一个文件，因为这常常会加速服务的 启动并消除不必要的带宽浪费。注意，对一个服务器上大量的 区（数万或数十万），最好对区文件名使用两级命名机制。例 如，区{\texttt{{example.\dbz{}com}}}的辅服务器可能将区 的内容放进名为{\texttt{{ex/\dbz{}example.\dbz{}com}}}的文件 中，在这里{\texttt{{ex/\dbz{}}}}仅仅是区名的头两个字 母。（如果你将100000个文件放在一个目录中，大多数操作系 统操作都非常缓慢。）}} \tabularnewline
{{{\texttt{{stub}}}}} & {{存根（stub）区类似于一个辅区，差别仅仅是它只复制一个 主区中的NS记录而不是整个区。存根区不是DNS的标准部份； 它只是BIND实现的一个特性。  \par  存根区可以用来消除父区中粘着NS记录的需求，代价是维护一 个存根区条目和{\texttt{{named.\dbz{}conf}}}中名字服务 器地址的集合。在新配置中不推荐这种用法，并且BIND 9仅仅 以有限的方式支持它。在BIND 4/8中，对 父区的区传送会包含这个区中存根孩子的NS记录。这意谓着， 在某些情况下，用户可以不用配置孩子的存根，而仅在主服务 器中为父区配置。BIND 9从来不以这样的 方式混淆不同区中的区数据。所以，如果一个 BIND 9配置成父区的主服务器，并配置了 子区的存根区，那么所以父区的辅服务器也都需要配置同样的 子区的存根区。  \par  存根区也可以用于强制使用某个特定权威服务器集合来解析某 一给定域名。例如，使用RFC1918地址的某个私有网络上的缓存 服务器可能为{\texttt{{10.\dbz{}in-\dbz{}addr.\dbz{}arpa}}}配置存根 区，并使用内部名字服务器的一个集合作为这个区的 权威服务器。}} \tabularnewline
{{{\texttt{{static-stub}}}}} & {{静态存根（static-stub）区类似于存根区，仅仅有下列例外： 区数据是静态配置而不是从主服务器传送而来；当一个匹配某个 静态存根区的请求需要递归时，总是使用本地配置的数据（名字 服务器的名字和粘连地址），即使其缓存了不同的权威信息。  \par  区数据使用{\bfseries{server-addresses}}和 {\bfseries{server-names}}区选项来配置。  \par  区数据在内部是以NS和（如果需要）粘连的A或者AAAA资源记录 的形式维护，可以使用{\bfseries{rndc dumpdb -all}} 将区数据库转储为可读的格式。  \par  由于数据是静态配置的，对于一个静态存根区来说，不会发生 区维护动作。例如，没有周期性的刷新，收到的通知消息将会 被拒绝，并带有一个NOTAUTH的响应码（rcode）。  \par  每个静态存根区都被配置为带有内部生成的NS和（如果需要） 粘连的A或者AAAA资源记录。}} \tabularnewline
{{{\texttt{{forward}}}}} & {{一个“转发区”是基于域名配置转发的方式。一个 {\bfseries{forward}}类型的{\bfseries{zone}} 语句可以包含{\bfseries{forward}}和/或 {\bfseries{forwarders}}语句，这将对由区名所给出的 域内的请求起作用。如果没有{\bfseries{forwarders}} 语句或者为{\bfseries{forwarders}}配置一个空表，这 个域就不会有转发动作，即取消了 {\bfseries{options}}语句中任何转发者的效果。这样 如果你想使用这种类型的区来改变全局 {\bfseries{forward}}选项（即，“forward first”， 然后“forward only”，或者相反，但是想要使用同样的 服务器作为全局设置），你需要重新指定全局转发者。}} \tabularnewline
{{{\texttt{{hint}}}}} & {{使用一个“hint zone”来指定初始的根名字服务器集合。在服 务器启动时，它使用根提示信息来找到一个根名字服务器并从 后者获取最近的根名字服务器名单。如果没有为类IN指定提示 区，服务器使用编译内建的根服务器提示集合。IN之外的其它 类没有内建缺省提示。}} \tabularnewline
{{{\texttt{{redirect}}}}} & {{重定向区用于在普通解析将导致返回一个NXDOMAIN时，而 给请求提供一个回答。 每个视图只支持一个重定向区。可以使用 {\bfseries{allow-query}}限制哪些客户端可以看见 这些回复。  \par  如果客户端请求DNSSEC记录（DO=1）并且NXDOMAIN响应被 签名，就不会发生任何替换。  \par  要重定向所有的NXDOMAIN响应到100.100.100.2和 2001:ffff:ffff::100.100.100.2，需要配置一个名为“.”的 典型(type)重定向区，其区文件中包含指向期望地址的通配符记录： {\texttt{{"*.\dbz{} IN A 100.\dbz{}100.\dbz{}100.\dbz{}2"}}} 和 {\texttt{{"*.\dbz{} IN AAAA 2001:ffff:ffff::100.\dbz{}100.\dbz{}100.\dbz{}2"}}}.  \par  要重定向所有西班牙名字（在.ES下面），需要使用类似的 名字，但要用“*.ES.”替代“*.”。要重定向所有商业西班牙 名字（在.COM.ES下面），需要使用通配符条目“*.COM.ES.”。  \par  注意重定向区支持所有可能的类型；它不限于A和AAAA记录。  \par  由于重定向区不会直接被名字引用，它们不保存在普通主区 和辅区的区查找表中。因此，当前不可能使用 {\bfseries{rndc reload {\ttfamily\itshape{{zonename}}}}} 来重载一个重定向区。然而，当使用 {\bfseries{rndc reload}}而不指定一个区名时， 重定向区将会随着其它区被重载。}} \tabularnewline
{{{\texttt{{delegation-only}}}}} & {{这个用于强制基础区（如COM，NET，ORG）为只授权状态。任何 收到的回答在权威部份没有一个显式或隐式的授权时都会被当 做NXDOMAIN。这个不应用在区顶点。这不应该应用在叶子区。  \par  {\texttt{{delegation-only}}}对从转发服务器来的回 答没有效果。  \par  参见\hyperlink{root_delegation_only}{{\bfseries{root-delegation-only}}}中的说明。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsubsection{类}
\label{idm178370671392}\hypertarget{idm178370671392}{}%

作为可选项，区的名字后面可以跟一个类。如果未指定类，就设定为类 {\texttt{{IN}}}（表示{\texttt{{Internet}}}）。这在 大多数情况下是正确的。

{\texttt{{hesiod}}}类是表示来自MIT的雅典娜项目的一种信息服 务。它用于在不同系统数据库之间共享信息，如用户、组、打印机等等。 关键字{\texttt{{HS}}}是hesiod的符号。

另一个MIT开发的是Chaosnet，一个创建于1970年代中期的局域网协议。 它的区数据可以使用{\texttt{{CHAOS}}}类指定。
\subsubsection{区选项}
\label{idm178370666544}\hypertarget{idm178370666544}{}%

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-notify}}}]\null{}
参见\hyperlink{access_control}{第\ref{access_control}节}中对 {\bfseries{allow-notify}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-query}}}]\null{}
参见\hyperlink{access_control}{第\ref{access_control}节}中对 {\bfseries{allow-query}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-query-on}}}]\null{}
参见\hyperlink{access_control}{第\ref{access_control}节}中对 {\bfseries{allow-query-on}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-transfer}}}]\null{}
参见\hyperlink{access_control}{第\ref{access_control}节}中对 {\bfseries{allow-transfer}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-update}}}]\null{}
参见\hyperlink{access_control}{第\ref{access_control}节}中对 {\bfseries{allow-update}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{update-policy}}}]\null{}
指定一个“简单安全更新”策略。参见 \hyperlink{dynamic_update_policies}{第\ref{dynamic_update_policies}节}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{allow-update-forwarding}}}]\null{}
参见\hyperlink{access_control}{第\ref{access_control}节}中对 {\bfseries{allow-update-forwarding}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{also-notify}}}]\null{}
仅在这个区的{\bfseries{notify}}是激活时有意义。会收到 这个区的{\texttt{{DNS NOTIFY}}}消息的机器集由所有列出 的区名字服务器（主服务器除外）和 {\bfseries{also-notify}}所指定的任何IP地址。可以在每 个{\bfseries{also-notify}}地址指定通知消息要送达的端 口，缺省为53。也可以指定一个TSIG密钥，让 {\texttt{{NOTIFY}}}被给出的密钥签名。 {\bfseries{also-notify}}对存根区没有意义。缺省是空表。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-names}}}]\null{}
这个选项用于限制某些域名的字符集和语法，这些域名包括来自主 文件和/或来自网络的DNS响应。缺省值是依区类型的不同而 不同的。对{\bfseries{master}}区缺省值是 {\bfseries{fail}}。 对{\bfseries{slave}}区缺省值 是{\bfseries{warn}}。 对于{\bfseries{hint}}区没有实现。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-mx}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{check-mx}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-spf}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{check-spf}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-wildcard}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{check-wildcard}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-integrity}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{check-integrity}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{check-sibling}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{check-sibling}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{zero-no-soa-ttl}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{zero-no-soa-ttl}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{update-check-ksk}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{update-check-ksk}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-update-mode}}}]\null{}
参见\hyperlink{options}{第\ref{options}节}中对 {\bfseries{dnssec-update-mode}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-dnskey-kskonly}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{dnssec-dnskey-kskonly}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{try-tcp-refresh}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{try-tcp-refresh}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{database}}}]\null{}
指定用于存放区数据的数据库类型。{\bfseries{database}} 关键字后跟的字符串被解释为一个空格分隔的单词列表。第一个单 词标识数据库类型，接下来的单词作为参数传递给数据库，并按照 数据库类型所指定的处理方式来解释。

缺省是{\ttfamily\bfseries{{“rbt”}}}，BIND 9的原生内存红黑 树数据库。这个数据库不需要参数。

如果有附加的数据库驱动被链接到服务器，也可能有其它值。在分 发包中包含一些简单的驱动，但是缺省没有被链接进来。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dialup}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{dialup}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{delegation-only}}}]\null{}
这个标志只用于转发区，提示区和存根区。如果设置为 {\ttfamily\bfseries{{yes}}}，区将被当成一个只授权类型的区。

参见\hyperlink{root_delegation_only}{{\bfseries{root-delegation-only}}}中的说明。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{forward}}}]\null{}
仅在区有一个转发者列表的时候有意义。{\bfseries{only}} 值将会在试探转发者但没有回答之后导致查找失败，而 {\bfseries{first}}值将会允许进行一个普通查找的试探。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{forwarders}}}]\null{}
用于重载全局转发者列表。如果没有指定区类型为 {\bfseries{forward}}，对此区就没有转发， 也不使用全局选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{ixfr-base}}}]\null{}
用于BIND 8中，为动态更新和IXFR指定事务日 志（journal）文件的名字。BIND 9忽略这个 选项，它通过在区文件的名字后面增加 “{\texttt{{.\dbz{}jnl}}}”来构造日志文件名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{ixfr-tmp-file}}}]\null{}
BIND 8中一个未列入文档的选项。 在BIND 9中被忽略。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{journal}}}]\null{}
允许覆盖缺省的日志文件名。缺省为区文件后增 “{\texttt{{.\dbz{}jnl}}}”。这个应用于 {\bfseries{master}}和{\bfseries{slave}}区中。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-journal-size}}}]\null{}
参见\hyperlink{server_resource_limits}{第\ref{server_resource_limits}节}中对 {\bfseries{max-journal-size}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-time-in}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{max-transfer-time-in}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-idle-in}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{max-transfer-idle-in}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-time-out}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{max-transfer-time-out}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-transfer-idle-out}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{max-transfer-idle-out}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{notify}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-delay}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中对 {\bfseries{notify-delay}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-to-soa}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{notify-to-soa}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{pubkey}}}]\null{}
在BIND 8中，这个选项用于指定一个公共区密 钥，它是为了在从磁盘中装载DNSSEC签名的区时校验区的签名的。 BIND 9在装载时不校验签名，并忽略此选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{zone-statistics}}}]\null{}
如果为{\ttfamily\bfseries{{yes}}}，服务器将会保持这个区的统 计信息，这些信息可以被导出到服务器选项 {\bfseries{statistics-file}}所指定的文件中。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{server-addresses}}}]\null{}
仅对静态存根区有意义。这是一个IP地址列表，在递归解析这个区 时，请求将被发向这个列表。 为这个选项配置一个非空列表，将会在内部配置顶点NS资源记录及 附带的粘连A或者AAAA记录。

例如，如果“example.com”被配置成一个静态存根区，在一个 {\bfseries{server-addresses}}选项中配置192.0.2.1和 2001:db8::1234，内部将被配置为下列资源记录。
\null{}
\begin{Verbatim}[]
example.com. NS example.com.
example.com. A 192.0.2.1
example.com. AAAA 2001:db8::1234
\end{Verbatim}

这些记录将会被用于解析这个静态存根区下的名字。例如，如果 服务器受到一个带RD位的“www.example.com”请求，服务器将 发起一个递归解析，将请求发给192.0.2.1和/或2001:db8::1234。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{server-names}}}]\null{}
仅对静态存根区有意义。这是一个名字服务器域名的列表，充当 这个静态存根区的权威服务器。 在{\bfseries{named}}需要发送请求到这些服务器时，这些 名字将被解析成IP地址。 为使这个补充解析能够成功，这些名字必须不能是静态存根区原点 名的子域名。即，当一个静态存根区的原点是“example.net”时， “ns.example”和“master.example.com”可以设定在 {\bfseries{server-names}}选项中，但是 “ns.example.net”不能，它将被配置分析器拒绝。

为这个选项配置一个非空列表，将会使用指定的名字在内部配置 顶点NS资源记录。例如，如果“example.com”被配置为一个静态 存根区，并在一个{\bfseries{server-names}}选项配置 “ns1.example.net”和“ns2.example.net”，内部将被配置为 下列资源记录。
\null{}
\begin{Verbatim}[]
example.com. NS ns1.example.net.
example.com. NS ns2.example.net.

\end{Verbatim}

这些记录将会被用于解析这个静态存根区下的名字。例如，如果 服务器受到一个带RD位的“www.example.com”请求，服务器将 发起一个递归解析，先将“ns1.example.net”和/或 “ns2.example.net”解析成IP地址，再将请求发给（一个或多个） 这些地址。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-validity-interval}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中对 {\bfseries{sig-validity-interval}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-signing-nodes}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中对 {\bfseries{sig-signing-nodes}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-signing-signatures}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中对 {\bfseries{sig-signing-signatures}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{sig-signing-type}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中对 {\bfseries{sig-signing-type}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfer-source}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{transfer-source}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{transfer-source-v6}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{transfer-source-v6}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{alt-transfer-source}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{alt-transfer-source}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{alt-transfer-source-v6}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{alt-transfer-source-v6}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{use-alt-transfer-source}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{use-alt-transfer-source}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-source}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{notify-source}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{notify-source-v6}}}]\null{}
参见\hyperlink{zone_transfers}{第\ref{zone_transfers}节}中对 {\bfseries{notify-source-v6}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{min-refresh-time}}, {\bfseries{max-refresh-time}}, {\bfseries{min-retry-time}}, {\bfseries{max-retry-time}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{ixfr-from-differences}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{ixfr-from-differences}}的描述。 （注意 {\bfseries{ixfr-from-differences}} {\ttfamily\bfseries{{master}}}和 {\ttfamily\bfseries{{slave}}}选择不能用于区这一级。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{key-directory}}}]\null{}
参见\hyperlink{options}{第\ref{options}节}中对 {\bfseries{key-directory}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{auto-dnssec}}}]\null{}
被配置为动态DNS的区也使用这个选项来允许多个级别的 自动DNSSEC密钥管理。有下列三种可能的设置：

{\bfseries{auto-dnssec allow;}}允许密钥被更新， 区被全部重新签名，无论何时用户发出命令{\bfseries{rndc sign {\ttfamily\itshape{{zonename}}}}}。

{\bfseries{auto-dnssec maintain;}}包含以上命令， 还能够工具密钥的计时元数据自动按时间表调整区的DNSSEC 密钥（参见\hyperlink{man.dnssec-keygen}{dnssec-keygen(8)}和 \hyperlink{man.dnssec-settime}{dnssec-settime(8)}）。命令 {\bfseries{rndc sign {\ttfamily\itshape{{zonename}}}}}让 {\bfseries{named}}从密钥仓库装载密钥并使用所有 激活的密钥签名区。{\bfseries{rndc loadkeys {\ttfamily\itshape{{zonename}}}}}让 {\bfseries{named}}从密钥仓库装载密钥并调度 将来发生的的密钥维护事件，但是它不立即签名整个区。 注意：一旦一个区的密钥被首次装载后，将定期搜索仓库以查找 变化，无论是否使用了{\bfseries{rndc loadkeys}}。 重新检查的间隔被{\bfseries{dnssec-loadkeys-interval}} 所定义。）

缺省设置是{\bfseries{auto-dnssec off}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{serial-update-method}}}]\null{}
被配置为动态DNS的区可以使用这个选项设置用于更新SOA记录中区 序列号的更新方法。

使用缺省的设置 {\bfseries{serial-update-method increment;}}， SOA序列号将会在每次区被更新时加一。

当设置为 {\bfseries{serial-update-method unixtime;}}时， SOA序列号将被设置为UNIX纪元以来的秒数，除非序列号已经大于 或等于那个值，这时它只是简单的加一。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{inline-signing}}}]\null{}
如果为{\texttt{{yes}}}，将允许对一个区进行 "bump in the wire"签名，这时，一个未签名区通过区传送传入或 从磁盘加载，将会生成区的签名版本，可能带有一个不同的 序列号。此特性缺省是关闭的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{multi-master}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{multi-master}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{masterfile-format}}}]\null{}
参见\hyperlink{tuning}{第\ref{tuning}节}中对 {\bfseries{masterfile-format}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{max-zone-ttl}}}]\null{}
参见\hyperlink{options}{第\ref{options}节}中对 {\bfseries{max-zone-ttl}}的描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{dnssec-secure-to-insecure}}}]\null{}
参见\hyperlink{boolean_options}{第\ref{boolean_options}节}中对 {\bfseries{dnssec-secure-to-insecure}}的描述。
\end{description}
\subsubsection{动态更新策略}
\label{dynamic_update_policies}\hypertarget{dynamic_update_policies}{}%

BIND 9支持两种方法来授权客户端对一个区执行动态 更新，分别是配置{\bfseries{allow-update}}和 {\bfseries{update-policy}}选项。

{\bfseries{allow-update}}子句与先前的 BIND是同样的工作方式。它授权客户端更新一个区中 任何名字的任何记录的权限。

{\bfseries{update-policy}}子句允许对所授权的更新 作更细粒度的控制。指定一个规则集， 其中的每个规则是授权或禁止一个或多个名字被一个或多个身份所更新。 如果动态更新请求消息是签名的（即包含TSIG或者SIG(0)记录）， 可以决定签名者的身份。

在{\bfseries{update-policy}}区选项中所指定的规则，仅仅对主 区有意义。当出现{\bfseries{update-policy}}语句时，再出现 {\bfseries{allow-update}}语句就会报配置错误。 {\bfseries{update-policy}}语句仅仅检查一个消息的签名者； 而不管源地址。

有一个预定义的{\bfseries{update-policy}}规则，可以 使用命令{\bfseries{update-policy local;}}打开。 对一个区打开这个规则会导致{\bfseries{named}} 生成一个TSIG会话密钥并将其放到一个文件中，并且允许用这个 密钥更新这个区。（缺省时，文件是 {\texttt{{/\dbz{}var/\dbz{}run/\dbz{}named/\dbz{}session.\dbz{}key}}}，密钥名是 “local-ddns”，密钥算法是HMAC-SHA256，但这些值是分别配置 在{\bfseries{session-keyfile}}， {\bfseries{session-keyname}}和 {\bfseries{session-keyalg}}选项中）。

一个运行在本地系统上并带有合适授权的客户端可以读那个文件， 并使用密钥来签名更新请求。区的签名策略将会被设置为允许那个 密钥改变区中的任何记录。假设密钥名是“local-ddns”，这个 策略等效为：

\begin{Verbatim}[]
update-policy { grant local-ddns zonesub any; };
            
\end{Verbatim}

{\bfseries{nsupdate -l}}命令向本机发出更新请求，并 使用会话密钥对其签名。

其它的规则看起来像这个：

\begin{Verbatim}[]

( grant | deny ) identity nametype [ name ] [ types ]

\end{Verbatim}

每条规则授予或禁止权限。一旦一条消息成功地匹配了一条规则，立即进 行授予或禁止操作而不再进行更多的规则检查。一条规则匹配是指签名者 与identity字段匹配，名字按照nametype字段与name字段匹配，并且类型 与types字段所指定的类型匹配。

对{\ttfamily\itshape{{tcp-self}}}或 {\ttfamily\itshape{{6to4-self}}}不要求有签名者，然而，标准 的反向映射/前缀转换必须匹配标识字段。

标识符字段指定一个名字或一个通配名字。通常情况下，这是用来签名更 新请求的TSIG或SIG(0)密钥的名字。当使用TKEY交换建立了一个共享密钥 之后，共享密钥的标识符就与用于认证TKEY交换的密钥的标识符相同。 TKEY也是GSS-TSIG所使用的协商方法，后者建立一个标识，即客户端的 Kerberos标识，如{\ttfamily\bfseries{{"user@host.\dbz{}domain"}}}。当 {\ttfamily\itshape{{identity}}}字段指定了一个通配名字，它服从 DNS通配符扩展，这样规则会应用到多个标识符。 {\ttfamily\itshape{{identity}}}字段必须包含一个完整域名。

对名字类型{\texttt{{krb5-self}}}， {\texttt{{ms-self}}}，{\texttt{{krb5-subdomain}}}， 和{\texttt{{ms-subdomain}}}， {\ttfamily\itshape{{identity}}}字段指定机器所属的Windows或 Kerberos域。

{\ttfamily\itshape{{nametype}}}字段有13个值： {\texttt{{name}}}，{\texttt{{subdomain}}}， {\texttt{{wildcard}}}，{\texttt{{self}}}， {\texttt{{selfsub}}}，{\texttt{{selfwild}}}, {\texttt{{krb5-self}}}，{\texttt{{ms-self}}}， {\texttt{{krb5-subdomain}}}， {\texttt{{ms-subdomain}}}， {\texttt{{tcp-self}}}，{\texttt{{6to4-self}}}, {\texttt{{zonesub}}}和{\texttt{{external}}}。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370443840}\hypertarget{idm178370443840}{}%
\begin{longtable}{|p{1.108in}p{4.017in}|}
\hline 
{{{\texttt{{name}}}}} & {{精确匹配语义。当被更新的名字与 {\ttfamily\itshape{{name}}}字段内容一致时， 这个规则匹配。}} \tabularnewline
{{{\texttt{{subdomain}}}}} & {{当被更新的名字是{\ttfamily\itshape{{name}}}字段内容 的子域或与其一致时，这个规则匹配。}} \tabularnewline
{{{\texttt{{zonesub}}}}} & {{这个规则与subdomain类似，除了当被更新的名字 是配置了{\bfseries{update-policy}}语句 的区的子域时，它会匹配。这就排除了两次输入 区名的需要，并且能够在多个区中使用标准的 {\bfseries{update-policy}}语句而不需要 修改。  \par  在使用这条规则时，{\ttfamily\itshape{{name}}} 字段会被忽略。}} \tabularnewline
{{{\texttt{{wildcard}}}}} & {{{\ttfamily\itshape{{name}}}字段服从DNS通配符扩展， 当被更新的名字是一个通配符的有效扩展时，这条规则匹配。}} \tabularnewline
{{{\texttt{{self}}}}} & {{当被更新的名字匹配{\ttfamily\itshape{{identity}}}字 段的内容时，这条规则匹配。 {\ttfamily\itshape{{name}}}字段被忽略，但是应该与 {\ttfamily\itshape{{identity}}}字段一致。在允许使用 每个名字一个密钥时，{\texttt{{self}}}名字类型是最 有用的，这时密钥与被更新的名字有同样的名字。这种情况下， {\ttfamily\itshape{{identity}}}应被指定为 {\texttt{{*}}}（星号）。}} \tabularnewline
{{{\texttt{{selfsub}}}}} & {{这条规则与{\texttt{{self}}}相似，除了 {\texttt{{self}}}的子域也可以被更新之外。}} \tabularnewline
{{{\texttt{{selfwild}}}}} & {{这条规则与{\texttt{{self}}}相似，除了仅仅只有 {\texttt{{self}}}的子域才能被更新之外。}} \tabularnewline
{{{\texttt{{ms-self}}}}} & {{这条规则接受Windows机器标识（machine\$@REALM）作为 域（REALM）中的机器，并将其转换为machine.realm， 允许这台机器更新machine.realm。所匹配的域（REALM）在 {\ttfamily\itshape{{identity}}}字段中指定。}} \tabularnewline
{{{\texttt{{ms-subdomain}}}}} & {{这条规则接受Windows机器标识（machine\$@REALM）作为 域（REALM）中的机器，并将其转换为machine.realm， 允许这台机器更新machine.realm的子域。 所匹配的域（REALM）在 {\ttfamily\itshape{{identity}}}字段中指定。}} \tabularnewline
{{{\texttt{{krb5-self}}}}} & {{这条规则接受Kerberos机器标识（host/machine@REALM）作为 域（REALM）中的机器，并将其转换为machine.realm， 允许这台机器更新machine.realm。所匹配的域（REALM）在 {\ttfamily\itshape{{identity}}}字段中指定。}} \tabularnewline
{{{\texttt{{krb5-subdomain}}}}} & {{这条规则接受Kerberos机器标识（host/machine@REALM）作为 域（REALM）中的机器，并将其转换为machine.realm， 允许这台机器更新machine.realm的子域。 所匹配的域（REALM）在 {\ttfamily\itshape{{identity}}}字段中指定。}} \tabularnewline
{{{\texttt{{tcp-self}}}}} & {{允许通过TCP发送更新，并且对这些更新，从发起更新的 IP地址到IN-ADDR.ARPA和IP6.ARPA名字空间进行标准的 映射，并与被更新的名字进行匹配。 
\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
理论上有可能欺骗这些TCP会话。\end{admonition}

}} \tabularnewline
{{{\texttt{{6to4-self}}}}} & {{允许通过任何从6to4网络或从对应的IPv4地址的TCP连接 更新6to4前缀。这是计划允许NS或DNAME资源记录集被添加 到反向树中。 
\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
理论上有可能欺骗这些TCP会话。\end{admonition}

}} \tabularnewline
{{{\texttt{{external}}}}} & {{这个规则允许{\bfseries{named}}推迟决定是否允许 一个给定的更新到一个外部的服务进程。  \par  和服务进程通信的方法在 {\ttfamily\itshape{{identity}}}字段中指定，其格式是 “{\texttt{{local:}}}{\ttfamily\itshape{{path}}}”， 这里{\ttfamily\itshape{{path}}}是一个UNIX域套接字 的位置。（当前，“local”是唯一支持的机制。）  \par  到外部服务进程的请求通过UNIX域套接字以数据报发送，其 格式为：  \par \texttt{
   Protocol version number (4 bytes, network byte order, currently 1)
   Request length (4 bytes, network byte order)
   Signer (null-terminated string)
   Name (null-terminated string)
   TCP source address (null-terminated string)
   Rdata type (null-terminated string)
   Key (null-terminated string)
   TKEY token length (4 bytes, network byte order)
   TKEY token (remainder of packet)} 服务进程以网络字节序回应一个四字节值，包含0或者1；0 表示指定的更新不被允许，1表示其被允许。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


在所有的情况中，{\ttfamily\itshape{{name}}}字段必须指定为一个 完整域名。

如果没有显式指定types，这条规则就匹配除RRSIG，NS，SOA，NSEC和 NSEC3之外的所有类型。types可以由名字指定，包括“ANY”（ANY匹配除 NSEC和NSEC3之外的所有类型，后者不能被更新）。 注意当遇到一个删除与一个名字相关的所有记录的企图时，需要针对 每个现存记录类型对规则进行检查。
\subsubsection{多视图}
\label{idm178370373664}\hypertarget{idm178370373664}{}%

当使用了多个视图，一个区可能被在超过一个视图中引用。通常，这些 视图会对同样的名字包含不同的区，即运行不同的客户端对同样请求收到 不同的回复。然而，在许多时候，期望多个视图包含同样的区。 {\bfseries{in-view}}区选项提供一个有效的方法来做这事：它 允许一个视图引用在之前一个已配置视图中定义的一个区。例如：

\begin{Verbatim}[]

view internal {
    match-clients { 10/8; };

    zone example.com {
        type master;
        file "example-external.db";
    };
};

view external {
    match-clients { any; };

    zone example.com {
        in-view internal;
    };
};
            
\end{Verbatim}

一个{\bfseries{in-view}}选项不能引用到在配置文件后面定义的 视图。

一个使用了{\bfseries{in-view}}选项的{\bfseries{zone}} 语句不能使用除{\bfseries{forward}}和 {\bfseries{forwarders}}之外的任何其它选项。 （这些选项控制包含视图的行为，而不是改变区对象自身。）

一个{\bfseries{in-view}}区不能用作一个响应策略区。

% ------------------------   
% Section 
\section{区文件}
\label{idm178370366272}\hypertarget{idm178370366272}{}%
\subsection{资源记录的类型及使用时机}
\label{types_of_resource_records_and_when_to_use_them}\hypertarget{types_of_resource_records_and_when_to_use_them}{}%

本节很大部份是引用自RFC 1034，描述资源记录（RR）的概念并解释了其使 用时机。自从RFC 1034公布以来，几种新的RR被确定并在DNS中实现。这些 RR也被包括进来。
\subsubsection{资源记录}
\label{idm178370363728}\hypertarget{idm178370363728}{}%

一个域名标识一个节点。每个节点有一个资源信息的集合，这个集合可以 是空的。资源信息集合与一个由分离的资源记录所组成的特定名字相关。 资源记录在集合中的顺序没有意义，也不会在名字服务器，解析器或DNS的 其它部份中保存。但是，允许出于优化的目的对多个资源记录排序， 例如，指定某个特定的附近的服务器第一个被尝试。参见 \hyperlink{the_sortlist_statement}{第\ref{the_sortlist_statement}节}和 \hyperlink{rrset_ordering}{第\ref{rrset_ordering}节}。

资源记录的组成部份为：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370360464}\hypertarget{idm178370360464}{}%
\begin{longtable}{|p{1.000in}p{3.500in}|}
\hline 
{{owner name}} & {{域名，用于确定资源记录的位置。}} \tabularnewline
{{type}} & {{一个编码的16位值，指定资源记录的类型。}} \tabularnewline
{{TTL}} & {{资源记录的生存时间。这个字段是以一个32位整数表示秒数， 主要用于解析器缓存资源记录时。TTL描述一个资源记录在其被 丢弃前可以被缓存多长的时间。}} \tabularnewline
{{class}} & {{一个编码的16位值，指定一个协议族或一个协议的实例。}} \tabularnewline
{{RDATA}} & {{资源数据。数据的格式是与类型（有时包括类）相关的。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


以下是有效资源记录的{\em{类型}}：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370339904}\hypertarget{idm178370339904}{}%
\begin{longtable}{|p{0.875in}p{3.625in}|}
\hline 
{{A}} & {{一个主机地址。在IN类中，这是一个32位的IP地址。 在RFC 1035中描述。}} \tabularnewline
{{AAAA}} & {{IPv6地址。在RFC 1886中描述。}} \tabularnewline
{{A6}} & {{IPv6地址。它可以是一部份地址（一个后缀）加上一个可以找 到其余部份地址（前缀）的间接指向的名字。试验性的。 在RFC 2874中描述。}} \tabularnewline
{{AFSDB}} & {{AFS数据库服务器的位置。试验性的。在RFC 1183中描述。}} \tabularnewline
{{APL}} & {{地址后缀列表。试验性的。在RFC 3123中描述。}} \tabularnewline
{{CERT}} & {{存放一个数字签名。在RFC 2538中描述。}} \tabularnewline
{{CNAME}} & {{指定一个别名的正规名。在RFC 1035中描述。}} \tabularnewline
{{DHCID}} & {{用于识别哪一个DHCP客户端被关联到这个名字。 在RFC 4701中描述。}} \tabularnewline
{{DNAME}} & {{使用另一个名字替代所指定的名字后进行查找，有效地将域名 空间的一个完整子树作为别名，与之相对的使CNAME RR将单个 记录作为别名。在RFC 2672中描述。}} \tabularnewline
{{DNSKEY}} & {{存储与一个签名DNS区相关的公钥。在RFC 4034中描述。}} \tabularnewline
{{DS}} & {{存储与一个签名DNS区相关的公钥的hash。在RFC 4034中描述。}} \tabularnewline
{{GPOS}} & {{指定全球位置。为LOC所替代。}} \tabularnewline
{{HINFO}} & {{指定主机所用的CPU和OS。在RFC 1035中描述。}} \tabularnewline
{{IPSECKEY}} & {{提供一个存储DNS中的IPsec keying材料的方法。 在RFC 4025中描述。}} \tabularnewline
{{ISDN}} & {{ISDN地址的表示。试验性的。在RFC 1183中描述。}} \tabularnewline
{{KEY}} & {{存放一个与DNS名字相关的公钥。用于最初的DNSSEC；现被 DNSSECbis中的DNSKEY所替代，但仍然用于SIG(0)。在RFC 2535 和2931中描述。}} \tabularnewline
{{KX}} & {{指定一个DNS名字的密钥交换者。在RFC 2230中描述。}} \tabularnewline
{{LOC}} & {{存放GPS信息。在RFC 1876中描述。试验性的。}} \tabularnewline
{{MX}} & {{为一个域指定邮件交换者。由邮件交换者的主机名后跟一个16 位的优先数（数值越小越优先）。在RFC 974、RFC 1035中描 述。}} \tabularnewline
{{NAPTR}} & {{名字权威指针。在RFC 2915中描述。}} \tabularnewline
{{NSAP}} & {{一个网络服务访问点。在RFC 1706中描述。}} \tabularnewline
{{NS}} & {{域的权威名字服务器。在RFC 1035中描述。}} \tabularnewline
{{NSEC}} & {{用于DNSSECbis中，指明在某个名字内部并带有属主名的资源记 录不在一个区内，也指明某个存在的名字所提供的资源记录类 型。在RFC 4034中描述。}} \tabularnewline
{{NSEC3}} & {{用于DNSSECbis，以安全地指示在一个区中某一名字 间隔内不存在某个指定名字的资源记录，以及指示 一个存在的名字具有那种资源记录类型。NSEC3与 NSEC的区别是它阻止对区的枚举，但是比NSEC更加 消耗服务器和客户端的计算资源。在RFC 5155中描述。}} \tabularnewline
{{NSEC3PARAM}} & {{用于DNSSECbis，告诉权威服务器哪个NSEC3链是可用 的。在RFC 5155中描述。}} \tabularnewline
{{NXT}} & {{用于DNSSEC中，安全地指明在某个名字之间的给定属主名的资 源记录不存在于一个区中，并指明对一个存在的名字具有哪种 类型的资源记录。在原始的DNSSEC中使用；在DNSSECbis中被 NSEC取代。在RFC 2535中描述。}} \tabularnewline
{{PTR}} & {{指向域名空间另一部份的指针。在RFC 1035中描述。}} \tabularnewline
{{PX}} & {{在RFC 822和X.400地址之间提供映射。在RFC 2163中描述。}} \tabularnewline
{{RP}} & {{关于域的负责人的信息。试验性的。在RFC 1183中描述。}} \tabularnewline
{{RRSIG}} & {{包含DNSSECbis签名数据。在RFC 4034中描述。}} \tabularnewline
{{RT}} & {{绑定在没有自己的直接的广域网地址的主机上的路由出口。 试验性的。在RFC 1183中描述。}} \tabularnewline
{{SIG}} & {{包含DNSSEC签名数据。在原始的DNSSEC中使用；已被DNSSECbis 中的RRSIG所替代，但是仍然用作SIG(0)。在RFC 2535和2931中 描述。}} \tabularnewline
{{SOA}} & {{标识一个授权区的头部。在RFC 1035中描述。}} \tabularnewline
{{SPF}} & {{包含一个给定电子邮件域名的发送者策略框架信息。 在RFC 4408中描述。}} \tabularnewline
{{SRV}} & {{关于众所周知的网络服务的信息（替代WKS）。在RFC 2782中 描述。}} \tabularnewline
{{SSHFP}} & {{提供发布一个安全shell密钥指纹的安全方式。 在RFC 4255中描述。}} \tabularnewline
{{TXT}} & {{文本记录。在RFC 1035中描述。}} \tabularnewline
{{WKS}} & {{关于一个域所支持的众所周知的网络服务的信息，如SMTP。已 成历史。}} \tabularnewline
{{X25}} & {{X.25网络地址的表示。试验性的。在RFC 1183中描述。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


以下是当前DNS中有效的资源记录的{\em{类}}：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370218080}\hypertarget{idm178370218080}{}%
\begin{longtable}{|p{0.875in}p{3.625in}|}
\hline 
{{IN}} & {{Internet。}} \tabularnewline
{{CH}} & {{CHAOSnet，一个MIT在1970年代中期建立的局域网协议。由于其 历史上的目的使用非常少，但是被BIND重新用于服务器内建信 息区，如，{\texttt{{version.\dbz{}bind}}}。}} \tabularnewline
{{HS}} & {{Hesiod，一个由MIT的雅典娜（Athena）项目所开发的 信息服务。它用于在不同的系统数据库之间共享信息， 如用户，用户组，打印机等等。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


主名字通常是隐含的，而不是形成资源记录的一个完整部份。例如，许多 名字服务器在内部为名字空间形成树或hash结构，和资源记录链节点。其 余的资源记录部份是固定的头部（类型，类，TTL），对所有的资源记录是 一致的，还有一个变化的部份（RDATA）要适应其所描述的记录。

TTL字段的含义是一个资源记录可以被保留在缓存中的时间长度。这个限制 不应用到区中的权威数据；它也会过期，但是遵从区的刷新策略。TTL由数 据源的所在区的区管理员指定。短的TTL可以减少缓存，一个为零的TTL禁 止缓存，互联网性能的现实建议对典型的主机，这些时间应该在天的 数量级。如果有一个预期的变化，先在变化之前将TTL减小以在变化期间 缩短不一致的持续时间，然后在变化之后增加回到其原先的值。

资源记录的RDATA部份中的数据作为二进制字符串和域名的一个组成部份被 携带。域名频繁地被用作指向DNS中其它数据的“指针”。
\subsubsection{文本形式的资源记录表示}
\label{idm178370201344}\hypertarget{idm178370201344}{}%

资源记录在DNS协议包内被表示成二进制形式，而在存放到一个名字服务器 或解析器中通常被表示成高级编码的形式。在RFC 1034中提供的例子中， 使用一个类似主文件中的形式来显示资源记录的内容。在这个格式中，大 多数资源记录显示在一行之内，虽然可以使用括号显示到多行中。

一行的开始是资源记录的属主。如果一行以一个空字符开始，属主就假设 是与上一个资源记录一样。通常包含一些空行以增加可读性。

在属主之后，依次列出资源记录的TTL，类型和类。类型和类使用上面所定 义的缩写，TTL是一个整数，在类型字段之前。为了避免词法分析时的 二义，类型和类的缩略语不能连着写，TTL是整数，类型缩略语总是在 最后。IN类和TTL值在例子中通常省略，主要是为了更清楚。

资源数据或者资源记录的RDATA部份根据各种数据的表示方法给出。

例如，我们可能这样显示在一个消息中所携带的资源记录：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370196544}\hypertarget{idm178370196544}{}%
\begin{longtable}{|p{1.381in}p{1.020in}p{2.099in}|}
\hline 
{{{\texttt{{ISI.\dbz{}EDU.\dbz{}}}}}} & {{{\texttt{{MX}}}}} & {{{\texttt{{10 VENERA.\dbz{}ISI.\dbz{}EDU.\dbz{}}}}}} \tabularnewline
{{}} & {{{\texttt{{MX}}}}} & {{{\texttt{{10 VAXA.\dbz{}ISI.\dbz{}EDU}}}}} \tabularnewline
{{{\texttt{{VENERA.\dbz{}ISI.\dbz{}EDU}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{128.\dbz{}9.\dbz{}0.\dbz{}32}}}}} \tabularnewline
{{}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}1.\dbz{}0.\dbz{}52}}}}} \tabularnewline
{{{\texttt{{VAXA.\dbz{}ISI.\dbz{}EDU}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}2.\dbz{}0.\dbz{}27}}}}} \tabularnewline
{{}} & {{{\texttt{{A}}}}} & {{{\texttt{{128.\dbz{}9.\dbz{}0.\dbz{}33}}}}} \tabularnewline
\hline 
\end{longtable}
\end{center}


MX资源记录的RDATA部份由一个16位数字和一个紧随的域名组成。地址资源 记录使用一个标准的IP地址格式来包含一个32位的互联网地址。

上述例子显示6条资源记录，即3个域名，每个域名带有2条资源记录。

类似的我们可以看到：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370161680}\hypertarget{idm178370161680}{}%
\begin{longtable}{|p{1.491in}p{1.067in}p{2.067in}|}
\hline 
{{{\texttt{{XX.\dbz{}LCS.\dbz{}MIT.\dbz{}EDU.\dbz{}}}}}} & {{{\texttt{{IN A}}}}} & {{{\texttt{{10.\dbz{}0.\dbz{}0.\dbz{}44}}}}} \tabularnewline
{{}} & {{{\texttt{{CH A}}}}} & {{{\texttt{{MIT.\dbz{}EDU.\dbz{} 2420}}}}} \tabularnewline
\hline 
\end{longtable}
\end{center}


这个例子显示了{\texttt{{XX.\dbz{}LCS.\dbz{}MIT.\dbz{}EDU}}}的两个地址，分别在 不同的类中。
\subsection{对MX记录的讨论}
\label{idm178370145984}\hypertarget{idm178370145984}{}%

如同上面所描述的，域名服务器将消息存放为一系列资源数据，每个资源数 据都包含一个关于一个给定域名（通常但不总是一个主机）的特定的信息片 段。理解一个资源记录的最简单的方式是将其作为一个数据对，即一个与一 个相关数据匹配的域名，和被存储的一些附加类型信息，后者是用以帮助系 统决定何时资源记录是相关的。

MX记录用于控制电子邮件的投递。在记录中指定的数据是一个优先级和一个 域名。优先级控制电子邮件尝试投递的顺序，数字最小的最优先。如果两个 优先级相同，就随机选择一个服务器。如果一个给定优先级的服务器没有响 应，邮件传输代理（MTA，mail transport agent）将会选择下一个更大的优 先数。优先数大小没有绝对含义－它们仅仅是相对于这个域名的其它MX记录 而言。所给出的域名是邮件将要被投递到的机器。它 {\em{必须}}有一个相关的地址记录（A或者AAAA） --- CNAME是不够的。

对于一个给定域，如果同时有一个CNAME记录和一个MX记录，MX记录就是错误 的，将被忽略。作为替代，邮件将被投递到被CNAME所指向的MX记录所指定的 服务器上。 例如：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370142416}\hypertarget{idm178370142416}{}%
\begin{longtable}{|p{1.708in}p{0.444in}p{0.444in}p{0.976in}p{1.553in}|}
\hline 
{{{\texttt{{example.\dbz{}com.\dbz{}}}}}} & {{{\texttt{{IN}}}}} & {{{\texttt{{MX}}}}} & {{{\texttt{{10}}}}} & {{{\texttt{{mail.\dbz{}example.\dbz{}com.\dbz{}}}}}} \tabularnewline
{{}} & {{{\texttt{{IN}}}}} & {{{\texttt{{MX}}}}} & {{{\texttt{{10}}}}} & {{{\texttt{{mail2.\dbz{}example.\dbz{}com.\dbz{}}}}}} \tabularnewline
{{}} & {{{\texttt{{IN}}}}} & {{{\texttt{{MX}}}}} & {{{\texttt{{20}}}}} & {{{\texttt{{mail.\dbz{}backup.\dbz{}org.\dbz{}}}}}} \tabularnewline
{{{\texttt{{mail.\dbz{}example.\dbz{}com.\dbz{}}}}}} & {{{\texttt{{IN}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}0.\dbz{}0.\dbz{}1}}}}} & {{}} \tabularnewline
{{{\texttt{{mail2.\dbz{}example.\dbz{}com.\dbz{}}}}}} & {{{\texttt{{IN}}}}} & {{{\texttt{{A}}}}} & {{{\texttt{{10.\dbz{}0.\dbz{}0.\dbz{}2}}}}} & {{}} \tabularnewline
\hline 
\end{longtable}
\end{center}


邮件投递将先尝试{\texttt{{mail.\dbz{}example.\dbz{}com}}}和 {\texttt{{mail2.\dbz{}example.\dbz{}com}}}（以任何顺序），然后如果都没有 成功，将会尝试投递到{\texttt{{mail.\dbz{}backup.\dbz{}org}}}。
\subsection{设置TTL}
\label{Setting_TTLs}\hypertarget{Setting_TTLs}{}%

资源记录的生存期字段是一个32位的整数，它的单位为秒，主要用于解析器 缓存资源记录。TTL描述一个资源记录在被丢弃前可以被缓存多长时间。当前 用于一个区文件中的有以下三种类型的TTL。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370094720}\hypertarget{idm178370094720}{}%
\begin{longtable}{|p{0.750in}p{4.375in}|}
\hline 
{{SOA}} & {{SOA的最后一个字段是否定缓存TTL。它控制从你发出的没有这个 域名（NXDOMAIN）的响应会在其它服务器中缓存多长时间。  \par  最大的否定缓存时间是3小时（3h）。}} \tabularnewline
{{\$TTL}} & {{在区文件顶部（在SOA之前）的\$TTL指令给出对每个没有指定TTL 集的资源记录一个缺省的TTL。}} \tabularnewline
{{RR TTLs}} & {{每个资源记录可以有一个以秒为单位的TTL，它将控制其它服务器 可以缓存它多长时间。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


所有这三种TTL的缺省单位都是秒，虽然单位都可以被显式指定，例如， {\texttt{{1h30m}}}。
\subsection{IPv4中的反向映射}
\label{idm178370078976}\hypertarget{idm178370078976}{}%

反向名字解析（即将IP地址翻译成名字）是通过使用 {\em{in-addr.arpa}}域和PTR记录来实现的。in-addr.arpa 域中的条目是以自左向右表示从大到小的方式组成的。这与IP地址通常书写 方式的顺序相反。这样，一个IP地址为10.1.2.3的机器对应的in-addr.arpa 名字为3.2.1.10.in-addr.arpa。这个名字应该有一个PTR资源记录，并且其 数据字段是机器的名字，如果机器有多个名字，作为可选项，也可以有多个 PTR记录。例如，在[example.com]域中：

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370075888}\hypertarget{idm178370075888}{}%
\begin{longtable}{|p{1.125in}p{4.000in}|}
\hline 
{{{\texttt{{\$ORIGIN}}}}} & {{{\texttt{{2.\dbz{}1.\dbz{}10.\dbz{}in-\dbz{}addr.\dbz{}arpa}}}}} \tabularnewline
{{{\texttt{{3}}}}} & {{{\texttt{{IN PTR foo.\dbz{}example.\dbz{}com.\dbz{}}}}}} \tabularnewline
\hline 
\end{longtable}
\end{center}


\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

例子中的{\bfseries{\$ORIGIN}}行用于提供相当于例子的上下文， 仅仅用在实际中不需要出现的地方。它们用于这里，仅仅是指明例子是相 对于所列出的起点。
\end{admonition}

\subsection{其它区文件指令}
\label{idm178370062656}\hypertarget{idm178370062656}{}%

主文件格式最初由RFC 1035定义，后来被扩展。虽然主文件格式本身是类独 立的，但主文件中的所有记录都必须是属于同一个类。

主文件指令包括{\bfseries{\$ORIGIN}}， {\bfseries{\$INCLUDE}}和{\bfseries{\$TTL}}。
\subsubsection{The {\bfseries{@}} (at-sign)}
\label{idm178370059456}\hypertarget{idm178370059456}{}%

当asperand或at符号（@）（译注：即圈a）用于标记（或名字） 字段中时，它表示当前原点。 在区文件的开始处，它就是 \textless{}{\texttt{{zone\_name}}}\textgreater{} （后跟一个结尾的点）。
\subsubsection{{\bfseries{\$ORIGIN}}指令}
\label{idm178370056928}\hypertarget{idm178370056928}{}%

语法：{\bfseries{\$ORIGIN}} {\ttfamily\itshape{{domain-name}}} [{\ttfamily\itshape{{comment}}}]

{\bfseries{\$ORIGIN}}设置域名，它将被添加到任何不完整记录的 后面。当一个区刚被读入时，有一个隐含的{\bfseries{\$ORIGIN}} \textless{}{\texttt{{zone\_name}}}\textgreater{}{\bfseries{.}} （后跟一个结尾的点）。当前的 {\bfseries{\$ORIGIN}}被添加到{\bfseries{\$ORIGIN}}参数 所指定的域名，如果它不是一个绝对名字。

\begin{Verbatim}[]

$ORIGIN example.com.
WWW     CNAME   MAIN-SERVER

\end{Verbatim}

相当于

\begin{Verbatim}[]

WWW.EXAMPLE.COM. CNAME MAIN-SERVER.EXAMPLE.COM.

\end{Verbatim}
\subsubsection{{\bfseries{\$INCLUDE}}指令}
\label{idm178370049488}\hypertarget{idm178370049488}{}%

语法：{\bfseries{\$INCLUDE}} {\ttfamily\itshape{{filename}}} [{\ttfamily\itshape{{origin}}}] [{\ttfamily\itshape{{comment}}}]

读入并处理文件{\texttt{{filename}}}，就象它在这一点包含此 文件进来。如果设定了{\bfseries{origin}}，文件就使用 {\bfseries{\$ORIGIN}}所设定的值被处理，否则，使用当前 {\bfseries{\$ORIGIN}}。

在被包含的文件被读入之后，起点和当前域名恢复到它们 {\bfseries{\$INCLUDE}}之前的值。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

RFC 1035指定了当前起点应该在一个{\bfseries{\$INCLUDE}}指令 之后恢复，但未对当前域名是否恢复作出规定。BIND 9对两者都恢复。 这可能构成RFC 1035的一个派生，或者一个特征，也许都是。
\end{admonition}

\subsubsection{{\bfseries{\$TTL}}指令}
\label{idm178370040752}\hypertarget{idm178370040752}{}%

语法：{\bfseries{\$TTL}} {\ttfamily\itshape{{default-ttl}}} [{\ttfamily\itshape{{comment}}}]

为此命令之后的未定义TTL的记录设置缺省的生存期（TTL）。有效的TTL值 范围为0-2147483647秒。

{\bfseries{\$TTL}}在RFC 2308中定义。
\subsection{BIND主文件扩展：{\bfseries{\$GENERATE}}指令}
\label{idm178370036016}\hypertarget{idm178370036016}{}%

语法：{\bfseries{\$GENERATE}} {\ttfamily\itshape{{range}}} {\ttfamily\itshape{{lhs}}} [{\ttfamily\itshape{{ttl}}}] [{\ttfamily\itshape{{class}}}] {\ttfamily\itshape{{type}}} {\ttfamily\itshape{{rhs}}} [{\ttfamily\itshape{{comment}}}]

{\bfseries{\$GENERATE}} 用于建立一系列资源记录，它们仅仅只差别一个循环变量。 {\bfseries{\$GENERATE}}可以轻易地生成在RFC 2317中所描述的支持 /24之下的反向授权所要求的一系列记录：无类IN-ADDR.ARPA授权。

\begin{Verbatim}[]
$ORIGIN 0.0.192.IN-ADDR.ARPA.
$GENERATE 1-2 @ NS SERVER$.EXAMPLE.
$GENERATE 1-127 $ CNAME $.0
\end{Verbatim}

等效于

\begin{Verbatim}[]
0.0.0.192.IN-ADDR.ARPA. NS SERVER1.EXAMPLE.
0.0.0.192.IN-ADDR.ARPA. NS SERVER2.EXAMPLE.
1.0.0.192.IN-ADDR.ARPA. CNAME 1.0.0.0.192.IN-ADDR.ARPA.
2.0.0.192.IN-ADDR.ARPA. CNAME 2.0.0.0.192.IN-ADDR.ARPA.
...
127.0.0.192.IN-ADDR.ARPA. CNAME 127.0.0.0.192.IN-ADDR.ARPA.

\end{Verbatim}

生成A和MX记录的集合。注意MX的右侧是一个被引号包含的字符串。 在右侧被处理时，引号会被去掉。

\begin{Verbatim}[]

$ORIGIN EXAMPLE.
$GENERATE 1-127 HOST-$ A 1.2.3.$
$GENERATE 1-127 HOST-$ MX "0 ."
\end{Verbatim}

等效于

\begin{Verbatim}[]
HOST-1.EXAMPLE.   A  1.2.3.1
HOST-1.EXAMPLE.   MX 0 .
HOST-2.EXAMPLE.   A  1.2.3.2
HOST-2.EXAMPLE.   MX 0 .
HOST-3.EXAMPLE.   A  1.2.3.3
HOST-3.EXAMPLE.   MX 0 .
...
HOST-127.EXAMPLE. A  1.2.3.127
HOST-127.EXAMPLE. MX 0 .

\end{Verbatim}

% tabular ------------------------------------------------------
\begin{center}
\label{idm178370025344}\hypertarget{idm178370025344}{}%
\begin{longtable}{|p{0.875in}p{4.250in}|}
\hline 
{{{\bfseries{range}}}} & {{这个可以有两种格式：start-stop或start-stop/step。如果使用 第一种格式，step就被设为1。start，stop和step都必须是介于0 和(2\textasciicircum{}31)-1之间的正整数。start必须小于等于stop。 为正值。}} \tabularnewline
{{{\bfseries{lhs}}}} & {{描述所建立的资源记录的属主名。任何在 {\bfseries{lhs}}串中的单个{\bfseries{\$}}（美元 符号）都被循环变量所替代。要在输出部份输出\$，需要使用一个 反斜线{\bfseries{\textbackslash}}对{\bfseries{\$}}进行 转义，例如{\bfseries{\textbackslash \$}}。可选地， {\bfseries{\$}}符号后可以跟修饰符，其作用是改变 循环器、宽度和进制的偏移量。修饰符由一个 {\bfseries{\{}}（左花括号） 引入，它紧接着{\bfseries{\$}}符号，即 {\bfseries{\$\{offset[,width[,base]]\}}}。例如， {\bfseries{\$\{-20,3,d\}}}从当前值减去20，打印“作为十 进制数，以0填充，宽度为3”的结果。可用的输出格式是十进制 （{\bfseries{d}}）， 八进制（{\bfseries{o}}）， 十六进制（{\bfseries{x}}或{\bfseries{X}}， 后者为大写输出） 和半字节（{\bfseries{n}}或{\bfseries{N}}， 后者为大写输出）。缺省修饰符是 {\bfseries{\$\{0,0,d\}}}。 如果{\bfseries{lhs}}不是 绝对名字，就将当前{\bfseries{\$ORIGIN}}添加在 名字后面。  \par  在半字节模式中，值会被当成一个倒置的十六进制串， 每个十六进制数字都是一个单独的标记。宽度域包含 标记分隔符。  \par  为了对早期版本的兼容，{\bfseries{\$\$}}仍然被识别，作 为指示在输出中的一个字面的\$。}} \tabularnewline
{{{\bfseries{ttl}}}} & {{指定所生成的记录的生存期。如果在这里未指定，就使用正常的 TTL继承规则来继承。  \par  {\bfseries{class}}和{\bfseries{ttl}}的位置可 以互换。}} \tabularnewline
{{{\bfseries{class}}}} & {{指定所生成的记录的类。如果指定，必须与区的类一致。  \par  {\bfseries{class}}和{\bfseries{ttl}}的位置可 以互换。}} \tabularnewline
{{{\bfseries{type}}}} & {{所有有效的类型。}} \tabularnewline
{{{\bfseries{rhs}}}} & {{{\bfseries{rhs}}，可选，被引号包含的字符串。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


{\bfseries{\$GENERATE}}指令是一个BIND 的扩展，并不是标准区文件格式的一部份。

BIND 8不支持可选的TTL和CLASS字段。
\subsection{附加文件格式}
\label{zonefile_format}\hypertarget{zonefile_format}{}%

除了标准的文件格式，BIND 9支持读或者列出其它格式区文件的能力。

{\texttt{{raw}}}格式是区数据的一个二进制表示，类似于在 区传送中使用的方式。由于它不要求对文本进行语法分析，装载时间显著 缩短。

一个更快的替代方法是{\texttt{{map}}}格式，它是一个 BIND 9内存区数据库的镜像；它适合使用 {\bfseries{mmap()}}函数直接装载到内存中；区几乎可以 立即开始对请求提供服务。

对一个主服务器，一个{\texttt{{raw}}}或 {\texttt{{map}}}格式的区可以通过 {\bfseries{named-compilezone}}命令从一个文本区文件生成。对 辅服务器或者动态区，它是在{\bfseries{named}}完成区传送之后 转储区或者应用上次的更新时自动生成的（如果使用 {\bfseries{masterfile-format}}选项指定了这种格式）。

如果需要手工修改一个二进制格式的区文件，必须先将其通过 {\bfseries{named-compilezone}}命令转换为文本格式。所有需要进 行的修改都应在文本文件中，然后再使用 {\bfseries{named-compilezone}}命令将其转换为二进制格式。

注意{\bfseries{map}}格式是及其体系相关的。一个 {\texttt{{map}}}文件{\em{不能}}用于一个与 生成数据的系统具有不同指针大小、字节序或数据对齐的系统，通常应该 只用于同样单个系统内部。 由于{\texttt{{raw}}}格式使用网络字节顺序避免了体系依赖的数 据对齐，所以它是尽可能可移植的，但是它还是最好用于同样的单个系统的 内部。 为导出一个{\texttt{{raw}}}或者{\texttt{{map}}}格式 的区文件，或者给这样的文件做一个可移植的备份，推荐将其转换为 {\texttt{{text}}}格式。

% ------------------------   
% Section 
\section{BIND9统计}
\label{statistics}\hypertarget{statistics}{}%

BIND 9维护许多统计信息并为用户提供几个 接口来访问这些统计。 可用的统计包括BIND 8中可用的并在 BIND 9有意义的所有统计计数器， 以及其它被认为有用的信息。

统计信息分类成下列部份。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178369970272}\hypertarget{idm178369970272}{}%
\begin{longtable}{|p{3.300in}|p{2.625in}|}
\hline 
{{Incoming Requests（进入请求）}} & {{对每个OPCODE的进入的DNS请求数目。}} \tabularnewline
 \hline 
{{Incoming Queries（进入查询）}} & {{对每个资源记录类型的进入的查询数目。}} \tabularnewline
 \hline 
{{Outgoing Queries（出去查询）}} & {{从内部解析器向外发出的对每个资源记录类型的 查询数目。 每个视图各自维护。}} \tabularnewline
 \hline 
{{Name Server Statistics（名字服务器统计）}} & {{关于进入请求处理的统计计数器。}} \tabularnewline
 \hline 
{{Zone Maintenance Statistics（区维护统计）}} & {{关于区维护操作，如区传送，的统计计数器。}} \tabularnewline
 \hline 
{{Resolver Statistics（解析器统计）}} & {{关于内部解析器所执行的名字解析的统计计数器。 每个视图各自维护。}} \tabularnewline
 \hline 
{{Cache DB RRsets（缓存数据资源记录集）}} & {{存放在缓存数据库中的每种资源记录类型的资源记录集 和不存在的名字的数目。 如果为某个资源记录类型打印了惊叹号（!），它表示 特定类型的资源记录是不存在的（也即“NXRRSET”）。 如果出现一个散列符号（\#），资源记录集被标记为垃圾回收。 每个视图各自维护。}} \tabularnewline
 \hline 
{{Socket I/O Statistics（套接字I/O统计）}} & {{网络相关事件的统计计数器。}} \tabularnewline
\hline 
\end{longtable}
\end{center}


当{\bfseries{zone-statistics}}被设为 {\ttfamily\bfseries{{yes}}}时，对服务器是其权威的每个区， 都收集并显示名字服务器统计的一个子集。 这些统计计数器与其区和视图名一起显示。 在某些情况，缺省视图的视图名被省略。

当前有两种用户接口可以用来访问统计信息。 一个是普通文本格式，转印到由{\bfseries{statistics-file}} 配置选项所指定的文件中。 另一个是通过在配置文件中的{\bfseries{statistics-channels}} 语句所指定的统计通道远程访问。 （参见\hyperlink{statschannels}{第\ref{statschannels}节}）。
\subsubsection{统计文件}
\label{statsfile}\hypertarget{statsfile}{}%

文本格式的统计转印以类似下面这一行开始：

{\bfseries{+++ Statistics Dump +++ (973798949)}}

括号中的数是标准的UNIX风格的时间戳，是自1970年1月1日以来的秒数。 后面紧接的行是一个统计信息的集合，其分类在上面已描述。 每部份以类似下面这一行开始：

{\bfseries{++ Name Server Statistics ++}}

每个部份由一些行组成，每行包含统计计数器的值，后面有文本描述。 参见下面的可用的计数器。 为简短起见，值为0的计数器没有显示在统计文件中。

统计转印结束是一个带有与开始行同样数字的行；例如：

{\bfseries{--- Statistics Dump --- (973798949)}}
\subsection{统计计数器}
\label{statistics_counters}\hypertarget{statistics_counters}{}%

下表概括了BIND所提供的统计计数器。 对表的每一行，最左一列是计数器的缩写符号名。 这些符号显示在可以通过HTTP统计通道访问的统计信息页面上。 最右列给出了计数器的描述，这也显示在统计文件上（但是， 在本文档中，为了更好的可读性可能做了一点修改）。 附加的说明也在这列提供。当这两列之间的中间列存在时， 它给出BIND 8统计中对应的计数器名， 如果合适的时候。
\subsubsection{名字服务器统计计数器}
\label{idm178369928944}\hypertarget{idm178369928944}{}%

% tabular ------------------------------------------------------
\begin{center}
\label{idm178369928272}\hypertarget{idm178369928272}{}%
\begin{longtable}{|p{1.150in}p{1.150in}p{3.350in}|}
\hline 
{{{\em{Symbol}}}} & {{{\em{BIND8 Symbol}}}} & {{{\em{Description}}}} \tabularnewline
{{{\bfseries{Requestv4}}}} & {{{\bfseries{RQ}}}} & {{收到的IPv4请求。 注意：这也会记录不是查询的请求。}} \tabularnewline
{{{\bfseries{Requestv6}}}} & {{{\bfseries{RQ}}}} & {{收到的IPv6请求。 注意：这也会记录不是查询的请求。}} \tabularnewline
{{{\bfseries{ReqEdns0}}}} & {{{\bfseries{}}}} & {{收到的带EDNS(0)的请求。}} \tabularnewline
{{{\bfseries{ReqBadEDNSVer}}}} & {{{\bfseries{}}}} & {{收到的带有不支持的EDNS版本的请求。}} \tabularnewline
{{{\bfseries{ReqTSIG}}}} & {{{\bfseries{}}}} & {{收到的带有TSIG的请求。}} \tabularnewline
{{{\bfseries{ReqSIG0}}}} & {{{\bfseries{}}}} & {{收到的带有SIG(0)的请求。}} \tabularnewline
{{{\bfseries{ReqBadSIG}}}} & {{{\bfseries{}}}} & {{收到的带有不正确(TSIG或SIG(0))签名的请求。}} \tabularnewline
{{{\bfseries{ReqTCP}}}} & {{{\bfseries{RTCP}}}} & {{收到的TCP请求。}} \tabularnewline
{{{\bfseries{AuthQryRej}}}} & {{{\bfseries{RUQ}}}} & {{拒绝掉的权威（非递归）请求。}} \tabularnewline
{{{\bfseries{RecQryRej}}}} & {{{\bfseries{RURQ}}}} & {{拒绝掉的递归查询。}} \tabularnewline
{{{\bfseries{XfrRej}}}} & {{{\bfseries{RUXFR}}}} & {{拒绝掉的区传送请求。}} \tabularnewline
{{{\bfseries{UpdateRej}}}} & {{{\bfseries{RUUpd}}}} & {{拒绝掉的动态更新请求。}} \tabularnewline
{{{\bfseries{Response}}}} & {{{\bfseries{SAns}}}} & {{已发出的响应。}} \tabularnewline
{{{\bfseries{RespTruncated}}}} & {{{\bfseries{}}}} & {{已发出的截断响应。}} \tabularnewline
{{{\bfseries{RespEDNS0}}}} & {{{\bfseries{}}}} & {{已发出的带EDNS(0)的响应。}} \tabularnewline
{{{\bfseries{RespTSIG}}}} & {{{\bfseries{}}}} & {{已发出的带TSIG的响应。}} \tabularnewline
{{{\bfseries{RespSIG0}}}} & {{{\bfseries{}}}} & {{已发出的带SIG(0)的响应。}} \tabularnewline
{{{\bfseries{QrySuccess}}}} & {{{\bfseries{}}}} & {{导致一个成功回答的查询。 这表示请求返回了一个NOERROR应答，并至少带有 一个回答资源记录。 这相当于先前BIND 9版本 中的{\bfseries{success}}计数器。}} \tabularnewline
{{{\bfseries{QryAuthAns}}}} & {{{\bfseries{}}}} & {{导致一个权威回答的查询。}} \tabularnewline
{{{\bfseries{QryNoauthAns}}}} & {{{\bfseries{SNaAns}}}} & {{导致一个非权威回答的查询。}} \tabularnewline
{{{\bfseries{QryReferral}}}} & {{{\bfseries{}}}} & {{导致一个引用回答的查询。 这相当于先前BIND 9版本 中的{\bfseries{referral}}计数器。}} \tabularnewline
{{{\bfseries{QryNxrrset}}}} & {{{\bfseries{}}}} & {{导致在NOERROR响应中没有数据的查询。 这相当于先前BIND 9版本 中的{\bfseries{nxrrset}}计数器。}} \tabularnewline
{{{\bfseries{QrySERVFAIL}}}} & {{{\bfseries{SFail}}}} & {{导致SERVFAIL的查询。}} \tabularnewline
{{{\bfseries{QryFORMERR}}}} & {{{\bfseries{SFErr}}}} & {{导致FORMERR的查询。}} \tabularnewline
{{{\bfseries{QryNXDOMAIN}}}} & {{{\bfseries{SNXD}}}} & {{导致NXDOMAIN的查询。 这相当于先前BIND 9版本 中的{\bfseries{nxdomain}}计数器。}} \tabularnewline
{{{\bfseries{QryRecursion}}}} & {{{\bfseries{RFwdQ}}}} & {{导致服务器执行递归解析以获取最终回答的查询。 这相当于先前BIND 9版本 中的{\bfseries{recursion}}计数器。}} \tabularnewline
{{{\bfseries{QryDuplicate}}}} & {{{\bfseries{RDupQ}}}} & {{导致服务器试图进行递归解析但是却发现已经存在 一个具有同样IP地址、端口、查询ID、名字、类型 和类的查询并且已经被处理过的查询。 这相当于先前BIND 9版本 中的{\bfseries{duplicate}}计数器。}} \tabularnewline
{{{\bfseries{QryDropped}}}} & {{{\bfseries{}}}} & {{服务器所发现的已有的对同一名字、类型和类的递归查询 并随后被丢弃的巨量递归查询。 这是由于{\bfseries{clients-per-query}} 和{\bfseries{max-clients-per-query}} 选项（参见关于\hyperlink{clients-per-query}{{\bfseries{clients-per-query}}} 的描述）所解释的原因而被丢弃的查询的数目。 这相当于先前BIND 9版本 中的{\bfseries{dropped}}计数器。}} \tabularnewline
{{{\bfseries{QryFailure}}}} & {{{\bfseries{}}}} & {{其它查询失败。 这相当于先前BIND 9版本 中的{\bfseries{failure}}计数器。 注意：提供这个计数器主要是为了向后兼容以前的版本。 通常情况一些更细粒度的计数器如 {\bfseries{AuthQryRej}}和 {\bfseries{RecQryRej}}也落在这个计数器范围中， 所以在实际中，这个计数器的意义不大。}} \tabularnewline
{{{\bfseries{XfrReqDone}}}} & {{{\bfseries{}}}} & {{已完成的所请求的区传送。}} \tabularnewline
{{{\bfseries{UpdateReqFwd}}}} & {{{\bfseries{}}}} & {{已转发的更新请求。}} \tabularnewline
{{{\bfseries{UpdateRespFwd}}}} & {{{\bfseries{}}}} & {{已转发的更新响应。}} \tabularnewline
{{{\bfseries{UpdateFwdFail}}}} & {{{\bfseries{}}}} & {{已失败的动态更新转发。}} \tabularnewline
{{{\bfseries{UpdateDone}}}} & {{{\bfseries{}}}} & {{已完成的动态更新。}} \tabularnewline
{{{\bfseries{UpdateFail}}}} & {{{\bfseries{}}}} & {{已失败的动态更新。}} \tabularnewline
{{{\bfseries{UpdateBadPrereq}}}} & {{{\bfseries{}}}} & {{由于先决条件失败而被拒绝的动态更新。}} \tabularnewline
{{{\bfseries{RateDropped}}}} & {{{\bfseries{}}}} & {{被比率限制丢弃的响应。}} \tabularnewline
{{{\bfseries{RateSlipped}}}} & {{{\bfseries{}}}} & {{被比率限制截断的响应。}} \tabularnewline
{{{\bfseries{RPZRewrites}}}} & {{{\bfseries{}}}} & {{响应策略区重写。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsubsection{区维护统计计数器}
\label{idm178369735408}\hypertarget{idm178369735408}{}%

% tabular ------------------------------------------------------
\begin{center}
\label{idm178369734768}\hypertarget{idm178369734768}{}%
\begin{longtable}{|p{1.150in}p{3.350in}|}
\hline 
{{{\em{Symbol}}}} & {{{\em{Description}}}} \tabularnewline
{{{\bfseries{NotifyOutv4}}}} & {{已发送的IPv4通知。}} \tabularnewline
{{{\bfseries{NotifyOutv6}}}} & {{已发送的IPv6通知。}} \tabularnewline
{{{\bfseries{NotifyInv4}}}} & {{收到的IPv4通知。}} \tabularnewline
{{{\bfseries{NotifyInv6}}}} & {{收到的IPv6通知。}} \tabularnewline
{{{\bfseries{NotifyRej}}}} & {{拒绝掉的进入通知。}} \tabularnewline
{{{\bfseries{SOAOutv4}}}} & {{发送出的IPv4 SOA查询。}} \tabularnewline
{{{\bfseries{SOAOutv6}}}} & {{发送出的IPv6 SOA查询。}} \tabularnewline
{{{\bfseries{AXFRReqv4}}}} & {{已请求的IPv4 AXFR。}} \tabularnewline
{{{\bfseries{AXFRReqv6}}}} & {{已请求的IPv6 AXFR。}} \tabularnewline
{{{\bfseries{IXFRReqv4}}}} & {{已请求的IPv4 IXFR。}} \tabularnewline
{{{\bfseries{IXFRReqv6}}}} & {{已请求的IPv6 IXFR。}} \tabularnewline
{{{\bfseries{XfrSuccess}}}} & {{已成功的区传送请求。}} \tabularnewline
{{{\bfseries{XfrFail}}}} & {{已失败的区传送请求。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsubsection{解析器统计计数器}
\label{idm178369688976}\hypertarget{idm178369688976}{}%

% tabular ------------------------------------------------------
\begin{center}
\label{idm178369688336}\hypertarget{idm178369688336}{}%
\begin{longtable}{|p{1.150in}p{1.150in}p{3.350in}|}
\hline 
{{{\em{Symbol}}}} & {{{\em{BIND8 Symbol}}}} & {{{\em{Description}}}} \tabularnewline
{{{\bfseries{Queryv4}}}} & {{{\bfseries{SFwdQ}}}} & {{已发送的IPv4查询。}} \tabularnewline
{{{\bfseries{Queryv6}}}} & {{{\bfseries{SFwdQ}}}} & {{已发送的IPv6查询。}} \tabularnewline
{{{\bfseries{Responsev4}}}} & {{{\bfseries{RR}}}} & {{已收到的IPv4响应。}} \tabularnewline
{{{\bfseries{Responsev6}}}} & {{{\bfseries{RR}}}} & {{已收到的IPv6响应。}} \tabularnewline
{{{\bfseries{NXDOMAIN}}}} & {{{\bfseries{RNXD}}}} & {{已收到的NXDOMAIN。}} \tabularnewline
{{{\bfseries{SERVFAIL}}}} & {{{\bfseries{RFail}}}} & {{已收到的SERVFAIL。}} \tabularnewline
{{{\bfseries{FORMERR}}}} & {{{\bfseries{RFErr}}}} & {{已收到的FORMERR。}} \tabularnewline
{{{\bfseries{OtherError}}}} & {{{\bfseries{RErr}}}} & {{已收到的其它错误。}} \tabularnewline
{{{\bfseries{EDNS0Fail}}}} & {{{\bfseries{}}}} & {{EDNS(0)查询失败。}} \tabularnewline
{{{\bfseries{Mismatch}}}} & {{{\bfseries{RDupR}}}} & {{已收到的不匹配响应。 DNS ID，响应的源地址和（或）响应的源端口与 预计的不匹配。 （端口必须是53或{\bfseries{port}}所 定义的。）这可能暗示一个缓存污染攻击。}} \tabularnewline
{{{\bfseries{Truncated}}}} & {{{\bfseries{}}}} & {{已收到的截断响应。}} \tabularnewline
{{{\bfseries{Lame}}}} & {{{\bfseries{RLame}}}} & {{已收到的不完整授权。}} \tabularnewline
{{{\bfseries{Retry}}}} & {{{\bfseries{SDupQ}}}} & {{执行过的查询重试。}} \tabularnewline
{{{\bfseries{QueryAbort}}}} & {{{\bfseries{}}}} & {{由于配额控制而被终止的查询。}} \tabularnewline
{{{\bfseries{QuerySockFail}}}} & {{{\bfseries{}}}} & {{打开查询套接字时的失败。 这类失败的一个通常原因是由于在文件描述符 上的限制而导致打开一个新套接字失败。}} \tabularnewline
{{{\bfseries{QueryTimeout}}}} & {{{\bfseries{}}}} & {{查询超时。}} \tabularnewline
{{{\bfseries{GlueFetchv4}}}} & {{{\bfseries{SSysQ}}}} & {{发起的取IPv4 NS的地址操作。}} \tabularnewline
{{{\bfseries{GlueFetchv6}}}} & {{{\bfseries{SSysQ}}}} & {{发起的取IPv6 NS的地址操作。}} \tabularnewline
{{{\bfseries{GlueFetchv4Fail}}}} & {{{\bfseries{}}}} & {{失败的取IPv4 NS的地址操作。}} \tabularnewline
{{{\bfseries{GlueFetchv6Fail}}}} & {{{\bfseries{}}}} & {{失败的取IPv6 NS的地址操作。}} \tabularnewline
{{{\bfseries{ValAttempt}}}} & {{{\bfseries{}}}} & {{试探过的DNSSEC验证。}} \tabularnewline
{{{\bfseries{ValOk}}}} & {{{\bfseries{}}}} & {{成功的DNSSEC验证。}} \tabularnewline
{{{\bfseries{ValNegOk}}}} & {{{\bfseries{}}}} & {{在否定信息上成功的DNSSEC验证。}} \tabularnewline
{{{\bfseries{ValFail}}}} & {{{\bfseries{}}}} & {{失败的DNSSEC验证。}} \tabularnewline
{{{\bfseries{QryRTTnn}}}} & {{{\bfseries{}}}} & {{请求往返时间（RTT）的频率表。 每个{\bfseries{nn}}指定相应的频率。 在序列 {\bfseries{nn\_1}}， {\bfseries{nn\_2}}， ...， {\bfseries{nn\_m}}中， {\bfseries{nn\_i}}的值是其RTT在 {\bfseries{nn\_(i-1)}}（含）和 {\bfseries{nn\_i}}（不含）之间毫秒的 请求的数目。 为方便起见，我们将{\bfseries{nn\_0}} 定义为0。 最后的条目应该表示为{\bfseries{nn\_m+}}， 它表示其RTT等于或大于 {\bfseries{nn\_m}}毫秒的请求的数目。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsubsection{套接字I/O统计计数器}
\label{idm178369572512}\hypertarget{idm178369572512}{}%

套接字I/O统计计数器是按每种套接字类型定义的，它们是 {\bfseries{UDP4}} （UDP/IPv4）， {\bfseries{UDP6}} （UDP/IPv6）， {\bfseries{TCP4}} （TCP/IPv4）， {\bfseries{TCP6}} （TCP/IPv6）， {\bfseries{Unix}} （Unix Domain)和 {\bfseries{FDwatch}} （朝套接字模块外打开的套接字）。 在下面的表中{\bfseries{\textless{}TYPE\textgreater{}}} 表示一个套接字类型。 并非所有套接字都可以使用所有的计数器； 在描述字段会说明例外情况。

% tabular ------------------------------------------------------
\begin{center}
\label{idm178369567488}\hypertarget{idm178369567488}{}%
\begin{longtable}{|p{1.150in}p{3.350in}|}
\hline 
{{{\em{Symbol}}}} & {{{\em{Description}}}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}Open}}}} & {{套接字成功打开。 这个计数器不适用于 {\bfseries{FDwatch}}类型。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}OpenFail}}}} & {{套接字打开失败。 这个计数器不适用于 {\bfseries{FDwatch}}类型。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}Close}}}} & {{套接字关闭。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}BindFail}}}} & {{绑定套接字失败。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}ConnFail}}}} & {{连接套接字失败。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}Conn}}}} & {{成功建立连接。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}AcceptFail}}}} & {{接受进入连接请求失败。 这个计数器不适用于{\bfseries{UDP}}和 {\bfseries{FDwatch}}类型。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}Accept}}}} & {{成功接受进入连接请求。 这个计数器不适用于{\bfseries{UDP}}和 {\bfseries{FDwatch}}类型。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}SendErr}}}} & {{套接字发送操作中的错误。 这个计数器对应于{\bfseries{BIND}} 8 的{\bfseries{SErr}}计数器。}} \tabularnewline
{{{\bfseries{\textless{}TYPE\textgreater{}RecvErr}}}} & {{套接字接收操作中的错误。 这包括在一个收到ICMP错误消息通知的已连接UDP 套接字上发送操作的错误。}} \tabularnewline
\hline 
\end{longtable}
\end{center}

\subsubsection{对{\em{BIND}} 8计数器的兼容性}
\label{idm178369525936}\hypertarget{idm178369525936}{}%

如以上的表格所示，大多数在{\bfseries{BIND}} 8中 可用的统计计数器在{\bfseries{BIND}} 9中也被支持。 这里有一些关于这些表格中没有的其它计数器的注意事项。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RFwdR,SFwdR}}}]\null{}
这些计数器不被支持，因为{\bfseries{BIND}} 9 没有采用{\bfseries{BIND}} 8中所采用的 {\em{forwarding}}概念。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RAXFR}}}]\null{}
这个计数器在进入查询部份中是可访问的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{RIQ}}}]\null{}
这个计数器在进入请求部份中是可访问的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{ROpts}}}]\null{}
这个计数器已不再支持，因为 {\bfseries{BIND}} 9不关心第一个位置的IP选项。
\end{description}

% -------------------------------------------------------------
% Chapter BIND 9安全考虑 
% ------------------------------------------------------------- 	
\chapter{BIND 9安全考虑}
\label{Bv9ARM-gbk.ch07}\hypertarget{Bv9ARM-gbk.ch07}{}%

% ------------------------   
% Section 
\section{访问控制表}
\label{Access_Control_Lists}\hypertarget{Access_Control_Lists}{}%

访问控制表（Access Control Lists，ACL）是地址匹配表，你可以建立并 命名，以备以后用于{\bfseries{allow-notify}}， {\bfseries{allow-query}}，{\bfseries{allow-query-on}}， {\bfseries{allow-recursion}}，{\bfseries{allow-recursion-on}}， {\bfseries{blackhole}}，{\bfseries{allow-transfer}} 等语句中。

使用ACL允许你对谁能够访问你的名字服务器有一个良好的控制，而不会用巨大 的IP地址表将你的配置文件搞混乱。

使用ACL并控制对你的服务器的访问是一个{\em{好主意}}。限 制外来者访问你的服务器可以帮助阻止对你的服务器的欺骗和拒绝服务（DoS） 攻击。

这是一个如何正确应用ACL的例子：

\begin{Verbatim}[]

// Set up an ACL named "bogusnets" that will block
// RFC1918 space and some reserved space, which is
// commonly used in spoofing attacks.
acl bogusnets {
        0.0.0.0/8; 192.0.2.0/24; 224.0.0.0/3;
        10.0.0.0/8; 172.16.0.0/12; 192.168.0.0/16;
};

// Set up an ACL called our-nets. Replace this with the
// real IP numbers.
acl our-nets { x.x.x.x/24; x.x.x.x/21; };
options {
  ...
  ...
  allow-query { our-nets; };
  allow-recursion { our-nets; };
  ...
  blackhole { bogusnets; };
  ...
};

zone "example.com" {
  type master;
  file "m/example.com";
  allow-query { any; };
};

\end{Verbatim}

这将允许外部对服务器进行递归查询，除非在之前递归被禁止。

% ------------------------   
% Section 
\section{{\bfseries{Chroot}}和{\bfseries{Setuid}}}
\label{idm178369503152}\hypertarget{idm178369503152}{}%

在UNIX服务器上，可以通过为{\bfseries{named}} 设定“{\texttt{{-t}}}”选项 BIND运行在{\em{chroot}}的环境中 （使用{\bfseries{chroot()}}函数）。这可以帮助增进系统的安全性， 它通过将BIND放入一个“沙箱”，后者将在服务器遇到危 险时把损坏限制在一个局部范围内。

UNIX版本的BIND的另外一个能力是作为一个非特权用户 （{\texttt{{-u}}} {\ttfamily\itshape{{user}}}）身份运行服务。 我们建议在使用{\bfseries{chroot}}特征时以一个非特权用户身份 运行。

这里是有个命令行的例子，即将BIND加载到一个 {\bfseries{chroot}}沙箱，{\bfseries{/var/named}}，并且 通过{\bfseries{setuid}}以用户202的身份运行 {\bfseries{named}}：

{\ttfamily\bfseries{{/\dbz{}usr/\dbz{}local/\dbz{}sbin/\dbz{}named -\dbz{}u 202 -\dbz{}t /\dbz{}var/\dbz{}named}}}
\subsection{{\bfseries{chroot}}环境}
\label{idm178369493024}\hypertarget{idm178369493024}{}%

为了让一个{\bfseries{chroot}}环境在一个特定目录（例如， {\texttt{{/\dbz{}var/\dbz{}named}}}）中正常工作，你需要设置一个环境，使 其包含BIND运行所需的所有东西。从 BIND的视角，{\texttt{{/\dbz{}var/\dbz{}named}}}是文 件系统的根。你需要通过调整象{\bfseries{directory}}和 {\bfseries{pid-file}}这样的选项的值来满足这个需求。

与BIND的早期版本不同，典型地，你{\em{不}}需要静态地编 译{\bfseries{named}}，也不需要在新的根下面安装共享库。然而， 依赖于你的操作系统，你可能需要设置诸如这样的一些东西： {\texttt{{/\dbz{}dev/\dbz{}zero}}}， {\texttt{{/\dbz{}dev/\dbz{}random}}}， {\texttt{{/\dbz{}dev/\dbz{}log}}}以及 {\texttt{{/\dbz{}etc/\dbz{}localtime}}}。
\subsection{使用{\bfseries{setuid}}函数}
\label{idm178369485104}\hypertarget{idm178369485104}{}%

在运行{\bfseries{named}}服务之前，在你想让 BIND写的文件上使用{\bfseries{touch}}应用程 序（改变文件访问和修改时间）或者{\bfseries{chown}}应用程序 （设置用户id和/或 组id）。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
注意如果{\bfseries{named}}后台进程是以一个非特权用户身份运行 的，如果服务器重新加载，它将不能够绑定到新的限制端口上。\end{admonition}


% ------------------------   
% Section 
\section{动态更新的安全}
\label{dynamic_update_security}\hypertarget{dynamic_update_security}{}%

应该严格限制对动态更新设施的访问。在早期的BIND版本 中，仅有的方法是基于请求进行动态更新的主机的IP地址，通过在 {\bfseries{allow-update}}区选项中列出一个IP地址或者网络前缀来实 现。由于更新UDP包的源地址非常容易伪造，这个方法是不安全的。另外要注意 的是，如果{\bfseries{allow-update}}选项中所允许的地址包含一个可 以执行转发动态更新的辅服务器的IP地址，主服务器将可能遭受琐碎的攻击， 即通过发送更新到辅服务器，辅服务器使用自己的地址作源地址将其转发到主 服务器，使主服务器毫无怀疑地接受。

由于这些原因，我们强烈推荐通过事务签名（TSIG）来加密和认证所进行的更 新。这就是说，{\bfseries{allow-update}}选项仅应该列出TSIG 密钥名，而不是IP地址或网络前缀。作为另外的选择，也可以使用新的 {\bfseries{update-policy}}选项。

一些站点选择将所有的动态更新的DNS数据保存到一个子域并将子域授权到一个 单独的区。在这种方法中，包含象公共web和邮件服务器的IP地址这样的关键数 据的顶级区就完全不允许对其进行动态更新。

% -------------------------------------------------------------
% Chapter 排除故障 
% ------------------------------------------------------------- 	
\chapter{排除故障}
\label{Bv9ARM-gbk.ch08}\hypertarget{Bv9ARM-gbk.ch08}{}%

% ------------------------   
% Section 
\section{通常问题}
\label{idm178369472992}\hypertarget{idm178369472992}{}%
\subsection{它不工作；我如何判定哪里出错了？}
\label{idm178369472336}\hypertarget{idm178369472336}{}%

解决安装和配置问题的最好方法是通过预先设置日志文件来采取预防性的措 施。日志文件提供了暗示和信息的源头，后者用于判断哪里出现了错误以及 如何来解决问题。

% ------------------------   
% Section 
\section{增加和修改序列号}
\label{idm178369470416}\hypertarget{idm178369470416}{}%

区的序列号只是数字，它们与日期没有联系。大多数人将它们设置成表示日期 的一个数，通常是YYYYMMDDRR的格式。偶尔地，他们会错误地将它们设置为一 个“未来的日期”然后试图通过将其设置为“当前的日期”来纠正错误。这就 产生了问题，因为序列号是用来指示一个区被更新了。如果一个辅服务器上的 序列号小于主服务器上的序列号，辅服务器将试图更新它的区拷贝。

将主服务器的序列号设置成为一个比辅服务器上更小的数意味着辅服务器将不 会执行对它的区拷贝的更新。

解决方案是将数字增加2147483647（2\textasciicircum{}31-1），重新装载区并确保所有的辅服 务器都更新为新的区序列号，然后重新设置数字为你想要的，再重新装载一次 区。

% ------------------------   
% Section 
\section{从哪里获得帮助？}
\label{idm178369466976}\hypertarget{idm178369466976}{}%

互联网系统集团（Internet Systems Consortium，ISC） 对BIND和DHCP服务器提供广泛的支 持和协议服务。可以提供四级费用的支持，每级包括对所有 ISC的程序的支持，产品和培训上的大幅折扣，在故障解 决上的认识优先和非盈利特性请求。另外，ISC提供标准 的支持协议包，它包括的服务从故障解决通告到远程支持。它也包括对 BIND和DHCP的培训。

要讨论对支持的安排，请联系 info@isc.org {\textless}\url{mailto:info@isc.org}{\textgreater}或访问 ISC的主页 {\textless}\url{http://www.isc.org/services/support/}{\textgreater} 以了解更多信息。

\newcommand{\dbappendix}[1]{\chapter{#1}}%
% ------------------------------------------------------------- 
% Appendices start here
% -------------------------------------------------------------
\appendix

% -------------------------------------------------------------
% appendix:  发行注记 
% ------------------------------------------------------------- 	
\dbappendix{发行注记}
\label{Bv9ARM-gbk.ch09}\hypertarget{Bv9ARM-gbk.ch09}{}%

% ------------------------   
% Section 
\section{BIND版本9.10.2的发行注记}
\label{idm178369458720}\hypertarget{idm178369458720}{}%
\subsection{介绍}
\label{relnotes_intro}\hypertarget{relnotes_intro}{}%

本文档总结了在相应的主版本分支上自从上一个BIND产品版本以来的变化。
\subsection{下载}
\label{relnotes_download}\hypertarget{relnotes_download}{}%

最新版的BIND 9软件总是可以在 {\textless}\url{http://www.isc.org/downloads/}{\textgreater}找到。 在那里，你会发现每个版本的附加信息，源码和微软Windows操作系统 上的预编译版本。
\subsection{安全修补}
\label{relnotes_security}\hypertarget{relnotes_security}{}%

\begin{itemize}
%--- Item
\item 
在配置了使用受管理的信任锚（即，通过 {\bfseries{managed-keys}}显式配置密钥，或通过 {\bfseries{dnssec-validation auto;}}或者 {\bfseries{dnssec-lookaside auto;}}隐式配置）来执行DNSSEC验证 的服务器上，撤销一个信任锚并发送一个新的未受信任的替代者可能导致 {\bfseries{named}}崩溃并伴有一个断言失败。 这可能发生在一个botched密钥轮转事件中，或者潜在地作为一个故意攻击的结果， 如果攻击者处于监控牺牲者DNS流量的位置上。

这个缺陷由Jan-Piet Mens发现，并在CVE-2015-1349中公开。 [RT \#38344]


%--- Item
\item 
一个授权处理中的缺陷可能被利用并将{\bfseries{named}}置于 一个无限循环中，在其中每个对一个名字服务器的查找都触发附加的对 更多名字服务器的查找。这已被处理，通过限制{\bfseries{named}}所 允许的递归层级数目（缺省是7），和在中断一个递归请求之前它会发出的 请求个数（缺省是50）。

递归深度限制由{\texttt{{max-recursion-depth}}}选项配置， 而请求限制由{\texttt{{max-recursion-queries}}}选项配置。

这个缺陷由ANSSI的Florian Maury发现，并在CVE-2014-8500中公开。 [RT \#37580]


%--- Item
\item 
在BIND的GeoIP代码中，有两个分离的问题被鉴定可能导致一个断言失败。 其中一个由同时使用IPv4和IPv6地址族所触发，另一个由在 {\texttt{{named.\dbz{}conf}}}中引用了一个GeoIP数据库却未安装这个 数据库所触发。这两个都被CVE-2014-8680所覆盖。 [RT \#37672] [RT \#37679]

一个不太严重的安全缺陷也在GeoIP中被发现：在运行 {\bfseries{rndc reconfig}}时，对 {\texttt{{named.\dbz{}conf}}}中的 {\bfseries{geoip-directory}}选项的修改将被忽略。 理论上，这会让{\bfseries{named}}允许非计划的客户端访问。

\end{itemize}
\subsection{新特性}
\label{relnotes_features}\hypertarget{relnotes_features}{}%

\begin{itemize}
%--- Item
\item 
无

\end{itemize}
\subsection{有变化的特性}
\label{relnotes_changes}\hypertarget{relnotes_changes}{}%

\begin{itemize}
%--- Item
\item 
ACLs containing {\bfseries{geoip asnum}} elements were not correctly matched unless the full organization name was specified in the ACL (as in {\bfseries{geoip asnum "AS1234 Example, Inc.";}}). They can now match against the AS number alone (as in {\bfseries{geoip asnum "AS1234";}}).


%--- Item
\item 
在使用原生PKCS\#11加密时（即 {\bfseries{configure --enable-native-pkcs11}}），可以使用 至多256个字符的HSM PIN。


%--- Item
\item 
对DS类型的NXDOMAIN响应现在是与其它类型的记录分开单独进行缓存。 这在使用转发类型的"嫁接"区时较为有用，对这些区来说，父区不包含 一个授权，例如本地顶级域。以前针对这样区的DS类型的请求将会使 区顶点作为NXDOMAIN缓存，并阻塞所有随后的请求。（注意：这个变化 仅在DNSSEC验证关闭时有用。在父区中没有授权的"嫁接"区不是一个 推荐的配置。）


%--- Item
\item 
因为一个区被更新而发出的NOTIFY消息现在被给予比在服务器启动而 计划的NOTIFY消息更高的优先级。 这会减轻区在服务器频繁重启时的传播延迟。


%--- Item
\item 
运行{\bfseries{rndc addzone}}时（例如，当一个区文件不能被 装载时）的错误报告被澄清，以使诊断问题更容易。


%--- Item
\item 
增加对OPENPGPKEY类型的支持。


%--- Item
\item 
当遇到一个权威名字服务器，其名字为一个别名指向另一个名字时， 解析器将这个当成一个错误并调到下一个服务器。 之前这个是静默地发生；现在将会在新建的"cname"日志类别中记录 错误。


%--- Item
\item 
If named is not configured to validate the answer then allow fallback to plain DNS on timeout even when we know the server supports EDNS. This will allow the server to potentially resolve signed queries when TCP is being blocked.

\end{itemize}
\subsection{修补的错误}
\label{relnotes_bugs}\hypertarget{relnotes_bugs}{}%

\begin{itemize}
%--- Item
\item 
{\bfseries{dig}}，{\bfseries{host}}和 {\bfseries{nslookup}}在遇到一个增添了搜索列表中的元素后 超过255字节的名字时异常终止。 现在，这样的名字会被跳过，但会继续处理其它名字。 [RT \#36892]


%--- Item
\item 
当{\bfseries{named-checkzone}}或 {\bfseries{named-checkconf -z}}遇到一个未带值的 {\texttt{{\$TTL}}}指令所生成的错误信息被修改为更清晰。 [RT \#37138]


%--- Item
\item 
当记录被显示为文本时，TXT记录中的分号字符（;）会被反斜线 错误地转意。 这个实际上仅在没有引号时需要。 [RT \#37159]


%--- Item
\item 
When files opened for writing by {\bfseries{named}}, such as zone journal files, were referenced more than once in {\texttt{{named.\dbz{}conf}}}, it could lead to file corruption as multiple threads wrote to the same file. This is now detected when loading {\texttt{{named.\dbz{}conf}}} and reported as an error. [RT \#37172]


%--- Item
\item 
由于私钥文件中的一个差异，{\bfseries{dnssec-keygen -S}}无法对 某些算法类型（包括ECDSA和GOST）生成后续的密钥。 这个已被纠正。 [RT \#37183]


%--- Item
\item 
UPDATE messages that arrived too soon after an {\bfseries{rndc thaw}} could be lost. [RT \#37233]


%--- Item
\item 
当UPDATE消息被SIG(0)签名时，对其的转发不工作；它们导致一个 BADSIG响应码。 [RT \#37216]


%--- Item
\item 
When checking for updates to trust anchors listed in {\texttt{{managed-keys}}}, {\bfseries{named}} now revalidates keys based on the current set of active trust anchors, without relying on any cached record of previous validation. [RT \#37506]


%--- Item
\item 
Large-system tuning ({\bfseries{configure --with-tuning=large}}) caused problems on some platforms by setting a socket receive buffer size that was too large. This is now detected and corrected at run time. [RT \#37187]


%--- Item
\item 
When NXDOMAIN redirection is in use, queries for a name that is present in the redirection zone but a type that is not present will now return NOERROR instead of NXDOMAIN.


%--- Item
\item 
When a zone contained a delegation to an IPv6 name server but not an IPv4 name server, it was possible for a memory reference to be left un-freed. This caused an assertion failure on server shutdown, but was otherwise harmless. [RT \#37796]


%--- Item
\item 
Due to an inadvertent removal of code in the previous release, when {\bfseries{named}} encountered an authoritative name server which dropped all EDNS queries, it did not always try plain DNS. This has been corrected. [RT \#37965]


%--- Item
\item 
A regression caused nsupdate to use the default recursive servers rather than the SOA MNAME server when sending the UPDATE.


%--- Item
\item 
Adjusted max-recursion-queries to accommodate the smaller initial packet sizes used in BIND 9.10 and higher when contacting authoritative servers for the first time.


%--- Item
\item 
内置"空"区不正确地从options或view中继承 "allow-transfer" ACL。 [RT \#38310]


%--- Item
\item 
两个可能导致{\bfseries{named}}进程增长到非常大的内存泄漏 被修复。 [RT \#38454]


%--- Item
\item 
修复一些RFC 5011信任锚管理的错误，包括一个内存泄漏和一个可能的 状态信息丢失。 [RT \#38458]

\end{itemize}
\subsection{生命周期}
\label{end_of_life}\hypertarget{end_of_life}{}%

BIND 9.10的生命周期还未确定，但不会早于BIND 9.12.0发布之后半年。 {\textless}\url{https://www.isc.org/downloads/software-support-policy/}{\textgreater}
\subsection{谢谢你}
\label{relnotes_thanks}\hypertarget{relnotes_thanks}{}%

谢谢每一个你对我们的帮助，使得这个版本成为可能。 如果你想捐助ISC以帮助我们不断提供优质的开源软件，请访问我们的赞助网页 {\textless}\url{http://www.isc.org/donate/}{\textgreater}.

% -------------------------------------------------------------
% appendix:  DNS和BIND的简要历史 
% ------------------------------------------------------------- 	
\dbappendix{DNS和BIND的简要历史}
\label{Bv9ARM-gbk.ch10}\hypertarget{Bv9ARM-gbk.ch10}{}%

% ------------------------   
% Section 
\section{Section}
\label{historical_dns_information}\hypertarget{historical_dns_information}{}%

尽管域名系统的“官方的”开始是随着RFC 920的公布而发生在1984年， 但这个新系统的核心是由RFC 882和883在1983年描述的。 从1984年到1987年，ARPAnet（今天的互联网的前身）成为一个在 快速扩展的、运转中的网络环境中开发新的命名/寻址机制的试验床。 新的RFC于1987年被写作并出版，它们修改了原始的文档以合并进 基于这个工作模式的进展。RFC 1034， “域名 C 概念和设施”，和RFC 1035，“域名 C 实现和规范”出版并成 为所有DNS实现的标准。

第一个可以工作的域名服务器，名叫“Jeeves”，由Paul Mockapetris于 1983-84年在位于南加州大学信息科学研究所（USC-ISI）和SRI国际网络信息 中心（SRI-NIC）上的DEC Tops-20机器上写成的。一个在Unix上的 DNS，伯克利互联网名字域 （Berkeley Internet Name Domain，BIND）包， 是稍后由一组加州大学伯克利分校的研究生在 美国国防部高级研究项目管理局（DARPA）的资助下完成的。

BIND版本直到4.8.3都是由在加州大学伯克利分校的 计算机研究组（CSRG）所维护。Douglas Terry，Mark Painter，David Riggle和 Songnian Zhou组成了最初的BIND项目组。之后， Ralph Campbell在软件包上做了一些增加的工作。Kevin Dunlap， 一个数字设备公司（DEC）的雇员，作为赞助给CSRG的资源， 为BIND工作了2年，从1985年到1987年，在此期间还有 许多其他人也对BIND的开发作出了贡献：Doug Kingston， Craig Partridge，Smoot Carl-Mitchell，Mike Muuss，Jim Bloom和 Mike Schwartz。BIND的维护随后被移交给了 Mike Karels和 {\O}ivind Kure。

BIND版本4.9和4.9.1由数字设备公司发行 （现在是Compaq计算机公司）。Paul Vixie，那时是DEC的一名雇员， 成为了BIND的主要日常维护者。他的助手有 Phil Almquist，Robert Elz，Alan Barrett，Paul Albitz， Bryan Beecher，Andrew Partan，Andy Cherenson，Tom Limoncelli， Berthold Paffrath，Fuat Baran，Anant Kumar，Art Harkin， Win Treese，Don Lewis，Christophe Wolfhugel及其他一些人。

在1994年，BIND版本4.9.2由Vixie公司赞助。 Paul Vixie成为BIND的首席架构师/程序员。

BIND版本自4.9.3之后由互联网系统集团及其前身 互联网软件集团进行开发和维护，并由ISC的赞助商提供支持。

作为共同架构设计师和程序员，Bob Halley和Paul Vixie在1997年5月发布了 第一个BIND版本8的产品级版本。

BIND版本9于2000年9月发布，它几乎重写了BIND体系结构的各个方面。

BIND版本4和8已经正式被废弃了。不再在BIND版本4或BIND版本8 上做进一步的开发了。

今天，在几个公司的赞助下，并且经过许多人的不懈地努力工作， BIND开发工作才成为可能。

% -------------------------------------------------------------
% appendix:  通用DNS参考信息 
% ------------------------------------------------------------- 	
\dbappendix{通用DNS参考信息}
\label{Bv9ARM-gbk.ch11}\hypertarget{Bv9ARM-gbk.ch11}{}%

% ------------------------   
% Section 
\section{IPv6地址（AAAA）}
\label{ipv6addresses}\hypertarget{ipv6addresses}{}%

IPv6地址是128位接口和接口集合的标识符，它被引入 DNS以促进可扩展的互联网路由。有三种类型的地址： {\em{Unicast}}，标识单个接口； {\em{Anycast}}，标识一组接口； 和{\em{Multicast}}，标识一组接口。在这里，我们描述 全球Unicast（单播）地址机制。更多信息， 参见RFC 3587，“全局单播地址格式”。

IPv6单播地址由一个{\em{全局路由前缀}}， 一个{\em{子网标识符}}， 和一个{\em{接口标识符}}所组成。

全局路由前缀有上层提供者或ISP提供，并且（大致地）与IPv4地址范围 的{\em{网络}}部份相对应。子网标识符标识局域子网， 就象在IPv4的/16网络中划分出/24的子网。接口标识符是一个给定网络上 的单个地址；在IPv6中，地址属于接口而不属于主机。

IPv6划分子网的能力比IPv6更灵活：子网划分可以在位边界，相当于无类 域间路由（Classless InterDomain Routing，CIDR）的方式， 并且DNS PTR表示（“半字节”格式）使反向区的设置更为简单。

接口标识符必须在局部连接上是唯一的，并且通常由IPv6实现自动生成， 虽然在需要时，通常可以翻盖缺省设置。一个典型的IPv6地址可能是 这样的： {\bfseries{2001:db8:201:9:a00:20ff:fe81:2b32}}

IPv6地址规范通常包含一大串0，所以架构师引入了指示这个的缩写方式。 一对冒号（‘::’）指示可能出现的最长0串，其在地址中仅能出现一次。

% ------------------------   
% Section 
\section{参考书目（和建议读物）}
\label{bibliography}\hypertarget{bibliography}{}%
\subsection{注释请求（RFC）}
\label{rfcs}\hypertarget{rfcs}{}%

包括DNS的互联网协议族的规范文档是作为注释请求 （RFC）系列的技术备忘的一部份被出版的。标准本身是由互联网工程任务组 （IETF）和互联网专家任务组（IESG）所定义。RFC可以通过 FTP 由以下 地址获得：

ftp://www.isi.edu/in-notes/RFC{\ttfamily\itshape{{xxxx}}}.txt {\textless}\url{ftp://www.isi.edu/in-notes/}{\textgreater}

（在这里{\ttfamily\itshape{{xxxx}}}是RFC的编号）。 RFC也可以通过主页获得：

{\textless}\url{http://www.ietf.org/rfc/}{\textgreater}.
\section*{\docbooktolatexbibnamex}\hypertarget{idm178369361424}{}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{标准}\hypertarget{idm178369361168}{}

% -------------- biblioentry 
\bibitem[{RFC1034}]{RFC1034}\docbooktolatexbibaux{idm178369357376}{RFC1034}
\hypertarget{idm178369357376}{\emph{Domain Names --- Concepts and Facilities}}, P.V. Mockapetris, November 1987.


% -------------- biblioentry 
\bibitem[{RFC1035}]{RFC1035}\docbooktolatexbibaux{idm178369354576}{RFC1035}
\hypertarget{idm178369354576}{\emph{Domain Names --- Implementation and
                  Specification}}, P. V. Mockapetris, November 1987.


% -------------- biblioentry 
\bibitem[{RFC974}]{RFC974}\docbooktolatexbibaux{idm178369360144}{RFC974}
\hypertarget{idm178369360144}{\emph{Mail Routing and the Domain System}}, C. Partridge, January 1986.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{建议标准}\hypertarget{proposed_standards}{}

% -------------- biblioentry 
\bibitem[{RFC1995}]{RFC1995}\docbooktolatexbibaux{idm178369343760}{RFC1995}
\hypertarget{idm178369343760}{\emph{Incremental Zone Transfer in DNS}}, M. Ohta, August 1996.


% -------------- biblioentry 
\bibitem[{RFC1996}]{RFC1996}\docbooktolatexbibaux{idm178369340736}{RFC1996}
\hypertarget{idm178369340736}{\emph{A Mechanism for Prompt Notification of Zone Changes}}, P. Vixie, August 1996.


% -------------- biblioentry 
\bibitem[{RFC2136}]{RFC2136}\docbooktolatexbibaux{idm178369337936}{RFC2136}
\hypertarget{idm178369337936}{\emph{Dynamic Updates in the Domain Name System}}, P. Vixie, S. Thomson, Y. Rekhter, and J. Bound, April 1997.


% -------------- biblioentry 
\bibitem[{RFC2181}]{RFC2181}\docbooktolatexbibaux{idm178369349984}{RFC2181}
\hypertarget{idm178369349984}{\emph{Clarifications to the DNS
                  Specification}}, R., R. Bush Elz, July 1997.


% -------------- biblioentry 
\bibitem[{RFC2308}]{RFC2308}\docbooktolatexbibaux{idm178369346912}{RFC2308}
\hypertarget{idm178369346912}{\emph{Negative Caching of DNS
                  Queries}}, M. Andrews, March 1998.


% -------------- biblioentry 
\bibitem[{RFC2671}]{RFC2671}\docbooktolatexbibaux{idm178369331200}{RFC2671}
\hypertarget{idm178369331200}{\emph{Extension Mechanisms for DNS (EDNS0)}}, P. Vixie, August 1997.


% -------------- biblioentry 
\bibitem[{RFC2672}]{RFC2672}\docbooktolatexbibaux{idm178369328032}{RFC2672}
\hypertarget{idm178369328032}{\emph{Non-Terminal DNS Name Redirection}}, M. Crawford, August 1999.


% -------------- biblioentry 
\bibitem[{RFC2845}]{RFC2845}\docbooktolatexbibaux{idm178369324864}{RFC2845}
\hypertarget{idm178369324864}{\emph{Secret Key Transaction Authentication for DNS (TSIG)}}, P. Vixie, O. Gudmundsson, D. Eastlake, 3rd, and B. Wellington, May 2000.


% -------------- biblioentry 
\bibitem[{RFC2930}]{RFC2930}\docbooktolatexbibaux{idm178369317312}{RFC2930}
\hypertarget{idm178369317312}{\emph{Secret Key Establishment for DNS (TKEY RR)}}, D. Eastlake, 3rd, September 2000.


% -------------- biblioentry 
\bibitem[{RFC2931}]{RFC2931}\docbooktolatexbibaux{idm178369313760}{RFC2931}
\hypertarget{idm178369313760}{\emph{DNS Request and Transaction Signatures (SIG(0)s)}}, D. Eastlake, 3rd, September 2000.


% -------------- biblioentry 
\bibitem[{RFC3007}]{RFC3007}\docbooktolatexbibaux{idm178369310192}{RFC3007}
\hypertarget{idm178369310192}{\emph{Secure Domain Name System (DNS) Dynamic Update}}, B. Wellington, November 2000.


% -------------- biblioentry 
\bibitem[{RFC3645}]{RFC3645}\docbooktolatexbibaux{idm178369307024}{RFC3645}
\hypertarget{idm178369307024}{\emph{Generic Security Service Algorithm for Secret
                       Key Transaction Authentication for DNS
                       (GSS-TSIG)}}, S. Kwan, P. Garg, J. Gilroy, L. Esibov, J. Westhead, and R. Hall, October 2003.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{DNS安全建议标准}\hypertarget{idm178369297792}{}

% -------------- biblioentry 
\bibitem[{RFC3225}]{RFC3225}\docbooktolatexbibaux{idm178369296864}{RFC3225}
\hypertarget{idm178369296864}{\emph{Indicating Resolver Support of DNSSEC}}, D. Conrad, December 2001.


% -------------- biblioentry 
\bibitem[{RFC3833}]{RFC3833}\docbooktolatexbibaux{idm178369293696}{RFC3833}
\hypertarget{idm178369293696}{\emph{Threat Analysis of the Domain Name System (DNS)}}, D. Atkins and R. Austein, August 2004.


% -------------- biblioentry 
\bibitem[{RFC4033}]{RFC4033}\docbooktolatexbibaux{idm178369289360}{RFC4033}
\hypertarget{idm178369289360}{\emph{DNS Security Introduction and Requirements}}, R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose, March 2005.


% -------------- biblioentry 
\bibitem[{RFC4034}]{RFC4034}\docbooktolatexbibaux{idm178369281520}{RFC4034}
\hypertarget{idm178369281520}{\emph{Resource Records for the DNS Security Extensions}}, R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose, March 2005.


% -------------- biblioentry 
\bibitem[{RFC4035}]{RFC4035}\docbooktolatexbibaux{idm178369273664}{RFC4035}
\hypertarget{idm178369273664}{\emph{Protocol Modifications for the DNS
                       Security Extensions}}, R. Arends, R. Austein, M. Larson, D. Massey, and S. Rose, March 2005.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{其它关于DNS实现的重要RFC}\hypertarget{idm178369265664}{}

% -------------- biblioentry 
\bibitem[{RFC1535}]{RFC1535}\docbooktolatexbibaux{idm178369264592}{RFC1535}
\hypertarget{idm178369264592}{\emph{A Security Problem and Proposed Correction With Widely
                  Deployed DNS Software.}}, E. Gavron, October 1993.


% -------------- biblioentry 
\bibitem[{RFC1536}]{RFC1536}\docbooktolatexbibaux{idm178369261360}{RFC1536}
\hypertarget{idm178369261360}{\emph{Common DNS Implementation
                  Errors and Suggested Fixes}}, A. Kumar, J. Postel, C. Neuman, P. Danzig, and S. Miller, October 1993.


% -------------- biblioentry 
\bibitem[{RFC1982}]{RFC1982}\docbooktolatexbibaux{idm178369253104}{RFC1982}
\hypertarget{idm178369253104}{\emph{Serial Number Arithmetic}}, R. Elz and R. Bush, August 1996.


% -------------- biblioentry 
\bibitem[{RFC4074}]{RFC4074}\docbooktolatexbibaux{idm178369248800}{RFC4074}
\hypertarget{idm178369248800}{\emph{Common Misbehaviour Against DNS
                Queries for IPv6 Addresses}}, Y. Morishita and T. Jinmei, May 2005.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{资源记录类型}\hypertarget{idm178369243920}{}

% -------------- biblioentry 
\bibitem[{RFC1183}]{RFC1183}\docbooktolatexbibaux{idm178369243248}{RFC1183}
\hypertarget{idm178369243248}{\emph{New DNS RR Definitions}}, C.F. Everhart, L. A. Mamakos, R. Ullmann, and P. Mockapetris, October 1990.


% -------------- biblioentry 
\bibitem[{RFC1706}]{RFC1706}\docbooktolatexbibaux{idm178369236176}{RFC1706}
\hypertarget{idm178369236176}{\emph{DNS NSAP Resource Records}}, B. Manning and R. Colella, October 1994.


% -------------- biblioentry 
\bibitem[{RFC1876}]{RFC1876}\docbooktolatexbibaux{idm178369227216}{RFC1876}
\hypertarget{idm178369227216}{\emph{A Means for Expressing Location Information in the
                  Domain
                  Name System}}, C. Davis, P. Vixie, T., and I. Dickinson, January 1996.


% -------------- biblioentry 
\bibitem[{RFC2052}]{RFC2052}\docbooktolatexbibaux{idm178369220480}{RFC2052}
\hypertarget{idm178369220480}{\emph{A DNS RR for Specifying the
                  Location of
                  Services.}}, A. Gulbrandsen and P. Vixie, October 1996.


% -------------- biblioentry 
\bibitem[{RFC2163}]{RFC2163}\docbooktolatexbibaux{idm178369215712}{RFC2163}
\hypertarget{idm178369215712}{\emph{Using the Internet DNS to
                  Distribute MIXER
                  Conformant Global Address Mapping}}, A. Allocchio, January 1998.


% -------------- biblioentry 
\bibitem[{RFC2168}]{RFC2168}\docbooktolatexbibaux{idm178369231600}{RFC2168}
\hypertarget{idm178369231600}{\emph{Resolution of Uniform Resource Identifiers using
                  the Domain Name System}}, R. Daniel and M. Mealling, June 1997.


% -------------- biblioentry 
\bibitem[{RFC2230}]{RFC2230}\docbooktolatexbibaux{idm178369212464}{RFC2230}
\hypertarget{idm178369212464}{\emph{Key Exchange Delegation Record for the DNS}}, R. Atkinson, October 1997.


% -------------- biblioentry 
\bibitem[{RFC2536}]{RFC2536}\docbooktolatexbibaux{idm178369209424}{RFC2536}
\hypertarget{idm178369209424}{\emph{DSA KEYs and SIGs in the Domain Name System (DNS)}}, D. Eastlake, 3rd, March 1999.


% -------------- biblioentry 
\bibitem[{RFC2537}]{RFC2537}\docbooktolatexbibaux{idm178369206240}{RFC2537}
\hypertarget{idm178369206240}{\emph{RSA/MD5 KEYs and SIGs in the Domain Name System (DNS)}}, D. Eastlake, 3rd, March 1999.


% -------------- biblioentry 
\bibitem[{RFC2538}]{RFC2538}\docbooktolatexbibaux{idm178369203056}{RFC2538}
\hypertarget{idm178369203056}{\emph{Storing Certificates in the Domain Name System (DNS)}}, D. Eastlake, 3rd and O. Gudmundsson, March 1999.


% -------------- biblioentry 
\bibitem[{RFC2539}]{RFC2539}\docbooktolatexbibaux{idm178369198320}{RFC2539}
\hypertarget{idm178369198320}{\emph{Storage of Diffie-Hellman Keys in the Domain Name System (DNS)}}, D. Eastlake, 3rd, March 1999.


% -------------- biblioentry 
\bibitem[{RFC2540}]{RFC2540}\docbooktolatexbibaux{idm178369194752}{RFC2540}
\hypertarget{idm178369194752}{\emph{Detached Domain Name System (DNS) Information}}, D. Eastlake, 3rd, March 1999.


% -------------- biblioentry 
\bibitem[{RFC2782}]{RFC2782}\docbooktolatexbibaux{idm178369191200}{RFC2782}
\hypertarget{idm178369191200}{\emph{A DNS RR for specifying the location of services (DNS SRV)}}, A. GulbrandsenP. VixieL. Esibov, February 2000.


% -------------- biblioentry 
\bibitem[{RFC2915}]{RFC2915}\docbooktolatexbibaux{idm178369186064}{RFC2915}
\hypertarget{idm178369186064}{\emph{The Naming Authority Pointer (NAPTR) DNS Resource Record}}, M. MeallingR. Daniel, September 2000.


% -------------- biblioentry 
\bibitem[{RFC3110}]{RFC3110}\docbooktolatexbibaux{idm178369182096}{RFC3110}
\hypertarget{idm178369182096}{\emph{RSA/SHA-1 SIGs and RSA KEYs in the Domain Name System (DNS)}}, D. Eastlake, 3rd, May 2001.


% -------------- biblioentry 
\bibitem[{RFC3123}]{RFC3123}\docbooktolatexbibaux{idm178369178912}{RFC3123}
\hypertarget{idm178369178912}{\emph{A DNS RR Type for Lists of Address Prefixes (APL RR)}}, P. Koch, June 2001.


% -------------- biblioentry 
\bibitem[{RFC3596}]{RFC3596}\docbooktolatexbibaux{idm178369176112}{RFC3596}
\hypertarget{idm178369176112}{\emph{DNS Extensions to support IP
                  version 6}}, S. Thomson, C. Huitema, V. Ksinant, and M. Souissi, October 2003.


% -------------- biblioentry 
\bibitem[{RFC3597}]{RFC3597}\docbooktolatexbibaux{idm178369169168}{RFC3597}
\hypertarget{idm178369169168}{\emph{Handling of Unknown DNS Resource Record (RR) Types}}, A. Gustafsson, September 2003.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{DNS和互联网}\hypertarget{idm178369166240}{}

% -------------- biblioentry 
\bibitem[{RFC1101}]{RFC1101}\docbooktolatexbibaux{idm178369165328}{RFC1101}
\hypertarget{idm178369165328}{\emph{DNS Encoding of Network Names
                  and Other Types}}, P. V. Mockapetris, April 1989.


% -------------- biblioentry 
\bibitem[{RFC1123}]{RFC1123}\docbooktolatexbibaux{idm178369162256}{RFC1123}
\hypertarget{idm178369162256}{\emph{Requirements for Internet Hosts - Application and
                  Support}}, Braden, October 1989.


% -------------- biblioentry 
\bibitem[{RFC1591}]{RFC1591}\docbooktolatexbibaux{idm178369159440}{RFC1591}
\hypertarget{idm178369159440}{\emph{Domain Name System Structure and Delegation}}, J. Postel, March 1994.


% -------------- biblioentry 
\bibitem[{RFC2317}]{RFC2317}\docbooktolatexbibaux{idm178369156656}{RFC2317}
\hypertarget{idm178369156656}{\emph{Classless IN-ADDR.ARPA Delegation}}, H. Eidnes, G. de Groot, and P. Vixie, March 1998.


% -------------- biblioentry 
\bibitem[{RFC2826}]{RFC2826}\docbooktolatexbibaux{idm178369151152}{RFC2826}
\hypertarget{idm178369151152}{\emph{IAB Technical Comment on the Unique DNS Root}}, Internet Architecture Board, May 2000.


% -------------- biblioentry 
\bibitem[{RFC2929}]{RFC2929}\docbooktolatexbibaux{idm178369148352}{RFC2929}
\hypertarget{idm178369148352}{\emph{Domain Name System (DNS) IANA Considerations}}, D. Eastlake, 3rd, E. Brunner-Williams, and B. Manning, September 2000.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{DNS运行}\hypertarget{idm178369142320}{}

% -------------- biblioentry 
\bibitem[{RFC1033}]{RFC1033}\docbooktolatexbibaux{idm178369141408}{RFC1033}
\hypertarget{idm178369141408}{\emph{Domain administrators operations guide.}}, M. Lottor, November 1987.


% -------------- biblioentry 
\bibitem[{RFC1537}]{RFC1537}\docbooktolatexbibaux{idm178369138624}{RFC1537}
\hypertarget{idm178369138624}{\emph{Common DNS Data File
                  Configuration Errors}}, P. Beertema, October 1993.


% -------------- biblioentry 
\bibitem[{RFC1912}]{RFC1912}\docbooktolatexbibaux{idm178369135424}{RFC1912}
\hypertarget{idm178369135424}{\emph{Common DNS Operational and
                  Configuration Errors}}, D. Barr, February 1996.


% -------------- biblioentry 
\bibitem[{RFC2010}]{RFC2010}\docbooktolatexbibaux{idm178369132224}{RFC2010}
\hypertarget{idm178369132224}{\emph{Operational Criteria for Root Name Servers.}}, B. Manning and P. Vixie, October 1996.


% -------------- biblioentry 
\bibitem[{RFC2219}]{RFC2219}\docbooktolatexbibaux{idm178369127888}{RFC2219}
\hypertarget{idm178369127888}{\emph{Use of DNS Aliases for
                  Network Services.}}, M. Hamilton and R. Wright, October 1997.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{国际化域名}\hypertarget{idm178369123008}{}

% -------------- biblioentry 
\bibitem[{RFC2825}]{RFC2825}\docbooktolatexbibaux{idm178369122352}{RFC2825}
\hypertarget{idm178369122352}{\emph{A Tangled Web: Issues of I18N, Domain Names,
                       and the Other Internet protocols}}, IAB and R. Daigle, May 2000.


% -------------- biblioentry 
\bibitem[{RFC3490}]{RFC3490}\docbooktolatexbibaux{idm178369118352}{RFC3490}
\hypertarget{idm178369118352}{\emph{Internationalizing Domain Names in Applications (IDNA)}}, P. Faltstrom, P. Hoffman, and A. Costello, March 2003.


% -------------- biblioentry 
\bibitem[{RFC3491}]{RFC3491}\docbooktolatexbibaux{idm178369112832}{RFC3491}
\hypertarget{idm178369112832}{\emph{Nameprep: A Stringprep Profile for Internationalized Domain Names}}, P. Hoffman and M. Blanchet, March 2003.


% -------------- biblioentry 
\bibitem[{RFC3492}]{RFC3492}\docbooktolatexbibaux{idm178369108464}{RFC3492}
\hypertarget{idm178369108464}{\emph{Punycode: A Bootstring encoding of Unicode
                       for Internationalized Domain Names in
                       Applications (IDNA)}}, A. Costello, March 2003.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{其它DNS相关的RFC}\hypertarget{idm178369105056}{}

% -------------- biblioentry 
\bibitem[{RFC1464}]{RFC1464}\docbooktolatexbibaux{idm178369102656}{RFC1464}
\hypertarget{idm178369102656}{\emph{Using the Domain Name System To Store Arbitrary String
                  Attributes}}, R. Rosenbaum, May 1993.


% -------------- biblioentry 
\bibitem[{RFC1713}]{RFC1713}\docbooktolatexbibaux{idm178369099824}{RFC1713}
\hypertarget{idm178369099824}{\emph{Tools for DNS Debugging}}, A. Romao, November 1994.


% -------------- biblioentry 
\bibitem[{RFC1794}]{RFC1794}\docbooktolatexbibaux{idm178369096672}{RFC1794}
\hypertarget{idm178369096672}{\emph{DNS Support for Load
                  Balancing}}, T. Brisco, April 1995.


% -------------- biblioentry 
\bibitem[{RFC2240}]{RFC2240}\docbooktolatexbibaux{idm178369093632}{RFC2240}
\hypertarget{idm178369093632}{\emph{A Legal Basis for Domain Name Allocation}}, O. Vaughan, November 1997.


% -------------- biblioentry 
\bibitem[{RFC2345}]{RFC2345}\docbooktolatexbibaux{idm178369090848}{RFC2345}
\hypertarget{idm178369090848}{\emph{Domain Names and Company Name Retrieval}}, J. Klensin, T. Wolf, and G. Oglesby, May 1998.


% -------------- biblioentry 
\bibitem[{RFC2352}]{RFC2352}\docbooktolatexbibaux{idm178369085344}{RFC2352}
\hypertarget{idm178369085344}{\emph{A Convention For Using Legal Names as Domain Names}}, O. Vaughan, May 1998.


% -------------- biblioentry 
\bibitem[{RFC3071}]{RFC3071}\docbooktolatexbibaux{idm178369082544}{RFC3071}
\hypertarget{idm178369082544}{\emph{Reflections on the DNS, RFC 1591, and Categories of Domains}}, J. Klensin, February 2001.


% -------------- biblioentry 
\bibitem[{RFC3258}]{RFC3258}\docbooktolatexbibaux{idm178369079360}{RFC3258}
\hypertarget{idm178369079360}{\emph{Distributing Authoritative Name Servers via
                       Shared Unicast Addresses}}, T. Hardie, April 2002.


% -------------- biblioentry 
\bibitem[{RFC3901}]{RFC3901}\docbooktolatexbibaux{idm178369076144}{RFC3901}
\hypertarget{idm178369076144}{\emph{DNS IPv6 Transport Operational Guidelines}}, A. Durand and J. Ihren, September 2004.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{废弃和未实现的试验性RFC}\hypertarget{idm178369071680}{}

% -------------- biblioentry 
\bibitem[{RFC1712}]{RFC1712}\docbooktolatexbibaux{idm178369070992}{RFC1712}
\hypertarget{idm178369070992}{\emph{DNS Encoding of Geographical
                  Location}}, C. Farrell, M. Schulze, S. Pleitner, and D. Baldoni, November 1994.


% -------------- biblioentry 
\bibitem[{RFC2673}]{RFC2673}\docbooktolatexbibaux{idm178369064048}{RFC2673}
\hypertarget{idm178369064048}{\emph{Binary Labels in the Domain Name System}}, M. Crawford, August 1999.


% -------------- biblioentry 
\bibitem[{RFC2874}]{RFC2874}\docbooktolatexbibaux{idm178369060880}{RFC2874}
\hypertarget{idm178369060880}{\emph{DNS Extensions to Support IPv6 Address Aggregation
                       and Renumbering}}, M. Crawford and C. Huitema, July 2000.


\end{docbooktolatexbibliography}

\begin{docbooktolatexbibliography}{WIDELABEL}{\subsection}{废弃的DNS安全RFC}\hypertarget{idm178369056368}{}

% -------------- biblioentry 
\bibitem[{RFC2065}]{RFC2065}\docbooktolatexbibaux{idm178369054752}{RFC2065}
\hypertarget{idm178369054752}{\emph{Domain Name System Security Extensions}}, D. Eastlake, 3rd and C. Kaufman, January 1997.


% -------------- biblioentry 
\bibitem[{RFC2137}]{RFC2137}\docbooktolatexbibaux{idm178369050032}{RFC2137}
\hypertarget{idm178369050032}{\emph{Secure Domain Name System Dynamic Update}}, D. Eastlake, 3rd, April 1997.


% -------------- biblioentry 
\bibitem[{RFC2535}]{RFC2535}\docbooktolatexbibaux{idm178369046864}{RFC2535}
\hypertarget{idm178369046864}{\emph{Domain Name System Security Extensions}}, D. Eastlake, 3rd, March 1999.


% -------------- biblioentry 
\bibitem[{RFC3008}]{RFC3008}\docbooktolatexbibaux{idm178369043312}{RFC3008}
\hypertarget{idm178369043312}{\emph{Domain Name System Security (DNSSEC)
                       Signing Authority}}, B. Wellington, November 2000.


% -------------- biblioentry 
\bibitem[{RFC3090}]{RFC3090}\docbooktolatexbibaux{idm178369040112}{RFC3090}
\hypertarget{idm178369040112}{\emph{DNS Security Extension Clarification on Zone Status}}, E. Lewis, March 2001.


% -------------- biblioentry 
\bibitem[{RFC3445}]{RFC3445}\docbooktolatexbibaux{idm178369036928}{RFC3445}
\hypertarget{idm178369036928}{\emph{Limiting the Scope of the KEY Resource Record (RR)}}, D. Massey and S. Rose, December 2002.


% -------------- biblioentry 
\bibitem[{RFC3655}]{RFC3655}\docbooktolatexbibaux{idm178369032576}{RFC3655}
\hypertarget{idm178369032576}{\emph{Redefinition of DNS Authenticated Data (AD) bit}}, B. Wellington and O. Gudmundsson, November 2003.


% -------------- biblioentry 
\bibitem[{RFC3658}]{RFC3658}\docbooktolatexbibaux{idm178369028240}{RFC3658}
\hypertarget{idm178369028240}{\emph{Delegation Signer (DS) Resource Record (RR)}}, O. Gudmundsson, December 2003.


% -------------- biblioentry 
\bibitem[{RFC3755}]{RFC3755}\docbooktolatexbibaux{idm178369025072}{RFC3755}
\hypertarget{idm178369025072}{\emph{Legacy Resolver Compatibility for Delegation Signer (DS)}}, S. Weiler, May 2004.


% -------------- biblioentry 
\bibitem[{RFC3757}]{RFC3757}\docbooktolatexbibaux{idm178369021888}{RFC3757}
\hypertarget{idm178369021888}{\emph{Domain Name System KEY (DNSKEY) Resource Record
                      (RR) Secure Entry Point (SEP) Flag}}, O. Kolkman, J. Schlyter, and E. Lewis, April 2004.


% -------------- biblioentry 
\bibitem[{RFC3845}]{RFC3845}\docbooktolatexbibaux{idm178369016320}{RFC3845}
\hypertarget{idm178369016320}{\emph{DNS Security (DNSSEC) NextSECure (NSEC) RDATA Format}}, J. Schlyter, August 2004.


\end{docbooktolatexbibliography}
\subsection{互联网草案}
\label{internet_drafts}\hypertarget{internet_drafts}{}%

互联网草案（ID）是互联网工程任务组粗略草案的工作文档。它们本质上 是RFC前期的开发阶段。实现者要小心不要将ID当成归档的标准，并且不要 在正式文档中引用它们，除非附带有它们处于“工作进程中”的免责声明。 ID具有六个月的生命，之后它们将被删除，除非被作者所更新。
\subsection{其它关于BIND的文档}
\label{idm178369010688}\hypertarget{idm178369010688}{}%


\begin{docbooktolatexbibliography}{WIDELABEL}{\section}{\docbooktolatexbibname}\hypertarget{idm178369009376}{}

% -------------- biblioentry 
\bibitem{idm178369009120}\docbooktolatexbibaux{idm178369009120}{idm178369009120}
\hypertarget{idm178369009120}{\emph{DNS and BIND}}, Paul Albitz and Cricket Liu, Copyright \copyright{} 1998 Sebastopol, CA: O'Reilly and Associates.


\end{docbooktolatexbibliography}

% -------------------------------------------------------------
% appendix:  BIND 9 DNS库支持 
% ------------------------------------------------------------- 	
\dbappendix{BIND 9 DNS库支持}
\label{Bv9ARM-gbk.ch12}\hypertarget{Bv9ARM-gbk.ch12}{}%

% ------------------------   
% Section 
\section{BIND 9 DNS Library Support}
\label{bind9.library}\hypertarget{bind9.library}{}%

本版本的BIND 9“导出”其内部库，使后者可以更容易地被第三方应用 所利用（我们在本文档中将其称为“导出”库）。除了BIND 9当前用到的所有 主要的DNS相关的API，导出库还提供下列特性：

\begin{itemize}
%--- Item
\item 
新创建的“DNS客户端”模块。这是一个更高层的API，它为名字 解析，与特定服务器之间的单次DNS事物，和动态更新提供了一个接口。 关于名字解析，它支持诸如DNSSEC验证和缓存这样的高级特性。这个 模块支持同步和异步模式。


%--- Item
\item 
新的“IRS”（Information Retrieval System，信息检索系统）库。 它为分析传统的resolv.conf文件和这个包中其余应用所用到的，更高级的， DNS专用配置文件提供一个接口（参见下面对dns.conf文件的描述）。


%--- Item
\item 
作为IRS库的一部份，提供了新实现的标准地址-名字映射函数， getaddrinfo()和getnameinfo()。它们使用支持DNSSEC验证解析器后端， 并能够使用其他BIND 9库的高级特性，如缓存。getaddrinfo()函数并发 解析A和AAAA资源记录（当未指定地址族时）。


%--- Item
\item 
一个试验性框架，用于支持与BIND 9内部事件任务系统不一样的 事件库。

\end{itemize}
\subsection{先决条件}
\label{idm178368994656}\hypertarget{idm178368994656}{}%

构建导出库要求用GNU make（BIND 9的其它部分仍然可以使用其它类型的 make来构建）。在本文档的剩余部份，“make”表示GNU make。注意在某些平台 上，你可能需要发起一个不同于“make”的命令名（例如“gmake”）来表示其 是GNU make。
\subsection{编译}
\label{idm178368992832}\hypertarget{idm178368992832}{}%

\begin{Verbatim}[]

$ ./configure --enable-exportlib [other flags]
$ make

\end{Verbatim}

这将会在通常的BIND 9程序之外，在lib/export目录下建立一套独立的库。 例如，{\texttt{{lib/\dbz{}export/\dbz{}dns/\dbz{}libdns.\dbz{}a}}}是BIND 9 DNS库的 导出版本的库文件。使用库的例子应用程序也将在lib/export/samples目录 下构建（见下）。
\subsection{安装}
\label{idm178368989520}\hypertarget{idm178368989520}{}%

\begin{Verbatim}[]

$ cd lib/export
$ make install

\end{Verbatim}

这将把库的目标文件安装到--with-export-libdir配置选项所指定的目录 下（缺省：EPREFIX/lib/bind9），把头文件安装到--with-export-includedir 配置选项所指定的目录下（缺省：EPREFIX/include/bind9）。 通常需要根用户特权。 在顶级目录下用“{\bfseries{make install}}”也会做同样的事情。

要了解如何在安装之后构建你自己的应用，参见 {\texttt{{lib/\dbz{}export/\dbz{}samples/\dbz{}Makefile-\dbz{}postinstall.\dbz{}in}}}。
\subsection{已知的缺陷/限制}
\label{idm178368985168}\hypertarget{idm178368985168}{}%

\begin{itemize}
%--- Item
\item 
当前，导出库不支持win32。（普通的BIND 9应用可以照旧构建）。


%--- Item
\item 
（当前）导出库不支持“固定的”资源记录集顺序。如果你想在某些 应用，如{\bfseries{named}}，使用“固定的”资源记录集顺序而同时 仍然向在没有固定的顺序支持的情况下构建导出库，就分别构建他们： 
\begin{Verbatim}[]

$ ./configure --enable-fixed-rrset [other flags, but not --enable-exportlib]
$ make
$ ./configure --enable-exportlib [other flags, but not --enable-fixed-rrset]
$ cd lib/export
$ make

\end{Verbatim}



%--- Item
\item 
当前，客户端模块和IRS库不支持使用DLV的DNSSEC验证（下层模块 可以处理后者，但是没有可调的借口来打开这个特性）。


%--- Item
\item 
导出库的验证存根解析器不支持RFC 5011。实际上，是否应该支持 并不明确：信任锚应该是一项系统范围的配置，它应该由一名系统管理员 来管理，同时，存根解析器是由普通用户运行的普通应用所使用。


%--- Item
\item 
不是所有通常的{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}选项都 在IRS库中有支持。在当前版本中，能够使用的选项仅有“debug”和 “ndots”。

\end{itemize}
\subsection{dns.conf文件}
\label{idm178368974976}\hypertarget{idm178368974976}{}%

IRS库支持一个与DNS库相关的“高级”配置文件，其配置参数会超越 {\texttt{{resolv.\dbz{}conf}}}的功能。 特别地，它还打算提供DNSSEC相关的配置参数。缺省时，这个配置文件的路径 为{\texttt{{/\dbz{}etc/\dbz{}dns.\dbz{}conf}}}。 这个模块极具试验性，其配置语法和库接口在将来的版本中可能会有变化。 当前，只支持{\bfseries{trusted-keys}}语句，其语法与 {\texttt{{named.\dbz{}conf}}}中的同名语句一样。（更详细的内容， 参见\hyperlink{trusted-keys}{第\ref{trusted-keys}节}。）
\subsection{例子应用}
\label{idm178368971136}\hypertarget{idm178368971136}{}%

这里提供了一些使用这个API的例子应用程序供参考。下面是对这些应用的 一个简要描述。
\subsubsection{sample: 一个简单的存根解析器应用}
\label{idm178368969968}\hypertarget{idm178368969968}{}%

它向一个指定的递归服务器发送一个指定名字（作为选项，也可指定资源记录类型） 的请求，并将结果打印为一个资源记录的列表。如果通过命令行选项的集合给出了 一个信任锚，它也可以用作一个验证存根解析器。

Usage: sample [options] server\_address hostname

选项和参数：

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t RRtype}]\null{}
指定请求的资源记录类型。缺省是A。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{[-a algorithm] [-e] -k keyname -K keystring}]\null{}
在命令行指定一个DNS密钥，用于验证响应。例如，指定下面example.com 的DNSKEY： \null{}
\begin{Verbatim}[]

                example.com. 3600 IN DNSKEY 257 3 5 xxx

\end{Verbatim}
 以下指定选项： \null{}
\begin{Verbatim}[]


          -e -k example.com -K "xxx"


\end{Verbatim}
 -e表示这个密钥是一个区的“密钥签名密钥”（也被称为“安全入口点”）。 当省略-a时，缺省使用rsasha1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s domain:alt\_server\_address}]\null{}
为特定“域”指定一个单独的递归服务器地址。例如： -s example.com:2001:db8::1234
% \null and \mbox are tricks to induce different typesetting decisions
\item[{server\_address}]\null{}
请求发向的递归服务器的一个IP（v4/v6）地址。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{hostname}]\null{}
请求的域名
\end{description}
\subsubsection{sample-async: 一个例子存根解析器，异步工作}
\label{idm178368957744}\hypertarget{idm178368957744}{}%

与“sample”相似，但是以一个独立文件方式接受（请求）域名清单并 异步解析这些名字。

Usage: sample-async [-s server\_address] [-t RR\_type] input\_file

选项和参数：

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s server\_address}]\null{}请求发向的递归服务器的一个IPv4地址。（在这个实现中不支持IPv6地址）% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t RR\_type}]\null{}指定请求的资源记录类型。缺省是A。% \null and \mbox are tricks to induce different typesetting decisions
\item[{input\_file}]\null{}要解析域名的清单。每行由一个域名组成。例如： \null{}
\begin{Verbatim}[]

  www.example.com
  mx.example.net
  ns.xxx.example

\end{Verbatim}
\end{description}
\subsubsection{sample-request: 一个简单的DNS事物客户端}
\label{idm178368950400}\hypertarget{idm178368950400}{}%

它向一个特定的服务器发送一个请求，并输出经过最小处理的响应。它不充当 一个“存根解析器”：一旦它从服务器获得任何响应，就停止处理进程，无论 响应是否一个引用或者别名（CNAME或DNAME），本该需要以更多的请求来获得 最终的答案。换句话说，这个应用扮演了一个非常简化的{\bfseries{dig}}。

Usage: sample-request [-t RRtype] server\_address hostname

选项和参数：

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t RRtype}]\null{}
指定请求的资源记录类型。缺省是A。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{server\_address}]\null{}
请求发向的递归服务器的一个IP（v4/v6）地址。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{hostname}]\null{}
请求的域名
\end{description}
\subsubsection{sample-gai: getaddrinfo()和getnameinfo()测试代码}
\label{idm178368941840}\hypertarget{idm178368941840}{}%

这是一个用于检查getaddrinfo()和getnameinfo()行为的测试程序。它使用 一个主机名作为测试，以给定的主机名调用getaddrinfo()，并用getaddrinfo() 所返回的结果IP地址调用getnameinfo()。如果dns.conf文件存在并且定义了 一个信任锚，下层解析器充当一个验证解析器，并且在DNSSEC验证失败时， getaddrinfo()/getnameinfo()会失败并返回一个EAI\_INSECUREDATA错误。

Usage: sample-gai hostname
\subsubsection{sample-update: 一个简单的动态更新客户端程序}
\label{idm178368939504}\hypertarget{idm178368939504}{}%

它接受一个更新命令作为一个命令行参数，发送一个更新请求消息给权威 服务器，并输出从服务器回来的响应。换句话说，这就是一个简化版的 {\bfseries{nsupdate}}。

Usage: sample-update [options] (add\docbooktolatexpipe{}delete) "update data"

选项和参数：

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a auth\_server}]\null{}
作为包含所更新名字的区的权威服务器的一个IP地址。这通常应该是 接受动态更新的主权威服务器。它也可以是一个被配置为向主服务器 转发更新请求的辅服务器。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k keyfile}]\null{}
一个TSIG密钥文件，用于保证更新事务的安全。密钥文件格式与nsupdate 实用程序所用的一致。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p prerequisite}]\null{}
一个更新的先决条件（只能指定一个先决条件）。这个先决条件的格式 与nsupdate实用程序所能接受的一致。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r recursive\_server}]\null{}
这个应用将会用到的一个递归服务器的一个IP地址。必须使用一个 递归服务器来获取权威服务器的地址，再向后者发送更新请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-z zonename}]\null{}
The domain name of the zone that contains
% \null and \mbox are tricks to induce different typesetting decisions
\item[{(add\docbooktolatexpipe{}delete)}]\null{}
指定更新操作的类型。必须是“add”或者“delete”之一。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{"update data"}]\null{}
指定要改更新的数据。典型的数据例子看起来像“name TTL RRtype RDATA”。
\end{description}

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path
实际上，必须指定-a或者-r。其它是可选的；下层的库例程试图为更新标识 合适的服务器和区名。\end{admonition}


例如：假设dynamic.example.com区的主权威服务器有一个IPv6地址 2001:db8::1234，

\begin{Verbatim}[]

$ sample-update -a sample-update -k Kxxx.+nnn+mmmm.key add "foo.dynamic.example.com 30 IN A 192.168.2.1"
\end{Verbatim}

使用给定的密钥为foo.dynamic.example.com增加一条A记录。

\begin{Verbatim}[]

$ sample-update -a sample-update -k Kxxx.+nnn+mmmm.key delete "foo.dynamic.example.com 30 IN A"
\end{Verbatim}

使用给定的密钥删除foo.dynamic.example.com的所有A记录。

\begin{Verbatim}[]
   
$ sample-update -a sample-update -k Kxxx.+nnn+mmmm.key delete "foo.dynamic.example.com"
\end{Verbatim}

使用给定的密钥删除foo.dynamic.example.com的所有记录。
\subsubsection{nsprobe: domain/name server checker in terms of RFC 4074}
\label{idm178368919952}\hypertarget{idm178368919952}{}%

它检查一个域名集合，按照RFC 4074的描述查看域名的名字服务器的行为是否正确。 它被包含在一系列例子程序的集合中，这些程序展示了如何将导出库用于DNS相关的 应用中。

Usage: nsprobe [-d] [-v [-v...]] [-c cache\_address] [input\_file]

Options

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d}]\null{}
在“debug”模式运行。使用这个选项，nsprobe将会转储其所收到的 每个资源记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v}]\null{}
增加其它普通日志消息的可见性。这个可以被多次指定。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c cache\_address}]\null{}
指定一个递归（缓存）名字服务器的一个IP地址。nsprobe使用这个服务器 来获取每个域名的NS资源记录集和名字服务器的A和/或AAAA资源记录集。 缺省值是127.0.0.1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{input\_file}]\null{}
一个包含了需要被探测的域（区）名清单的文件的文件名。输入文件的 每行指定了一个域名，如“example.com”。通常这个域名必须是某些 DNS区的顶点名（而不是普通的“主机名”如“www.example.com”）。 nsprobe首先识别给定域名的NS资源记录集，并向这些服务器发送A和 AAAA请求，请求区下某些“广泛使用的”名字；特别地，在区名前增加 “www”和“ftp”。
\end{description}
\subsection{库参考}
\label{idm178368910128}\hypertarget{idm178368910128}{}%

截至目前撰写的文稿，这个库还没有正式的“手册”，除了本文档， 头文件（其中一些提供了非常详细的解释），和例子应用程序。


% 
% -------------------------------------------------------------
% Reference 
% ------------------------------------------------------------- 	
\chapter{手册页}
\label{Bv9ARM-gbk.ch13}\hypertarget{Bv9ARM-gbk.ch13}{}%
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dig}
\label{man.dig}\hypertarget{man.dig}{}%
\label{idm178368903408}

\section*{名字}
dig --- DNS查找工具\label{idm178368894704}
\subsection*{概要}
\label{idm178368894448}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dig [@server] [{\texttt{{-b \textit{address}}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-f \textit{filename}}}}] [{\texttt{{-k \textit{filename}}}}] [{\texttt{{-p \textit{port\#}}}}] [{\texttt{{-q \textit{name}}}}] [{\texttt{{-t \textit{type}}}}] [{\texttt{{-V}}}] [{\texttt{{-x \textit{addr}}}}] [{\texttt{{-y \textit{[hmac:]name:key}}}}] [{\texttt{{-4}}}] [{\texttt{{-6}}}] [name] [type] [class] [queryopt...]}
\end{list}
\label{idm178368879232}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dig [{\texttt{{-h}}}]}
\end{list}
\label{idm178368877952}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dig [global-queryopt...] [query...]}
\end{list}

\subsection*{描述}
\label{idm178368875328}

{\bfseries{dig}}（domain information groper，域信息搜索者）是一个查 询DNS名字服务器的灵活工具。它执行DNS查找并显示从所查找的名字服务器所返回 的答案。由于其灵活性，容易使用和整洁的输出，大多数DNS管理员使用 {\bfseries{dig}}来排除DNS问题。{\bfseries{dig}}趋向于比其它查 找工具提供更多的功能。

虽然{\bfseries{dig}}通常使用命令行参数，它也具有批处理模式的操作， 从一个文件读入查找请求。在使用{\texttt{{-h}}}选项时，会打印出其命令行 参数的一个简要总结。与早期的版本不同，{\bfseries{dig}}的BIND 9实现 允许从命令行发出多个查找。

{\bfseries{dig}}将会试探{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中服务 器列表中的每台机器，除非让它查找一个指定的名字服务器。如果没有找到可用的 服务器地址，{\bfseries{dig}}将会把请求发给本地主机。

在没有给出命令行参数或选项时，将会执行一个对“.”（根）的NS请求。

通过{\texttt{{\$\docbooktolatexgobble\string\{HOME\docbooktolatexgobble\string\}/\dbz{}.\dbz{}digrc}}}文件，可以为每个用户设置 {\bfseries{dig}}的缺省参数。这个文件将被读入并在命令行参数之前应用 其中的所有参数。

IN和CH类名覆盖IN和CH顶级域名。使用{\texttt{{-t}}}和 {\texttt{{-c}}}选项指定类型和类，或者使用{\texttt{{-q}}}指定域名 或者在查找这些顶级域时使用“IN”和“CH”。

\subsection*{简单用法}
\label{idm178368848864}

典型的{\bfseries{dig}}调用看起来是这样的： 
\begin{Verbatim}[]
 dig @server name type 
\end{Verbatim}
 在这里： 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{server}}}}]\null{}
是请求发往的名字服务器的名字或者IP地址。可以是点分十进制格式的 IPv4地址或者冒号分隔形式的IPv6地址。当所提供的 {\ttfamily\itshape{{server}}}参数是一个主机名， {\bfseries{dig}}在请求这个名字服务器之前先解析其名字。

如果没有提供{\ttfamily\itshape{{server}}}参数， {\bfseries{dig}}查找{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}； 如果在其中发现一个地址，它就请求这个地址上的名字服务器。如果 使用了{\texttt{{-4}}}或{\texttt{{-6}}}选项，就只会试探 相关的传输层。如果没有找到可用的地址，{\bfseries{dig}} 就会把请求发到本地主机。显示从名字服务器返回的响应信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{name}}}}]\null{}
是要查找的资源记录的名字。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{type}}}}]\null{}
指明所要的请求类型 --- ANY，A，MX，SIG，等等。 {\ttfamily\itshape{{type}}}可以是任何有效的请求类型。如果没有提供 {\ttfamily\itshape{{type}}}参数，{\bfseries{dig}}将会执行对 A记录的查找。
\end{description}


\subsection*{选项}
\label{idm178368834928}

{\texttt{{-b}}}选项设置到地址{\ttfamily\itshape{{address}}}的请求的源 地址。这必须是主机的一个网络接口上的有效地址，或者为“0.0.0.0”，或者为 “::”。可以通过附加“\#\textless{}port\textgreater{}”指定一个可选的端口。

缺省的请求类（IN，表示internet）被{\texttt{{-c}}}选项所覆盖。 {\ttfamily\itshape{{class}}}是任何一个有效的类，如HS，表示Hesiod记录，或 者CH，表示CHAOSNET记录。

{\texttt{{-f}}}选项让{\bfseries{dig}}以批处理模式工作，从文件 {\ttfamily\itshape{{filename}}}中读入要查找请求的列表，并进行处理。文件包 含了一组请求，每行一个。文件中的每一行应该组织成与使用命令行提供请求给 {\bfseries{dig}}的同样方式。

如果要在一个非标准的端口进行查询，使用{\texttt{{-p}}}选项。 {\ttfamily\itshape{{port\#}}}是{\bfseries{dig}}请求发向的端口号，而 不是标准DNS端口号53。这个选项可以用于测试一个名字服务器，将其配置成监听在 一个非标准端口号。

{\texttt{{-4}}}选项强制{\bfseries{dig}}仅使用IPv4传输请求。 {\texttt{{-6}}}选项强制{\bfseries{dig}}仅使用IPv6传输请求。

{\texttt{{-t}}}选项设置请求类型为{\ttfamily\itshape{{type}}}。它可以 是BIND 9所支持的任何有效请求类型。缺省请求类型为“A”，除非设定 {\texttt{{-x}}}选项，它指定一个反向查找。可以通过指定AXFR的类型的请求 进行区传送。当请求一个增量区传送（IXFR）时，{\ttfamily\itshape{{type}}}被 设为{\texttt{{ixfr=N}}}。增量区传送将包含区的变化，区的SOA记录中的 序列号为{\ttfamily\itshape{{N}}}。

{\texttt{{-q}}}选项设置请求名为{\ttfamily\itshape{{name}}}。这个帮助 区别{\ttfamily\itshape{{name}}}和其它参数。

{\texttt{{-v}}}使{\bfseries{dig}}打印出版本号并退出。

反向查找 --- 将地址映射到名字 --- 很简单，只需设置 {\texttt{{-x}}}选项。{\ttfamily\itshape{{addr}}}是一个点分十进制形式 的IPv4地址，或者一个以冒号分隔的IPv6地址。在使用这个选项时，不需要提供 {\ttfamily\itshape{{name}}}，{\ttfamily\itshape{{class}}}和 {\ttfamily\itshape{{type}}}参数。{\bfseries{dig}}自动执行一个类似 {\texttt{{11.\dbz{}12.\dbz{}13.\dbz{}10.\dbz{}in-\dbz{}addr.\dbz{}arpa}}}的查找，并将请求类型和类分别设 置为PTR和IN。缺省时，IPv6地址使用半字节格式在IP6.ARPA域名下面查找。要使用 旧的RFC1886中的方法而使用IP6.INT域，需要指定{\texttt{{-i}}}选项。位串 标记（RFC2874）现在是试验性的，最好不要使用。

为对{\bfseries{dig}}发出的DNS请求和其使用事务签名 （transaction signatures，TSIG）的响应，使用{\texttt{{-k}}}选项指定一 个TSIG密钥。你也可以在命令行使用{\texttt{{-y}}}选项指定TSIG密钥本身； {\ttfamily\itshape{{hmac}}}是TSIG的类型，缺省是HMAC-MD5， {\ttfamily\itshape{{name}}}是TSIG密钥的名字，{\ttfamily\itshape{{key}}}是 实际的密钥。密钥是一个base-64编码的字符串，典型情况是由 dnssec-keygen(8)所生成。 在多用户系统上使用{\texttt{{-y}}}选项应当谨慎，因为密钥可以在 ps(1)的输出中或者在shell的历史文件中被看到。 在{\bfseries{dig}}中使用TSIG认证时，所请求的名字服务器需要知道所用 的密钥和算法。在BIND中，这是通过在{\texttt{{named.\dbz{}conf}}}中使用合 适的{\bfseries{key}}和{\bfseries{server}}语句来完成的。

\subsection*{请求选项}
\label{idm178368806912}

{\bfseries{dig}}提供许多查询选项，可以影响生成查询和显示结果的方式。 其中一些选项设置或清空请求头部的标志位，一些决定打印回答中的哪些部份，其 它的决定超时和重试策略。

每个请求选项由一个前导加号（{\texttt{{+\dbz{}}}}）和一个关键字标识。一些 关键字设置或清空一个选项。这些可能由前导字符串{\texttt{{no}}}来否定 关键字的含义。其它关键字给选项赋值，就像超时间隔。他们具有 {\texttt{{+keyword=value}}}的形式。请求选项是： 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]aaflag}}}}]\null{}
{\ttfamily\itshape{{+[no]aaonly}}}的同义词。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]aaonly}}}}]\null{}
在请求中设置“aa”标志。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]additional}}}}]\null{}
显示[不显示]回复的附加部份。缺省是显示。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]adflag}}}}]\null{}
设置[不设置]请求中的AD（可靠的数据）位。它要求服务器返回 回答和权威部份的所有记录是否都已按照服务器的安全策略验证。AD=1 指示所有记录都已被验证为安全并且回答不是来自于一个OPT-OUT范围。 AD=0指示回答中的某些部份是不安全的或者没有验证的。这个位缺省是 置位的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]all}}}}]\null{}
设置或清除所有显示标志。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]answer}}}}]\null{}
显示[不显示]回复的回答部份。缺省是显示。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]authority}}}}]\null{}
显示[不显示]回复的权威部份。缺省是显示。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]besteffort}}}}]\null{}
试图显示坏包消息的内容。缺省是不显示坏包回答。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+bufsize=B}}}}]\null{}
设置使用EDNS0公告的UDP消息缓冲大小为{\ttfamily\itshape{{B}}}字节。 这个缓冲的最大值和最小值分别为65535和0。在这个范围之外的值会被适 当地调整到高或低。0之外的值将会发送出一个EDNS请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]cdflag}}}}]\null{}
设置[不设置]请求中的CD（关闭检查）位。这请求服务器不对响应执行 DNSSEC验证。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]cl}}}}]\null{}
打印记录时显示[不显示]类。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]cmd}}}}]\null{}
翻转打印在输出中标识{\bfseries{dig}}版本和所应用的请求选项 的初始注释的状态。这个注释缺省是要打印的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]comments}}}}]\null{}
翻转在输出中显示注释行的状态。缺省是打印注释。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]crypto}}}}]\null{}
翻转对DNSSEC记录中加密字段的显示。这些字段在诊断大多数 DNSSEC验证失败时不是必须的，去掉它们使得查看普通失败更 容易。缺省是显示这些字段。当被省略时，它们被字符串 "[omitted]"替代，或者在DNSKEY情况，显示密钥标识号作为 替代，例如"[ key id = value ]"。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]defname}}}}]\null{}
废弃，作为{\ttfamily\itshape{{+[no]search}}}的同义词对待。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]dnssec}}}}]\null{}
通过在请求的附加部份放置OPT记录，并设置DNSSEC OK位（DO）来请求发 送DNSSEC记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+domain=somename}}}}]\null{}
设置搜索列表使包含唯一域名{\ttfamily\itshape{{somename}}}，就像在 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中{\bfseries{domain}} 命令中指定一样，如果给出{\ttfamily\itshape{{+search}}}选项，就打 开搜索列表处理。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]edns=\#}}}}]\null{}
指定请求所带的EDNS的版本。有效值为0到255。设置EDNS版本会导致发出 一个EDNS请求。{\texttt{{+noedns}}}清除所记住的EDNS版本。缺省 时EDNS被设置为0。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]expire}}}}]\null{}
发送一个EDNS过期选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]fail}}}}]\null{}
如果收到了一个SERVFAIL不会重试下一个服务器。缺省是不重试下一个服 务器，这与普通的存根解析器行为相反。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]identify}}}}]\null{}
在{\ttfamily\itshape{{+short}}}选项打开时，显示[不显示]用于补充回 答的IP地址和端口号。如果要求短格式回答，缺省是不显示提供回答的服 务器的源地址和端口号。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]ignore}}}}]\null{}
忽略UDP响应中的截断而不用TCP重试。缺省情况要用TCP重试。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]keepopen}}}}]\null{}
在两次或多次请求之间保持TCP套接字打开，这样可以重用而不是 每次查找时都建立一个新的TCP套接字。缺省是 {\texttt{{+nokeepopen}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]multiline}}}}]\null{}
以详细的多行格式并附带人所易读的注释打印如SOA这样的记录。缺省是将 每个记录打印在一行中，以适应机器分析{\bfseries{dig}}的输出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+ndots=D}}}}]\null{}
设置在name中必须出现的点的个数为D，{\ttfamily\itshape{{name}}}被 当成绝对名字。缺省值是在{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中用 ndots语句定义的值，或者为1，如果没有使用ndots语句。少于这个数目的 点的名字会被解释为相对名字，如果设置了{\texttt{{+search}}}， 就会在{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中的 {\texttt{{search}}}或{\texttt{{domain}}}指令所列的域名中 搜索。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]nsid}}}}]\null{}
在发送一个请求时包含一个EDNS名字服务器ID请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]nssearch}}}}]\null{}
在设置了这个选项时，{\bfseries{dig}}试图找到包含所查找名字 的区的权威名字服务器并显示这个区的每个名字服务器都有的SOA记录。

{\texttt{{resolv.\dbz{}conf}}}中的'ndots'(缺省是1），它可以被 {\ttfamily\itshape{{+ndots}}}覆盖，决定了名字是否被作为相对名字 对待，以及因此是否最终执行一个搜索。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]onesoa}}}}]\null{}
在执行一个AXFR时，仅打印一个（开始的）SOA记录。缺省是打印开始的和 结尾的SOA记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]qr}}}}]\null{}
打印[不打印]所发出的请求，缺省是不打印请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]question}}}}]\null{}
当一个回答返回时，打印[不打印]请求的问题部份。缺省是将问题部份作 为一个注释打印。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]recurse}}}}]\null{}
翻转请求中的RD（期望递归）位设置。这个位缺省是置位的，意谓着 {\bfseries{dig}}普通情况是发送递归的请求。在使用了 {\ttfamily\itshape{{+nssearch}}}或者{\ttfamily\itshape{{+trace}}} 选项时，递归是自动关闭的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+retry=T}}}}]\null{}
设置向服务器重新进行UDP请求的次数为{\ttfamily\itshape{{T}}}次， 取代缺省的2次。与{\ttfamily\itshape{{+tries}}}不同，这个不包括初 始请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]rrcomments}}}}]\null{}
翻转在输出中显示每记录注释的状态（例如，便于人阅读的关于DNSKEY 记录的密钥信息）。缺省是不打印记录注释，除非多行模式被激活。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]search}}}}]\null{}
使用[不使用]在{\texttt{{resolv.\dbz{}conf}}}（如果存在）中 searchlist或者domain命令所定义的搜索列表。缺省是不使用搜索列表。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]short}}}}]\null{}
提供一个简洁的回答。缺省是以冗长形式打印回答。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]showsearch}}}}]\null{}
执行[不执行]立即显示结果的搜索。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]sigchase}}}}]\null{}
追随DNSSEC签名链。要求dig编译时带-DDIG\_SIGCHASE。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]sit[=\#\#\#\#]}}}}]\null{}
发送一个源特征符号（Source Identity Token）EDNS选项，带有 可选值。从一个先前的响应重放一个SIT将允许服务器识别一个先前 的客户端。缺省值是{\texttt{{+nosit}}}。当前使用试验值 65001作为选项码。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+split=W}}}}]\null{}
将资源记录中较长的hex-或base64-格式的字段分割为 {\ttfamily\itshape{{W}}}个字符的块（{\ttfamily\itshape{{W}}} 被离散到距其最近的4的倍数上）。 {\ttfamily\itshape{{+nosplit}}}或 {\ttfamily\itshape{{+split=0}}}导致字段完全不被分割。缺省为56个 字符，或者在多行模式时为44个字符。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]stats}}}}]\null{}
这个请求选项翻转打印统计的选项：生成请求的时间，响应的大小等等。 缺省行为是打印统计。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]subnet=addr/prefix}}}}]\null{}
发送一个EDNS客户端子网选项，带有指定的IP地址或网络前缀。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]tcp}}}}]\null{}
在请求名字服务器时使用[不使用]TCP。缺省行为是使用UDP，除非要求一 个{\texttt{{ixfr=N}}}的请求，这种情况下缺省是TCP。AXFR请求 总是使用TCP。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+time=T}}}}]\null{}
设置一个请求的超时为{\ttfamily\itshape{{T}}}秒。缺省超时是5秒。试 图将{\ttfamily\itshape{{T}}}设置成小于1将会得到请求超时为1秒的结 果。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]topdown}}}}]\null{}
在追随DNSSEC签名链时执行至上而下的验证。要求dig编译时带 -DDIG\_SIGCHASE。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]trace}}}}]\null{}
翻转对从根名字服务器到要查找名字的授权路径的跟踪状态。缺省是关闭 跟踪的。当打开跟踪时，{\bfseries{dig}}迭代发送请求来解析要 查找的名字。它会跟随自根服务器起所给出的参考信息，显示出来自每个 解析用到的服务器的回答。

当设置了+trace时，也会设置{\bfseries{+dnssec}}，来更好地 模仿来自某个名字服务器的缺省请求。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+tries=T}}}}]\null{}
设置向服务器进行UDP请求的重试次数为{\ttfamily\itshape{{T}}}次， 取代缺省的3次。如果{\ttfamily\itshape{{T}}}小于或等于0，重试次数 就静默地回归为1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+trusted-key=\#\#\#\#}}}}]\null{}
指定一个文件，其包含用于{\texttt{{+sigchase}}}的信任密钥。每 个DNSKEY必须在其本身行。

如果没有指定，{\bfseries{dig}}会查找 {\texttt{{/\dbz{}etc/\dbz{}trusted-\dbz{}key.\dbz{}key}}}，然后在当前目录中查找 {\texttt{{trusted-\dbz{}key.\dbz{}key}}}。

要求dig编译时带-DDIG\_SIGCHASE。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]ttlid}}}}]\null{}
在打印记录时显示[不显示]TTL。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]vc}}}}]\null{}
在请求名字服务器时使用[不使用]TCP。这是为 {\ttfamily\itshape{{+[no]tcp}}}提供向后兼容性而使用的替换语法。 “vc”表示“virtual circuit”。
\end{description}


\subsection*{多个请求}
\label{idm178368686064}

BIND 9的{\bfseries{dig}}实现支持在命令行（另外还支持 {\texttt{{-f}}}批文件选项）指定多个请求。每个这样的请求可以带有自己的 标志、选项和请求选项集合。

在这种情况下，每个{\ttfamily\itshape{{query}}}参数代表一个上述命令行语法 中的单独请求。每个都是由标准选项和标志，待查找名字，可选的请求类型和类以 及任何应该应用于这个请求的请求选项所组成。

也可以采用一个请求选项的全局集，它将应用到所有请求上。这些全局请求选项必 须在命令行中先于第一个名字、类、类型、选项、标志和请求选项的元组之前。任 何全局请求选项（{\texttt{{+[no]cmd}}}选项除外）都可以被某个请求专用的 请求选项所覆盖。例如： 
\begin{Verbatim}[]

dig +qr www.isc.org any -x 127.0.0.1 isc.org ns +noqr

\end{Verbatim}
 显示怎样在命令行使用{\bfseries{dig}}完成三个查找：一个对 {\texttt{{www.\dbz{}isc.\dbz{}org}}}的ANY的查找，一个对127.0.0.1的反向查找和一 个对{\texttt{{isc.\dbz{}org}}}的NS记录的查找。应用了一个全局请求选项 {\ttfamily\itshape{{+qr}}}，这样{\bfseries{dig}}显示它所进行的每个 查找的初始请求。最终的请求有一个局部请求选项{\ttfamily\itshape{{+noqr}}}， 表示{\bfseries{dig}}不会打印它在查找{\texttt{{isc.\dbz{}org}}}的NS 记录时的初始请求。

\subsection*{IDN支持}
\label{idm178368677248}

如果编译{\bfseries{dig}}时带有IDN（internationalized domain name， 国际化域名）支持，它可以接受和显示非ASCII域名。{\bfseries{dig}}会在 发送一个请求到DNS服务器或显示一个来自服务器的回复之前正确地转换域名的字符 编码。如果由于某种原因你想关闭IDN支持，就定义{\texttt{{IDN\_DISABLE}}}环 境变量。在{\bfseries{dig}}运行时，如果变量已设置，IDN支持就是关闭的。

\subsection*{文件}
\label{idm178368674016}

{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}

{\texttt{{\$\docbooktolatexgobble\string\{HOME\docbooktolatexgobble\string\}/\dbz{}.\dbz{}digrc}}}

\subsection*{参见}
\label{idm178368671904}

host(1), named(8), dnssec-keygen(8), {\em{RFC1035}}.

\subsection*{BUGS}
\label{idm178368667248}

具有可能是太多的请求选项。
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{host}
\label{man.host}\hypertarget{man.host}{}%
\label{idm178368661664}

\section*{名字}
host --- DNS查找工具\label{idm178368654976}
\subsection*{概要}
\label{idm178368654720}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{host [{\texttt{{-aCdlnrsTwv}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-N \textit{ndots}}}}] [{\texttt{{-R \textit{number}}}}] [{\texttt{{-t \textit{type}}}}] [{\texttt{{-W \textit{wait}}}}] [{\texttt{{-m \textit{flag}}}}] [{\texttt{{-4}}}] [{\texttt{{-6}}}] [{\texttt{{-v}}}] [{\texttt{{-V}}}] {name} [server]}
\end{list}

\subsection*{描述}
\label{idm178368643808}

{\bfseries{host}}是一个进行DNS查找的简单工具。它通常用于转换名字到 IP地址或相反的操作。在没有给出参数或选项时，{\bfseries{host}}打印出 其命令行参数和选项的简短摘要。

{\ttfamily\itshape{{name}}}是要查找的域名。它也可以是一个点分十进制的IPv4 地址或者一个冒号分隔的IPv6地址，在这种情况下{\bfseries{host}}缺省将 会对那个地址执行一个反向查找。 {\ttfamily\itshape{{server}}}是一个可选参数，可以是名字服务器的名字或IP 地址，{\bfseries{host}}应该查询这个服务器，而不是 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中的服务器或服务器列表。

{\texttt{{-a}}}（全部）选项与设置{\texttt{{-v}}}选项并让 {\bfseries{host}}发一个ANY类型的请求等效。

当使用了{\texttt{{-C}}}选项，{\bfseries{host}}会试图从这个区的 所有列出的权威名字服务器中显示区{\ttfamily\itshape{{name}}}的SOA记录。名 字服务器的列表是由所找到的这个区的NS记录所定义的。

{\texttt{{-c}}}选项指示生成一个类{\ttfamily\itshape{{class}}}的请求。 这个可以用于查找Hesiod或者Chaosnet类的资源记录。缺省类是IN（Internet）。

在使用{\texttt{{-d}}}或{\texttt{{-v}}}选项时， {\bfseries{host}}产生冗余输出。这两个选项是等效的。它们提供了向后兼 容性。在先前的版本，{\texttt{{-d}}}选项打开调试跟踪而 {\texttt{{-v}}}打开冗余输出。

{\texttt{{-l}}}选项选择列表模式。这使{\bfseries{host}}对区 {\ttfamily\itshape{{name}}}执行一个区传送。传送区并打印出NS，PTR和地址记 录（A/AAAA）。如果与{\texttt{{-a}}}组合，就打印全部记录。

{\texttt{{-i}}}选项指定对Ipv6地址的反向查找应该使用IP6.INT域，这个域 是在RFC1886中定义的。缺省是使用IP6.ARPA。

{\texttt{{-N}}}选项设置出现在被当做决定名字的 {\ttfamily\itshape{{name}}}中的点的数目。缺失值是在 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中用ndots语句定义的值，或者为1，如果 没有使用ndots语句。少于这个数目的点的名字会被解释为相对名字，并在 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}的search或 domain指令所列的域名中搜索。

一个查找的UDP重试次数可以使用{\texttt{{-R}}}选项改变。 {\ttfamily\itshape{{number}}}指示{\bfseries{host}}将会在没有收到回 答时重发多少次请求。缺省的重试次数是1.如果{\ttfamily\itshape{{number}}}是 负数或为0，重试次数缺省为1。

可以通过{\texttt{{-r}}}选项生成非递归请求。设置这个选项清除 {\bfseries{host}}生成的请求中的RD --- 期望递归 --- 位。这意谓着名字服务器在收到这个请求后不会试图去解析 {\ttfamily\itshape{{name}}}。{\texttt{{-r}}}选项使 {\bfseries{host}}能够模仿一个名字服务器的行为，通过生成非递归请求并 期望接收这些请求的回答，这些回答通常是对其它名字服务器指向。

缺省情况，{\bfseries{host}}使用UDP生成请求。 {\texttt{{-T}}}选项使 其在请求名字服务器时使用一个TCP连接。在需要时，会自动为请求选择TCP，例如 区传送（AXFR）请求。

{\texttt{{-4}}}选项强制{\bfseries{host}}只使用IPv4请求传输。 {\texttt{{-6}}}选项强制{\bfseries{host}}只使用IPv6请求传输。

{\texttt{{-t}}}选项用于选择请求类型。{\ttfamily\itshape{{type}}}可以 是任何可识别的请求类型：CNAME, NS, SOA, SIG, KEY, AXFR等等。没有指定请求 类型时，{\bfseries{host}}自动选择一个合适的请求类型。 缺省情况，它查找A，AAAA和MX记录，但是如果给出{\texttt{{-C}}}选项， 请求将查找SOA记录，如果{\ttfamily\itshape{{name}}}是一个点分十进制 IPv4地址或冒号分隔的IPv6地址，{\bfseries{host}}将查找PTR记录。 如果选择一个IXFR请求类型，可以通过附加一个等号和开始序列号 （例如，-t IXFR=12345678）来指定开始序列号。

等待响应的时间可以通过{\texttt{{-W}}}和{\texttt{{-w}}}选项来控制。 {\texttt{{-W}}}选项使{\bfseries{host}}等待 {\ttfamily\itshape{{wait}}}秒。如果{\ttfamily\itshape{{wait}}}小于1，等待 间隔就设置为1秒。如果使用{\texttt{{-w}}}选项，{\bfseries{host}} 将有效地永远等待一个响应。等待一个响应的时间可以设置成由硬件的最大整数所 给出的秒数。

{\texttt{{-s}}}选项告诉{\bfseries{host}}如果任何服务器响应了一 个SERVFAIL，{\em{不}}发送请求到下一个名字服务器，这与普通的 存根解析器行为相反。

{\texttt{{-m}}}可以用于设置内存使用调试标志 {\ttfamily\itshape{{record}}}，{\ttfamily\itshape{{usage}}}和 {\ttfamily\itshape{{trace}}}。

{\texttt{{-V}}}选项使{\bfseries{host}}打印版本号并退出。

\subsection*{IDN支持}
\label{idm178368603360}

如果编译{\bfseries{host}}时带有IDN（internationalized domain name， 国际化域名）支持，它可以接受和显示非ASCII域名。{\bfseries{host}}会 在发送一个请求到DNS服务器或显示一个来自服务器的回复之前正确地转换域名的字 符编码。如果由于某种原因你想关闭IDN支持，就定义{\texttt{{IDN\_DISABLE}}} 环境变量。在{\bfseries{host}}运行时，如果变量已设置，IDN支持就是关 闭的。

\subsection*{文件}
\label{idm178368600048}

{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}

\subsection*{参见}
\label{idm178368598592}

dig(1), named(8).
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{delv}
\label{man.delv}\hypertarget{man.delv}{}%
\label{idm178368591248}

\section*{名字}
delv --- DNS查找和验证工具\label{idm178368588464}
\subsection*{概要}
\label{idm178368588208}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{delv [@server] [{\texttt{{-4}}}] [{\texttt{{-6}}}] [{\texttt{{-a \textit{anchor-file}}}}] [{\texttt{{-b \textit{address}}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-d \textit{level}}}}] [{\texttt{{-i}}}] [{\texttt{{-m}}}] [{\texttt{{-p \textit{port\#}}}}] [{\texttt{{-q \textit{name}}}}] [{\texttt{{-t \textit{type}}}}] [{\texttt{{-x \textit{addr}}}}] [name] [type] [class] [queryopt...]}
\end{list}
\label{idm178368573856}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{delv [{\texttt{{-h}}}]}
\end{list}
\label{idm178368572560}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{delv [{\texttt{{-v}}}]}
\end{list}
\label{idm178368571264}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{delv [queryopt...] [query...]}
\end{list}

\subsection*{描述}
\label{idm178368568624}

{\bfseries{delv}} (Domain Entity Lookup \& Validation，域名实体查找和验证)是一个发送 DNS请求并验证结果的工具，它使用与{\bfseries{named}}同样的内部解析器 和验证器逻辑。

{\bfseries{delv}}将所有需要获取的请求发向一个指定的名字服务器并 验证请求到的数据；这包含原始请求，跟随CNAME或DNAME链的后续请求，以及 为建立一个用于DNSSEC验证的信任链的对DNSKEY，DS和DLV记录的请求。 它不执行迭代解析，但是模仿一个配置为DNSSEC验证和转发的名字服务器的行为。

缺省时，响应使用内置根区（"."）以及ISC DNSSEC后备验证区（"dlv.isc.org"） 的DNSSEC信任锚点进行验证。{\bfseries{delv}}返回的记录要么是完全 验证的，要么是没有签名的。如果验证失败，输出中会包含一个对失败的解释； 验证过程可被详细跟踪。由于{\bfseries{delv}}不依赖一个外部服务器 来执行验证，它可以用于本地名字服务器不可信的环境中来检查DNS响应的 有效性。

除非其被告知去请求一个特定的名字服务器，{\bfseries{delv}}将试探 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}中列出的每个服务器。如果没有发现 可用的服务器地址，{\bfseries{delv}}将发请求到环回地址（IPv4为 127.0.0.1，IPv6为::1）。

当没有给出命令行参数或选项时，{\bfseries{delv}}将执行对"."（根区） 的NS查询。

\subsection*{简单用法}
\label{idm178368560080}

一个典型的{\bfseries{delv}}调用看起来像： 
\begin{Verbatim}[]
 delv @server name type 
\end{Verbatim}
 其中: 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{server}}}}]\null{}
是要请求的名字服务器的名字或IP地址。这可以是一个点分十进制表示的 IPv4地址或一个冒号分隔表示的IPv6地址。当所提供的 {\ttfamily\itshape{{server}}}参数是一个主机名时， {\bfseries{delv}}在请求那个名字服务器之前先解析那个名字 （注意，那个初始查询{\em{不}}被DNSSEC验证。

如果没有提供{\ttfamily\itshape{{server}}}参数， {\bfseries{delv}}会查找 {\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}；如果在其中发现一个地址， 它会请求那个地址上的名字服务器。如果使用了{\texttt{{-4}}} 或{\texttt{{-6}}}选项，则只有相关传输协议的地址才会被试探。 如果没有发现可用的地址，{\bfseries{delv}}将向本地地址（对 IPv4为127.0.0.1，对IPv6为::1）发送请求。 ::1 for IPv6).
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{name}}}}]\null{}
是被查找的域名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{type}}}}]\null{}
指明需要请求那种类型---ANY，A，MX，等。 {\ttfamily\itshape{{type}}}可以是任何有效的请求类型。 如果没有提供{\ttfamily\itshape{{type}}}参数， {\bfseries{delv}}将执行一个对A记录的查找。
\end{description}


\subsection*{选项}
\label{idm178368545808}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a {\ttfamily\itshape{{anchor-file}}}}]\null{}
指定从中读取DNSSEC信任锚点的文件。缺省为 {\texttt{{/\dbz{}etc/\dbz{}bind.\dbz{}keys}}}，它被包含在 BIND 9中，并含有根区（"."）和ISC DNSSEC后备验证区 （"dlv.isc.org"）的信任锚点。

与根或DLV信任锚点名字不匹配的密钥会被忽略；这些密钥名字可以使用 {\texttt{{+dlv=NAME}}}或者{\texttt{{+root=NAME}}}选项 覆盖。

注意：在读取信任锚点文件时，{\bfseries{delv}}同等对待 {\texttt{{managed-keys}}}语句和 {\texttt{{trusted-keys}}}语句。 即，对于一个被管理的密钥，它就是被信任的初始密钥；RFC 5011密钥管理 不被支持。 {\bfseries{delv}}将不咨询由{\bfseries{named}}维护的 被管理密钥数据库。 这意谓如果{\texttt{{/\dbz{}etc/\dbz{}bind.\dbz{}keys}}}有一个密钥被撤销并 轮转，就必须更新{\texttt{{/\dbz{}etc/\dbz{}bind.\dbz{}keys}}}以便在 {\bfseries{delv}}中使用DNSSEC验证。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-b {\ttfamily\itshape{{address}}}}]\null{}
设置请求的源IP地址为{\ttfamily\itshape{{address}}}。这必须是一个 主机网络接口上的有效地址，或者"0.0.0.0"，或者"::"。 可以通过附加"\#\textless{}port\textgreater{}"指定一个可选的源端口。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
为请求数据设置请求类。当前，在{\bfseries{delv}}中只支持 类"IN"，任何其它值将被忽略。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d {\ttfamily\itshape{{level}}}}]\null{}
设置系统范围的调试级别为{\texttt{{level}}}。 允许的范围为0到99. 缺省是0（关闭调试）。 调试级别越高，从{\bfseries{delv}}调试跟踪得到的信息越多。 参见下列{\texttt{{+mtrace}}}，{\texttt{{+rtrace}}}和 {\texttt{{+vtrace}}}选项以获得关于调试的详细信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
显示{\bfseries{delv}}使用帮助并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-i}]\null{}
非安全模式。这个关闭内部DNSSEC验证。（注意，这不会在向上游 查询时设置CD位。如果被查询的服务器正在执行DNSSEC验证，它将 会返回无效数据；这导致{\bfseries{delv}}超时。当必须 检查无效数据以调试一个DNSSEC问题时，使用 {\bfseries{dig +cd}}。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-m}]\null{}
打开内存使用调试。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{port\#}}}}]\null{}
指定一个用于请求的目的端口，而不是使用标准的DNS端口号53.这个 选项用于同一个被配置为在一个非标准端口号监听请求的名字服务器 通信时。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-q {\ttfamily\itshape{{name}}}}]\null{}
设置请求名为{\ttfamily\itshape{{name}}}。虽然指定请求名可以不需要 使用{\texttt{{-q}}}，但是某些时候必须使用这个选项来将请求名与 类型和类区别开来（例如，在查找名字"ns"时，可能被错误解释为类型NS， 或者查找"ch"，可能被错误解释为类CH）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{type}}}}]\null{}
设置请求类型为{\ttfamily\itshape{{type}}}，它可以是除区传送类型 AXFR和IXFR之外BIND 9所支持的任何有效类型。 As with {\texttt{{-q}}}, this is useful to distinguish query name type or class when they are ambiguous. 在某些时候必须将名字从类型中区别出来。

缺省请求类型是"A"，除非提供了{\texttt{{-x}}}指定一个反向 查找，这种情况类型是"PTR"。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v}]\null{}
打印{\bfseries{delv}}版本并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-x {\ttfamily\itshape{{addr}}}}]\null{}
执行一个反向查找，映射一个地址到一个名字。 {\ttfamily\itshape{{addr}}}是一个点分十进制表示的IPv4地址，或者 一个冒号分隔的IPv6地址。 当使用了{\texttt{{-x}}}，不需要提供{\ttfamily\itshape{{name}}} 或{\ttfamily\itshape{{type}}}参数。 {\bfseries{delv}}自动执行对一个类似 {\texttt{{11.\dbz{}12.\dbz{}13.\dbz{}10.\dbz{}in-\dbz{}addr.\dbz{}arpa}}}的名字的查找，并设置 请求类型为PTR。 IPv6地址是以半字节格式在IP6.ARPA域下查找。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-4}]\null{}
强制{\bfseries{delv}}使用IPv4。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-6}]\null{}
强制{\bfseries{delv}}使用IPv6。
\end{description}

\subsection*{请求选项}
\label{idm178368498112}

{\bfseries{delv}} 提供一些请求选项，它们影响结果的显式方式，在某些情况它们也影响请求执行 的方式。

每个请求由一个加号（{\texttt{{+\dbz{}}}}）引导的关键字所标识。 一些关键字设置或清除一个选项。 这些可以由前导的{\texttt{{no}}}字符串反转关键字的含义。 其它关键字给选项赋值，如超时间隔。 它们具有{\texttt{{+keyword=value}}}的形式。 请求选项为： 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]cdflag}}}}]\null{}
控制是否在由{\bfseries{delv}}发出的请求中设置CD （checking disabled，关闭验证）位。 这个可以用于从一个验证解析器后端进行DNSSEC问题排查。 一个验证解析器将阻塞无效响应，就使获取它们进行分析变得很困难。 在请求中设置CD标志将使解析器返回无效响应， {\bfseries{delv}}可以在内部验证并详细报告错误。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]class}}}}]\null{}
控制在打印一个记录时是否显示类。缺省是显示类。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]ttl}}}}]\null{}
控制在打印一个记录时是否显示TTL。缺省是显示TTL。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]rtrace}}}}]\null{}
翻转解析器取动作的日志。这报告了在执行解析和验证过程中每个 由{\bfseries{delv}}发送的请求的名字和类型：这包含了 原始请求和跟随CNAME记录和为DNSSEC验证建立信任链的随后请求。

这和在"resolver"日志类别中设置调试级别为1是等效的。 使用{\texttt{{-d}}}选项在系统范围设置调试级别为1会得到 同样的输出（但是也会影响其它日志类别）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]mtrace}}}}]\null{}
翻转消息日志。这产生{\bfseries{delv}}在执行解析和 验证过程中收到的响应的详细导出结果。

这和在"resolver"日志类别的"packets"模块中设置调试级别为10是等效的。 使用{\texttt{{-d}}}选项在系统范围设置调试级别为10会得到 同样的输出（但是也会影响其它日志类别）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]vtrace}}}}]\null{}
翻转验证日志。这显示验证器的内部进程，它决定一个答复是否是 有效签名、未签名或者无效的。

这和在"dnssec"日志类别的"validator"模块中设置调试级别为3是等效的。 使用{\texttt{{-d}}}选项在系统范围设置调试级别为3会得到 同样的输出（但是也会影响其它日志类别）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]short}}}}]\null{}
提供一个简洁的回答。缺省是以冗长形式输出回答。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]comments}}}}]\null{}
翻转在输出中显示注释。缺省是打印注释。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]rrcomments}}}}]\null{}
翻转对输出中每个记录注释的显示状态（例如，关于DNSKEY的人可读 的密钥信息）。 缺省是打印每个记录的注释。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]crypto}}}}]\null{}
翻转DNSSEC记录中加密字段的显示。 这些字段的内容对于调试大多数DNSSEC验证失败不是必须的，并且去掉 它们会使查看通常的失败更容易。 缺省是显示这些字段。 如果省略，它们被字符串"[omitted]"所替代，或者在DNSKEY的情况下， 作为替代，显示密钥的id，例如"[ key id = value ]"。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]trust}}}}]\null{}
控制在打印一个记录时是否显示信任级别。缺省是显示信任级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]split[=W]}}}}]\null{}
分割资源记录中的长的hex-或base64-格式的字段为 {\ttfamily\itshape{{W}}}个字符大小的块。 （这里{\ttfamily\itshape{{W}}}是最接近的4的倍数）。 {\ttfamily\itshape{{+nosplit}}}或 {\ttfamily\itshape{{+split=0}}}使字段完全不被分割。 缺省是56个字符，或者在打开多行模式时为44个字符。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]all}}}}]\null{}
设置或清除显示选项 {\texttt{{+[no]comments}}}, {\texttt{{+[no]rrcomments}}}和 {\texttt{{+[no]trust}}}作为一个组。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]multiline}}}}]\null{}
以冗长多行格式并附带人可读的注释打印长记录（诸如RRSIG，DNSKEY 和SOA记录） 缺省是将每条记录打印在一行上，以便{\bfseries{delv}}的 输出更容易被机器分析。 output.
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]dnssec}}}}]\null{}
指示是否在{\bfseries{delv}}的输出中显示RRSIG记录。 缺省是显示。 注意（与{\bfseries{dig}}不同）这{\em{不}} 控制是否请求DNSSEC记录或者是否验证它们。 总是请求DNSSEC记录，并总是进行验证，除非使用{\texttt{{-i}}} 或{\texttt{{+noroot}}}和{\texttt{{+nodlv}}}禁止。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]root[=ROOT]}}}}]\null{}
指示是否执行传统的（非后备）DNSSEC验证，如果是，指定信任锚点 的名字。 缺省是使用一个"."（根区）的信任锚点，对此有一个内置密钥。 如果指定一个不同的信任锚点，必须使用{\texttt{{-a}}} 指定一个包含这个密钥的文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{+[no]dlv[=DLV]}}}}]\null{}
指示是否执行DNSSEC后备验证，如果执行，就指定DLV信任锚点的名字。 缺省是使用信任锚点"dlv.isc.org"执行后备验证，对这个锚点存在一个 内置密钥。如果指定一个不同的名字，就必须使用{\texttt{{-a}}} 指定一个包含DLV密钥的文件。
\end{description}


\subsection*{文件}
\label{idm178368447376}

{\texttt{{/\dbz{}etc/\dbz{}bind.\dbz{}keys}}}

{\texttt{{/\dbz{}etc/\dbz{}resolv.\dbz{}conf}}}

\subsection*{参见}
\label{idm178368445536}

dig(1), named(8), {\em{RFC4034}}, {\em{RFC4035}}, {\em{RFC4431}}, {\em{RFC5074}}, {\em{RFC5155}}.
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-checkds}
\label{man.dnssec-checkds}\hypertarget{man.dnssec-checkds}{}%
\label{idm178368435920}

\section*{名字}
dnssec-checkds --- 一个DNSSEC授权一致性检查工具\label{idm178368432176}
\subsection*{概要}
\label{idm178368431920}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-checkds [{\texttt{{-l \textit{domain}}}}] [{\texttt{{-f \textit{file}}}}] [{\texttt{{-d \textit{dig path}}}}] [{\texttt{{-D \textit{dsfromkey path}}}}] {zone}}
\end{list}
\label{idm178368426416}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-dsfromkey [{\texttt{{-l \textit{domain}}}}] [{\texttt{{-f \textit{file}}}}] [{\texttt{{-d \textit{dig path}}}}] [{\texttt{{-D \textit{dsfromkey path}}}}] {zone}}
\end{list}

\subsection*{描述}
\label{idm178368420768}

{\bfseries{dnssec-checkds}} 为指定区中的密钥验证授权签名者（DS）或者DNSSEC旁观验证（DLV）资源记录 的正确性。

\subsection*{选项}
\label{idm178368419040}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{file}}}}]\null{}
如果指定了一个{\texttt{{file}}}，就从那个文件中读入区以查找 DNSKEY记录。如果没有，就在DNS中查找区的DNSKEY记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-l {\ttfamily\itshape{{domain}}}}]\null{}
在指定的旁观域中核对一个DLV记录，而不是与本区的父区中一个DS记录 进行核对。 例如，要在ISC的DLV区中核对“example.com”的DLV记录，使用： {\bfseries{dnssec-checkds -l dlv.isc.org example.com}}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d {\ttfamily\itshape{{dig path}}}}]\null{}
给一个{\bfseries{dig}}程序指定一个路径。用于测试。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D {\ttfamily\itshape{{dsfromkey path}}}}]\null{}
给一个{\bfseries{dnssec-dsfromkey}}程序指定一个路径。 用于测试。
\end{description}

\subsection*{参见}
\label{idm178368407216}

dnssec-dsfromkey(8), dnssec-keygen(8), dnssec-signzone(8),

\subsection*{作者}
\label{idm178368403008}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-coverage}
\label{man.dnssec-coverage}\hypertarget{man.dnssec-coverage}{}%
\label{idm178368397184}

\section*{名字}
dnssec-coverage --- 检查一个区DNSKEY将来的覆盖范围\label{idm178368393840}
\subsection*{概要}
\label{idm178368393584}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-coverage [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-l \textit{length}}}}] [{\texttt{{-f \textit{file}}}}] [{\texttt{{-d \textit{DNSKEY TTL}}}}] [{\texttt{{-m \textit{max TTL}}}}] [{\texttt{{-r \textit{interval}}}}] [{\texttt{{-c \textit{compilezone path}}}}] [{\texttt{{-k}}}] [{\texttt{{-z}}}] [zone]}
\end{list}

\subsection*{描述}
\label{idm178368383776}

{\bfseries{dnssec-coverage}} 验证一个给定的区或一个区集合的DNSSEC密钥是正确设置了定时元数据以确保 将来没有DNSSEC覆盖的间隔。

如果指定了{\texttt{{zone}}}，在密钥仓库中与这个区匹配的密钥都会被 扫描，并为那个密钥生成一个事件日程的顺序列表（如，发布，激活，失效， 删除）。事件列表以发生顺序遍历。 如果任何事件在进行时，可能导致区进入一个可能发生验证失败的状态时，会 生成一个警告。例如，如果一个对给定算法，其发布或激活的密钥数下降到零， 或者如果一个密钥在一个新密钥轮转后从其区中被太快地删除，由前一个密钥 签名的缓存数据还没时间从解析器的缓存中过期。

如果未指定{\texttt{{zone}}}，在密钥仓库中的所有密钥都会被扫描， 所有带密钥的区都会被分析。（注意：这个报告方法只在所有带有给定仓库中 密钥的区共享同样的TTL参数时才是精确的。）

\subsection*{选项}
\label{idm178368380176}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
设置能够找到密钥的目录。缺省为当前工作目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{file}}}}]\null{}
如果指定了一个{\texttt{{file}}}，区就从那个文件读取；最大 TTL和DNSKEY TTL就直接从区数据决定，就不需要在命令行指定 {\texttt{{-m}}}和{\texttt{{-d}}}选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-l {\ttfamily\itshape{{duration}}}}]\null{}
检查DNSSEC覆盖的时间长度。计划在超过{\texttt{{duration}}}的 将来的密钥事件将被忽略，并假设为正确的。

{\texttt{{duration}}}的值可以按秒设置，或通过增加一个后缀设为 更大的时间单位： 'mi'表示分钟，'h'表示小时，'d'表示天，'w'表示周， 'mo'表示月，'y'表示年。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-m {\ttfamily\itshape{{maximum TTL}}}}]\null{}
在决定是否存在一个验证失败的可能性时，为一个或多个被分析的区设置 最大TTL值。 当一个区签名密钥失效时，在密钥被剔除出DNSKEY资源记录集之前，必须 有足够的时间，让区中最大TTL的记录在解析器的缓存中过期。 如果这个条件不满足，将会产生一个警告。

TTL长度可以按秒设置，或通过增加一个后缀设为更大的时间单位： 'mi'表示分钟，'h'表示小时，'d'表示天，'w'表示周， 'mo'表示月，'y'表示年。

这个选项是必须的，除非使用{\texttt{{-f}}}指定了一个区文件。 （如果指定了{\texttt{{-f}}}，仍然可以使用这个选项；它将覆盖 在文件中发现的值。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d {\ttfamily\itshape{{DNSKEY TTL}}}}]\null{}
在决定是否存在一个验证失败的可能性时，为一个或多个被分析的区设置 用作DNSKEY TTL的值。 当一个密钥被轮转时（即被一个新密钥替代），在新密钥被激活并开始 生成签名之前，必须有足够的时间让旧的DNSKEY资源记录集在解析器 缓存中过期。 如果这个条件不满足，将会产生一个警告。

TTL长度可以按秒设置，或通过增加一个后缀设为更大的时间单位： 'mi'表示分钟，'h'表示小时，'d'表示天，'w'表示周， 'mo'表示月，'y'表示年。

这个选项是必须的，除非使用{\texttt{{-f}}}指定了一个区文件， 或者使用{\texttt{{-L}}}给{\bfseries{dnssec-keygen}} 设置了一个缺省的密钥TTL。（如果使用了上述两者之一，仍然可以使用 这个选项；它将覆盖在区或密钥文件中发现的值。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r {\ttfamily\itshape{{resign interval}}}}]\null{}
在决定是否存在一个验证失败的可能性时，为一个或多个被分析的区设置 用作放弃间隔（resign interval）的值。 这个值缺省为22.5天，也是{\bfseries{named}}中的缺省值。 然而，如果在{\texttt{{named.\dbz{}conf}}}使用 {\texttt{{sig-validity-interval}}}选项修改了，它应该在这里被 修改。

TTL长度可以按秒设置，或通过增加一个后缀设为更大的时间单位： 'mi'表示分钟，'h'表示小时，'d'表示天，'w'表示周， 'mo'表示月，'y'表示年。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k}]\null{}
只检查KSK覆盖；忽略ZSK事件。不能与{\texttt{{-z}}}一起使用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-z}]\null{}
只检查ZSK覆盖；忽略KSK事件。不能与{\texttt{{-k}}}一起使用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{compilezone path}}}}]\null{}
指定一个{\bfseries{named-compilezone}}二进制文件的路径。 用于测试。
\end{description}

\subsection*{参见}
\label{idm178368347408}

dnssec-checkds(8), dnssec-dsfromkey(8), dnssec-keygen(8), dnssec-signzone(8)

\subsection*{作者}
\label{idm178368342032}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-dsfromkey}
\label{man.dnssec-dsfromkey}\hypertarget{man.dnssec-dsfromkey}{}%
\label{idm178368336208}

\section*{名字}
dnssec-dsfromkey --- DNSSEC DS资源记录生成工具\label{idm178368331296}
\subsection*{概要}
\label{idm178368331040}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-dsfromkey [{\texttt{{-v \textit{level}}}}] [{\texttt{{-1}}}] [{\texttt{{-2}}}] [{\texttt{{-a \textit{alg}}}}] [{\texttt{{-l \textit{domain}}}}] [{\texttt{{-T \textit{TTL}}}}] {keyfile}}
\end{list}
\label{idm178368324464}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-dsfromkey {-s} [{\texttt{{-v \textit{level}}}}] [{\texttt{{-1}}}] [{\texttt{{-2}}}] [{\texttt{{-a \textit{alg}}}}] [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-l \textit{domain}}}}] [{\texttt{{-s}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-T \textit{TTL}}}}] [{\texttt{{-f \textit{file}}}}] [{\texttt{{-A}}}] [{\texttt{{-v \textit{level}}}}] {dnsname}}
\end{list}
\label{idm178368312224}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-dsfromkey [{\texttt{{-h}}}] [{\texttt{{-V}}}]}
\end{list}

\subsection*{描述}
\label{idm178368310272}

{\bfseries{dnssec-dsfromkey}} 为给定密钥输出在RFC 3658和RFC 4509中所定义的授权签名者（DS） 资源记录（RR）。

\subsection*{选项}
\label{idm178368308544}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-1}]\null{}
使用SHA-1作为摘要算法（缺省是使用SHA-1和SHA-256）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-2}]\null{}
使用SHA-256作为摘要算法。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a {\ttfamily\itshape{{algorithm}}}}]\null{}
选择摘要算法。{\texttt{{algorithm}}}的值必须是 SHA-1 (SHA1)，SHA-256 (SHA256)，GOST或SHA-384 (SHA384)之一。 这些值是大小写不敏感的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-T {\ttfamily\itshape{{TTL}}}}]\null{}
指定DS记录的TTL。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
在{\texttt{{directory}}}中查找密钥文件（或者在keyset模式时， 查找{\texttt{{keyset-\dbz{}}}}文件）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{file}}}}]\null{}
区文件模式：作为密钥文件名的替代，此参数是一个区主文件的 域名，它可以从{\texttt{{file}}}中读入。如果区名与 {\texttt{{file}}}相同，这个参数可以忽略。

如果{\texttt{{file}}}被设置为{\texttt{{"-\dbz{}"}}}，区数据 将从标准输入读入。这使使用{\bfseries{dig}}命令的输出作为 输入成为可能，例如：

{\ttfamily\bfseries{{dig dnskey example.\dbz{}com | dnssec-\dbz{}dsfromkey -\dbz{}f -\dbz{} example.\dbz{}com}}}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-A}]\null{}
当生成DS记录时包含ZSK。没有这个选项时，只有具有KSK标志的 密钥被转换为DS记录并打印。仅用于区文件模式。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-l {\ttfamily\itshape{{domain}}}}]\null{}
生成一个DLV集合而不是一个DS集合。所指定的 {\texttt{{domain}}}被添加到集合中每条记录的名字。 DNSSEC旁观验证（DLV）资源记录在RFC 4431中描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s}]\null{}
密钥集合模式：替代密钥文件名字，参数是一个密钥集合文件的 DNS域名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
指定DNS类（缺省是IN），仅用于密钥集合（keyset）或区文件模式。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印用法信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
\end{description}

\subsection*{例子}
\label{idm178368276288}

要从{\ttfamily\bfseries{{Kexample.\dbz{}com.\dbz{}+\dbz{}003+\dbz{}26160}}}密钥文件（keyfile） 名构建SHA-256 DS资源记录，执行下列命令：

{\ttfamily\bfseries{{dnssec-\dbz{}dsfromkey -\dbz{}2 Kexample.\dbz{}com.\dbz{}+\dbz{}003+\dbz{}26160}}}

命令将输出类似下面的内容：

{\ttfamily\bfseries{{example.\dbz{}com.\dbz{} IN DS 26160 5 2 3A1EADA7A74B8D0BA86726B0C227AA85AB8BBD2B2004F41A868A54F0 C5EA0B94}}}

\subsection*{文件}
\label{idm178368272656}

密钥文件可以根据密钥标识{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii}}} 或者由 dnssec-keygen(8) 所生成的完整文件名{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}key}}}来设计。

密钥集合文件名是从{\texttt{{directory}}}，字符串 {\texttt{{keyset-\dbz{}}}}和{\texttt{{dnsname}}}中构建的。

\subsection*{注意}
\label{idm178368268016}

即使文件存在，一个密钥文件错误也会给出一个"文件不存在"消息。

\subsection*{参见}
\label{idm178368266624}

dnssec-keygen(8), dnssec-signzone(8), {\em{BIND 9管理员参考手册}}, {\em{RFC 3658}}, {\em{RFC 4431}}. {\em{RFC 4509}}.

\subsection*{作者}
\label{idm178368261776}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-importkey}
\label{man.dnssec-importkey}\hypertarget{man.dnssec-importkey}{}%
\label{idm178368255936}

\section*{名字}
dnssec-importkey --- 从外部系统导入DNSKEY记录从而可对其进行管理。\label{idm178368252560}
\subsection*{概要}
\label{idm178368252304}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-importkey [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-L \textit{ttl}}}}] [{\texttt{{-P \textit{date/offset}}}}] [{\texttt{{-D \textit{date/offset}}}}] [{\texttt{{-h}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] {{\texttt{{keyfile}}}}}
\end{list}
\label{idm178368244592}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-importkey {{\texttt{{-f \textit{filename}}}}} [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-L \textit{ttl}}}}] [{\texttt{{-P \textit{date/offset}}}}] [{\texttt{{-D \textit{date/offset}}}}] [{\texttt{{-h}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] [{\texttt{{dnsname}}}]}
\end{list}

\subsection*{描述}
\label{idm178368235760}

{\bfseries{dnssec-importkey}}读一个公共DNSKEY记录并生成一对 .key/.private文件。DNSKEY记录可以从一个现存的.key文件中读入，这种 情况将会生成一个相关的.private文件，或者它可以从任何其它文件或者 标准输入读入，这时将会生成.key和.private文件。

新建立的.private文件{\em{不}}包含私钥数据，不能用于 签名。但是，有一个.private文件使得设置密钥的发布（{\texttt{{-P}}}） 和删除（{\texttt{{-D}}}）时间成为可能，这意谓着即使真正的私钥 是离线存放，也可以按预计计划将公钥添加到DNSKEY资源记录集中，或从中 删除。

\subsection*{选项}
\label{idm178368231664}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{filename}}}}]\null{}
区文件模式：作为公钥文件名的替代，此参数是一个区主文件的 域名，它可以从{\texttt{{file}}}中读入。如果这个域名与 {\texttt{{file}}}相同，这个参数可以忽略。

如果{\texttt{{file}}}被设置为{\texttt{{"-\dbz{}"}}}，区数据 将从标准输入读入。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
设置存放密钥文件的目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-L {\ttfamily\itshape{{ttl}}}}]\null{}
设置本密钥在被转换进一个DNSKEY资源记录中时的缺省TTL值。如果这个 密钥被导入进一个区，这就被用作密钥的TTL，除非区中已经有一个 DNSKEY资源记录集，在后者的情况下，已经存在的TTL将会优先。将 缺省的TTL设置为{\texttt{{0}}}或者{\texttt{{none}}} 来删除它。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
输出用法消息并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
\end{description}

\subsection*{定时选项}
\label{idm178368214864}

日期可以被表示成YYYYMMDD或YYYYMMDDHHMMSS格式。 如果参数以'+'或'-'开始，它将会被解释成自当前时间始的偏移量。 为方便起见，如果这个偏移量带有这些后缀之一，'y'，'mo'，'w'， 'd'，'h'或'mi'，这个偏移量就分别被以年（定义为365个24小时的天， 忽略闰年），月（定义为30个24小时的天），周，天，小时或分钟计算。 没有后缀时，偏移量以秒计算。要显式阻止设置一个日期，使用'none'或'never'。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-P {\ttfamily\itshape{{date/offset}}}}]\null{}
设置一个密钥被发布到区的日期。在此日期之后，密钥将会被包含到 区中，但不会用于对其签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被删除的日期。在此日期之后，密钥将不再被包含在区中。 （然而，它可能仍然保留在密钥仓库中。）
\end{description}

\subsection*{文件}
\label{idm178368207872}

可以由密钥标识{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii}}}或者 dnssec-keygen(8) 生成的完整文件名{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}key}}}来决定。

\subsection*{参见}
\label{idm178368205040}

dnssec-keygen(8), dnssec-signzone(8), {\em{BIND 9 Administrator Reference Manual}}, {\em{RFC 5011}}.

\subsection*{作者}
\label{idm178368201040}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-keyfromlabel}
\label{man.dnssec-keyfromlabel}\hypertarget{man.dnssec-keyfromlabel}{}%
\label{idm178368195200}

\section*{名字}
dnssec-keyfromlabel --- DNSSEC密钥生成工具\label{idm178368190304}
\subsection*{概要}
\label{idm178368190048}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-keyfromlabel {-l \textit{label}} [{\texttt{{-3}}}] [{\texttt{{-a \textit{algorithm}}}}] [{\texttt{{-A \textit{date/offset}}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-D \textit{date/offset}}}}] [{\texttt{{-E \textit{engine}}}}] [{\texttt{{-f \textit{flag}}}}] [{\texttt{{-G}}}] [{\texttt{{-I \textit{date/offset}}}}] [{\texttt{{-i \textit{interval}}}}] [{\texttt{{-k}}}] [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-L \textit{ttl}}}}] [{\texttt{{-n \textit{nametype}}}}] [{\texttt{{-P \textit{date/offset}}}}] [{\texttt{{-p \textit{protocol}}}}] [{\texttt{{-R \textit{date/offset}}}}] [{\texttt{{-S \textit{key}}}}] [{\texttt{{-t \textit{type}}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] [{\texttt{{-y}}}] {name}}
\end{list}

\subsection*{描述}
\label{idm178368167408}

{\bfseries{dnssec-keyfromlabel}} 生成一个密钥对的文件，文件指向存储在一个加密机硬件服务模块（HSM）中的 一个密钥对象。 私钥文件可以用于DNSSEC对区数据的签名，就如同它是一个由 {\bfseries{dnssec-keygen}}所创建的传统签名密钥一样， 但是密钥介质是存放在HSM内，实际上签名也在其中进行。

密钥的{\texttt{{name}}}在命令行指定。这必须与为其生成密钥的 区的名字相匹配。

\subsection*{选项}
\label{idm178368164032}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a {\ttfamily\itshape{{algorithm}}}}]\null{}
选择加密算法。{\texttt{{algorithm}}}的值必须为 RSAMD5，RSASHA1，DSA，NSEC3RSASHA1，NSEC3DSA，RSASHA256， RSASHA512，ECCGOST，ECDSAP256SHA256或ECDSAP384SHA384之一。 这些值是大小写不敏感的。

如果未指定算法，缺省使用RSASHA1，除非指定了{\texttt{{-3}}} 选项，这时将使用NSEC3RSASHA1。（如果使用了{\texttt{{-3}}} 并指定了一个算法，将检查这个算法对NSEC3的兼容性。）

注1：对DNSSEC来说，RSASHA1是必须实现的算法，而DSA是推荐的。

注2：DH自动设置-k标志。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-3}]\null{}
使用NSEC3兼容算法生成一个DNSSEC密钥。 如果使用了这个选项并且没有在命令行显式设定算法，缺省将 使用NSEC3RSASHA1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine}}}}]\null{}
指定要使用的加密硬件。

当BIND使用OpenSSL PKCS\#11支持构建时，这个缺省为字符串"pkcs11"， 它标识一个可以驱动加密加速器或硬件服务模块的OpenSSL引擎。当BIND 使用原生PKCS\#11加密（--enable-native-pkcs11）构建时，它缺省是由 "--with-pkcs11"所指定的PKCS\#11提供者库的路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-l {\ttfamily\itshape{{label}}}}]\null{}
指定加密硬件中密钥对的标记。

当BIND 9使用基于OpenSSL的PKCS\#11支持构建时， 这个标记是一个任意的字符串，它标识一个特定的密钥。它可能由一个 可选的OpenSSL引擎名开始，后跟一个冒号，如同 "pkcs11:{\ttfamily\itshape{{keylabel}}}"。

当BIND 9使用原生PKCS\#11支持构建时，这个标记 是一个PKCS\#11 URI字符串，其格式为 "pkcs11:{\texttt{{keyword}}}={\ttfamily\itshape{{value}}}[;{\texttt{{keyword}}}={\ttfamily\itshape{{value}}};...]" 关键字包括"token"，它标识HSM；"object"，它标识密钥； 和"pin-source"，它标识一个文件，从中可以获得HSM的PIN码。 这个标记将存放在磁盘上的"private"文件中。

如果这个标记包含一个{\texttt{{pin-source}}}字段，使用生成密钥 文件的工具将能够使用HSM签名和其它操作，而不需要一个操作人员手工 输入一个PIN。注意：使得HSM的PIN可以以这样的方式访问可能减小使用 HSM的安全优势；在使用这个特性之前确认这就是你想要做的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-n {\ttfamily\itshape{{nametype}}}}]\null{}
指定密钥的拥有者类型。{\texttt{{nametype}}}的值是ZONE （对DNSSEC的区密钥（KEY/DNSKEY）），HOST或ENTITY（对一个与主机 （KEY）相关的密钥），USER（对一个与用户（KEY）相关的密钥）或 OTHER（DNSKEY）。这些值是大小写不敏感的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-C}]\null{}
兼容模式：生成一个旧风格的密钥，不带任何元数据。缺省时， {\bfseries{dnssec-keyfromlabel}}将在存放于私钥的元数据中 包含密钥的创建日期，其它日期也可能在那儿设置（发布日期， 激活日期等等）。包含这些数据的密钥可能与旧版本的BIND 不兼容；{\texttt{{-C}}}防止了这些情况。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
指示包含密钥的DNS记录应该具有指定的类。如果未指定，使用类IN。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{flag}}}}]\null{}
在KEY/DNSKEY记录的标志字段中设置特定的标志。只能被识别的标志 是KSK（密钥签名密钥）和REVOKE。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-G}]\null{}
生成一个密钥，但是不发布它，也不使用它签名。这个选项与 -P和-A不兼容。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印{\bfseries{dnssec-keyfromlabel}}的选项和参数的 简短摘要。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
设置写密钥文件的目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k}]\null{}
生成KEY记录而不是DNSKEY记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-L {\ttfamily\itshape{{ttl}}}}]\null{}
设置本密钥在被转换进一个DNSKEY资源记录中时的缺省TTL值。如果这个 密钥被导入进一个区，这就被用作密钥的TTL，除非区中已经有一个 DNSKEY资源记录集，在后者的情况下，已经存在的TTL将会优先。将 缺省的TTL设置为{\texttt{{0}}}或者{\texttt{{none}}} 来删除它。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{protocol}}}}]\null{}
为密钥设置协议值。协议是一个0到255之间的数。缺省是3 （DNSSEC）。这个参数的其它可能值在RFC 2535及其后继中列出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-S {\ttfamily\itshape{{key}}}}]\null{}
生成一个密钥，作为一个现存密钥的明确后继。这个密钥的名字，算法， 大小和类型要设置成与其前驱向匹配。新密钥的激活日期设置成现存 密钥的失活日期。公开日期设置成激活日期减去预先公开的间隔，后者 缺省为30天。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{type}}}}]\null{}
指定密钥的使用。{\texttt{{type}}}必须是AUTOCONF， NOAUTHCONF，NOAUTH或NOCONF之一。缺省是AUTHCONF。AUTH为认证 数据的能力，而CONF为加密数据的能力。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-y}]\null{}
即使在密钥ID会与一个已存在的密钥冲突的情况下，也允许生成密钥 文件，两种情况下密钥都会被撤销。（这仅在你确定不会使用RFC 5011 信任锚点维护所涉及的密钥时，才是安全的。）
\end{description}

\subsection*{定时选项}
\label{idm178368108016}

日期可以被表示成YYYYMMDD或YYYYMMDDHHMMSS格式。 如果参数以'+'或'-'开始，它将会被解释成自当前时间始的偏移量。 为方便起见，如果这个偏移量带有这些后缀之一，'y'，'mo'，'w'， 'd'，'h'或'mi'，这个偏移量就分别被以年（定义为365个24小时的天， 忽略闰年），月（定义为30个24小时的天），周，天，小时或分钟计算。 没有后缀时，偏移量以秒计算。要显式阻止设置一个日期，使用'none'或'never'。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-P {\ttfamily\itshape{{date/offset}}}}]\null{}
设置一个密钥被发布到区的日期。在此日期之后，密钥将会被包含到 区中，但不会用于对其签名。如果未设置，并且没有使用-G选项， 缺省是“now”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-A {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被激活的日期。在此日期之后，密钥将会被包含到区中并用于 对其签名。如果未设置，并且没有使用-G选项，缺省是“now”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-R {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被撤销的日期。在此日期之后，密钥将被标志为被撤销。 它将会被包含到区中并用于对其签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-I {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被撤销的日期。在此日期之后，密钥仍然被包含在区中， 但它不再被用于签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被删除的日期。在此日期之后，密钥将不再被包含在区中。 （然而，它可能仍然保留在密钥仓库中。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-i {\ttfamily\itshape{{interval}}}}]\null{}
为一个密钥设置发布前间隔。如果设置，则发布日期与激活日期之间必须 至少间隔这么多的日期。如果指定了激活日期而没有指定发布日期，则发 布日期缺省为激活日期之前这么多时间；相反地，如果指定了发布日期但 没有指定激活日期，则激活日期将被设置为在发布日期之后这么多时间。

正在被创建的密钥是另一个密钥的明确后继，则缺省的发布前间隔是30天； 否则就是零。

与日期偏移量相伴，如果参数后面有后缀‘y’，‘mo’，‘w’，‘d’， ‘h’，或‘mi’中的一个，则间隔的单位分别为年，月，周，天，小时， 分钟。没有后缀的情况，间隔的单位为秒。
\end{description}

\subsection*{生成的密钥文件}
\label{idm178368089232}

当{\bfseries{dnssec-keyfromlabel}}完全成功时，它打印一个 {\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii}}}格式的字符串到标准输出。这是 其生成的密钥的标识字符串。

\begin{itemize}
%--- Item
\item 
{\texttt{{nnnn}}}是密钥名。


%--- Item
\item 
{\texttt{{aaa}}}是算法的数字表示。


%--- Item
\item 
{\texttt{{iiiii}}}是密钥标识符（或足迹）。

\end{itemize}

{\bfseries{dnssec-keyfromlabel}}创建两个文件，其名字类似 这个打印的字符串。{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}key}}}包含 公钥，而{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}private}}}包含私钥。

{\texttt{{.\dbz{}key}}}文件包含一个DNS KEY记录，可以 （直接或使用一个\$INCLUDE语句）插入到一个区文件中。

{\texttt{{.\dbz{}private}}}文件包含算法相关字段。由于明显 的安全原因，这个文件不能具有任何人可读的权限。

\subsection*{参见}
\label{idm178368079808}

dnssec-keygen(8), dnssec-signzone(8), {\em{BIND 9管理员参考手册}}， {\em{RFC 4034}}， {\em{PKCS\#11 URI方案 (draft-pechanec-pkcs11uri-13)}}。

\subsection*{作者}
\label{idm178368075280}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-keygen}
\label{man.dnssec-keygen}\hypertarget{man.dnssec-keygen}{}%
\label{idm178368069376}

\section*{名字}
dnssec-keygen --- DNSSEC密钥生成工具\label{idm178368060528}
\subsection*{概要}
\label{idm178368060272}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-keygen [{\texttt{{-a \textit{algorithm}}}}] [{\texttt{{-b \textit{keysize}}}}] [{\texttt{{-n \textit{nametype}}}}] [{\texttt{{-3}}}] [{\texttt{{-A \textit{date/offset}}}}] [{\texttt{{-C}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-D \textit{date/offset}}}}] [{\texttt{{-E \textit{engine}}}}] [{\texttt{{-f \textit{flag}}}}] [{\texttt{{-G}}}] [{\texttt{{-g \textit{generator}}}}] [{\texttt{{-h}}}] [{\texttt{{-I \textit{date/offset}}}}] [{\texttt{{-i \textit{interval}}}}] [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-L \textit{ttl}}}}] [{\texttt{{-k}}}] [{\texttt{{-P \textit{date/offset}}}}] [{\texttt{{-p \textit{protocol}}}}] [{\texttt{{-q}}}] [{\texttt{{-R \textit{date/offset}}}}] [{\texttt{{-r \textit{randomdev}}}}] [{\texttt{{-S \textit{key}}}}] [{\texttt{{-s \textit{strength}}}}] [{\texttt{{-t \textit{type}}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] [{\texttt{{-z}}}] {name}}
\end{list}

\subsection*{描述}
\label{idm178368033136}

{\bfseries{dnssec-keygen}}为DNSSEC（安全DNS）生成密钥， 在RFC 2535和RFC 4034中定义。它也可以为使用在RFC 2845中所定义的 TSIG（事务签名）或在RFC 2930中所定义的TKEY（事务密钥）生成密钥。

密钥的{\texttt{{name}}}在命令行指定。对于DNSSEC密钥，这必须 与为其生成密钥的区的名字相匹配。

\subsection*{选项}
\label{idm178368030384}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a {\ttfamily\itshape{{algorithm}}}}]\null{}
选择加密算法。对DNSSEC密钥，{\texttt{{algorithm}}}的值 必须为RSAMD5，RSASHA1，DSA，NSEC3RSASHA1，NSEC3DSA，RSASHA256 ，RSASHA512，ECCGOST，ECDSAP256SHA256或ECDSAP384SHA384之一。对 TSIG/TKEY，其值必须为DH（Diffie Hellman），HMAC-MD5，HMAC-SHA1， HMAC-SHA224，HMAC-SHA256，HMAC-SHA384或HMAC-SHA512之一。 这些值是大小写不敏感的。

如果未指定算法，缺省使用RSASHA1，除非指定了{\texttt{{-3}}} 选项，这时将使用NSEC3RSASHA1。（如果使用了{\texttt{{-3}}} 并指定了一个算法，将检查这个算法对NSEC3的兼容性。）

注1：对DNSSEC来说，RSASHA1是必须实现的算法，而DSA是推荐的。 对TSIG来说，HMAC-MD5是必须的。

注2：DH，HMAC-MD5以及从HMAC-SHA1到HMAC-SHA512自动设置-T KEY选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-b {\ttfamily\itshape{{keysize}}}}]\null{}
指定密钥的位数。密钥大小的选择依赖于所使用的算法。 RSA密钥必须在512和2048位之间。Diffie Hellman密钥必须在 128和4096位之间。DSA密钥必须在512和1024位之间并且是64的整数倍。 HMAC密钥必须在1和512位之间。椭圆曲线算法不需要这个参数。

如果使用缺省算法，不需要指定密钥的大小。对区签名密钥（ZSK）， 缺省密钥大小是1024位，而对密钥签名密钥（KSK，由 {\texttt{{-f KSK}}}所生成），缺省是2048位。 然而，如果使用{\texttt{{-a}}}显式指定了一个算法， 就没有缺省的密钥大小了，就必须使用{\texttt{{-b}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-n {\ttfamily\itshape{{nametype}}}}]\null{}
指定密钥的拥有者类型。{\texttt{{nametype}}}的值要么是ZONE （对DNSSEC的区密钥（KEY/DNSKEY）），HOST或ENTITY（对一个与主机 （KEY）相关的密钥），USER（对一个与用户（KEY）相关的密钥）或 OTHER（DNSKEY）。这些值是大小写不敏感的。缺省是ZONE，用于DNSKEY 生成。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-3}]\null{}
使用NSEC3兼容算法生成一个DNSSEC密钥。 如果使用了这个选项并且没有在命令行显式设定算法，缺省将 使用NSEC3RSASHA1。注意RSASHA256，RSASHA512，ECCGOST， ECDSAP256SHA256和ECDSAP384SHA384算法是NSEC3兼容的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-C}]\null{}
兼容模式：生成一个旧风格的密钥，不带任何元数据。缺省时， {\bfseries{dnssec-keygen}}将在存放于私钥的元数据中 包含密钥的创建日期，其它日期也可能在那儿设置（发布日期， 激活日期等等）。包含这些数据的密钥可能与旧版本的BIND 不兼容；{\texttt{{-C}}}防止了这些情况。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
指示包含密钥的DNS记录应该具有指定的类。如果未指定，使用类IN。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine}}}}]\null{}
如果适用，指定要使用的加密硬件。

当BIND使用带OpenSSL PKCS\#11支持构建时，这个缺省值是字符串 "pkcs11"，它标识一个可以驱动一个加密加速器或硬件服务模块的 OpenSSL引擎，当BIND使用带原生PKCS\#11加密 （--enable-native-pkcs11）构建时，它缺省是由"--with-pkcs11" 指定的PKCS\#11提供者库的路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{flag}}}}]\null{}
在KEY/DNSKEY记录的标志字段中设置特定的标志。只能被识别的标志 是KSK（密钥签名密钥）和REVOKE。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-G}]\null{}
生成一个密钥，但是不发布它，也不使用它签名。这个选项与 -P和-A不兼容。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-g {\ttfamily\itshape{{generator}}}}]\null{}
如果生成一个Diffie Hellman密钥，使用这个生成器。允许值为2到 5。如果未指定生成器，如果可能使用来自RFC 2539的著名素数；否 则缺省为2。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印{\bfseries{dnssec-keygen}}的选项和参数的简短摘要。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
设置写密钥文件的目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k}]\null{}
废除的-T KEY。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-L {\ttfamily\itshape{{ttl}}}}]\null{}
设置本密钥在被转换进一个DNSKEY资源记录中时的缺省TTL值。如果这个 密钥被导入进一个区，这就被用作密钥的TTL，除非区中已经有一个 DNSKEY资源记录集，在后者的情况下，已经存在的TTL将会优先。 如果未设置这个值并且不存在DNSKEY资源记录集，TTL缺省将是SOA TTL。 将缺省的TTL设置为{\texttt{{0}}}或者{\texttt{{none}}} 就和不设置它有同样的效果。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{protocol}}}}]\null{}
为生成密钥设置协议值。协议是一个0到255之间的数。缺省是3 （DNSSEC）。这个参数的其它可能值在RFC 2535及其后继中列出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-q}]\null{}
安静模式：关闭不必要的输出，也包含进度指示。在没有这个 选项时，当交互式运行{\bfseries{dnssec-keygen}}来 生成一个RSA或DSA密钥对时，它会打印一串符号到 {\texttt{{stderr}}}，以指示生成密钥的进度。 一个‘.‘表示发现一个随机数，它被传递给一个初始化过滤 测试；’+‘表示一个随机数被传递给一个单轮 Miller-Rabin primality测试；一个空格表示随机数被传递给 所有的测试并且是一个合格的密钥。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r {\ttfamily\itshape{{randomdev}}}}]\null{}
指定随机性的源。如果操作系统不提供 {\texttt{{/\dbz{}dev/\dbz{}random}}}或等效的设备，缺省的随机性的源为 键盘输入。{\texttt{{randomdev}}}指定一个字符设备名或包含 随机数据的文件名，用来替代缺省值。特定值 {\texttt{{keyboard}}}指示使用键盘输入。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-S {\ttfamily\itshape{{key}}}}]\null{}
创建一个新密钥，它是一个当前存在密钥的明确的后继。这个密钥的 名字，算法，大小，和类型都被设置为与现存密钥向匹配。新密钥的 激活日期设置为现存密钥的失效日期。其发布日期被设置为激活日期 减去发布前间隔，后者缺省是30天。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s {\ttfamily\itshape{{strength}}}}]\null{}
指定密钥的强度值。这个强度是0到15之间的一个数，当前在 DNSSEC中没有定义其意图。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-T {\ttfamily\itshape{{rrtype}}}}]\null{}
为密钥指定所使用的资源记录类型。 {\texttt{{rrtype}}}必须是DNSKEY或KEY。在使用一个 DNSSEC算法时，缺省是DNSKEY，但是与SIG(0)一起使用时，它可以被 覆盖为KEY。 

 使用任何TSIG算法（HMAC-*或DH）强制这个选项为KEY。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{type}}}}]\null{}
指定密钥的使用。{\texttt{{type}}}必须是AUTOCONF， NOAUTHCONF，NOAUTH或NOCONF之一。缺省是AUTHCONF。AUTH为认证 数据的能力，而CONF为加密数据的能力。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
\end{description}

\subsection*{定时选项}
\label{idm178367964064}

日期可以被表示成YYYYMMDD或YYYYMMDDHHMMSS格式。 如果参数以'+'或'-'开始，它将会被解释成自当前时间始的偏移量。 为方便起见，如果这个偏移量带有这些后缀之一，'y'，'mo'，'w'， 'd'，'h'或'mi'，这个偏移量就分别被以年（定义为365个24小时的天， 忽略闰年），月（定义为30个24小时的天），周，天，小时或分钟计算。 没有后缀时，偏移量以秒计算。要显式阻止设置一个日期，使用'none'或'never'。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-P {\ttfamily\itshape{{date/offset}}}}]\null{}
设置一个密钥被发布到区的日期。在此日期之后，密钥将会被包含到 区中，但不会用于对其签名。如果未设置，并且没有使用-G选项， 缺省是“now”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-A {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被激活的日期。在此日期之后，密钥将会被包含到区中并用于 对其签名。如果未设置，并且没有使用-G选项，缺省是“now”。如果 设置，并且未设置-P，公开日期将被设置为激活日期减去提前公开的 间隔。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-R {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被撤销的日期。在此日期之后，密钥将被标志为被撤销。 它将会被包含到区中并用于对其签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-I {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被撤销的日期。在此日期之后，密钥仍然被包含在区中， 但它不再被用于签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被删除的日期。在此日期之后，密钥将不再被包含在区中。 （然而，它可能仍然保留在密钥仓库中。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-i {\ttfamily\itshape{{interval}}}}]\null{}
为一个密钥设置发布前间隔。如果设置，则发布日期与激活日期之间必须 至少间隔这么多的日期。如果指定了激活日期而没有指定发布日期，则发 布日期缺省为激活日期之前这么多时间；相反地，如果指定了发布日期但 没有指定激活日期，则激活日期将被设置为在发布日期之后这么多时间。

正在被创建的密钥是另一个密钥的明确后继，则缺省的发布前间隔是30天； 否则就是零。

与日期偏移量相伴，如果参数后面有后缀‘y’，‘mo’，‘w’，‘d’， ‘h’，或‘mi’中的一个，则间隔的单位分别为年，月，周，天，小时， 分钟。没有后缀的情况，间隔的单位为秒。
\end{description}

\subsection*{生成的密钥}
\label{idm178367945072}

当{\bfseries{dnssec-keygen}}完全成功时，它打印一个 {\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii}}}格式的字符串到标准输出。这是 其生成的密钥的标识字符串。

\begin{itemize}
%--- Item
\item 
{\texttt{{nnnn}}}是密钥名。


%--- Item
\item 
{\texttt{{aaa}}}是算法的数字表示。


%--- Item
\item 
{\texttt{{iiiii}}}是密钥标识符（或足迹）。

\end{itemize}

{\bfseries{dnssec-keygen}}创建两个文件，其名字类似这个打印 的字符串。{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}key}}}包含公钥， 而{\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}private}}}包含私钥。

{\texttt{{.\dbz{}key}}}文件包含一个DNS KEY记录，可以 （直接或使用一个\$INCLUDE语句）插入到一个区文件中。

{\texttt{{.\dbz{}private}}}文件包含算法相关字段。由于明显 的安全原因，这个文件不能具有任何人可读的权限。

{\texttt{{.\dbz{}key}}}和{\texttt{{.\dbz{}private}}}文件都 是由对称加密算法，如HMAC-MD5，生成，即使公钥和私钥是等价的。

\subsection*{例子}
\label{idm178367934416}

要为域{\ttfamily\bfseries{{example.\dbz{}com}}}生成一个768位的DSA密钥， 需要执行下列命令：

{\ttfamily\bfseries{{dnssec-\dbz{}keygen -\dbz{}a DSA -\dbz{}b 768 -\dbz{}n ZONE example.\dbz{}com}}}

命令将会打印下列格式的字符串：

{\ttfamily\bfseries{{Kexample.\dbz{}com.\dbz{}+\dbz{}003+\dbz{}26160}}}

在这个例子中，{\bfseries{dnssec-keygen}}建立文件 {\texttt{{Kexample.\dbz{}com.\dbz{}+\dbz{}003+\dbz{}26160.\dbz{}key}}}和 {\texttt{{Kexample.\dbz{}com.\dbz{}+\dbz{}003+\dbz{}26160.\dbz{}private}}}。

\subsection*{参见}
\label{idm178367929104}

dnssec-signzone(8), {\em{BIND 9管理员参考手册}}, {\em{RFC 2539}}, {\em{RFC 2845}}, {\em{RFC 4034}}.

\subsection*{作者}
\label{idm178367925296}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-revoke}
\label{man.dnssec-revoke}\hypertarget{man.dnssec-revoke}{}%
\label{idm178367919472}

\section*{名字}
dnssec-revoke --- 设置一个DNSSEC密钥中的REVOKED位\label{idm178367915728}
\subsection*{概要}
\label{idm178367915472}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-revoke [{\texttt{{-hr}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-E \textit{engine}}}}] [{\texttt{{-f}}}] [{\texttt{{-R}}}] {keyfile}}
\end{list}

\subsection*{描述}
\label{idm178367908816}

{\bfseries{dnssec-revoke}} 读一个DNSSEC密钥文件，设置在RFC 5011中定义的密钥中的REVOKED位， 并创建一对新的密钥文件，其中包含现在已撤销的密钥。

\subsection*{选项}
\label{idm178367906992}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
输出用法消息并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
设置存放密钥文件的目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r}]\null{}
在写了新的密钥集合文集之后删去原来的密钥集合文集。 files.
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine}}}}]\null{}
如果适用，指定要使用的加密硬件。

当BIND使用带OpenSSL PKCS\#11支持构建时，这个缺省值是字符串 "pkcs11"，它标识一个可以驱动一个加密加速器或硬件服务模块的 OpenSSL引擎，当BIND使用带原生PKCS\#11加密 （--enable-native-pkcs11）构建时，它缺省是由"--with-pkcs11" 指定的PKCS\#11提供者库的路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f}]\null{}
强制覆盖：导致{\bfseries{dnssec-revoke}}输出新的 密钥对，即使一个与被撤销密钥的算法和密钥ID都匹配的文件 已经存在。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-R}]\null{}
打印带有REVOKE位的密钥的密钥标签但不激活密钥。
\end{description}

\subsection*{参见}
\label{idm178367889456}

dnssec-keygen(8), {\em{BIND 9管理员参考手册}}, {\em{RFC 5011}}.

\subsection*{作者}
\label{idm178367886496}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-settime}
\label{man.dnssec-settime}\hypertarget{man.dnssec-settime}{}%
\label{idm178367880656}

\section*{名字}
dnssec-settime --- 为一个DNSSEC密钥设置密钥定时元数据\label{idm178367876096}
\subsection*{概要}
\label{idm178367875840}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-settime [{\texttt{{-f}}}] [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-L \textit{ttl}}}}] [{\texttt{{-P \textit{date/offset}}}}] [{\texttt{{-A \textit{date/offset}}}}] [{\texttt{{-R \textit{date/offset}}}}] [{\texttt{{-I \textit{date/offset}}}}] [{\texttt{{-D \textit{date/offset}}}}] [{\texttt{{-h}}}] [{\texttt{{-V}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-E \textit{engine}}}}] {keyfile}}
\end{list}

\subsection*{描述}
\label{idm178367863568}

{\bfseries{dnssec-settime}} 读取一个DNSSEC私钥文件并按照{\texttt{{-P}}}， {\texttt{{-A}}}，{\texttt{{-R}}}，{\texttt{{-I}}} 和{\texttt{{-D}}}选项的指定设置密钥定时的元数据。 元数据可以用于{\bfseries{dnssec-signzone}}或其它签名软件， 以决定何时发布一个密钥，密钥是否可以用于对一个区签名等等。

如果命令行中没有设置这些选项，{\bfseries{dnssec-settime}} 只是简单地打印已经存储在密钥中的密钥定时元数据。

当密钥的元数据字段被改变时，密钥对的两个文件（ {\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}key}}}和 {\texttt{{Knnnn.\dbz{}+\dbz{}aaa+\dbz{}iiiii.\dbz{}private}}}）都被重新生成。 元数据字段存放在private文件中。在key文件中也以注释形式存放 一份人可读的元数据描述。私钥文件的权限总是被设置为除属主外任何人 都不可访问（模式0600）。

\subsection*{选项}
\label{idm178367856752}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f}]\null{}
强制更新一个不带元数据字段的旧格式的密钥。如果没有这个选项， {\bfseries{dnssec-settime}}在试图更新一个旧密钥时将会 失败。有这个选项时，将会以新格式重新生成密钥，但是会保留 原始的密钥数据。密钥的创建日期会被设置为当前时间。如果未指定 其它值，密钥的发布日期和激活日期也将被设置为当前时间。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
设置存放密钥文件的目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-L {\ttfamily\itshape{{ttl}}}}]\null{}
设置本密钥在被转换进一个DNSKEY资源记录中时的缺省TTL值。如果这个 密钥被导入进一个区，这就被用作密钥的TTL，除非区中已经有一个 DNSKEY资源记录集，在后者的情况下，已经存在的TTL将会优先。 如果未设置这个值并且不存在DNSKEY资源记录集，TTL缺省将是SOA TTL。 将缺省的TTL设置为{\texttt{{0}}}或者{\texttt{{none}}} 从密钥中删除它。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
输出用法消息并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine}}}}]\null{}
如果适用，指定要使用的加密硬件。

当BIND使用带OpenSSL PKCS\#11支持构建时，这个缺省值是字符串 "pkcs11"，它标识一个可以驱动一个加密加速器或硬件服务模块的 OpenSSL引擎，当BIND使用带原生PKCS\#11加密 （--enable-native-pkcs11）构建时，它缺省是由"--with-pkcs11" 指定的PKCS\#11提供者库的路径。
\end{description}

\subsection*{定时选项}
\label{idm178367838400}

日期可以被表示成YYYYMMDD或YYYYMMDDHHMMSS格式。 如果参数以'+'或'-'开始，它将会被解释成自当前时间始的偏移量。 为方便起见，如果这个偏移量带有这些后缀之一，'y'，'mo'，'w'， 'd'，'h'或'mi'，这个偏移量就分别被以年（定义为365个24小时的天， 忽略闰年），月（定义为30个24小时的天），周，天，小时或分钟计算。 没有后缀时，偏移量以秒计算。要清除一个日期，使用'none'或'never'。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-P {\ttfamily\itshape{{date/offset}}}}]\null{}
设置一个密钥被发布到区的日期。在此日期之后，密钥将会被包含到 区中，但不会用于对其签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-A {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被激活的日期。在此日期之后，密钥将会被包含到区中并用于 对其签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-R {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被撤销的日期。在此日期之后，密钥将被标志为被撤销。 它将会被包含到区中并用于对其签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-I {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被退休的日期。在此日期之后，密钥仍然被包含在区中， 但它不再被用于签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D {\ttfamily\itshape{{date/offset}}}}]\null{}
设置密钥被删除的日期。在此日期之后，密钥将不再被包含在区中。 （然而，它可能仍然保留在密钥仓库中。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-S {\ttfamily\itshape{{predecessor key}}}}]\null{}
选择一个密钥，被修改的密钥是其明确的后继。前驱密钥的名字，算法， 大小，和类型必须与被修改密钥的精确匹配。 后继密钥的激活日期将被设置为前驱密钥的失效日期。 其发布日期被设置为激活日期减去发布前间隔，后者缺省是30天。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-i {\ttfamily\itshape{{interval}}}}]\null{}
为一个密钥设置发布前间隔。如果设置，则发布日期与激活日期之间必须 至少间隔这么多的日期。如果指定了激活日期而没有指定发布日期，则发 布日期缺省为激活日期之前这么多时间；相反地，如果指定了发布日期但 没有指定激活日期，则激活日期将被设置为在发布日期之后这么多时间。

正在被创建的密钥是另一个密钥的明确后继，则缺省的发布前间隔是30天； 否则就是零。

与日期偏移量相伴，如果参数后面有后缀‘y’，‘mo’，‘w’，‘d’， ‘h’，或‘mi’中的一个，则间隔的单位分别为年，月，周，天，小时， 分钟。没有后缀的情况，间隔的单位为秒。
\end{description}

\subsection*{打印选项}
\label{idm178367800928}

{\bfseries{dnssec-settime}}也能够被用于打印出与一个密钥 相关联的定时元数据。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-u}]\null{}
打印UNIX纪元格式的时间。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{C/P/A/R/I/D/all}}}}]\null{}
打印一个指定的元数据值或元数据值的集合。 {\texttt{{-p}}}选项可以跟随一个或多个下列字符，以表示要 打印哪一个或哪几个值： {\texttt{{C}}}表示创建日期， {\texttt{{P}}}表示发布日期， {\texttt{{A}}}表示激活日期， {\texttt{{R}}}表示撤销日期， {\texttt{{I}}}表示失效日期， {\texttt{{D}}}表示删除日期。 使用{\texttt{{-p all}}}打印所有的元数据。
\end{description}

\subsection*{参见}
\label{idm178367791488}

dnssec-keygen(8), dnssec-signzone(8), {\em{BIND 9管理员参考手册}}, {\em{RFC 5011}}.

\subsection*{作者}
\label{idm178367787456}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-signzone}
\label{man.dnssec-signzone}\hypertarget{man.dnssec-signzone}{}%
\label{idm178367781568}

\section*{名字}
dnssec-signzone --- DNSSEC区签名工具\label{idm178367772736}
\subsection*{概要}
\label{idm178367772480}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-signzone [{\texttt{{-a}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-d \textit{directory}}}}] [{\texttt{{-D}}}] [{\texttt{{-E \textit{engine}}}}] [{\texttt{{-e \textit{end-time}}}}] [{\texttt{{-f \textit{output-file}}}}] [{\texttt{{-g}}}] [{\texttt{{-h}}}] [{\texttt{{-K \textit{directory}}}}] [{\texttt{{-k \textit{key}}}}] [{\texttt{{-L \textit{serial}}}}] [{\texttt{{-l \textit{domain}}}}] [{\texttt{{-M \textit{domain}}}}] [{\texttt{{-i \textit{interval}}}}] [{\texttt{{-I \textit{input-format}}}}] [{\texttt{{-j \textit{jitter}}}}] [{\texttt{{-N \textit{soa-serial-format}}}}] [{\texttt{{-o \textit{origin}}}}] [{\texttt{{-O \textit{output-format}}}}] [{\texttt{{-P}}}] [{\texttt{{-p}}}] [{\texttt{{-R}}}] [{\texttt{{-r \textit{randomdev}}}}] [{\texttt{{-S}}}] [{\texttt{{-s \textit{start-time}}}}] [{\texttt{{-T \textit{ttl}}}}] [{\texttt{{-t}}}] [{\texttt{{-u}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] [{\texttt{{-X \textit{extended end-time}}}}] [{\texttt{{-x}}}] [{\texttt{{-z}}}] [{\texttt{{-3 \textit{salt}}}}] [{\texttt{{-H \textit{iterations}}}}] [{\texttt{{-A}}}] {zonefile} [key...]}
\end{list}

\subsection*{描述}
\label{idm178367739440}

{\bfseries{dnssec-signzone}}签名一个区。它生成NSEC和RRSIG记录并产生 一个区的签名版本。来自这个签名区的授权的安全状态（即，子区是否安全） 是由是否存在各个子区的{\texttt{{keyset}}}文件而决定的。

\subsection*{选项}
\label{idm178367737232}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a}]\null{}
验证所有生成的签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
指定区的DNS类。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-C}]\null{}
兼容模式：在对一个区签名时，除了生成 {\texttt{{dsset-\dbz{}{\ttfamily\itshape{{zonename}}}}}} 之外还生成 {\texttt{{keyset-\dbz{}{\ttfamily\itshape{{zonename}}}}}}， 用于旧版本的{\bfseries{dnssec-signzone}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d {\ttfamily\itshape{{directory}}}}]\null{}
在{\texttt{{directory}}}中查找{\texttt{{dsset-\dbz{}}}}或 {\texttt{{keyset-\dbz{}}}}文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D}]\null{}
输出那些仅由{\bfseries{dnssec-signzone}}自动管理的记录类型， 即RRSIG，NSEC，NSEC3和NSEC3PARAM记录。如果使用了智能签名 （{\texttt{{-S}}}），也包含DNSKEY记录。结果文件可以用 {\bfseries{\$INCLUDE}}包含进原始的区文件中。这个选项不能和 {\texttt{{-O raw}}}，{\texttt{{-O map}}}或序列号更新一起使用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine}}}}]\null{}
如果适用，指定要使用的加密硬件。

当BIND使用带OpenSSL PKCS\#11支持构建时，这个缺省值是字符串 "pkcs11"，它标识一个可以驱动一个加密加速器或硬件服务模块的 OpenSSL引擎，当BIND使用带原生PKCS\#11加密 （--enable-native-pkcs11）构建时，它缺省是由"--with-pkcs11" 指定的PKCS\#11提供者库的路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-g}]\null{}
为来自{\texttt{{dsset-\dbz{}}}}或{\texttt{{keyset-\dbz{}}}} 文件的子区生成DS记录。已经存在的DS将被删除。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-K {\ttfamily\itshape{{directory}}}}]\null{}
密钥仓库：为搜索DNSSEC密钥指定一个目录。 如果未指定，缺省为当前目录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k {\ttfamily\itshape{{key}}}}]\null{}
将指定的密钥当作密钥签名密钥并忽略所有密钥标志。这个选项可以 指定多次。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-l {\ttfamily\itshape{{domain}}}}]\null{}
在生成密钥（DNSKEY）和DS集合之外还生成一个DLV集合。 域被添加到记录名之后。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-M {\ttfamily\itshape{{maxttl}}}}]\null{}
为签名区设置最大TTL。 输入区中任何超过{\ttfamily\itshape{{maxttl}}}的TTL在输出中将被 减小到{\ttfamily\itshape{{maxttl}}}。 这为签名区中最大可能的TTL提供了确定性，这对知道何时轮转密钥是非常 有用的，因为这是被解析器取走的签名能够在解析器缓存中保存的最长可能的 时间， 使用这个选项签名的区应该配置成在{\texttt{{named.\dbz{}conf}}}中 使用一个一致的{\texttt{{max-zone-ttl}}}。 （注意：这个选项与{\texttt{{-D}}}不兼容，因为它修改了输出区中的 非DNSSEC数据。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s {\ttfamily\itshape{{start-time}}}}]\null{}
指定所生成的RRSIG记录生效的日期和时间。这个可以是一个绝对或 相对时间。一个绝对开始时间由一个YYYYMMDDHHMMSS格式的数所指明； 20000530144500表示2000年5月30日14:45:00（UTC）。一个相对开始 时间由+N所指明，N是从当前时间开始的秒数。如果没有指定 {\texttt{{start-time}}}，就使用当前时间减1小时（允许时钟 误差）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-e {\ttfamily\itshape{{end-time}}}}]\null{}
指定所生成的RRSIG记录过期的日期和时间。与 {\texttt{{start-time}}}一样，一个绝对时间由YYYYMMDDHHMMSS 格式所指明。一个相对于开始时间的时间由+N所指明，即自开始时间 之后N秒。一个相对于当前时间的时间由now+N所指明。如果没有指定 {\texttt{{end-time}}}，就使用开始时间30天后作为缺省值。 {\texttt{{end-time}}}必须比{\texttt{{start-time}}}更晚。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-X {\ttfamily\itshape{{extended end-time}}}}]\null{}
指定为DNSKEY资源记录集而生成的RRSIG记录的过期日期和时间。这是用于 DNSKEY签名的有效时间需要比其它记录签名的有效时间持续更长的情况； 例如，当KSK的私密部份被离线保存并且需要手动刷新KSK签名时。

与{\texttt{{start-time}}}一样，一个绝对时间由YYYYMMDDHHMMSS 格式所指明。一个相对于开始时间的时间由+N所指明，即自开始时间 之后N秒。一个相对于当前时间的时间由now+N所指明。如果没有指定 {\texttt{{extended end-time}}}，就使用 {\texttt{{end-time}}}的值作为缺省值。（相应地， {\texttt{{end-time}}}的缺省值为开始时间的30天后。） {\texttt{{extended end-time}}}必须比 {\texttt{{start-time}}}更晚。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{output-file}}}}]\null{}
包含签名区的输出文件的名字。缺省是在输入文件名后面添加 {\texttt{{.\dbz{}signed}}}。如果{\texttt{{output-file}}}被 设置成{\texttt{{"-\dbz{}"}}}，签名区将被写到标准输出，以缺省的输出 格式“full”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印{\bfseries{dnssec-signzone}}的选项和参数的简短摘要。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-i {\ttfamily\itshape{{interval}}}}]\null{}
当一个先前已签名的区被作为输入，记录可能被再次签名。 {\texttt{{interval}}}选项指定作为自当前时间开始的偏移量 （以秒计）的循环间隔。如果一个RRSIG记录在这个循环间隔后过期， 它会被保留。否则，它被考虑为马上过期，并被替代。

缺省的循环间隔是签名的结束时间和开始时间之差的四分之一，所以 如果既不指定{\texttt{{end-time}}}，也不指定 {\texttt{{start-time}}}，{\bfseries{dnssec-signzone}} 生成的签名在30天内有效，并带有7.5天的循环间隔。所以，如果任何现存 的RRSIG记录将在7.5天以内过期，它们将会被替代。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-I {\ttfamily\itshape{{input-format}}}}]\null{}
输入区文件的格式。可能的格式是{\bfseries{"text"}}（缺省）， {\bfseries{"raw"}}和{\bfseries{"map"}}。 这个选项主要用于动态签名区，这样一个包含动态更新的以非文本格式转储 的区文件就可以被直接签名。 使用这个选项对非动态区没有意义。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-j {\ttfamily\itshape{{jitter}}}}]\null{}
在使用一个固定的签名生存时间对一个区签名时，所有的RRSIG 记录都分配了几乎是同时的签名过期时间。如果区被增量签名， 例如，一个先前签过名的区作为输入传递给签名者，所有过期 的签名必须在大致相同的时间被重新生成。 {\texttt{{jitter}}}选项指定了一个抖动窗口，用来随机 化签名的过期时间，这样就将增量签名的重生成扩展到一个时 间段。

签名生存时间抖动通过分散缓存过期时间对验证者和服务器也 有某种程度的帮助，例如，如果所有的缓冲中都没有大量RRSIG 在同一时间过期，就比所有验证者需要在几乎相同的时刻来重新 获取记录有更少的拥塞。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-L {\ttfamily\itshape{{serial}}}}]\null{}
当以'raw'或'map'格式输出一个签名区时，在头部中设置"source serial"值 以指定序列号。（这个功能预期主要用于测试目的。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-n {\ttfamily\itshape{{ncpus}}}}]\null{}
指定要使用的线程个数。缺省时，为每个被检测到的CPU绑定一个线程。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-N {\ttfamily\itshape{{soa-serial-format}}}}]\null{}
签名区的SOA序列号格式。可能的格式有{\bfseries{"keep"}} （缺省），{\bfseries{"increment"}}和 {\bfseries{"unixtime"}}。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{"keep"}}}]\null{}
不改变SOA序列号。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{"increment"}}}]\null{}
使用RFC 1982算术增加SOA序列号。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{"unixtime"}}}]\null{}
将SOA序列号设置为UNIX纪元以来的秒数。
\end{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-o {\ttfamily\itshape{{origin}}}}]\null{}
区起点。如果未指定，就使用区名作为起点。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-O {\ttfamily\itshape{{output-format}}}}]\null{}
包含签名区的输出文件的格式。可能的格式为{\bfseries{"text"}} （缺省），它是区的标准文本格式；{\bfseries{"full"}}，它是以 文本输出的适合由外部脚本处理的格式，和{\bfseries{"map"}}， {\bfseries{"raw"}}和{\bfseries{"raw=N"}}，它是以二进制 格式存储区以便{\bfseries{named}}快速加载。 {\bfseries{"raw=N"}}指定raw区文件的格式版本：如果N为0，raw 区文件可以被任何版本的{\bfseries{named}}读取；如果N为1，这个 文件则只能被9.9.0或更高版本读取。缺省为1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p}]\null{}
在签名区时使用伪随机数据。这样比使用真随机数据更快，但安全性 较低。这个选项在签名区较大或者在熵源有限的时候可能会有用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-P}]\null{}
关闭签名验证后测试。

签名验证后测试确保对每个用到的算法都有至少一个非撤销自签名 的KSK密钥，所有撤销的KSK都是自签名的，以及区中所有记录都是 由这个算法所签名的。 这个选项跳过这些测试。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-Q}]\null{}
删除不再活动的密钥的签名。

通常情况，当一个以前已经签名的区被作为输入传递给签名者时，并且一个 DNSKEY记录被删除且被一个新的所替代时，来自旧密钥的并且仍在其有效期 内的签名将被保留。这允许区继续使用缓存中的旧DNSKEY资源记录集来作验 证。{\texttt{{-Q}}}强制{\bfseries{dnssec-signzone}}删除 不再活动的密钥的签名。 这使ZSK使用RFC 4641第4.2.1.1部份 （“Pre-Publish Key Rollover”）中描述的过程进行轮转。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-R}]\null{}
删除不再公开的密钥的签名。

这个选项与{\texttt{{-Q}}}相似，除了它强制 {\bfseries{dnssec-signzone}}从不再公开的密钥签名之外。 这使ZSK使用RFC 4641第4.2.1.2部份 （“Double Signature Zone Signing Key Rollover”）中描述的过程 进行轮转。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r {\ttfamily\itshape{{randomdev}}}}]\null{}
指定随机性的源。如果操作系统不提供 {\texttt{{/\dbz{}dev/\dbz{}random}}}或等效的设备，缺省的随机性的源为 键盘输入。{\texttt{{randomdev}}}指定一个字符设备名或包含 随机数据的文件名，用来替代缺省值。特定值 {\texttt{{keyboard}}}指示使用键盘输入。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-S}]\null{}
智能签名：指示{\bfseries{dnssec-signzone}}在密钥仓库中 搜索与被签名区匹配的密钥，如果有合适的还要将其包含到区中。

当找到了一个密钥时，就检查其计时元数据以决定如何根据以下的 规则来使用它。每个后面的规则优先于其之前的规则：

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{}]\null{}
如果没有为密钥指定计时元数据，密钥被发布在区中并用于 对区签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{}]\null{}
如果设置了密钥的发布日期并且已经到了，密钥就被发布到 区中。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{}]\null{}
如果设置了密钥的激活日期并且已经到了，密钥就被发布 （忽略发布日期） 并用于对区签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{}]\null{}
如果设置了密钥的撤销日期并且已经到了，并且密钥已被发布， 就撤销密钥，已撤销的密钥可用于对区签名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{}]\null{}
如果设置了密钥的停止公开日期或删除日期之一并且已经到了， 密钥不再公开或用于对区签名，而不管任何其它元数据。
\end{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-T {\ttfamily\itshape{{ttl}}}}]\null{}
为从密钥仓库导入到区中的新DNSKEY记录指定一个TTL。 如果未指定，缺省是区的SOA记录中的TTL值。当不使用 {\texttt{{-S}}}签名时这个选项被忽略，因为在那种情况下， 不会从密钥仓库导入DNSKEY记录。同样，如果在区顶点存在任何 DNSKEY记录时，也会忽略这个选项，在这个情况中，新记录的TTL值将会被 设置成与其匹配，或者如果任何被导入的DNSKEY记录有一个缺省的TTL值时 也会被忽略。在导入密钥中的TTL值有冲突的情况下，使用时间最短的一个。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t}]\null{}
在完成时打印统计结果。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-u}]\null{}
当对之前已签过名的区重新签名时更新NSEC/NSEC3链。带有这个选项 时，一个使用NSEC签名的区可以转换到NSEC3，或者一个使用NSEC3 签名的区可以转换为NSEC或其它参数的NSEC3。没有这个选项时， 重新签名时，{\bfseries{dnssec-signzone}}将维持已存在 的链。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-x}]\null{}
仅使用密钥签名密钥对DNSKEY资源记录集签名，并忽略来自区签名密钥 的签名。（这与{\bfseries{named}}中的 {\bfseries{dnssec-dnskey-kskonly yes;}}区选项相似。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-z}]\null{}
在决定要签名什么东西时，忽略密钥中的KSK标志。这导致有KSK标志 的密钥对所有记录签名，而不仅仅是DNSKEY资源记录集。（这与 {\bfseries{named}}中的 {\bfseries{update-check-ksk no;}}区选项相似。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-3 {\ttfamily\itshape{{salt}}}}]\null{}
使用给定的十六进制编码的干扰值（salt）生成一个NSEC3链。 在生成NSEC3链时，可以使用一个破折号 （{\ttfamily\itshape{{salt}}}） 来指示不使用干扰值（salt）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-H {\ttfamily\itshape{{iterations}}}}]\null{}
在生成一个NSEC3链时，使用这么多次循环。缺省是10。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-A}]\null{}
在生成一个NSEC3链时，设置所有NSEC3记录的OPTOUT标志，并且不 为不安全的授权生成NSEC3记录。

使用这个选项两次（例如，{\texttt{{-AA}}}）关闭所有记录的 OPTOUT标志。这在使用{\texttt{{-u}}}选项修改一个先前具有 OPTOUT集合的NSEC3链时很有用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{zonefile}]\null{}
包含被签名区的文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{key}]\null{}
指定应该使用那个密钥来签名这个区。如果没有指定密钥， 会对区进行检查，在区顶点找DNSKEY记录。如果在当前目录 找到并与私钥匹配，这个就会用于签名。
\end{description}

\subsection*{例子}
\label{idm178367593456}

下列命令使用由{\bfseries{dnssec-keygen}}所生成的DSA密钥 （Kexample.com.+003+17247）对{\ttfamily\bfseries{{example.\dbz{}com}}}区 签名。因为现在没有使用{\bfseries{-S}}选项，区的密钥必须在 主文件中（{\texttt{{db.\dbz{}example.\dbz{}com}}}）。 这个需要在当前目录查找{\texttt{{dsset}}}文件，这样DS记录 可以从中导入（{\bfseries{-g}}）。

\begin{Verbatim}[]
% dnssec-signzone -g -o example.com db.example.com \
Kexample.com.+003+17247
db.example.com.signed
%
\end{Verbatim}

在上述例子中，{\bfseries{dnssec-signzone}}创建文件 {\texttt{{db.\dbz{}example.\dbz{}com.\dbz{}signed}}}。这个文件被 {\texttt{{named.\dbz{}conf}}}文件中的区语句所引用。

这个例子使用缺省参数重新对先前的签名区签名。假定私钥存放在当前目录。

\begin{Verbatim}[]
% cp db.example.com.signed db.example.com
% dnssec-signzone -o example.com db.example.com
db.example.com.signed
%
\end{Verbatim}

\subsection*{参见}
\label{idm178367586144}

dnssec-keygen(8), {\em{BIND 9管理员参考手册}}, {\em{RFC 4033}}, {\em{RFC 4641}}.

\subsection*{作者}
\label{idm178367582784}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{dnssec-verify}
\label{man.dnssec-verify}\hypertarget{man.dnssec-verify}{}%
\label{idm178367576960}

\section*{名字}
dnssec-verify --- DNSSEC区验证工具\label{idm178367573680}
\subsection*{概要}
\label{idm178367573424}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{dnssec-verify [{\texttt{{-c \textit{class}}}}] [{\texttt{{-E \textit{engine}}}}] [{\texttt{{-I \textit{input-format}}}}] [{\texttt{{-o \textit{origin}}}}] [{\texttt{{-v \textit{level}}}}] [{\texttt{{-V}}}] [{\texttt{{-x}}}] [{\texttt{{-z}}}] {zonefile}}
\end{list}

\subsection*{描述}
\label{idm178367565280}

{\bfseries{dnssec-verify}} 验证一个区是被区中每个DNSKEY资源记录集中的算法完整地签名，并且 NSEC/NSEC3链是完整的。

\subsection*{选项}
\label{idm178367563536}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
指定区的DNS类。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine}}}}]\null{}
如果适用，指定要使用的加密硬件。

当BIND使用带OpenSSL PKCS\#11支持构建时，这个缺省值是字符串 "pkcs11"，它标识一个可以驱动一个加密加速器或硬件服务模块的 OpenSSL引擎，当BIND使用带原生PKCS\#11加密 （--enable-native-pkcs11）构建时，它缺省是由"--with-pkcs11" 指定的PKCS\#11提供者库的路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-I {\ttfamily\itshape{{input-format}}}}]\null{}
输入区文件的格式。 可能的格式为{\bfseries{"text"}}（缺省）和 {\bfseries{"raw"}}。 这个选项的主要目的是用于动态签名区，使导出的区文件以一个 非文本的格式，其中所包含的更新可以被独立地验证。 使用这个选项对非动态区没有更多的意义。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-o {\ttfamily\itshape{{origin}}}}]\null{}
区原点。如果未设置，区文件的名字被当成原点。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v {\ttfamily\itshape{{level}}}}]\null{}
设置调试级别。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打印版本信息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-x}]\null{}
只验证使用密钥签名密钥签名的DNSKEY资源记录集。没有这个标志时， 假定DNSKEY资源记录集被所有活动的密钥签名。当设置了这个标志时， 如果DNSKEY资源记录集未被区签名密钥签名也不成为一个错误。这对应 着{\bfseries{dnssec-signzone}}中的{\texttt{{-x}}}选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-z}]\null{}
在决定区是否被正确签名时，忽略密钥中的KSK标志。没有这个标志时， 假设存在一个为撤销，自签名的DNSKEY，它带有对应于每种算法的KSK 标志集，并且DNSKEY资源记录集之外的其它资源记录集都被一个没有 KSK标志集的另一个DNSKEY所签名。

设置了这个标志时，我们只要求对每种算法，都存在至少一个非活动的， 自签名的DNSKEY，不管其KSK标志状态，并且其它资源记录集被一个 对应同样算法的非活动密钥签名，这个算法包含自签名密钥；同一密钥 可以用于两个目的。这对应着{\bfseries{dnssec-signzone}}中 的{\texttt{{-z}}}选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{zonefile}]\null{}
包含被签名区的文件。
\end{description}

\subsection*{参见}
\label{idm178367538976}

dnssec-signzone(8), {\em{BIND 9 Administrator Reference Manual}}, {\em{RFC 4033}}.

\subsection*{作者}
\label{idm178367535904}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{named-checkconf}
\label{man.named-checkconf}\hypertarget{man.named-checkconf}{}%
\label{idm178367524800}

\section*{名字}
named-checkconf --- named配置文件语法检查工具\label{idm178367523408}
\subsection*{概要}
\label{idm178367523152}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{named-checkconf [{\texttt{{-h}}}] [{\texttt{{-v}}}] [{\texttt{{-j}}}] [{\texttt{{-t \textit{directory}}}}] {filename} [{\texttt{{-p}}}] [{\texttt{{-x}}}] [{\texttt{{-z}}}]}
\end{list}

\subsection*{描述}
\label{idm178367517648}

{\bfseries{named-checkconf}}检查一个{\bfseries{named}} 配置文件的语法，但是不检查语义。将会分析配置文件及其所有包含的文件 并检查语法错误，缺省是读{\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}。

注意：{\bfseries{named}}在分离的分析器上下文中所读的文件，如 {\texttt{{rndc.\dbz{}key}}}和{\texttt{{bind.\dbz{}keys}}}，是 不会自动被{\bfseries{named-checkconf}}读取的。即使 {\bfseries{named-checkconf}}成功，这些文件中的错误也可能导致 {\bfseries{named}}启动失败。然而， {\bfseries{named-checkconf}}可以显式地检查这些文件。

\subsection*{选项}
\label{idm178367511424}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印用法摘要并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{directory}}}}]\null{}
改变根到{\texttt{{directory}}}，这样在配置文件中 包含的指令就象运行在类似的被改变了根的named中一样被处理。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v}]\null{}
打印{\bfseries{named-checkconf}}程序的版本并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p}]\null{}
如果没有检测到错误，以正规形式打印 {\texttt{{named.\dbz{}conf}}}和被包含文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-x}]\null{}
在以规范形式打印配置文件时，通过替代为问号（‘?’）串的方式 隐藏共享密钥。这允许{\texttt{{named.\dbz{}conf}}}的内容和 相关的文件被共享 --- 例如，当提交错误报告时 --- 而不 损失私密数据。 这个选项在不用{\texttt{{-p}}}时不能使用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-z}]\null{}
执行{\texttt{{named.\dbz{}conf}}}中所有主区的测试装载。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-j}]\null{}
在装载一个区文件时，如果存在日志文件，就读入。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{filename}]\null{}
所要检查的配置文件的名字。如果未指定，缺省为 {\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}。
\end{description}

\subsection*{返回值}
\label{idm178367493040}

{\bfseries{named-checkconf}}返回一个退出状态， 如果检测到错误为1，否则为0。

\subsection*{参见}
\label{idm178367491392}

named(8), named-checkzone(8), {\em{BIND 9管理员参考手册}}。

\subsection*{作者}
\label{idm178367487776}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{named-checkzone}
\label{man.named-checkzone}\hypertarget{man.named-checkzone}{}%
\label{idm178367474688}

\section*{名字}
named-checkzone, named-compilezone --- 区文件正确性检查和转换工具\label{idm178367472800}
\subsection*{概要}
\label{idm178367472544}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{named-checkzone [{\texttt{{-d}}}] [{\texttt{{-h}}}] [{\texttt{{-j}}}] [{\texttt{{-q}}}] [{\texttt{{-v}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-f \textit{format}}}}] [{\texttt{{-F \textit{format}}}}] [{\texttt{{-J \textit{filename}}}}] [{\texttt{{-i \textit{mode}}}}] [{\texttt{{-k \textit{mode}}}}] [{\texttt{{-m \textit{mode}}}}] [{\texttt{{-M \textit{mode}}}}] [{\texttt{{-n \textit{mode}}}}] [{\texttt{{-l \textit{ttl}}}}] [{\texttt{{-L \textit{serial}}}}] [{\texttt{{-o \textit{filename}}}}] [{\texttt{{-r \textit{mode}}}}] [{\texttt{{-s \textit{style}}}}] [{\texttt{{-S \textit{mode}}}}] [{\texttt{{-t \textit{directory}}}}] [{\texttt{{-T \textit{mode}}}}] [{\texttt{{-w \textit{directory}}}}] [{\texttt{{-D}}}] [{\texttt{{-W \textit{mode}}}}] {{\texttt{{-o \textit{filename}}}}} {zonename} {filename}}
\end{list}
\label{idm178367446720}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{named-compilezone [{\texttt{{-d}}}] [{\texttt{{-j}}}] [{\texttt{{-q}}}] [{\texttt{{-v}}}] [{\texttt{{-c \textit{class}}}}] [{\texttt{{-C \textit{mode}}}}] [{\texttt{{-f \textit{format}}}}] [{\texttt{{-F \textit{format}}}}] [{\texttt{{-J \textit{filename}}}}] [{\texttt{{-i \textit{mode}}}}] [{\texttt{{-k \textit{mode}}}}] [{\texttt{{-m \textit{mode}}}}] [{\texttt{{-n \textit{mode}}}}] [{\texttt{{-l \textit{ttl}}}}] [{\texttt{{-L \textit{serial}}}}] [{\texttt{{-r \textit{mode}}}}] [{\texttt{{-s \textit{style}}}}] [{\texttt{{-t \textit{directory}}}}] [{\texttt{{-w \textit{directory}}}}] [{\texttt{{-D}}}] [{\texttt{{-W \textit{mode}}}}] {zonename} {filename}}
\end{list}

\subsection*{描述}
\label{idm178367425584}

{\bfseries{named-checkzone}}检查一个区文件的语法和完整性。 它与{\bfseries{named}}在装载一个区时执行同样的检查。这使 {\bfseries{named-checkzone}}能在将区文件配置到一个名字服务 器之前对其进行有用的检查。

{\bfseries{named-compilezone}}与 {\bfseries{named-checkzone}}相似，但是它总是以一个特殊的 格式将区的内容转储到一个特定的文件中。另外，它缺省使用更加严 格的检查级别，因为转储的输出将用作一个实际的区文件并由 {\bfseries{named}}所装载。否则，在手工指定时，必须至少达 到named配置文件所指定的检查级别。

\subsection*{选项}
\label{idm178367421008}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d}]\null{}
打开调试。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印用法摘要并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-q}]\null{}
安静模式 - 仅仅有退出码。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v}]\null{}
打印{\bfseries{named-checkzone}}程序的版本并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-j}]\null{}
在装载区文件时读日志，如果后者存在。 日志文件名是由区文件名后加上字符串{\texttt{{.\dbz{}jnl}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-J {\ttfamily\itshape{{filename}}}}]\null{}
在装载区文件时，从给定的文件读日志，如果后者存在。（隐含-j）。 日志文件名是由区文件名后加上字符串{\texttt{{.\dbz{}jnl}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{class}}}}]\null{}
指定区的类。如果未指定，就假设为“IN”。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-i {\ttfamily\itshape{{mode}}}}]\null{}
对已装载区执行完整性检查。可能的模式为 {\bfseries{"full"}}（缺省）， {\bfseries{"full-sibling"}}， {\bfseries{"local"}}， {\bfseries{"local-sibling"}}和 {\bfseries{"none"}}。

模式{\bfseries{"full"}}检查指向A或AAAA记录的MX记录 （包括区内和区外主机名）。模式 {\bfseries{"local"}}仅仅检查指向区内主机名的MX记录。

模式{\bfseries{"full"}}检查指向A或AAAA记录的SRV记录 （包括区内和区外主机名）。模式 {\bfseries{"local"}}仅仅检查指向区内主机名的SRV记录。

模式{\bfseries{"full"}}检查指向A或AAAA记录的授权NS记录 （包括区内和区外主机名）。它也检查在区内与子域所广播记录匹 配的粘着地址记录。模式{\bfseries{"local"}}仅仅检查指向 区内主机名的NS记录，或者指向要求粘着记录存在，即名字服务器 在一个子区中，的NS记录。

模式{\bfseries{"full-sibling"}}和 {\bfseries{"local-sibling"}}关闭兄弟粘着记录检查，但是 其它方面分别与{\bfseries{"full"}} 和{\bfseries{"local"}}相同。

模式{\bfseries{"none"}}关闭所有检查。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f {\ttfamily\itshape{{format}}}}]\null{}
指定区文件格式。可能的格式为{\bfseries{"text"}} （缺省）， {\bfseries{"raw"}}和{\bfseries{"map"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-F {\ttfamily\itshape{{format}}}}]\null{}
指定输出文件的格式。 对{\bfseries{named-checkzone}}，这个不会有任何效果，除 非它转储区的内容。

可能的格式为{\bfseries{"text"}}（缺省），这是区的标准文本 表示形式，和{\bfseries{"map"}}，{\bfseries{"raw"}}及 {\bfseries{"raw=N"}}， 将会以二进制格式存放区以使{\bfseries{named}}快速装载它。 {\bfseries{"raw=N"}}指定raw区文件的格式版本：如果N是0， 原始文件可以被任何版本的{\bfseries{named}}读取；如果N是1， 则文件只能被9.9.0或更高版本读取。缺省为1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k {\ttfamily\itshape{{mode}}}}]\null{}
使用指定的失败模式执行{\bfseries{"check-names"}} 检查。可能的模式为{\bfseries{"fail"}} （{\bfseries{named-compilezone}}的缺省模式）， {\bfseries{"warn"}} （{\bfseries{named-checkzone}}的缺省模式）和 {\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-l {\ttfamily\itshape{{ttl}}}}]\null{}
为输入文件设定一个允许的最大TTL。 任何一个TTL大于这个值的记录都会导致区被拒绝。这类似于在 {\texttt{{named.\dbz{}conf}}}中使用 {\bfseries{max-zone-ttl}}选项。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-L {\ttfamily\itshape{{serial}}}}]\null{}
当将一个区编译成"raw"或"map"格式时，将头部中的"source serial"值 设置为指定的序列号。（预料这个功能主要被用于测试目的。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-m {\ttfamily\itshape{{mode}}}}]\null{}
指定是否检查MX记录以查看其是否为地址。可能的模式为 {\bfseries{"fail"}}，{\bfseries{"warn"}}（缺省） 和{\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-M {\ttfamily\itshape{{mode}}}}]\null{}
检查一个MX记录是否指向一个CNAME记录。可能的模式为 {\bfseries{"fail"}}，{\bfseries{"warn"}}（缺省） 和{\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-n {\ttfamily\itshape{{mode}}}}]\null{}
指定是否检查NS记录以查看其是否为地址。可能的模式为 {\bfseries{"fail"}}（{\bfseries{named-compilezone}} 的缺省模式），{\bfseries{"warn"}} （{\bfseries{named-checkzone}}的缺省模式）和 {\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-o {\ttfamily\itshape{{filename}}}}]\null{}
写区的输出到{\texttt{{filename}}}。 如果{\texttt{{filename}}}是{\texttt{{-\dbz{}}}}， 就写到标准输出。这个对 {\bfseries{named-compilezone}}是必须的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r {\ttfamily\itshape{{mode}}}}]\null{}
检查在DNSSEC中被当作不同的，但是在普通DNS语义上却是相等的记录。 可能的模式为{\bfseries{"fail"}}， {\bfseries{"warn"}}（缺省）和 {\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s {\ttfamily\itshape{{style}}}}]\null{}
指定导出的区文件的风格。可能的模式为{\bfseries{"full"}} （缺省）和{\bfseries{"relative"}}。full格式最适合用一个 单独的脚本自动进行处理。在另一方面，relative格式对人来说更易 读，因而适合手工编辑。对{\bfseries{named-checkzone}}， 这个不会有任何效果，除非它转储区的内容。如果输出格式不是文本， 它也没有任何意义。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-S {\ttfamily\itshape{{mode}}}}]\null{}
检查一个SRV记录是否指向一个CNAME记录。可能的模式为 {\bfseries{"fail"}}，{\bfseries{"warn"}}（缺省） 和{\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{directory}}}}]\null{}
改变根到{\texttt{{directory}}}，这样在配置文件中 包含的指令就象运行在类似的被改变了根的named中一样被处理。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-T {\ttfamily\itshape{{mode}}}}]\null{}
检查发送方策略框架（SPF，Sender Policy Framework）记录是否存在 并在不存在一个SPF格式的TXT记录时发出一个警告。可能的模式为 {\bfseries{"warn"}} （缺省），{\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-w {\ttfamily\itshape{{directory}}}}]\null{}
改变目录为{\texttt{{directory}}}，这样在主文件\$INCLUDE 指令中的相对文件名就可以工作。这与 {\texttt{{named.\dbz{}conf}}}中的directory子句相似。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D}]\null{}
以正式格式转储区文件。对{\bfseries{named-compilezone}} 这总是打开的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-W {\ttfamily\itshape{{mode}}}}]\null{}
指定是否检查非终结通配符。非终结通配符几乎总是对通配符匹配算法 （RFC 1034）理解失败的结果。可能的模式为 {\bfseries{"warn"}}（缺省）和{\bfseries{"ignore"}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{zonename}]\null{}
要检查的区的域名。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{filename}]\null{}
区文件名。
\end{description}

\subsection*{返回值}
\label{idm178367330128}

{\bfseries{named-checkzone}}返回一个退出状态，如果检测到错误 为1，否则为0。

\subsection*{参见}
\label{idm178367328496}

named(8)， named-checkconf(8)， {\em{RFC 1035}}， {\em{BIND 9管理员参考手册}}。

\subsection*{作者}
\label{idm178367324464}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{named}
\label{man.named}\hypertarget{man.named}{}%
\label{idm178367318576}

\section*{名字}
named --- 互联网域名服务器\label{idm178367310448}
\subsection*{概要}
\label{idm178367310192}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{named [{\texttt{{-4}}}] [{\texttt{{-6}}}] [{\texttt{{-c \textit{config-file}}}}] [{\texttt{{-d \textit{debug-level}}}}] [{\texttt{{-D \textit{string}}}}] [{\texttt{{-E \textit{engine-name}}}}] [{\texttt{{-f}}}] [{\texttt{{-g}}}] [{\texttt{{-m \textit{flag}}}}] [{\texttt{{-n \textit{\#cpus}}}}] [{\texttt{{-p \textit{port}}}}] [{\texttt{{-s}}}] [{\texttt{{-S \textit{\#max-socks}}}}] [{\texttt{{-t \textit{directory}}}}] [{\texttt{{-U \textit{\#listeners}}}}] [{\texttt{{-u \textit{user}}}}] [{\texttt{{-v}}}] [{\texttt{{-V}}}] [{\texttt{{-x \textit{cache-file}}}}]}
\end{list}

\subsection*{描述}
\label{idm178367293376}

{\bfseries{named}}是一个域名系统（DNS）服务器，是由ISC发布的BIND 9 的一部份。关于更多DNS的信息，参考RFC 1033，1034，1035。

在没有参数时调用，{\bfseries{named}}将读缺省的配置文件 {\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}，从其中读入所有初始数据，并监听端口 以待请求。

\subsection*{选项}
\label{idm178367290304}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-4}]\null{}
即使主机支持IPv6，也只使用IPv4。{\texttt{{-4}}}和 {\texttt{{-6}}}是互斥的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-6}]\null{}
即使主机支持IPv4，也只使用IPv6。{\texttt{{-4}}}和 {\texttt{{-6}}}是互斥的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{config-file}}}}]\null{}
使用{\ttfamily\itshape{{config-file}}}作为配 置文件，以取代缺省的{\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}。由于配置 文件中可能的{\texttt{{directory}}}选项，服务器改变了其工作目录。 要保证重新装入配置文件之后能够继续工作， {\ttfamily\itshape{{config-file}}}应该是一个 绝对路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-d {\ttfamily\itshape{{debug-level}}}}]\null{}
设置服务器守护进程的调试级别为 {\ttfamily\itshape{{debug-level}}}。随着调试 级别的增加，来自{\bfseries{named}}的调试跟踪信息就会更冗长。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-D {\ttfamily\itshape{{string}}}}]\null{}
指定一个用于在一个进程列表中标识一个{\bfseries{named}} 实例的字符串。{\ttfamily\itshape{{string}}} 的内容是未检查过的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-E {\ttfamily\itshape{{engine-name}}}}]\null{}
如果适用，指定要使用的加密硬件。

当BIND使用带OpenSSL PKCS\#11支持构建时，这个缺省值是字符串 "pkcs11"，它标识一个可以驱动一个加密加速器或硬件服务模块的 OpenSSL引擎，当BIND使用带原生PKCS\#11加密 （--enable-native-pkcs11）构建时，它缺省是由"--with-pkcs11" 指定的PKCS\#11提供者库的路径。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-f}]\null{}
在前台运行服务器（如，不做守护进程化）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-g}]\null{}
在前台运行服务器并强制将所有日志写到{\texttt{{stderr}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-m {\ttfamily\itshape{{flag}}}}]\null{}
打开内存使用的调试标志。可能的标志是 {\ttfamily\itshape{{usage}}}， {\ttfamily\itshape{{trace}}}， {\ttfamily\itshape{{record}}}， {\ttfamily\itshape{{size}}}和 {\ttfamily\itshape{{mctx}}}。这些与 ISC\_MEM\_DEBUGXXXX相关的标志在 {\texttt{{<isc/\dbz{}mem.\dbz{}h>}}}中描述。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-n {\ttfamily\itshape{{\#cpus}}}}]\null{}
创建{\ttfamily\itshape{{\#cpus}}}个工作线程来 利用多个CPU。如果未指定，{\bfseries{named}}会试图决定CPU的个 数并为每个CPU创建一个线程。如果它不能决定CPU的数量，就只创建一个工 作线程。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{port}}}}]\null{}
在端口{\ttfamily\itshape{{port}}}监听请求。如 果未指定，缺省是53端口。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s}]\null{}
在退出时将内存使用统计写到{\texttt{{stdout}}}。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

这个选项主要是BIND 9的开发者对其有兴趣，在未来的版本中可能被去掉 或改变。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{-S {\ttfamily\itshape{{\#max-socks}}}}]\null{}
允许{\bfseries{named}}使用最大数量直到 {\ttfamily\itshape{{\#max-socks}}}的套接字。 在使用缺省配置选项构建的系统上缺省值为4096，在使用 "configure --with-tuning=large"构建的系统上缺省值为21000。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/warning}{警告}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

这个选项对大量的多数用户而言是不需要的。使用这个选项甚至 是有害的，因为所指定的值可能超过下层系统API的限制。因此 仅仅在缺省配置会耗尽文件描述符并且确认运行环境支持所指定 数目的套接字时才设置它。还要注意的是实际的最大数目通常比 所指定的值小一点点，因为{\bfseries{named}}保留一些 文件描述符供其内部使用。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{directory}}}}]\null{}
在处理命令行参数之后而在读配置文件之前，将根改变为 {\ttfamily\itshape{{directory}}}。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/warning}{警告}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

这个选项应该与-u选项结合使用， 这个选项应该与{\texttt{{-u}}}选项结合使用，因为 改变一个以root用户运行的进程的根目录在大多数系统上 并不增强安全性；定义{\texttt{{chroot(2)}}} 的方式允许一个具有root特权的进程逃出一个改变根限制。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{-U {\ttfamily\itshape{{\#listeners}}}}]\null{}
在每个地址上使用 {\ttfamily\itshape{{\#listeners}}}个工作线程 来监听UDP请求。如果未指定，{\bfseries{named}}将基于检测到的 CPU个数计算一个缺省值：1个CPU为1，2-4个CPU为2，大于4个CPU为检测到 的CPU个数除以2。如果将{\texttt{{-n}}}设置为比检测到的CPU数目 更大的值，{\texttt{{-U}}}将会增加到同样的值，但不会超过它。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-u {\ttfamily\itshape{{user}}}}]\null{}
在完成特权操作后，设置用户ID(setuid)为 {\ttfamily\itshape{{user}}}，这样就可以创建套 接字，使其监听在特权端口上。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/note}{注意}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

在Linux上，{\bfseries{named}}使用内核提供的机制来放弃所有 的root特权，除{\texttt{{bind(2)}}}到一个特权端口和设置 进程资源限制的能力之外。很遗憾，这意谓着当 {\bfseries{named}}运行在2.2.18之后或2.3.99-pre3之后的内核 上时，{\texttt{{-u}}}选项才能工作，因为之前的内核不允许 {\texttt{{setuid(2)}}}之后保留特权。
\end{admonition}

% \null and \mbox are tricks to induce different typesetting decisions
\item[{-v}]\null{}
报告版本号并退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
报告版本号和编译选项，然后退出。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-x {\ttfamily\itshape{{cache-file}}}}]\null{}
从{\ttfamily\itshape{{cache-file}}}装入数据到 缺省视图的缓存中。

\begin{admonition}{/usr/local/share/db2latex/xsl/figures/warning}{警告}% NOTICE: see the db2latex FAQ w.r.t db2latex variable $latex.admonition.path

这个选项必须不能使用。仅仅是BIND 9的开发者对其有兴趣，在未来的版 本中可能被去掉或改变。
\end{admonition}

\end{description}

\subsection*{信号}
\label{idm178367222464}

在常规操作中，信号不应该用于控制名字服务器；应该使用 {\bfseries{rndc}}来代替。

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{SIGHUP}]\null{}
强制服务器重新装载。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{SIGINT, SIGTERM}]\null{}
关闭服务器。
\end{description}

发送任何其它信号到服务器的结果都未定义。

\subsection*{配置}
\label{idm178367216432}

{\bfseries{named}}的配置文件太复杂而无法在这里详细描述。完整的描述 在{\em{BIND 9管理员参考手册}}中提供。

{\bfseries{named}}从父进程继承{\texttt{{umask}}} （文件创建模式掩码）。如果文件由{\bfseries{named}}创建， 如日志文件，就需要具有定制的权限，就应当在用于启动 {\bfseries{named}}进程的脚本中显式地设置 {\texttt{{umask}}}。

\subsection*{文件}
\label{idm178367211600}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}}]\null{}
缺省配置文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{/\dbz{}var/\dbz{}run/\dbz{}named/\dbz{}named.\dbz{}pid}}}}]\null{}
缺省进程ID文件。
\end{description}

\subsection*{参见}
\label{idm178367206848}

{\em{RFC 1033}}, {\em{RFC 1034}}, {\em{RFC 1035}}, named-checkconf(8), named-checkzone(8), rndc(8), lwresd(8), named.conf(5), {\em{BIND 9管理员参考手册}}。

\subsection*{作者}
\label{idm178367198192}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{named-journalprint}
\label{man.named-journalprint}\hypertarget{man.named-journalprint}{}%
\label{idm178367192352}

\section*{名字}
named-journalprint --- 以人可读的格式打印区日志文件\label{idm178367188992}
\subsection*{概要}
\label{idm178367188736}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{named-journalprint {\textit{journal}}}
\end{list}

\subsection*{描述}
\label{idm178367186816}

{\bfseries{named-journalprint}} 以人可读的格式打印一个区的日志文件的内容。

日志文件是在动态区有变化时（例如，通过{\bfseries{nsupdate}}） 由{\bfseries{named}}自动创建的。它们以二进制格式记录了每一个 资源记录的增加和删除，允许当服务器在宕机或崩溃之后的重启后将改变 重新应用到区中。缺省时，日志文件的名字由相应区文件的名字加上扩展名 {\texttt{{.\dbz{}jnl}}}组成。 zone file.

{\bfseries{named-journalprint}}将一个给定日志文件转换为一个 人可读的文本格式。每行都以“add”或“del”开头，以指明记录是否被 增加或删除，并以主区文件格式连续放置资源记录。

\subsection*{参见}
\label{idm178367182096}

named(8), nsupdate(8), {\em{BIND 9管理员参考手册}}.

\subsection*{作者}
\label{idm178367178352}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{named-rrchecker}
\label{man.named-rrchecker}\hypertarget{man.named-rrchecker}{}%
\label{idm178367172528}

\section*{名字}
named-rrchecker --- 一个针对单个DNS资源记录的语法检查器\label{idm178367169168}
\subsection*{概要}
\label{idm178367168912}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{named-rrchecker [{\texttt{{-h}}}] [{\texttt{{-o \textit{origin}}}}] [{\texttt{{-p}}}] [{\texttt{{-u}}}] [{\texttt{{-C}}}] [{\texttt{{-T}}}] [{\texttt{{-P}}}]}
\end{list}

\subsection*{描述}
\label{idm178367163904}

{\bfseries{named-rrchecker}} 从标准输入读取单个DNS资源记录并检查其在语句构成上是否正确。

{\texttt{{-h}}}打印输出标准菜单。

{\texttt{{-o {\ttfamily\itshape{{origin}}}}}} 选项指定一个用于解释记录时的原点。

{\texttt{{-p}}}以正规形式打印输出结果记录。如果不存在正规形式的 定义，就以未知记录格式打印记录。

{\texttt{{-u}}}以未知记录形式打印输出结果记录。

{\texttt{{-C}}}，{\texttt{{-T}}}和{\texttt{{-P}}}分别打印 输出已知的类，标准类型和私有类型助记符。

\subsection*{参见}
\label{idm178367156720}

{\em{RFC 1034}}, {\em{RFC 1035}}, named(8)
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{nsupdate}
\label{man.nsupdate}\hypertarget{man.nsupdate}{}%
\label{idm178367148960}

\section*{名字}
nsupdate --- 动态DNS更新工具\label{idm178367140048}
\subsection*{概要}
\label{idm178367139792}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{nsupdate [{\texttt{{-d}}}] [{\texttt{{-D}}}] [{\texttt{{-g}}} | {\texttt{{-o}}} | {\texttt{{-l}}} | {\texttt{{-y \textit{[hmac:]keyname:secret}}}} | {\texttt{{-k \textit{keyfile}}}}] [{\texttt{{-t \textit{timeout}}}}] [{\texttt{{-u \textit{udptimeout}}}}] [{\texttt{{-r \textit{udpretries}}}}] [{\texttt{{-R \textit{randomdev}}}}] [{\texttt{{-v}}}] [{\texttt{{-T}}}] [{\texttt{{-P}}}] [{\texttt{{-V}}}] [filename]}
\end{list}

\subsection*{描述}
\label{idm178367127040}

{\bfseries{nsupdate}} 是用于提交在RFC 2136中所定义的动态DNS更新请求给一个名字服务器。 这允许在不用手工编辑区文件的情况下增加或删除一个区的资源记录。 一个更新请求可以包含增加或删除多个资源记录的请求。

在由{\bfseries{nsupdate}}进行动态控制之下的区或者 一个DHCP服务器不应该由手工编辑。手工编辑可能与动态更新 相冲突并导致数据丢失。

使用{\bfseries{nsupdate}}动态增加或删除的资源记录必须 在同一个区内。 请求发给区的主服务器。 这由区的SOA记录的MNAME字段来标识。

{\texttt{{-d}}}选项使{\bfseries{nsupdate}}运行在 调试模式。 它提供关于所生成的更新请求和从名字服务器收到的回复的跟踪信息。

{\texttt{{-D}}}选项让{\bfseries{nsupdate}}报告比 {\texttt{{-d}}}更多的附加调试信息。

{\texttt{{-L}}}选项带有一个整数参数，为0或更大，用于设置 日志的调试级别。如果为0，就关掉日志。

事务签名可以被用于认证动态DNS更新。 这些使用在RFC 2845中所描述的TSIG资源记录或者在RFC 2535和RFC 2931 中所描述的SIG(0)记录或者在RFC 3645中所描述的GSS-TSIG。 TSIG依赖于一个仅有{\bfseries{nsupdate}}和名字服务器所知道 一个共享密钥。 当前，TSIG中唯一支持的加密算法是在RFC 2104中所定义的HMAC-MD5。 一旦为TSIG定义了其它算法，应用程序需要确保在相互认证时，它们选择 合适的算法，如同选择合适的密钥一样。 例如，合适的key和server语句会被添加到 {\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}，这样名字服务器可以将合适 的密钥和算法关联到将会使用TSIG认证的客户端应用所在的IP地址上。 SIG(0)使用概要加密算法。要使用一个SIG(0)密钥，公钥必须存放在 名字服务器所服务的区的一个KEY记录中。 {\bfseries{nsupdate}}不会读 {\texttt{{/\dbz{}etc/\dbz{}named.\dbz{}conf}}}。 GSS-TSIG使用Kerberos凭证。标准的GSS-TSIG模式使用 {\texttt{{-g}}}标志打开。Windows 2000所使用的一个非标准兼容的 GSS-TSIG变体可以用{\texttt{{-o}}}标志打开。

{\bfseries{nsupdate}} 使用{\texttt{{-y}}}或{\texttt{{-k}}}选项提供生成一个 认证动态DNS更新请求的TSIG记录所需的共享密钥，缺省是HMAC-MD5。 这些选项是互斥的。

当使用了{\texttt{{-y}}}选项时，从 [{\ttfamily\itshape{{hmac:}}}]{\ttfamily\itshape{{keyname:secret}}} 生成一个签名。 {\ttfamily\itshape{{keyname}}}是密钥的名字，而 {\ttfamily\itshape{{secret}}}是base64编码的共享密钥。 {\ttfamily\itshape{{hmac}}}是密钥算法名；有效的选择为 {\texttt{{hmac-\dbz{}md5}}}， {\texttt{{hmac-\dbz{}sha1}}}，{\texttt{{hmac-\dbz{}sha224}}}， {\texttt{{hmac-\dbz{}sha256}}}，{\texttt{{hmac-\dbz{}sha384}}}或 {\texttt{{hmac-\dbz{}sha512}}}。如果未指定{\ttfamily\itshape{{hmac}}}， 缺省是{\texttt{{hmac-\dbz{}md5}}}。 注意：不鼓励使用{\texttt{{-y}}}选项，因为共享密钥是以 文本形式作为命令行参数提供的。在 ps(1)的输出或者在用户的shell所维护的历史文件中， 这个可能是可见的。

使用{\texttt{{-k}}}选项， {\bfseries{nsupdate}}从文件 {\ttfamily\itshape{{keyfile}}}读入共享密钥。密钥文件可以 有两种格式：一个包含一个{\texttt{{named.\dbz{}conf}}}-格式 的{\bfseries{key}}语句的文件，它可以由 {\bfseries{ddns-confgen}}自动生成，或者一对文件，其 文件名格式是 {\texttt{{K\docbooktolatexgobble\string\{name\docbooktolatexgobble\string\}.\dbz{}+\dbz{}157.\dbz{}+\dbz{}\docbooktolatexgobble\string\{random\docbooktolatexgobble\string\}.\dbz{}private}}}和 {\texttt{{K\docbooktolatexgobble\string\{name\docbooktolatexgobble\string\}.\dbz{}+\dbz{}157.\dbz{}+\dbz{}\docbooktolatexgobble\string\{random\docbooktolatexgobble\string\}.\dbz{}key}}}，它们可以 由{\bfseries{dnssec-keygen}}生成。 {\texttt{{-k}}}也可以用于指定一个用于认证动态DNS更新请求的SIG(0) 密钥。在这个情况下，所指定的密钥不是一个HMAC-MD5密钥。

{\bfseries{nsupdate}}可以用于一个只local-host的模式， 通过使用{\texttt{{-l}}}标志。这将会把服务器地址设置为 localhost（关闭{\bfseries{server}}，这样服务器地址 就不能被覆盖）。到本地服务器的连接将使用在 {\texttt{{/\dbz{}var/\dbz{}run/\dbz{}named/\dbz{}session.\dbz{}key}}}中找到的一个 TSIG密钥，如果有任何本地主区的{\bfseries{update-policy}} 设置为{\bfseries{local}}，这个密钥可以由{\bfseries{named}} 自动生成。这个密钥文件的位置可以使用{\texttt{{-k}}} 选项覆盖。

缺省时，{\bfseries{nsupdate}}使用UDP发送更新请求给名字服务器， 除非它们太大不能装进一个UDP请求中，这种情况将使用TCP。 {\texttt{{-v}}}选项让{\bfseries{nsupdate}}使用一个TCP连接。 当有一批更新请求时，这个可能是更优的。

{\texttt{{-p}}}设置用于连接一个名字服务器的缺省端口。缺省 为53.

{\texttt{{-t}}}选项设置一个更新请求在其被中断之前可以持续的最大 时间。缺省是300秒。0可以用来关掉超时。

{\texttt{{-u}}}选项设置UDP重试间隔。缺省是3秒。如果为0，这个间隔 将会从超时间隔和UDP重试次数中计算得到。

{\texttt{{-r}}}选项设置UDP重试次数。缺省是3。如果为0，仅仅会生成 一次更新请求。

{\texttt{{-R {\ttfamily\itshape{{randomdev}}}}}}选项 指定一个随机性的源。如果操作系统不提供 {\texttt{{/\dbz{}dev/\dbz{}random}}}或等效的设备，缺省的随机性的源为 键盘输入。{\texttt{{randomdev}}}指定一个字符设备名或包含 随机数据的文件名，用来替代缺省值。特定值 {\texttt{{keyboard}}}指示使用键盘输入。 这个选项可以指定多次。

其它类型可以使用"TYPEXXXXX"键入，这里"XXXXX"是不以零开始的类型的 十进制值。如果有资源数据（rdata），它将被分析成使用UNKNOWN资源数据格式， （\textless{}backslash\textgreater{} \textless{}hash\textgreater{} \textless{}space\textgreater{} \textless{}length\textgreater{} \textless{}space\textgreater{} \textless{}hexstring\textgreater{}）。

{\texttt{{-T}}}和{\texttt{{-P}}}选项打印输出非元类型的列表， 对这些类型来说，其类型专用的表示格式是已知的。 {\texttt{{-T}}}打印输出由IANA分配类型的列表。{\texttt{{-P}}}打印 输出指定给{\bfseries{named}}的私有类型的列表。这些选项可以组合。 {\bfseries{nsupdate}}将在打印列表后退出。

-V选项使{\bfseries{nsupdate}}打印版本号并退出。

\subsection*{输入格式}
\label{idm178367082064}

{\bfseries{nsupdate}} 从{\ttfamily\itshape{{filename}}}或标准输入读取输入。 每个命令刚好在一个输入行内。 一些命令是出于管理的目的。 其它的命令要么是更新指令，要么是检查区内容的先决条件。 这些检查设置条件，即一些名字或资源记录集要么存在，要么 不存在于区中。 如果要让整个更新请求成功，这些条件必须被满足。 如果对先决条件的测试失败，更新将被拒绝。

每个更新请求由0个或多个先决条件以及0个或多个更新所组成。 如果某些指定的资源记录出现或不出现在区中，这允许一个合适的经过 认证的更新请求进行处理。 一个空输入行（或{\bfseries{send}}命令）导致所有累积的命令被 作为一个动态DNS更新请求发送给名字服务器。

命令格式及其含义如下： 
\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{server}}  {servername}  [port]}]\null{}
发送所有更新请求给名字服务器 {\ttfamily\itshape{{servername}}}。 当没有提供server语句时，{\bfseries{nsupdate}}将发送 更新请求给正确的区的主服务器。 这个区的SOA记录中的MNAME字段将会标识这个区的主服务器。 {\ttfamily\itshape{{port}}} 是接收动态更新请求的 {\ttfamily\itshape{{servername}}} 上的端口号。 如果没有指定端口号，就使用缺省的DNS端口号53。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{local}}  {address}  [port]}]\null{}
使用本地{\ttfamily\itshape{{address}}}发送所有动态更新请求给 名字服务器。 当没有提供local语句时， 将使用系统所选择的一个地址和端口发送更新。 {\ttfamily\itshape{{port}}}还可以用在使请求来自一个 指定的端口。 如果没有指定端口号，系统将会分配一个。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{zone}}  {zonename}}]\null{}
指定所有的更新都发生在区 {\ttfamily\itshape{{zonename}}}上。 如果没有提供{\ttfamily\itshape{{zone}}}语句， {\bfseries{nsupdate}}会试图基于其余的输入来决定正确的区。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{class}}  {classname}}]\null{}
指定缺省类。如果没有指定 {\ttfamily\itshape{{class}}}，缺省类是 {\ttfamily\itshape{{IN}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{ttl}}  {seconds}}]\null{}
指定要添加记录的缺省生存期。 值{\ttfamily\itshape{{none}}}将清除缺省生存期。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{key}}  [hmac:] {keyname}  {secret}}]\null{}
指定所有的更新都用 {\ttfamily\itshape{{keyname}}} {\ttfamily\itshape{{secret}}} 对进行TSIG签名。 如果指定了{\ttfamily\itshape{{hmac}}}，它将设置签名使用的算法； 缺省是{\texttt{{hmac-\dbz{}md5}}}。 {\bfseries{key}}命令覆盖任何在命令行由 {\texttt{{-y}}}或{\texttt{{-k}}}所指定的 密钥。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{gsstsig}}}]\null{}
使用GSS-TSIG对更新签名。这个等效于在命令行指定 {\texttt{{-g}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{oldgsstsig}}}]\null{}
使用Windows 2000版的GSS-TSIG对更新签名。这个等效于在命令行指定 {\texttt{{-o}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{realm}}  {[realm\_name]}}]\null{}
在使用GSS-TSIG时，用{\ttfamily\itshape{{realm\_name}}}而不是 {\texttt{{krb5.\dbz{}conf}}}中的缺省realm。如果未指定realm， 则已保存的realm将被清除。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[prereq] nxdomain}}  {domain-name}}]\null{}
要求名字{\ttfamily\itshape{{domain-name}}}没有存在任何类型的 资源记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[prereq] yxdomain}}  {domain-name}}]\null{}
要求{\ttfamily\itshape{{domain-name}}}存在（至少有一个 资源记录，可以是任何类型）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[prereq] nxrrset}}  {domain-name}  [class]  {type}}]\null{}
要求指定的{\ttfamily\itshape{{type}}}， {\ttfamily\itshape{{class}}}和 {\ttfamily\itshape{{domain-name}}}不存在任何资源记录。 如果省略 {\ttfamily\itshape{{class}}}，就假定为IN（internet）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[prereq] yxrrset}}  {domain-name}  [class]  {type}}]\null{}
这个要求指定的{\ttfamily\itshape{{type}}}， {\ttfamily\itshape{{class}}}和 {\ttfamily\itshape{{domain-name}}}必须存在一个资源记录。 如果省略{\ttfamily\itshape{{class}}}， 就假定为IN（internet）。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[prereq] yxrrset}}  {domain-name}  [class]  {type}  {data...}}]\null{}
来自每个这种形式的先决条件集合的 {\ttfamily\itshape{{data}}}共享一个共同的 {\ttfamily\itshape{{type}}}， {\ttfamily\itshape{{class}}}和 {\ttfamily\itshape{{domain-name}}}，并被组合成一个 资源记录集合的形式。 这个资源记录集合必须精确地匹配区中以 {\ttfamily\itshape{{type}}}， {\ttfamily\itshape{{class}}}和 {\ttfamily\itshape{{domain-name}}}给出的已存在的资源记录 集合。 {\ttfamily\itshape{{data}}}以资源记录RDATA的标准文本表示 方法书写。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[update] del[ete]}}  {domain-name}  [ttl]  [class]  [type  [data...]]}]\null{}
删除名为{\ttfamily\itshape{{domain-name}}}的任何资源记录。 如果提供了{\ttfamily\itshape{{type}}}和 {\ttfamily\itshape{{data}}}，只有匹配的资源记录会被删除。 如果没有提供{\ttfamily\itshape{{class}}}，就假设是 internet类。{\ttfamily\itshape{{ttl}}}被忽略，仅为了 兼容性而允许之。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{[update] add}}  {domain-name}  {ttl}  [class]  {type}  {data...}}]\null{}
使用指定的{\ttfamily\itshape{{ttl}}}， {\ttfamily\itshape{{class}}}和 {\ttfamily\itshape{{data}}}增添一个新的 资源记录。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{show}}}]\null{}
显示当前消息，包含自上次发送以来所指定的所有 先决条件和更新。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{send}}}]\null{}
发送当前消息。这等效于输入一个空行。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{answer}}}]\null{}
显示回答。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{debug}}}]\null{}
打开调试。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{version}}}]\null{}
打印版本号。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\bfseries{help}}}]\null{}
打印命令表。
\end{description}


以一个分号开始的行是注释并被忽略。

\subsection*{例子}
\label{idm178366985872}

下面的例子显示{\bfseries{nsupdate}}如何被用于对 example.com区插入和删除资源记录。 注意每个例子中的输入包含一个结尾的空行，这样就将一组命令作为一个 动态更新请求发送给example.com的主名字服务器。 
\begin{Verbatim}[]

# nsupdate
> update delete oldhost.example.com A
> update add newhost.example.com 86400 A 172.16.1.1
> send

\end{Verbatim}


oldhost.example.com的任何A记录 被删除。 newhost.example.com的一个带有 IP地址172.16.1.1的A记录被添加。 新添加的记录具有一个1天的TTL（86400秒）。 
\begin{Verbatim}[]

# nsupdate
> prereq nxdomain nickname.example.com
> update add nickname.example.com 86400 CNAME somehost.example.com
> send

\end{Verbatim}


先决条件是让名字服务器检查没有nickname.example.com 的任何类型的资源记录。 如果有，更新请求失败。 如果这个名字不存在，就为它添加一个CNAME。 这就确保了在添加CNAME时，不会与RFC 1034中的长标准规则相冲突，即如果一个 名字存在一个CNAME，就必须不能存在其它任何记录类型。 （这个规则在RFC 2535中为DNSSEC而被更新，以允许CNAME可以有RRSIG，DNSKEY 和NSEC记录。）

\subsection*{文件}
\label{idm178366979184}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{/etc/resolv.conf}}}}]\null{}
用于标识缺省的名字服务器。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{/var/run/named/session.key}}}}]\null{}
设置用于local-only模式的缺省TSIG密钥。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{K\{name\}.+157.+\{random\}.key}}}}]\null{}
由 dnssec-keygen(8)所创建的HMAC-MD5密钥的base-64编码。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\texttt{{K\{name\}.+157.+\{random\}.private}}}}]\null{}
由 dnssec-keygen(8)所创建的HMAC-MD5密钥的base-64编码。
\end{description}

\subsection*{参见}
\label{idm178366968656}

{\em{RFC 2136}}, {\em{RFC 3007}}, {\em{RFC 2104}}, {\em{RFC 2845}}, {\em{RFC 1034}}, {\em{RFC 2535}}, {\em{RFC 2931}}, named(8), ddns-confgen(8), dnssec-keygen(8).

\subsection*{BUGS}
\label{idm178366961408}

TSIG密钥是冗余存放在两个分离的文件中。 这是nsupdate为其加密操作使用DST库的一个后果，在将来的 版本中可能会变化。
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{rndc}
\label{man.rndc}\hypertarget{man.rndc}{}%
\label{idm178366955456}

\section*{名字}
rndc --- 名字服务器控制工具\label{idm178366949328}
\subsection*{概要}
\label{idm178366949072}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{rndc [{\texttt{{-b \textit{source-address}}}}] [{\texttt{{-c \textit{config-file}}}}] [{\texttt{{-k \textit{key-file}}}}] [{\texttt{{-s \textit{server}}}}] [{\texttt{{-p \textit{port}}}}] [{\texttt{{-q}}}] [{\texttt{{-V}}}] [{\texttt{{-y \textit{key\_id}}}}] {command}}
\end{list}

\subsection*{描述}
\label{idm178366940368}

{\bfseries{rndc}}控制一个名字服务器的运行。它替代了旧BIND发布版本所 提供的{\bfseries{ndc}}工具。如果{\bfseries{rndc}}在没有命令行 选项或参数时被调用，它将打印出其所支持的命令和可用选项和参数的简短总结。

{\bfseries{rndc}}通过一个TCP连接与名字服务器通信，发送经过数字签名 认证的命令。在当前版本的{\bfseries{rndc}}和{\bfseries{named}} 中，只支持的认证算法是HMAC-MD5（为了兼容），HMAC-SHA1，HMAC-SHA224， HMAC-SHA256（缺省），HMAC-SHA384和HMAC-SHA512。 他们在连接的两端使用共享密钥。 它为命令请求和名字服务器的响应提供TSIG类型的认证。所有经由通道发送的命令 都必须被一个服务器所知道的key\_id签名。

{\bfseries{rndc}}读一个配置文件来决定如何联系名字服务器并决定使用哪 一个算法和密钥。

\subsection*{选项}
\label{idm178366934624}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-b {\ttfamily\itshape{{source-address}}}}]\null{}
使用{\ttfamily\itshape{{source-address}}}作为 连接服务器的源地址。允许多个实例设置其IPv4和IPv6源地址。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{config-file}}}}]\null{}
使用{\ttfamily\itshape{{config-file}}}作为缺 省的配置文件{\texttt{{/\dbz{}etc/\dbz{}rndc.\dbz{}conf}}}的替代。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k {\ttfamily\itshape{{key-file}}}}]\null{}
使用{\ttfamily\itshape{{key-file}}}作为缺省的 密钥文件{\texttt{{/\dbz{}etc/\dbz{}rndc.\dbz{}key}}}的替代。如果 {\ttfamily\itshape{{config-file}}}不存在， {\texttt{{/\dbz{}etc/\dbz{}rndc.\dbz{}key}}}中的密钥将用于认证发向服务器的命 令。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s {\ttfamily\itshape{{server}}}}]\null{}
{\ttfamily\itshape{{server}}}是与 {\bfseries{rndc}}的配置文件中server语句相匹配的服务器 的名字或地址。如果命令行没有提供服务器，会使用 {\bfseries{rndc}}配置文件中options语句中的default-server 子句所命名的主机。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{port}}}}]\null{}
发送命令到TCP端口 {\ttfamily\itshape{{port}}}， 以取代BIND 9的缺省控制通道端口，953。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-q}]\null{}
安静模式：从服务器返回的消息文本将不被打印，除非存在错误。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-V}]\null{}
打开冗余日志。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-y {\ttfamily\itshape{{key\_id}}}}]\null{}
使用配置文件中的密钥 {\ttfamily\itshape{{key\_id}}}。 {\ttfamily\itshape{{key\_id}}}必须被named 所知道，带有同样的算法和密钥字符串，以便成功通过控制消息的验证。 如果没有指定 {\ttfamily\itshape{{key\_id}}}， {\bfseries{rndc}}将首先在所用的服务器的server语句中查找 key子句，或者如果没有为主机提供server语句，就查找options语句中 的default-key子句。注意配置文件中包含有用于发送认证控制命令到 名字服务器的共享密钥。因此它不应该具有通常的读或写的权限。
\end{description}

\subsection*{命令}
\label{idm178366907440}

{\bfseries{rndc}}所支持的命令列表，可以通过不带任何参数运行 {\bfseries{rndc}}来查看。

当前支持的命令是：

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{reload}}}}]\null{}
重新载入配置文件和区文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{reload {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
重新载入指定的区文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{refresh {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
对指定的区进行区维护。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{retransfer {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
重新从主服务器传送指定的区文件。

如果使用{\bfseries{inline-signing}}配置区，区的签名版本将被 丢弃；在重新传送非签名版本完成后，将使用所有新签名重新生成签名版本。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{sign {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
从密钥目录取给定区的所有DNSSEC密钥（参见BIND 9管理员参考手册 中的{\bfseries{key-directory}}）， 如果它们在其发布期内，将它们合并到区的DNSKEY资源记录集中。 如果DNSKEY资源记录集发生了变化，就自动使用新的密钥集合对区重新 签名。

这个命令要求{\bfseries{auto-dnssec}}区选项被设置为 {\texttt{{allow}}}或{\texttt{{maintain}}}，还要求区 被配置为允许动态更新。（更详细情况参见管理员参考手册中的 “动态更新策略”。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{loadkeys {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
从密钥目录取给定区的所有DNSSEC密钥。如果它们在其发布期内，将它们 合并到区的DNSKEY资源记录集中。然而，与{\bfseries{rndc sign}} 不同，不会立即使用新密钥重签区，但是允许随时间推移进行增量重签。

这个命令要求{\bfseries{auto-dnssec}}区选项 被设置为{\texttt{{maintain}}}，而且还要求区被配置 为允许动态DNS。（更详细情况参见管理员参考手册中的 “动态更新策略”。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{freeze [{\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]]}}}}]\null{}
冻结对一个动态更新区的更新。如果没有指定区，就冻结对 所有区的更新。这就允许对一个动态更新方式正常更新的区 进行手工编辑。它也会导致日志文件中的变化被同步到 主区文件。 在区被冻结时，所有的动态更新尝试都会被拒绝。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{thaw [{\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]]}}}}]\null{}
解冻一个被冻结的动态更新区。如果没有指定区，就解冻所有 被冻结的区。它会导致服务器重新从磁盘载入区，并在载入 完成后打开动态更新功能。在解冻一个区后。动态更新请求将 不会被拒绝。 如果区被修改并且使用了{\bfseries{ixfr-from-differences}} 选项，将修改日志文件以对应到区的变化。否则，如果区被修改， 将会删除所有现存的日志文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{scan}}}}]\null{}
扫描可用网络接口列表以查看变化，不执行完全的 {\bfseries{reconfig}}，也不等待 {\bfseries{interface-interval}}计时器。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{sync [-\dbz{}clean] [{\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]]}}}}]\null{}
将一个动态区中日志文件的变化部分同步到其区文件。如果指定了 “-clean”选项，会将日志文件删除。如果未指定区，将同步所有区。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{notify {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
重新发出区的NOTIFY消息。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{reconfig}}}}]\null{}
重新载入配置文件和新的区，但是不载入已经存在的区文件， 即使其已经被修改过。这在有大量区的时候可以比完全的 {\bfseries{reload}}更快，因为它避免了去检查 区文件的修改时间。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{stats}}}}]\null{}
显示给定区的当前状态，包含主文件名以及它加载时包含的所有文件， 最近加载的时间，当前序列号，节点数目，区是否支持动态更新，区 是否作了DNSSEC签名，它是否使用动态DNSSEC密钥管理或inline签名， 以及区的预期刷新或过期时间。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{stats}}}}]\null{}
写服务器的统计信息到统计文件。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{querylog}}}}]\null{}
打开或关闭请求日志。（为向后兼容，可以不带参数使用这个命令，即 请求日志在开和关之间切换。

请求日志也可以显式打开，通过在 {\texttt{{named.\dbz{}conf}}}的 {\bfseries{logging}}部份指定 {\bfseries{queries}} {\bfseries{category}} 到一个{\bfseries{channel}}，或者在 {\texttt{{named.\dbz{}conf}}}的 {\bfseries{options}}部份指定 {\bfseries{querylog yes;}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{dumpdb [-\dbz{}all|-\dbz{}cache|-\dbz{}zone] [{\ttfamily\itshape{{view .\dbz{}.\dbz{}.\dbz{}}}}]}}}}]\null{}
转储服务器指定视图的缓存（缺省情况）和/或区到 转储文件中。如果未指定视图就转储所有视图。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{secroots [{\ttfamily\itshape{{view .\dbz{}.\dbz{}.\dbz{}}}}]}}}}]\null{}
转储服务器的安全根到指定视图的secroots文件中。如果 没有指定视图，就转储所有视图的安全根。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{stop [-\dbz{}p]}}}}]\null{}
停止服务器，在之前先确保所有通过动态更新或IXFR所作的 最新修改第一时间被存入被修改区的区文件中。如果指定了 {\texttt{{-p}}}，将返回{\bfseries{named}}的 进程号。这可以让一个外部进程来检查 {\bfseries{named}}是否完全被停止。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{halt [-\dbz{}p]}}}}]\null{}
立即停止服务器。所有由动态更新或IXFR所作的最新改变没有 被存到区文件中，但是在服务器重新启动时，将从日志文件中 向前滚动。如果指定了{\texttt{{-p}}}，将返回 {\bfseries{named}}的进程号。这可以让一个外部进程 来检查{\bfseries{named}}是否完全被中断。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{trace}}}}]\null{}
将服务器的调试级别增加1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{trace {\ttfamily\itshape{{level}}}}}}}]\null{}
将服务器的调试级别设置为指定的值。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{notrace}}}}]\null{}
将服务器的调试级别设置为0。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{flush}}}}]\null{}
刷新服务器的缓存。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{flushname}}} {\ttfamily\itshape{{name}}}}]\null{}
刷新来自服务器的DNS缓存以及，如果合适，以及来自服务器的名字 服务器地址库或异常服务器缓存的给定名字。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{flushtree}}} {\ttfamily\itshape{{name}}} [{\ttfamily\itshape{{view}}}]}]\null{}
刷新来自服务器的DNS缓存，地址库或异常服务器缓存中的给定名字， 及其所有子域。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{status}}}}]\null{}
显示服务器的状态。注意，区数目包括内部的 {\bfseries{bind/CH}}区，如果没有显式配置根区 还包括缺省的{\bfseries{./IN}}区。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{recursing}}}}]\null{}
转储{\bfseries{named}}当前为其提供递归服务的 请求列表。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{validation (\dbz{} on | off | check )\dbz{} [{\ttfamily\itshape{{view .\dbz{}.\dbz{}.\dbz{}}}}]}}}}]\null{}
打开，关闭DNSSEC验证或检查DNSSEC验证的状态。 注意{\bfseries{dnssec-enable}}也需要设置成 {\ttfamily\bfseries{{yes}}}或{\ttfamily\bfseries{{auto}}}才能 生效。缺省打开的。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{tsig-\dbz{}list}}}}]\null{}
列出当前被配置由{\bfseries{named}}所使用的每个视图 中的全部TSIG密钥的名字。这个列表包含静态配置的密钥和动态 TKEY协商的密钥。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{tsig-\dbz{}delete}}} {\ttfamily\itshape{{keyname}}} [{\ttfamily\itshape{{view}}}]}]\null{}
从服务器删除所给出的TKEY协商的密钥。（这个命令不会删除 静态配置的TSIG密钥。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{addzone {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]] {\ttfamily\itshape{{configuration}}}}}}}]\null{}
在服务器运行时增加一个区。这个命令要求 {\bfseries{allow-new-zones}}选项被设置为 {\ttfamily\bfseries{{yes}}}。在命令行所指定的 {\ttfamily\itshape{{configuration}}}字符串就是 通常被放在{\texttt{{named.\dbz{}conf}}}中的区配置 文本。

配置被保存在名为 {\texttt{{{\ttfamily\itshape{{hash}}}.\dbz{}nzf}}} 的文件中，其中{\ttfamily\itshape{{hash}}}是由视图 的名字加密hash后所生成的。当{\bfseries{named}}被 重启时，这个文件将被转载到视图的配置中，这样被添加的区 将会在重启后能够持续。

这个例子{\bfseries{addzone}}命令将会添加区 {\texttt{{example.\dbz{}com}}}到缺省视图：

{\texttt{{\$}}}{\ttfamily\bfseries{{rndc addzone example.\dbz{}com '\docbooktolatexgobble\string\{ type master; file "example.\dbz{}com.\dbz{}db"; \docbooktolatexgobble\string\};'}}}

（注意围绕区配置文本的花括号和分号。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{delzone [-\dbz{}clean] {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
在服务器运行时删除一个区。只有最初由 {\bfseries{rndc addzone}}所增加的区才能用这种 方式删除。

如果指定了{\texttt{{-clean}}}，区的主文件（和日志文件， 如果有的话）将会随着区一块被删除。没有 {\texttt{{-clean}}}选项时，区文件必须手动清除。（如果 区是"slave"或"stub"类型时，{\bfseries{rndc delzone}} 命令的输出将报告需要清理的文件。）
% \null and \mbox are tricks to induce different typesetting decisions
\item[{{\ttfamily\bfseries{{signing [(\dbz{} -\dbz{}list | -\dbz{}clear {\ttfamily\itshape{{keyid/\dbz{}algorithm}}} | -\dbz{}clear {\texttt{{all}}} | -\dbz{}nsec3param (\dbz{} {\ttfamily\itshape{{parameters}}} | {\texttt{{none}}} )\dbz{} )\dbz{}] {\ttfamily\itshape{{zone}}} [{\ttfamily\itshape{{class}}} [{\ttfamily\itshape{{view}}}]]}}}}]\null{}
列出，编辑或删除指定区的DNSSEC签名状态记录。正在进行的DNSSEC操作 （如签名或生成NSEC3链）的状态以DNS资源记录类型 {\bfseries{sig-signing-type}}的形式存放在区中。 {\bfseries{rndc signing -list}}转换这些记录成为人可读的 格式，指明哪个密钥是当前签名所用，哪个已完成对区的签名，哪个 NSEC3链被创建和删除。

{\bfseries{rndc signing -clear}}可以删除单一的一个密钥 （以{\bfseries{rndc signing -list}}用来显示密钥的同一格式 所指定的），或所有密钥。在这两种情况下，只有完成的密钥才能被 删除；任何记录指明，一个没有完成签名的密钥将会被保留。

{\bfseries{rndc signing -nsec3param}}为一个区设置NSEC3参数。 这只是在与{\bfseries{inline-signing}}区一起使用NSEC3时才有 的支持机制。参数以与NSEC3PARAM资源记录同样的格式指定：hash算法， flags，iterations和salt，按上述顺序。

当前，hash算法唯一定义的值为{\texttt{{1}}}，表示SHA-1。 {\texttt{{flags}}}可以被设置为{\texttt{{0}}}或 {\texttt{{1}}}，取决与你是否希望设置NSEC3链中的opt-out位。 {\texttt{{iterations}}}定义额外次数的数字，它应用于生成NSEC3 hash的算法中。{\texttt{{salt}}}是一个表示成十六机制数的一串 数据，一个连字符（‘-’）表示不使用salt，或者关键字 {\texttt{{auto}}}，它使{\bfseries{named}}生成一个 随机64位salt。

例如，要创建一个NSEC3链，使用SHA-1 hash算法，没有opt-out标志， 10次循环，以及一个值为“FFFF”的salt，使用： {\bfseries{rndc signing -nsec3param 1 0 10 FFFF {\ttfamily\itshape{{zone}}}}}. 要设置opt-out标志，15次循环，没有salt，使用： {\bfseries{rndc signing -nsec3param 1 1 15 - {\ttfamily\itshape{{zone}}}}}.

{\bfseries{rndc signing -nsec3param none}} 删除一个现存的NSEC3链并使用NSEC替代它。
\end{description}

\subsection*{限制}
\label{idm178366776784}

{\bfseries{rndc}}还不支持BIND 8的{\bfseries{ndc}}工具中的所有 命令。

当前没有在不使用配置文件的方式下提供共享密钥{\texttt{{key\_id}}}的方式。

几个错误消息可以被清除。

\subsection*{参见}
\label{idm178366756976}

rndc.conf(5), rndc-confgen(8), named(8), named.conf(5), ndc(8), {\em{BIND 9管理员参考手册}}。

\subsection*{作者}
\label{idm178366750272}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{{\texttt{{rndc.\dbz{}conf}}}}
\label{man.rndc.conf}\hypertarget{man.rndc.conf}{}%
\label{idm178366744400}

\section*{名字}
{\texttt{{rndc.\dbz{}conf}}} --- rndc的配置文件\label{idm178366738368}
\subsection*{概要}
\label{idm178366738112}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{rndc.conf}
\end{list}

\subsection*{描述}
\label{idm178366737200}

{\texttt{{rndc.\dbz{}conf}}}是BIND 9名字服务器控制工具 {\bfseries{rndc}}的配置文件。这个文件有与 {\texttt{{named.\dbz{}conf}}}相似的结构和语法。语句包含 在花括号之内，并以分号结束。语句中的子句也以分号结束。 所支持的通常的注释风格为：

C风格：/* */

C++风格：// 到行尾

Unix风格：\# 到行尾

{\texttt{{rndc.\dbz{}conf}}}比 {\texttt{{named.\dbz{}conf}}}简短得多。文件使用三个语句： 一个options语句，一个server语句和一个key语句。

{\texttt{{options}}}语句包含五个子句。 {\texttt{{default-server}}}子句后跟名字或者一个名字服 务器的地址。在没有为{\bfseries{rndc}}提供名字服务器 参数时，将使用这个主机。 {\texttt{{default-key}}}子句后跟一个密钥名，这个密钥由 一个{\texttt{{key}}}语句标识。如果在rndc命令行没有提供 {\texttt{{keyid}}}，并且在一个匹配的 {\texttt{{server}}}语句中没有找到{\texttt{{key}}}子 句，就使用这个缺省的密钥来认证服务器的命令和响应。 {\texttt{{default-port}}}子句后跟要连接到的远程名字服务 器的端口。如果在rndc命令行没有提供{\texttt{{port}}}选项， 并且在一个匹配的{\texttt{{server}}}语句中没有找到 {\texttt{{port}}}子句，就使用这个缺省的端口来连接。 {\texttt{{default-source-address}}}和 {\texttt{{default-source-address-v6}}}子句可以分别 用来设置IPv4和IPv6的源地址。

在{\texttt{{server}}}关键字之后，server语句包含一个字符串， 代表一个名字服务器的主机名或地址。这个语句有三个可能的子句： {\texttt{{key}}}，{\texttt{{port}}}和 {\texttt{{addresses}}}。密钥名必须匹配文件中一个key语句的 名字。端口号指定要连接到的端口。如果提供了一个 {\texttt{{addresses}}}子句，将使用这些地址来代替服务器名 字。每个地址可以带有一个可选的端口。如果使用了 {\texttt{{source-address}}}或者 {\texttt{{source-address-v6}}}，这些会分别用于指定IPv4和 IPv6的源地址。

{\texttt{{key}}}语句以一个标识密钥名字的字符串开始。这个 语句有两个子句。{\texttt{{algorithm}}}定义 {\bfseries{rndc}}用到的认证算法；当前仅支持HMAC-MD5（为了兼容）， HMAC-SHA1，HMAC-SHA224，HMAC-SHA256（缺省），HMAC-SHA384和HMAC-SHA512。 它后跟一个secret子句，后者包含base-64编码的算法的认证密钥。 这个base-64字符串使用双引号引起来。

有两个通常的方式来生成密钥的base-64字符串。BIND 9程序 {\bfseries{rndc-confgen}}可以用来生成一个随机密钥，或者 {\bfseries{mmencode}}程序，也叫做 {\bfseries{mimencode}}，可以用来生成一个已知输入的base-64 字符串。{\bfseries{mmencode}}不随BIND 9提供，但是它在许多 系统上是可用的。关于每个命令行的样例，参见例子部份。

\subsection*{例子}
\label{idm178366716464}


\begin{Verbatim}[]

      options {
        default-server  localhost;
        default-key     samplekey;
      };

\end{Verbatim}



\begin{Verbatim}[]

      server localhost {
        key             samplekey;
      };

\end{Verbatim}



\begin{Verbatim}[]

      server testserver {
        key		testkey;
        addresses	{ localhost port 5353; };
      };

\end{Verbatim}



\begin{Verbatim}[]

      key samplekey {
        algorithm       hmac-sha256;
        secret          "6FMfj43Osz4lyb24OIe2iGEz9lf1llJO+lz";
      };

\end{Verbatim}



\begin{Verbatim}[]

      key testkey {
        algorithm	hmac-sha256;
        secret		"R3HI8P6BKw9ZwXwN3VZKuQ==";
      };
    
\end{Verbatim}


在上面的例子中，{\bfseries{rndc}}缺省将使用 localhost(127.0.0.1)作为服务器，和名为samplekey的密钥。到服务器 localhost的命令将使用密钥samplekey，后者也必须使用同样的名字和 密钥定义在服务器的配置文件中。key语句指明samplekey使用HAMC-SHA256 算法，它的secret子句包含这个HMAC-SHA256密钥的base-64编码，并被包括 在双引号中。

如果使用{\bfseries{rndc -s testserver}}， {\bfseries{rndc}}将会连接到服务器localhost的5353端口，并 使用密钥testkey。

使用{\bfseries{rndc-confgen}}生成一个随机密钥：

{\ttfamily\bfseries{{rndc-\dbz{}confgen}}}

一个完整的{\texttt{{rndc.\dbz{}conf}}}文件，包含随机生成 的密钥，将会被写到标准输出。还会打印出为 {\texttt{{named.\dbz{}conf}}}提供的被注释掉的 {\texttt{{key}}} 和{\texttt{{controls}}}语句。

使用{\bfseries{mmencode}}生成一个base-64密钥：

{\ttfamily\bfseries{{echo "known plaintext for a secret" | mmencode}}}

\subsection*{名字服务器配置}
\label{idm178366703616}

名字服务器必须被配置成接受rndc连接和识别 {\texttt{{rndc.\dbz{}conf}}}文件中所指定的密钥，这通过在 {\texttt{{named.\dbz{}conf}}}中的controls语句来实现。详细情况参见 BIND 9管理员参考手册中的{\texttt{{controls}}}语句部份。

\subsection*{参见}
\label{idm178366700880}

rndc(8)， rndc-confgen(8)， mmencode(1)， {\em{BIND 9管理员参考手册}}。

\subsection*{作者}
\label{idm178366696208}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{rndc-confgen}
\label{man.rndc-confgen}\hypertarget{man.rndc-confgen}{}%
\label{idm178366690320}

\section*{名字}
rndc-confgen --- rndc密钥生成工具\label{idm178366683888}
\subsection*{概要}
\label{idm178366683632}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{rndc-confgen [{\texttt{{-a}}}] [{\texttt{{-A \textit{algorithm}}}}] [{\texttt{{-b \textit{keysize}}}}] [{\texttt{{-c \textit{keyfile}}}}] [{\texttt{{-h}}}] [{\texttt{{-k \textit{keyname}}}}] [{\texttt{{-p \textit{port}}}}] [{\texttt{{-r \textit{randomfile}}}}] [{\texttt{{-s \textit{address}}}}] [{\texttt{{-t \textit{chrootdir}}}}] [{\texttt{{-u \textit{user}}}}]}
\end{list}

\subsection*{描述}
\label{idm178366672480}

{\bfseries{rndc-confgen}}为{\bfseries{rndc}}生 成配置文件。它可以用作一个方便手段，用以手工书写 {\texttt{{rndc.\dbz{}conf}}}文件及在 {\texttt{{named.\dbz{}conf}}}中写相应的 {\bfseries{controls}}和{\bfseries{key}}语句。作 为选择，它可以带有{\bfseries{-a}}选项运行来建立一个 {\texttt{{rndc.\dbz{}key}}}文件，以避免对 {\texttt{{rndc.\dbz{}conf}}}文件和一个 {\bfseries{controls}}语句的需求。

\subsection*{选项}
\label{idm178366666976}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a}]\null{}
做自动的{\bfseries{rndc}}配置。这会在 {\texttt{{/\dbz{}etc}}}（或其它在编译 BIND时所指定的 {\texttt{{sysconfdir}}}）建立一个文件 {\texttt{{rndc.\dbz{}key}}}，可以被 {\bfseries{rndc}}和{\bfseries{named}}两个在 启动时读取。{\texttt{{rndc.\dbz{}key}}}文件定义了一 个缺省的命令通道和认证密钥，它允许 {\bfseries{rndc}}与本机上的 {\bfseries{named}}通信而不需要更多的配置。

运行{\bfseries{rndc-confgen -a}}允许BIND 9和 {\bfseries{rndc}}作为BIND 8和 {\bfseries{ndc}}的简易替代，而不对现存的BIND 8的 {\texttt{{named.\dbz{}conf}}}做任何改变。

如果需要一个比{\bfseries{rndc-confgen -a}}所生成 的更加复杂的配置，例如如果rndc需要远程使用，你应该不 使用{\bfseries{-a}}选项运行 {\bfseries{rndc-confgen}}的并按指示设置 {\texttt{{rndc.\dbz{}conf}}}和 {\texttt{{named.\dbz{}conf}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-A {\ttfamily\itshape{{algorithm}}}}]\null{}
指定用于TSIG密钥的算法。可用的选择有： hmac-md5，hmac-sha1，hmac-sha224，hmac-sha256, hmac-sha384和hmac-sha512。缺省是hmac-md5。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-b {\ttfamily\itshape{{keysize}}}}]\null{}
指定认证密钥的位数。必须在1到512位之间；缺省是散列的大小。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-c {\ttfamily\itshape{{keyfile}}}}]\null{}
与{\bfseries{-a}}选项一起使用指定一个 {\texttt{{rndc.\dbz{}key}}}的替代位置。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印{\bfseries{rndc-confgen}}的选项和参数的简短摘要。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k {\ttfamily\itshape{{keyname}}}}]\null{}
指定rndc认证密钥的密钥名。这个必须是一个有效域名。缺省是 {\texttt{{rndc-key}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-p {\ttfamily\itshape{{port}}}}]\null{}
指定{\bfseries{named}}监听{\bfseries{rndc}}连接的 命令通道的端口。缺省是953。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r {\ttfamily\itshape{{randomfile}}}}]\null{}
指定用于生成授权的随机数据的源。如果操作系统不提供 {\texttt{{/\dbz{}dev/\dbz{}random}}}或等效的设备，缺省的随机性的源为 键盘输入。{\texttt{{randomdev}}}指定一个字符设备名或包含 随机数据的文件名，用来替代缺省值。特定值 {\texttt{{keyboard}}}指示使用键盘输入。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s {\ttfamily\itshape{{address}}}}]\null{}
指定{\bfseries{named}}监听{\bfseries{rndc}}连接的 命令通道的IP地址。缺省是环回地址127.0.0.1。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-t {\ttfamily\itshape{{chrootdir}}}}]\null{}
与{\bfseries{-a}}选项一起使用，指定{\bfseries{named}} 运行改变根的目录。一个附加的{\texttt{{rndc.\dbz{}key}}}拷贝会 写到相对于这个目录的位置，这样改变了根的{\bfseries{named}} 才能找到它。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-u {\ttfamily\itshape{{user}}}}]\null{}
与{\bfseries{-a}}选项一起使用，设置所生成的 {\texttt{{rndc.\dbz{}key}}}文件的拥有者。如果也指定了 {\bfseries{-t}}，只有改变了根的目录下的文件才改变其 拥有者。
\end{description}

\subsection*{例子}
\label{idm178366625408}

允许不用手工配置而使用{\bfseries{rndc}}，运行

{\ttfamily\bfseries{{rndc-\dbz{}confgen -\dbz{}a}}}

要打印一个例子{\texttt{{rndc.\dbz{}conf}}}文件和相对应的用于手工插入 {\texttt{{named.\dbz{}conf}}}的{\bfseries{controls}}和 {\bfseries{key}}语句，运行

{\ttfamily\bfseries{{rndc-\dbz{}confgen}}}

\subsection*{参见}
\label{idm178366620272}

rndc(8)， rndc.conf(5)， named(8)， {\em{BIND 9管理员参考手册}}。

\subsection*{作者}
\label{idm178366615600}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{ddns-confgen}
\label{man.ddns-confgen}\hypertarget{man.ddns-confgen}{}%
\label{idm178366609792}

\section*{名字}
ddns-confgen --- ddns密钥生成工具\label{idm178366606512}
\subsection*{概要}
\label{idm178366606256}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{tsig-keygen [{\texttt{{-a \textit{algorithm}}}}] [{\texttt{{-h}}}] [{\texttt{{-r \textit{randomfile}}}}] [name]}
\end{list}
\label{idm178366602336}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{ddns-confgen [{\texttt{{-a \textit{algorithm}}}}] [{\texttt{{-h}}}] [{\texttt{{-k \textit{keyname}}}}] [{\texttt{{-q}}}] [{\texttt{{-r \textit{randomfile}}}}] [-s \textit{name} | -z \textit{zone}]}
\end{list}

\subsection*{描述}
\label{idm178366594640}

{\bfseries{tsig-keygen}}和{\bfseries{ddns-confgen}} 是一个应用程序的调用方法，它为使用TSIG签名生成密钥。例如，作为 结果的密钥可以被用于加固对一个区的动态DNS更新或者用于 {\bfseries{rndc}}命令通道。

当作为{\bfseries{tsig-keygen}}运行时，可以在命令行指定一个 域名，它将被用作所生成密钥的名字。如果未指定名字，缺省为 {\texttt{{tsig-key}}}。

当作为{\bfseries{ddns-confgen}}运行时，所生成的密钥伴随有 设置动态DNS时用于{\bfseries{nsupdate}}和 {\bfseries{named}}的配置文件和指令，包括一个 {\bfseries{update-policy}}语句的例子。（这个用法类似于用 {\bfseries{rndc-confgen}}命令设置命令通道的安全。）

注意{\bfseries{named}}自己可以配置一个本地DDNS密钥， 并用于{\bfseries{nsupdate -l}}： 它在区被配置为{\bfseries{update-policy local;}}时才这样做。 {\bfseries{ddns-confgen}}只在更复杂的配置才需要： 例如，如果{\bfseries{nsupdate}}用于来自一个远程系统。

\subsection*{选项}
\label{idm178366585088}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-a {\ttfamily\itshape{{algorithm}}}}]\null{}
指定用于TSIG密钥的算法。可用的选择为：hmac-md5，hmac-sha1， hmac-sha224，hmac-sha256，hmac-sha384和hmac-sha512。缺省为 hmac-sha256。 选项是大小写无关的，前缀"hmac-"可以被忽略。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-h}]\null{}
打印选项和参数的一个简短摘要。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-k {\ttfamily\itshape{{keyname}}}}]\null{}
指定DDNS认证密钥的密钥名。当既没有指定 {\texttt{{-s}}}，也没有指定{\texttt{{-z}}}选项时， 缺省是{\texttt{{ddns-key}}}；否则，缺省将 {\texttt{{ddns-key}}}作为一个独立的标记，后跟选项的 参数，例如，{\texttt{{ddns-key.example.com.}}}。 密钥名必须是合法的域名，由字母，数字，连字符和点组成。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-q}]\null{}
（只对{\bfseries{ddns-confgen}}。）安静模式：只打印密钥， 没有解释的文本或用法举例； 这对{\bfseries{tsig-keygen}}基本相同。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-r {\ttfamily\itshape{{randomfile}}}}]\null{}
指定生成授权的随机数据的源。如果操作系统不提供 {\texttt{{/\dbz{}dev/\dbz{}random}}}或等效的设备，缺省的随机性的源为 键盘输入。{\texttt{{randomdev}}}指定一个字符设备名或包含 随机数据的文件名，用来替代缺省值。特定值 {\texttt{{keyboard}}}指示使用键盘输入。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-s {\ttfamily\itshape{{name}}}}]\null{}
（只对{\bfseries{ddns-confgen}}。） 给一个允许动态更新的单一主机名生成配置例子。 例子{\bfseries{named.conf}}文本显示了 如何使用“name”名字类型为指定的 {\ttfamily\itshape{{name}}}设置一个 更新策略。 缺省的密钥名字是 ddns-key.{\ttfamily\itshape{{name}}}。 注意“self”名字类型不再使用，因为要被更新的名字可能 与密钥名不同。 这个选项不能与{\texttt{{-z}}}选项同时使用。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-z {\ttfamily\itshape{{zone}}}}]\null{}
（只对{\bfseries{ddns-confgen}}。） 给一个允许动态更新的区生成配置例子。 例子{\bfseries{named.conf}}文本展示了如何使用 "zonesub"名字类型为所指定的 {\ttfamily\itshape{{zone}}} 设置一个更新策略，允许更新 {\ttfamily\itshape{{zone}}}内所有子域。 这个选项不能与{\texttt{{-s}}}选项同时使用。
\end{description}

\subsection*{参见}
\label{idm178366559024}

nsupdate(1), named.conf(5), named(8), {\em{BIND 9管理员参考手册}}.

\subsection*{作者}
\label{idm178366554352}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{arpaname}
\label{man.arpaname}\hypertarget{man.arpaname}{}%
\label{idm178366548544}

\section*{名字}
arpaname --- 将IP地址翻译成对应的ARPA名字\label{idm178366545216}
\subsection*{概要}
\label{idm178366544960}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{arpaname {\textit{ipaddress}...}}
\end{list}

\subsection*{描述}
\label{idm178366542816}

{\bfseries{arpaname}}将IP地址（IPv4和IPv6）翻译成 对应的IN-ADDR.ARPA或IP6.ARPA名字。

\subsection*{参见}
\label{idm178366541152}

{\em{BIND 9管理员参考手册}}.

\subsection*{作者}
\label{idm178423332864}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{genrandom}
\label{man.genrandom}\hypertarget{man.genrandom}{}%
\label{idm178375656736}

\section*{名字}
genrandom --- 生成一个包含随机数据的文件\label{idm178375652768}
\subsection*{概要}
\label{idm178375652512}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{genrandom [{\texttt{{-n \textit{number}}}}] {\textit{size}} {\textit{filename}}}
\end{list}

\subsection*{描述}
\label{idm178375648896}

{\bfseries{genrandom}} 生成一个或多个包含指定数量的伪随机数据的文件，在没有随机设备的系统上， 这些数据可以用作其它命令的熵源。

\subsection*{参数}
\label{idm178375647008}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{-n {\ttfamily\itshape{{number}}}}]\null{}
代替生成一个文件，生成{\texttt{{number}}}（从2到9）个文件， 在文件名后面附加{\texttt{{number}}}。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{size}]\null{}
要生成的文件大小，以千字节为单位。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{filename}]\null{}
要写入随机数据的文件名。
\end{description}

\subsection*{参见}
\label{idm178375639712}

rand(3), arc4random(3)

\subsection*{作者}
\label{idm178375636512}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{isc-hmac-fixup}
\label{man.isc-hmac-fixup}\hypertarget{man.isc-hmac-fixup}{}%
\label{idm178375630800}

\section*{名字}
isc-hmac-fixup --- 修补旧版本的BIND所生成的HMAC密钥\label{idm178375627216}
\subsection*{概要}
\label{idm178375626960}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{isc-hmac-fixup {\textit{algorithm}} {\textit{secret}}}
\end{list}

\subsection*{描述}
\label{idm178375624240}

BIND 9的各个版本直到并包含BIND 9.6都包含一个缺陷，它导致HMAC-SHA* TSIG 密钥比hash算法（如，SHA1密钥超过160位，SHA256密钥超过256位等等）的摘要 长度更长，因此不能正确使用，其生成一个消息认证码与其它DNS实现不兼容。

这个缺陷在BIND 9.7中被修补了。然而，这个修补可能导致在使用长的密钥时， 旧的和新的BIND版本之间不兼容。{\bfseries{isc-hmac-fixup}}修改了 那些密钥以恢复兼容性。

要修改一个密钥，运行{\bfseries{isc-hmac-fixup}}并在命令行指定 密钥的算法和口令。如果口令比算法的摘要长度更长（对SHA1到SHA256为64字节， 或者对SHA384和SHA512为128字节），将会生成一个新的口令，它由旧的口令 的一个hash摘要所组成。（如果口令不要求转换，就不加修改地输出它。）

\subsection*{安全考虑}
\label{idm178375619856}

被{\bfseries{isc-hmac-fixup}}所转换的口令被缩短了，但是这 就是HMAC协议的工作方式，它没有影响安全。RFC 2104中提到， “比[摘要长度]更长的密钥时可接受的，但是额外的长度不应较大地增加 函数的强度。”

\subsection*{参见}
\label{idm178375618048}

{\em{BIND 9管理员参考手册}}, {\em{RFC 2104}}.

\subsection*{作者}
\label{idm178375616128}

Internet Systems Consortium
% 
% -------------------------------------------------------------
% Refentry 
% ------------------------------------------------------------- 	
\section{nsec3hash}
\label{man.nsec3hash}\hypertarget{man.nsec3hash}{}%
\label{idm178375610544}

\section*{名字}
nsec3hash --- 生成NSEC3 hash值\label{idm178375607344}
\subsection*{概要}
\label{idm178375607088}
\begin{list}{}{\setlength{\itemindent}{-\leftmargin}\setlength{\parsep}{0mm}}
\item\raggedright\texttt{nsec3hash {\textit{salt}} {\textit{algorithm}} {\textit{iterations}} {\textit{domain}}}
\end{list}

\subsection*{描述}
\label{idm178375602352}

{\bfseries{nsec3hash}}基于一个NSEC3参数集生成一个NSEC3 hash值。 这可以用于检查一个签名区中NSEC3记录的有效性。

\subsection*{参数}
\label{idm178375600672}

\begin{description}
% \null and \mbox are tricks to induce different typesetting decisions
\item[{salt}]\null{}
提供给hash算法的salt。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{algorithm}]\null{}
一个表示hash算法的数字。当前对NSEC3唯一支持的hash算法是 SHA-1，由数字1表示；因此，“1”是这个参数唯一合法的值。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{iterations}]\null{}
hash应该额外执行的次数。
% \null and \mbox are tricks to induce different typesetting decisions
\item[{domain}]\null{}
被hash的域名。
\end{description}

\subsection*{参见}
\label{idm178375592768}

{\em{BIND 9管理员参考手册}}, {\em{RFC 5155}}.

\subsection*{作者}
\label{idm178375590848}

Internet Systems Consortium

\end{CJK*}
\end{document}

